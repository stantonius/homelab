2023-03-25 20:57:19,606 p=38584 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-25 20:57:19,606 p=38584 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-25 20:57:19,606 p=38584 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-25 20:57:19,611 p=38584 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-25 20:57:20,050 p=38584 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ***********************************************************************************************************************************************************************************
2023-03-25 20:57:20,068 p=38584 u=craig n=ansible | TASK [Gathering Facts ] *****************************************************************************************************************************************************************************************************
2023-03-25 20:57:21,658 p=38584 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:57:21,690 p=38584 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ********************************************************************************************************************************************************
2023-03-25 20:57:22,559 p=38584 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:57:22,575 p=38584 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] **********************************************************************************
2023-03-25 20:57:23,011 p=38584 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:57:23,028 p=38584 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ********************************************************************
2023-03-25 20:57:23,827 p=38584 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:57:23,857 p=38584 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *******************************************************************************************************************
2023-03-25 20:57:24,213 p=38584 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-25 20:57:24,228 p=38584 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 20:57:24,238 p=38584 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-25 20:57:24,254 p=38584 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 20:58:13,743 p=38584 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'t': '  Logical volume \"vm-110-disk-0\" created.', 'n': 1}]"}
2023-03-25 20:58:13,746 p=38584 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************
2023-03-25 20:58:13,746 p=38584 u=craig n=ansible | 192.168.1.99               : ok=5    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-25 20:58:58,605 p=38862 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-25 20:58:58,605 p=38862 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-25 20:58:58,605 p=38862 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-25 20:58:58,609 p=38862 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-25 20:58:58,880 p=38862 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] **********************************************************************************************************************************************************************
2023-03-25 20:58:58,897 p=38862 u=craig n=ansible | TASK [Gathering Facts ] ****************************************************************************************************************************************************************************************
2023-03-25 20:59:00,286 p=38862 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:59:00,317 p=38862 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *******************************************************************************************************************************************
2023-03-25 20:59:01,177 p=38862 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:59:01,200 p=38862 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *********************************************************************
2023-03-25 20:59:01,588 p=38862 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:59:01,607 p=38862 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *******************************************************
2023-03-25 20:59:02,458 p=38862 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:59:02,493 p=38862 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ******************************************************************************************************
2023-03-25 20:59:02,802 p=38862 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-25 20:59:02,818 p=38862 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 20:59:02,827 p=38862 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-25 20:59:02,844 p=38862 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 20:59:03,304 p=38862 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 20:59:03,324 p=38862 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ***********************************************************
2023-03-25 20:59:32,865 p=38862 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-25 20:59:32,866 p=38862 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for starting VM. Last line in task before timeout: [{'n': 1, 't': 'no content'}]"}
2023-03-25 20:59:32,868 p=38862 u=craig n=ansible | PLAY RECAP *****************************************************************************************************************************************************************************************************
2023-03-25 20:59:32,869 p=38862 u=craig n=ansible | 192.168.1.99               : ok=6    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-25 21:00:07,093 p=39052 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-25 21:00:07,093 p=39052 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-25 21:00:07,094 p=39052 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-25 21:00:07,097 p=39052 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-25 21:00:07,370 p=39052 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] **********************************************************************************************************************************************************************
2023-03-25 21:00:07,387 p=39052 u=craig n=ansible | TASK [Gathering Facts ] ****************************************************************************************************************************************************************************************
2023-03-25 21:00:09,108 p=39052 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 21:00:09,139 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *******************************************************************************************************************************************
2023-03-25 21:00:10,402 p=39052 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 21:00:10,434 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *********************************************************************
2023-03-25 21:00:11,434 p=39052 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 21:00:11,461 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *******************************************************
2023-03-25 21:00:12,770 p=39052 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 21:00:12,818 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ******************************************************************************************************
2023-03-25 21:00:13,127 p=39052 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-25 21:00:13,143 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 21:00:13,152 p=39052 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-25 21:00:13,169 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 21:00:13,811 p=39052 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 21:00:13,838 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ***********************************************************
2023-03-25 21:00:14,348 p=39052 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-25 21:00:14,349 p=39052 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 21:00:14,378 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] *************************************************************************************
2023-03-25 21:00:14,415 p=39052 u=craig n=ansible | changed: [192.168.1.99]
2023-03-25 21:00:14,441 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] ************************************************
2023-03-25 21:00:14,846 p=39052 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-03-25 21:00:14,881 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ******************************************************************************
2023-03-25 21:00:20,666 p=39052 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.4]
2023-03-25 21:00:20,707 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ************************************************************************************************************
2023-03-25 21:00:22,221 p=39052 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.4]
2023-03-25 21:00:22,257 p=39052 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] ************************************************************************************************************************
2023-03-25 21:01:29,183 p=39052 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.4]
2023-03-25 21:01:29,216 p=39052 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] ***********************************************************************************
2023-03-25 21:01:29,829 p=39052 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.4]
2023-03-25 21:01:29,905 p=39052 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: caddy

2023-03-25 21:01:29,905 p=39052 u=craig n=ansible | PLAY [Create a user and lock down the container] ***************************************************************************************************************************************************************
2023-03-25 21:01:29,905 p=39052 u=craig n=ansible | skipping: no hosts matched
2023-03-25 21:01:29,923 p=39052 u=craig n=ansible | PLAY [Install gui] *********************************************************************************************************************************************************************************************
2023-03-25 21:01:29,923 p=39052 u=craig n=ansible | skipping: no hosts matched
2023-03-25 21:01:29,923 p=39052 u=craig n=ansible | PLAY RECAP *****************************************************************************************************************************************************************************************************
2023-03-25 21:01:29,923 p=39052 u=craig n=ansible | 192.168.1.99               : ok=13   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-25 22:12:06,281 p=44757 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-25 22:12:06,281 p=44757 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-25 22:12:06,282 p=44757 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-25 22:12:06,287 p=44757 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-25 22:12:06,560 p=44757 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: caddy

2023-03-25 22:12:06,561 p=44757 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:12:06,561 p=44757 u=craig n=ansible | skipping: no hosts matched
2023-03-25 22:12:06,561 p=44757 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:14:13,617 p=44927 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:26: Expected key=value host variable assignment, got: ansible_host

2023-03-25 22:14:13,617 p=44927 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-25 22:14:13,617 p=44927 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-25 22:14:13,622 p=44927 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-25 22:14:13,788 p=44927 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:14:13,799 p=44927 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:14:14,019 p=44927 u=craig n=ansible | fatal: [caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-03-25 22:14:14,020 p=44927 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:14:14,020 p=44927 u=craig n=ansible | caddy                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-25 22:15:00,065 p=45030 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:26: Expected key=value host variable assignment, got: ansible_host

2023-03-25 22:15:00,065 p=45030 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-25 22:15:00,065 p=45030 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-25 22:15:00,069 p=45030 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-25 22:15:00,355 p=45030 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] **********************************************************************************************************************************************************************
2023-03-25 22:15:00,372 p=45030 u=craig n=ansible | TASK [Gathering Facts ] ****************************************************************************************************************************************************************************************
2023-03-25 22:15:02,059 p=45030 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 22:15:02,090 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *******************************************************************************************************************************************
2023-03-25 22:15:02,904 p=45030 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 22:15:02,926 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *********************************************************************
2023-03-25 22:15:03,284 p=45030 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 22:15:03,301 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *******************************************************
2023-03-25 22:15:04,108 p=45030 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 22:15:04,142 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ******************************************************************************************************
2023-03-25 22:15:04,462 p=45030 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-25 22:15:04,477 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 22:15:04,487 p=45030 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-25 22:15:04,504 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-25 22:15:04,973 p=45030 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 22:15:04,995 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ***********************************************************
2023-03-25 22:15:05,371 p=45030 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-25 22:15:05,371 p=45030 u=craig n=ansible | ok: [192.168.1.99]
2023-03-25 22:15:05,394 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] *************************************************************************************
2023-03-25 22:15:05,430 p=45030 u=craig n=ansible | changed: [192.168.1.99]
2023-03-25 22:15:05,457 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] ************************************************
2023-03-25 22:15:05,784 p=45030 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-03-25 22:15:05,818 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ******************************************************************************
2023-03-25 22:15:08,483 p=45030 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.4]
2023-03-25 22:15:08,518 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ************************************************************************************************************
2023-03-25 22:15:10,022 p=45030 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.4]
2023-03-25 22:15:10,058 p=45030 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] ************************************************************************************************************************
2023-03-25 22:15:11,041 p=45030 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.4]
2023-03-25 22:15:11,075 p=45030 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] ***********************************************************************************
2023-03-25 22:15:11,658 p=45030 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.4]
2023-03-25 22:15:11,749 p=45030 u=craig n=ansible | PLAY [Create a user and lock down the container] ***************************************************************************************************************************************************************
2023-03-25 22:15:11,761 p=45030 u=craig n=ansible | TASK [Gathering Facts ] ****************************************************************************************************************************************************************************************
2023-03-25 22:15:12,681 p=45030 u=craig n=ansible | ok: [caddy]
2023-03-25 22:15:12,712 p=45030 u=craig n=ansible | TASK [create_user : Ensure group sudo exists name=sudo, state=present] *****************************************************************************************************************************************
2023-03-25 22:15:13,063 p=45030 u=craig n=ansible | ok: [caddy]
2023-03-25 22:15:13,079 p=45030 u=craig n=ansible | TASK [create_user : Allow sudo group to have passwordless sudo path=/etc/sudoers, state=present, regexp=^%sudo, line=%sudo ALL=(ALL) NOPASSWD: ALL, validate=/usr/sbin/visudo -cf %s] **************************
2023-03-25 22:15:13,467 p=45030 u=craig n=ansible | changed: [caddy]
2023-03-25 22:15:13,483 p=45030 u=craig n=ansible | TASK [create_user : Create a new user name={{machine_user}}, password={{machine_password | string | password_hash('sha512')}}, shell=/bin/bash, groups=sudo, append=True] **************************************
2023-03-25 22:15:14,722 p=45030 u=craig n=ansible | changed: [caddy]
2023-03-25 22:15:14,744 p=45030 u=craig n=ansible | TASK [create_user : Create the .ssh directory path=/home/{{machine_user}}/.ssh, state=directory, mode=0700, owner={{machine_user}}, group={{machine_user}}] ****************************************************
2023-03-25 22:15:15,032 p=45030 u=craig n=ansible | changed: [caddy]
2023-03-25 22:15:15,046 p=45030 u=craig n=ansible | TASK [create_user : Copy the ssh key to the new user src={{machine_ssh_key}}, dest=/home/{{machine_user}}/.ssh/authorized_keys, mode=0600, owner={{machine_user}}, group={{machine_user}}] *********************
2023-03-25 22:15:15,726 p=45030 u=craig n=ansible | changed: [caddy]
2023-03-25 22:15:15,756 p=45030 u=craig n=ansible | TASK [lockdown : Ensure the /run/sshd directory exists path=/run/sshd, state=directory, mode=493] **************************************************************************************************************
2023-03-25 22:15:16,046 p=45030 u=craig n=ansible | ok: [caddy]
2023-03-25 22:15:16,063 p=45030 u=craig n=ansible | TASK [lockdown : Update SSH configuration to be more secure dest=/etc/ssh/sshd_config, regexp={{ item.regexp }}, line={{ item.line }}, state=present, validate=sshd -T -f %s, mode=420] ************************
2023-03-25 22:15:16,368 p=45030 u=craig n=ansible | changed: [caddy] => (item={'regexp': '^#?PasswordAuthentication', 'line': 'PasswordAuthentication no'})
2023-03-25 22:15:16,650 p=45030 u=craig n=ansible | changed: [caddy] => (item={'regexp': '^#?PermitRootLogin', 'line': 'PermitRootLogin no'})
2023-03-25 22:15:16,923 p=45030 u=craig n=ansible | changed: [caddy] => (item={'regexp': '^#?Port', 'line': 'Port 22'})
2023-03-25 22:15:17,229 p=45030 u=craig n=ansible | changed: [caddy] => (item={'regexp': '^#?PermitEmptyPasswords', 'line': 'PermitEmptyPasswords no'})
2023-03-25 22:15:17,265 p=45030 u=craig n=ansible | RUNNING HANDLER [restart ssh name=sshd, state=restarted] *******************************************************************************************************************************************************
2023-03-25 22:15:17,918 p=45030 u=craig n=ansible | changed: [caddy]
2023-03-25 22:15:17,967 p=45030 u=craig n=ansible | PLAY [Install gui] *********************************************************************************************************************************************************************************************
2023-03-25 22:15:17,983 p=45030 u=craig n=ansible | TASK [Gathering Facts ] ****************************************************************************************************************************************************************************************
2023-03-25 22:15:19,051 p=45030 u=craig n=ansible | ok: [caddy]
2023-03-25 22:15:19,081 p=45030 u=craig n=ansible | TASK [lxc_gui : Ensure system is up to date update_cache=True, upgrade=True] ***********************************************************************************************************************************
2023-03-25 22:15:19,092 p=45030 u=craig n=ansible | skipping: [caddy]
2023-03-25 22:15:19,107 p=45030 u=craig n=ansible | TASK [lxc_gui : Install xrdp and Xfce4 desktop and force if needed and install dependencies and recommends name={{item}}, state=present, force=True, install_recommends=True] **********************************
2023-03-25 22:15:19,120 p=45030 u=craig n=ansible | skipping: [caddy] => (item=xfce4) 
2023-03-25 22:15:19,121 p=45030 u=craig n=ansible | skipping: [caddy] => (item=xfce4-session) 
2023-03-25 22:15:19,121 p=45030 u=craig n=ansible | skipping: [caddy] => (item=xrdp) 
2023-03-25 22:15:19,137 p=45030 u=craig n=ansible | TASK [lxc_gui : Make sure xrdp is running name=xrdp, state=started, enabled=True] ******************************************************************************************************************************
2023-03-25 22:15:19,148 p=45030 u=craig n=ansible | skipping: [caddy]
2023-03-25 22:15:19,165 p=45030 u=craig n=ansible | TASK [lxc_gui : Install chrome using wget and apt install deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb, state=present, force=True, install_recommends=True] *******************
2023-03-25 22:15:19,176 p=45030 u=craig n=ansible | skipping: [caddy]
2023-03-25 22:15:19,220 p=45030 u=craig n=ansible | PLAY RECAP *****************************************************************************************************************************************************************************************************
2023-03-25 22:15:19,220 p=45030 u=craig n=ansible | 192.168.1.99               : ok=13   changed=3    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-25 22:15:19,221 p=45030 u=craig n=ansible | caddy                      : ok=10   changed=6    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2023-03-25 22:16:04,529 p=45412 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:16:04,540 p=45412 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:16:05,642 p=45412 u=craig n=ansible | ok: [caddy]
2023-03-25 22:16:05,653 p=45412 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:16:07,094 p=45412 u=craig n=ansible | ok: [caddy]
2023-03-25 22:16:07,103 p=45412 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:16:09,029 p=45412 u=craig n=ansible | changed: [caddy] => (item=apt-transport-https)
2023-03-25 22:16:09,818 p=45412 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-25 22:16:14,163 p=45412 u=craig n=ansible | changed: [caddy] => (item=curl)
2023-03-25 22:16:20,886 p=45412 u=craig n=ansible | changed: [caddy] => (item=gnupg)
2023-03-25 22:16:21,702 p=45412 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-25 22:16:38,658 p=45412 u=craig n=ansible | changed: [caddy] => (item=software-properties-common)
2023-03-25 22:16:38,669 p=45412 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:16:39,519 p=45412 u=craig n=ansible | changed: [caddy]
2023-03-25 22:16:39,528 p=45412 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:16:41,574 p=45412 u=craig n=ansible | changed: [caddy]
2023-03-25 22:16:41,583 p=45412 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:17:06,281 p=45412 u=craig n=ansible | changed: [caddy]
2023-03-25 22:17:06,293 p=45412 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:17:07,045 p=45412 u=craig n=ansible | ok: [caddy]
2023-03-25 22:17:07,054 p=45412 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:17:07,570 p=45412 u=craig n=ansible | changed: [caddy]
2023-03-25 22:17:07,589 p=45412 u=craig n=ansible | TASK [docker_swarm_node : Check if Docker Swarm is already initialized _raw_params=docker info -f "{{ '{{.Swarm.LocalNodeState}}' }}"] *********************************************************************
2023-03-25 22:17:08,708 p=45412 u=craig n=ansible | ok: [caddy]
2023-03-25 22:17:08,716 p=45412 u=craig n=ansible | TASK [docker_swarm_node : Initialize Docker Swarm _raw_params=docker swarm init] ***************************************************************************************************************************
2023-03-25 22:17:09,522 p=45412 u=craig n=ansible | changed: [caddy]
2023-03-25 22:17:09,532 p=45412 u=craig n=ansible | TASK [docker_swarm_node : Join Docker Swarm as a worker _raw_params=docker swarm join --token "{{ hostvars[groups['lxc']['swarm-master']].swarm_init_result.stdout_lines[-2].split(' ')[-1] }}" "{{ hostvars[groups['lxc']['swarm-master']].ansible_host }}:2377"] ***
2023-03-25 22:17:09,549 p=45412 u=craig n=ansible | fatal: [caddy]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'list object' has no attribute 'swarm-master'\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/docker_swarm_node/tasks/main.yaml': line 13, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Join Docker Swarm as a worker\n  ^ here\n"}
2023-03-25 22:17:09,550 p=45412 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:17:09,550 p=45412 u=craig n=ansible | caddy                      : ok=10   changed=6    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-25 22:19:00,331 p=45868 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:19:00,341 p=45868 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:19:01,811 p=45868 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:01,822 p=45868 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:19:03,703 p=45868 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:03,712 p=45868 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:19:04,470 p=45868 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-25 22:19:05,198 p=45868 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-25 22:19:05,978 p=45868 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-25 22:19:06,772 p=45868 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-25 22:19:07,592 p=45868 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-25 22:19:08,404 p=45868 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-25 22:19:08,416 p=45868 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:19:09,048 p=45868 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:09,058 p=45868 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:19:09,584 p=45868 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:09,590 p=45868 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:19:10,341 p=45868 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:10,350 p=45868 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:19:10,976 p=45868 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:10,985 p=45868 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:19:11,413 p=45868 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:11,432 p=45868 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-25 22:19:11,443 p=45868 u=craig n=ansible | fatal: [caddy]: FAILED! => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-25 22:19:11,445 p=45868 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:19:11,445 p=45868 u=craig n=ansible | caddy                      : ok=8    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-25 22:19:49,994 p=46090 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:19:50,004 p=46090 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:19:51,114 p=46090 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:51,127 p=46090 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:19:52,620 p=46090 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:52,630 p=46090 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:19:53,391 p=46090 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-25 22:19:54,181 p=46090 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-25 22:19:54,947 p=46090 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-25 22:19:55,695 p=46090 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-25 22:19:56,439 p=46090 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-25 22:19:57,251 p=46090 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-25 22:19:57,262 p=46090 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:19:57,892 p=46090 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:57,902 p=46090 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:19:58,437 p=46090 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:58,446 p=46090 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:19:59,296 p=46090 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:59,306 p=46090 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:19:59,959 p=46090 u=craig n=ansible | ok: [caddy]
2023-03-25 22:19:59,968 p=46090 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:20:00,398 p=46090 u=craig n=ansible | ok: [caddy]
2023-03-25 22:20:00,421 p=46090 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:20:00,421 p=46090 u=craig n=ansible | caddy                      : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-25 22:23:51,466 p=46564 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:23:51,476 p=46564 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:23:52,896 p=46564 u=craig n=ansible | ok: [caddy]
2023-03-25 22:23:52,907 p=46564 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:23:54,529 p=46564 u=craig n=ansible | ok: [caddy]
2023-03-25 22:23:54,538 p=46564 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:23:55,267 p=46564 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-25 22:23:55,945 p=46564 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-25 22:23:56,771 p=46564 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-25 22:23:57,488 p=46564 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-25 22:23:58,198 p=46564 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-25 22:23:58,958 p=46564 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-25 22:23:58,970 p=46564 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:23:59,577 p=46564 u=craig n=ansible | ok: [caddy]
2023-03-25 22:23:59,586 p=46564 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:24:00,102 p=46564 u=craig n=ansible | ok: [caddy]
2023-03-25 22:24:00,111 p=46564 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:24:00,805 p=46564 u=craig n=ansible | ok: [caddy]
2023-03-25 22:24:00,814 p=46564 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:24:01,395 p=46564 u=craig n=ansible | ok: [caddy]
2023-03-25 22:24:01,402 p=46564 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:24:01,828 p=46564 u=craig n=ansible | ok: [caddy]
2023-03-25 22:24:01,841 p=46564 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-25 22:24:02,230 p=46564 u=craig n=ansible | changed: [caddy]
2023-03-25 22:24:02,240 p=46564 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-25 22:24:02,984 p=46564 u=craig n=ansible | changed: [caddy]
2023-03-25 22:24:02,990 p=46564 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-25 22:24:03,631 p=46564 u=craig n=ansible | changed: [caddy]
2023-03-25 22:24:03,641 p=46564 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-25 22:24:03,716 p=46564 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-25 22:24:03,716 p=46564 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-25 22:24:03,717 p=46564 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:24:03,717 p=46564 u=craig n=ansible | caddy                      : ok=11   changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-25 22:25:24,160 p=46861 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:25:24,170 p=46861 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:25:25,587 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:25,600 p=46861 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:25:27,076 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:27,083 p=46861 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:25:27,791 p=46861 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-25 22:25:28,522 p=46861 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-25 22:25:29,228 p=46861 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-25 22:25:29,920 p=46861 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-25 22:25:30,608 p=46861 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-25 22:25:31,309 p=46861 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-25 22:25:31,316 p=46861 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:25:31,905 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:31,911 p=46861 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:25:32,422 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:32,432 p=46861 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:25:33,122 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:33,130 p=46861 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:25:33,747 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:33,755 p=46861 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:25:34,205 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:34,219 p=46861 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-25 22:25:34,610 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:34,619 p=46861 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-25 22:25:35,232 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:35,239 p=46861 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-25 22:25:35,768 p=46861 u=craig n=ansible | ok: [caddy]
2023-03-25 22:25:35,779 p=46861 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-25 22:25:35,860 p=46861 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-25 22:25:35,861 p=46861 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-25 22:25:35,861 p=46861 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:25:35,861 p=46861 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-25 22:28:05,888 p=47332 u=craig n=ansible | [WARNING]: While constructing a mapping from /Users/craig/Projects/homelab/ansible/playbooks/caddy/caddy.yaml, line 5, column 7, found a duplicate dict key (name). Using last defined value only.

2023-03-25 22:28:05,943 p=47332 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:28:05,954 p=47332 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:28:07,390 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:07,404 p=47332 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:28:08,756 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:08,766 p=47332 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:28:09,603 p=47332 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-25 22:28:10,418 p=47332 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-25 22:28:11,237 p=47332 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-25 22:28:11,967 p=47332 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-25 22:28:12,691 p=47332 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-25 22:28:13,453 p=47332 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-25 22:28:13,464 p=47332 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:28:14,085 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:14,095 p=47332 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:28:14,630 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:14,640 p=47332 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:28:15,436 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:15,445 p=47332 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:28:16,075 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:16,083 p=47332 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:28:16,514 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:16,527 p=47332 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-25 22:28:16,919 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:16,928 p=47332 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-25 22:28:17,562 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:17,571 p=47332 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-25 22:28:18,100 p=47332 u=craig n=ansible | ok: [caddy]
2023-03-25 22:28:18,111 p=47332 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-25 22:28:18,183 p=47332 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-25 22:28:18,183 p=47332 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-25 22:28:18,184 p=47332 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:28:18,184 p=47332 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-25 22:33:13,848 p=47906 u=craig n=ansible | [WARNING]: While constructing a mapping from /Users/craig/Projects/homelab/ansible/playbooks/caddy/caddy.yaml, line 5, column 7, found a duplicate dict key (name). Using last defined value only.

2023-03-25 22:33:13,908 p=47906 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:33:13,919 p=47906 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:33:15,497 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:15,510 p=47906 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:33:16,965 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:16,976 p=47906 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:33:17,718 p=47906 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-25 22:33:18,548 p=47906 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-25 22:33:19,299 p=47906 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-25 22:33:20,181 p=47906 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-25 22:33:20,916 p=47906 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-25 22:33:21,713 p=47906 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-25 22:33:21,725 p=47906 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:33:22,367 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:22,376 p=47906 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:33:22,881 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:22,891 p=47906 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:33:23,667 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:23,677 p=47906 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:33:24,316 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:24,325 p=47906 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:33:24,749 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:24,762 p=47906 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-25 22:33:25,156 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:25,165 p=47906 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-25 22:33:25,766 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:25,775 p=47906 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-25 22:33:26,293 p=47906 u=craig n=ansible | ok: [caddy]
2023-03-25 22:33:26,303 p=47906 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-25 22:33:26,394 p=47906 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-25 22:33:26,394 p=47906 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-25 22:33:26,395 p=47906 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:33:26,395 p=47906 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-25 22:33:52,463 p=48136 u=craig n=ansible | ansible-playbook [core 2.13.5]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/6.5.0/libexec/lib/python3.10/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.10.8 (main, Oct 21 2022, 22:22:30) [Clang 14.0.0 (clang-1400.0.29.202)]
  jinja version = 3.1.2
  libyaml = True
2023-03-25 22:33:52,463 p=48136 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-25 22:34:04,751 p=48136 u=craig n=ansible | [WARNING]: While constructing a mapping from /Users/craig/Projects/homelab/ansible/playbooks/caddy/caddy.yaml, line 5, column 7, found a duplicate dict key (name). Using last defined value only.

2023-03-25 22:34:04,790 p=48136 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-03-25 22:34:04,805 p=48136 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-03-25 22:34:04,805 p=48136 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-03-25 22:34:04,805 p=48136 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-03-25 22:34:04,805 p=48136 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-03-25 22:34:04,805 p=48136 u=craig n=ansible | 1 plays in ansible/playbooks/caddy/caddy.yaml
2023-03-25 22:34:04,808 p=48136 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:34:04,818 p=48136 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:34:05,901 p=48136 u=craig n=ansible | ok: [caddy]
2023-03-25 22:34:05,907 p=48136 u=craig n=ansible | META: ran handlers
2023-03-25 22:34:05,911 p=48136 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:34:07,385 p=48136 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679797001, "cache_updated": false, "changed": false}
2023-03-25 22:34:07,393 p=48136 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:34:08,221 p=48136 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-25 22:34:09,033 p=48136 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-25 22:34:09,824 p=48136 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-25 22:34:10,556 p=48136 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-25 22:34:11,487 p=48136 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-25 22:34:12,211 p=48136 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-25 22:34:12,222 p=48136 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:34:12,856 p=48136 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-25 22:34:12,865 p=48136 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:34:13,382 p=48136 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-25 22:34:13,392 p=48136 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:34:14,145 p=48136 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679797001, "cache_updated": false, "changed": false}
2023-03-25 22:34:14,160 p=48136 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:34:14,786 p=48136 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1731959000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "97546240", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-25 22:34:14,795 p=48136 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:34:15,219 p=48136 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-25 22:34:15,226 p=48136 u=craig n=ansible | META: role_complete for caddy
2023-03-25 22:34:15,232 p=48136 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-25 22:34:15,606 p=48136 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-25 22:34:15,614 p=48136 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-25 22:34:16,229 p=48136 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-25 22:34:16,238 p=48136 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-25 22:34:16,757 p=48136 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-25 22:34:16,768 p=48136 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-25 22:34:16,847 p=48136 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-25 22:34:16,847 p=48136 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-25 22:34:16,848 p=48136 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:34:16,848 p=48136 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-25 22:35:43,285 p=48458 u=craig n=ansible | ansible-playbook [core 2.13.5]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/6.5.0/libexec/lib/python3.10/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.10.8 (main, Oct 21 2022, 22:22:30) [Clang 14.0.0 (clang-1400.0.29.202)]
  jinja version = 3.1.2
  libyaml = True
2023-03-25 22:35:43,285 p=48458 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-25 22:35:49,610 p=48458 u=craig n=ansible | [WARNING]: While constructing a mapping from /Users/craig/Projects/homelab/ansible/playbooks/caddy/caddy.yaml, line 5, column 7, found a duplicate dict key (name). Using last defined value only.

2023-03-25 22:35:49,649 p=48458 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-03-25 22:35:49,665 p=48458 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-03-25 22:35:49,665 p=48458 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-03-25 22:35:49,665 p=48458 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-03-25 22:35:49,665 p=48458 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-03-25 22:35:49,665 p=48458 u=craig n=ansible | 1 plays in ansible/playbooks/caddy/caddy.yaml
2023-03-25 22:35:49,667 p=48458 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-25 22:35:49,678 p=48458 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-25 22:35:51,047 p=48458 u=craig n=ansible | ok: [caddy]
2023-03-25 22:35:51,055 p=48458 u=craig n=ansible | META: ran handlers
2023-03-25 22:35:51,061 p=48458 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-25 22:35:52,761 p=48458 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679797001, "cache_updated": false, "changed": false}
2023-03-25 22:35:52,770 p=48458 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-25 22:35:53,583 p=48458 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-25 22:35:54,315 p=48458 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-25 22:35:55,114 p=48458 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-25 22:35:55,869 p=48458 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-25 22:35:56,653 p=48458 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-25 22:35:57,468 p=48458 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679797001, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-25 22:35:57,480 p=48458 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-25 22:35:58,101 p=48458 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-25 22:35:58,110 p=48458 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-25 22:35:58,615 p=48458 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-25 22:35:58,621 p=48458 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-25 22:35:59,359 p=48458 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679797001, "cache_updated": false, "changed": false}
2023-03-25 22:35:59,369 p=48458 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-25 22:36:00,001 p=48458 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1854843000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "97484800", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-25 22:36:00,010 p=48458 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-25 22:36:00,435 p=48458 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-25 22:36:00,443 p=48458 u=craig n=ansible | META: role_complete for caddy
2023-03-25 22:36:00,449 p=48458 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-25 22:36:00,829 p=48458 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-25 22:36:00,838 p=48458 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-25 22:36:01,450 p=48458 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-25 22:36:01,459 p=48458 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-25 22:36:01,985 p=48458 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-25 22:36:01,996 p=48458 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-25 22:36:02,079 p=48458 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-25 22:36:02,080 p=48458 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-25 22:36:02,080 p=48458 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-25 22:36:02,081 p=48458 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 09:24:50,745 p=49565 u=craig n=ansible | ansible-playbook [core 2.13.5]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/6.5.0/libexec/lib/python3.10/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.10.8 (main, Oct 21 2022, 22:22:30) [Clang 14.0.0 (clang-1400.0.29.202)]
  jinja version = 3.1.2
  libyaml = True
2023-03-26 09:24:50,745 p=49565 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 09:24:59,490 p=49565 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-03-26 09:24:59,506 p=49565 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-03-26 09:24:59,506 p=49565 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-03-26 09:24:59,507 p=49565 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-03-26 09:24:59,507 p=49565 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-03-26 09:24:59,507 p=49565 u=craig n=ansible | 1 plays in ansible/playbooks/caddy/caddy.yaml
2023-03-26 09:24:59,509 p=49565 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 09:24:59,519 p=49565 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 09:25:00,927 p=49565 u=craig n=ansible | ok: [caddy]
2023-03-26 09:25:00,935 p=49565 u=craig n=ansible | META: ran handlers
2023-03-26 09:25:00,940 p=49565 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 09:25:04,138 p=49565 u=craig n=ansible | changed: [caddy] => {"cache_update_time": 1679837102, "cache_updated": true, "changed": true}
2023-03-26 09:25:04,147 p=49565 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 09:25:05,005 p=49565 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 09:25:05,750 p=49565 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 09:25:06,488 p=49565 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 09:25:07,233 p=49565 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 09:25:07,969 p=49565 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 09:25:08,689 p=49565 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 09:25:08,700 p=49565 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 09:25:09,398 p=49565 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 09:25:09,407 p=49565 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 09:25:09,896 p=49565 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 09:25:09,903 p=49565 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 09:25:10,728 p=49565 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 09:25:10,737 p=49565 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 09:25:11,333 p=49565 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "46599763000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "72863744", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 09:25:11,341 p=49565 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 09:25:11,758 p=49565 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 09:25:11,766 p=49565 u=craig n=ansible | META: role_complete for caddy
2023-03-26 09:25:11,771 p=49565 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 09:25:12,163 p=49565 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 09:25:12,172 p=49565 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 09:25:12,777 p=49565 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 09:25:12,786 p=49565 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 09:25:13,292 p=49565 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 09:25:13,303 p=49565 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 09:25:13,378 p=49565 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-26 09:25:13,378 p=49565 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-26 09:25:13,379 p=49565 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 09:25:13,379 p=49565 u=craig n=ansible | caddy                      : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 09:29:21,450 p=50103 u=craig n=ansible | ansible-playbook [core 2.13.5]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/6.5.0/libexec/lib/python3.10/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.10.8 (main, Oct 21 2022, 22:22:30) [Clang 14.0.0 (clang-1400.0.29.202)]
  jinja version = 3.1.2
  libyaml = True
2023-03-26 09:29:21,450 p=50103 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 09:29:30,190 p=50103 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-03-26 09:29:30,205 p=50103 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-03-26 09:29:30,205 p=50103 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-03-26 09:29:30,205 p=50103 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-03-26 09:29:30,205 p=50103 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-03-26 09:29:30,205 p=50103 u=craig n=ansible | 1 plays in ansible/playbooks/caddy/caddy.yaml
2023-03-26 09:29:30,208 p=50103 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 09:29:30,217 p=50103 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 09:29:31,645 p=50103 u=craig n=ansible | ok: [caddy]
2023-03-26 09:29:31,652 p=50103 u=craig n=ansible | META: ran handlers
2023-03-26 09:29:31,659 p=50103 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 09:29:33,220 p=50103 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 09:29:33,229 p=50103 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 09:29:33,961 p=50103 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 09:29:34,674 p=50103 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 09:29:35,423 p=50103 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 09:29:36,165 p=50103 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 09:29:36,901 p=50103 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 09:29:37,648 p=50103 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 09:29:37,659 p=50103 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 09:29:38,265 p=50103 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 09:29:38,274 p=50103 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 09:29:38,784 p=50103 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 09:29:38,793 p=50103 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 09:29:39,545 p=50103 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 09:29:39,554 p=50103 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 09:29:40,178 p=50103 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "46918429000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "72863744", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 09:29:40,186 p=50103 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 09:29:40,613 p=50103 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 09:29:40,620 p=50103 u=craig n=ansible | META: role_complete for caddy
2023-03-26 09:29:40,625 p=50103 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 09:29:40,997 p=50103 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 09:29:41,005 p=50103 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 09:29:41,615 p=50103 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 09:29:41,624 p=50103 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 09:29:42,142 p=50103 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 09:29:42,152 p=50103 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 09:29:42,227 p=50103 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-26 09:29:42,228 p=50103 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-26 09:29:42,228 p=50103 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 09:29:42,228 p=50103 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 09:31:02,214 p=50552 u=craig n=ansible | ansible-playbook [core 2.13.5]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/6.5.0/libexec/lib/python3.10/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.10.8 (main, Oct 21 2022, 22:22:30) [Clang 14.0.0 (clang-1400.0.29.202)]
  jinja version = 3.1.2
  libyaml = True
2023-03-26 09:31:02,214 p=50552 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 09:31:08,592 p=50552 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-03-26 09:31:08,606 p=50552 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-03-26 09:31:08,607 p=50552 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-03-26 09:31:08,607 p=50552 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-03-26 09:31:08,607 p=50552 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-03-26 09:31:08,607 p=50552 u=craig n=ansible | 1 plays in ansible/playbooks/caddy/caddy.yaml
2023-03-26 09:31:08,609 p=50552 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 09:31:08,619 p=50552 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 09:31:09,998 p=50552 u=craig n=ansible | ok: [caddy]
2023-03-26 09:31:10,005 p=50552 u=craig n=ansible | META: ran handlers
2023-03-26 09:31:10,011 p=50552 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 09:31:11,591 p=50552 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 09:31:11,599 p=50552 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 09:31:12,337 p=50552 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 09:31:13,118 p=50552 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 09:31:13,851 p=50552 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 09:31:14,581 p=50552 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 09:31:15,304 p=50552 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 09:31:16,019 p=50552 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 09:31:16,031 p=50552 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 09:31:16,699 p=50552 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 09:31:16,706 p=50552 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 09:31:17,215 p=50552 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 09:31:17,223 p=50552 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 09:31:18,042 p=50552 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 09:31:18,051 p=50552 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 09:31:18,646 p=50552 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "47027164000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "72863744", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 09:31:18,654 p=50552 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 09:31:19,101 p=50552 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 09:31:19,106 p=50552 u=craig n=ansible | META: role_complete for caddy
2023-03-26 09:31:19,111 p=50552 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 09:31:19,504 p=50552 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 09:31:19,512 p=50552 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 09:31:20,126 p=50552 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 09:31:20,135 p=50552 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 09:31:20,662 p=50552 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 09:31:20,673 p=50552 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 09:31:20,753 p=50552 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-26 09:31:20,753 p=50552 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-26 09:31:20,754 p=50552 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 09:31:20,754 p=50552 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 09:44:30,314 p=51659 u=craig n=ansible | ERROR! input is already encrypted
2023-03-26 09:49:47,982 p=52049 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-26 09:50:01,990 p=52093 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 09:50:02,001 p=52093 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 09:50:03,369 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:03,382 p=52093 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 09:50:04,841 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:04,850 p=52093 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 09:50:05,550 p=52093 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-26 09:50:06,318 p=52093 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-26 09:50:06,997 p=52093 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-26 09:50:07,675 p=52093 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-26 09:50:08,469 p=52093 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-26 09:50:09,159 p=52093 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-26 09:50:09,171 p=52093 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 09:50:09,778 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:09,787 p=52093 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 09:50:10,278 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:10,287 p=52093 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 09:50:10,975 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:10,985 p=52093 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 09:50:11,569 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:11,577 p=52093 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 09:50:12,012 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:12,025 p=52093 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 09:50:12,385 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:12,393 p=52093 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 09:50:12,958 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:12,964 p=52093 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 09:50:13,454 p=52093 u=craig n=ansible | ok: [caddy]
2023-03-26 09:50:13,464 p=52093 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 09:50:13,537 p=52093 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-26 09:50:13,538 p=52093 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-26 09:50:13,538 p=52093 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 09:50:13,538 p=52093 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 09:54:53,653 p=52537 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-26 09:55:00,257 p=52684 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 09:55:00,268 p=52684 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 09:55:01,657 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:01,668 p=52684 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 09:55:03,087 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:03,095 p=52684 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 09:55:03,899 p=52684 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-26 09:55:04,706 p=52684 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-26 09:55:05,420 p=52684 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-26 09:55:06,253 p=52684 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-03-26 09:55:07,078 p=52684 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-03-26 09:55:07,910 p=52684 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-03-26 09:55:07,922 p=52684 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 09:55:08,608 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:08,616 p=52684 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 09:55:09,112 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:09,121 p=52684 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 09:55:09,850 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:09,858 p=52684 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 09:55:10,486 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:10,494 p=52684 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 09:55:10,915 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:10,927 p=52684 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 09:55:11,302 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:11,310 p=52684 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 09:55:11,932 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:11,940 p=52684 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 09:55:12,481 p=52684 u=craig n=ansible | ok: [caddy]
2023-03-26 09:55:12,490 p=52684 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 09:55:12,565 p=52684 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-26 09:55:12,565 p=52684 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-26 09:55:12,566 p=52684 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 09:55:12,566 p=52684 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 10:00:03,184 p=53313 u=craig n=ansible | ERROR! Unable to read source file (vault.yaml): [Errno 2] No such file or directory: 'vault.yaml'
2023-03-26 11:00:55,889 p=54652 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:00:55,900 p=54652 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:00:58,321 p=54652 u=craig n=ansible | ok: [caddy]
2023-03-26 11:00:58,335 p=54652 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:01:00,886 p=54652 u=craig n=ansible | ok: [caddy]
2023-03-26 11:01:00,896 p=54652 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:01:02,148 p=54652 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-26 11:01:03,431 p=54652 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-26 11:01:04,729 p=54652 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-03-26 11:01:05,246 p=54652 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-26 11:01:52,846 p=54799 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:01:52,856 p=54799 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:01:54,722 p=54799 u=craig n=ansible | ok: [caddy]
2023-03-26 11:01:54,735 p=54799 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:01:57,185 p=54799 u=craig n=ansible | ok: [caddy]
2023-03-26 11:01:57,196 p=54799 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:01:58,716 p=54799 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-03-26 11:02:00,058 p=54799 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-03-26 11:02:00,848 p=54799 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-26 11:02:04,337 p=54862 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:02:04,493 p=54862 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:02:04,503 p=54862 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:02:06,422 p=54862 u=craig n=ansible | ok: [caddy]
2023-03-26 11:02:06,436 p=54862 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:02:08,544 p=54862 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:02:08,554 p=54862 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:02:09,890 p=54862 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:02:11,295 p=54862 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:02:12,636 p=54862 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:02:13,983 p=54862 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:02:15,432 p=54862 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:02:15,690 p=54862 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-26 11:03:20,362 p=55047 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:03:20,537 p=55047 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:03:20,547 p=55047 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:03:22,950 p=55047 u=craig n=ansible | ok: [caddy]
2023-03-26 11:03:22,964 p=55047 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:03:25,014 p=55047 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:03:25,026 p=55047 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:03:26,336 p=55047 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:03:27,714 p=55047 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:03:29,046 p=55047 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:03:30,441 p=55047 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:03:31,702 p=55047 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:03:32,953 p=55047 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:03:32,967 p=55047 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:03:34,114 p=55047 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:03:34,121 p=55047 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:03:35,275 p=55047 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:03:35,281 p=55047 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:03:36,516 p=55047 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:03:36,526 p=55047 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:03:37,738 p=55047 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "53386371000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "75042816", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:03:37,748 p=55047 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:03:38,714 p=55047 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:03:38,731 p=55047 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:03:39,659 p=55047 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:03:39,671 p=55047 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:03:41,245 p=55047 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 11:03:41,253 p=55047 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:03:42,791 p=55047 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 11:03:42,808 p=55047 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:03:43,078 p=55047 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-26 11:03:43,079 p=55047 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-26 11:03:43,081 p=55047 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:03:43,081 p=55047 u=craig n=ansible | caddy                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:04:05,799 p=55307 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:04:05,964 p=55307 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:04:05,972 p=55307 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:04:07,844 p=55307 u=craig n=ansible | ok: [caddy]
2023-03-26 11:04:07,856 p=55307 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:04:07,870 p=55307 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:04:07,877 p=55307 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-26 11:04:07,891 p=55307 u=craig n=ansible | fatal: [caddy]: FAILED! => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 11:04:07,892 p=55307 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:04:07,892 p=55307 u=craig n=ansible | caddy                      : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:04:28,244 p=55361 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:04:28,423 p=55361 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:04:28,431 p=55361 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:04:30,321 p=55361 u=craig n=ansible | ok: [caddy]
2023-03-26 11:04:30,334 p=55361 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:04:30,347 p=55361 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:04:30,354 p=55361 u=craig n=ansible | TASK [Include secrets file=secrets.yaml, name=vault_secrets] ***********************************************************************************************************************************************
2023-03-26 11:04:30,367 p=55361 u=craig n=ansible | fatal: [caddy]: FAILED! => {"ansible_facts": {"vault_secrets": {}}, "ansible_included_var_files": [], "changed": false, "message": "Could not find or access 'secrets.yaml'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy/vars/secrets.yaml\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy/secrets.yaml\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy/vars/secrets.yaml\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy/secrets.yaml on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-03-26 11:04:30,368 p=55361 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:04:30,368 p=55361 u=craig n=ansible | caddy                      : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:06:37,466 p=55542 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:06:37,634 p=55542 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:06:37,642 p=55542 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:06:40,108 p=55542 u=craig n=ansible | ok: [caddy]
2023-03-26 11:06:40,123 p=55542 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:06:40,137 p=55542 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:06:40,158 p=55542 u=craig n=ansible | TASK [Include secrets file=../../../secrets.yaml, name=vault_secrets] **************************************************************************************************************************************
2023-03-26 11:06:40,183 p=55542 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"vault_secrets": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "host_ip": "192.168.1.99", "proxmox_api_token_id": "root@pam!terraform", "proxmox_api_token_secret": "6165417e-cfcb-4839-a136-4f9e243968be", "proxmox_api_url": "https://192.168.1.99:8006/api2/json", "root_password": "$3z!b9YHBhH8#kSt$", "root_user": "root@pam"}}, "ansible_included_var_files": ["/Users/craig/Projects/homelab/ansible/playbooks/caddy/../../../secrets.yaml"], "changed": false}
2023-03-26 11:06:40,190 p=55542 u=craig n=ansible | TASK [Set Google Domains API key from vault secrets google_domains_api_key={{ vault_secrets.google_domains_api_key }}] *************************************************************************************
2023-03-26 11:06:40,204 p=55542 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="}, "changed": false}
2023-03-26 11:06:40,210 p=55542 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:06:40,223 p=55542 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:06:40,235 p=55542 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:06:40,235 p=55542 u=craig n=ansible | caddy                      : ok=5    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 11:07:03,305 p=55624 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:07:03,471 p=55624 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:07:03,479 p=55624 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:07:05,317 p=55624 u=craig n=ansible | ok: [caddy]
2023-03-26 11:07:05,348 p=55624 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:07:05,360 p=55624 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:07:05,367 p=55624 u=craig n=ansible | TASK [Include secrets file=../../../secrets.yaml, name=vault_secrets] **************************************************************************************************************************************
2023-03-26 11:07:05,390 p=55624 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"vault_secrets": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "host_ip": "192.168.1.99", "proxmox_api_token_id": "root@pam!terraform", "proxmox_api_token_secret": "6165417e-cfcb-4839-a136-4f9e243968be", "proxmox_api_url": "https://192.168.1.99:8006/api2/json", "root_password": "$3z!b9YHBhH8#kSt$", "root_user": "root@pam"}}, "ansible_included_var_files": ["/Users/craig/Projects/homelab/ansible/playbooks/caddy/../../../secrets.yaml"], "changed": false}
2023-03-26 11:07:05,395 p=55624 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:07:05,408 p=55624 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "VARIABLE IS NOT DEFINED!: 'google_domains_api_key' is undefined"
}
2023-03-26 11:07:05,420 p=55624 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:07:05,420 p=55624 u=craig n=ansible | caddy                      : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 11:07:19,733 p=55669 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:07:19,899 p=55669 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:07:19,907 p=55669 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:07:21,786 p=55669 u=craig n=ansible | ok: [caddy]
2023-03-26 11:07:21,799 p=55669 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:07:21,810 p=55669 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:07:21,817 p=55669 u=craig n=ansible | TASK [Include secrets file=../../../secrets.yaml] **********************************************************************************************************************************************************
2023-03-26 11:07:21,840 p=55669 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "host_ip": "192.168.1.99", "proxmox_api_token_id": "root@pam!terraform", "proxmox_api_token_secret": "6165417e-cfcb-4839-a136-4f9e243968be", "proxmox_api_url": "https://192.168.1.99:8006/api2/json", "root_password": "$3z!b9YHBhH8#kSt$", "root_user": "root@pam"}, "ansible_included_var_files": ["/Users/craig/Projects/homelab/ansible/playbooks/caddy/../../../secrets.yaml"], "changed": false}
2023-03-26 11:07:21,846 p=55669 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:07:21,859 p=55669 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:07:21,870 p=55669 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:07:21,870 p=55669 u=craig n=ansible | caddy                      : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 11:07:40,048 p=55721 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:07:40,225 p=55721 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:07:40,235 p=55721 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:07:42,326 p=55721 u=craig n=ansible | ok: [caddy]
2023-03-26 11:07:42,354 p=55721 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:07:44,331 p=55721 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:07:44,337 p=55721 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:07:45,638 p=55721 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:07:46,942 p=55721 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:07:47,211 p=55721 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-26 11:09:28,119 p=55924 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:09:28,294 p=55924 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:09:28,304 p=55924 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:09:30,741 p=55924 u=craig n=ansible | ok: [caddy]
2023-03-26 11:09:30,750 p=55924 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:09:30,762 p=55924 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:09:30,768 p=55924 u=craig n=ansible | TASK [Include secrets file=../../../secrets.yaml] **********************************************************************************************************************************************************
2023-03-26 11:09:30,790 p=55924 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "host_ip": "192.168.1.99", "proxmox_api_token_id": "root@pam!terraform", "proxmox_api_token_secret": "6165417e-cfcb-4839-a136-4f9e243968be", "proxmox_api_url": "https://192.168.1.99:8006/api2/json", "root_password": "$3z!b9YHBhH8#kSt$", "root_user": "root@pam"}, "ansible_included_var_files": ["/Users/craig/Projects/homelab/ansible/playbooks/caddy/../../../secrets.yaml"], "changed": false}
2023-03-26 11:09:30,796 p=55924 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:09:30,809 p=55924 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:09:30,820 p=55924 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:09:32,970 p=55924 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:09:32,980 p=55924 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:09:34,459 p=55924 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:09:36,056 p=55924 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:09:37,585 p=55924 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:09:38,922 p=55924 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:09:40,206 p=55924 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:09:41,547 p=55924 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:09:41,560 p=55924 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:09:42,809 p=55924 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:09:42,819 p=55924 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:09:44,103 p=55924 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:09:44,114 p=55924 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:09:45,497 p=55924 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:09:45,507 p=55924 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:09:46,741 p=55924 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "53801272000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "75046912", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:09:46,751 p=55924 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:09:47,706 p=55924 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:09:47,724 p=55924 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:09:48,777 p=55924 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:09:48,789 p=55924 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:09:50,513 p=55924 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 11:09:50,523 p=55924 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:09:51,974 p=55924 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 11:09:51,985 p=55924 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:09:53,891 p=55924 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "c43724b971717b15ffebd8d050204a7db84c3473", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "md5sum": "b24bfe99016027b6f037dfdb11f86590", "mode": "0644", "owner": "root", "size": 300, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679843392.076098-56123-84196841431076/source", "state": "file", "uid": 0}
2023-03-26 11:09:53,902 p=55924 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-26 11:09:54,916 p=55924 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ModuleNotFoundError: No module named 'requests'
2023-03-26 11:09:54,917 p=55924 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Failed to import the required Python library (Docker SDK for Python: docker above 5.0.0 (Python >= 3.6) or docker before 5.0.0 (Python 2.7) or docker-py (Python 2.6)) on caddy's Python /usr/bin/python3. Please read the module documentation and install it in the appropriate location. If the required library is installed, but Ansible is using the wrong Python interpreter, please consult the documentation on ansible_python_interpreter, for example via `pip install docker` (Python >= 3.6) or `pip install docker==4.4.4` (Python 2.7) or `pip install docker-py` (Python 2.6). The error was: No module named 'requests'"}
2023-03-26 11:09:54,919 p=55924 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:09:54,919 p=55924 u=craig n=ansible | caddy                      : ok=15   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:11:31,660 p=56323 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:11:31,835 p=56323 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:11:31,845 p=56323 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:11:34,204 p=56323 u=craig n=ansible | ok: [caddy]
2023-03-26 11:11:34,213 p=56323 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:11:34,224 p=56323 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:11:34,230 p=56323 u=craig n=ansible | TASK [Include secrets file=../../../secrets.yaml] **********************************************************************************************************************************************************
2023-03-26 11:11:34,255 p=56323 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "host_ip": "192.168.1.99", "proxmox_api_token_id": "root@pam!terraform", "proxmox_api_token_secret": "6165417e-cfcb-4839-a136-4f9e243968be", "proxmox_api_url": "https://192.168.1.99:8006/api2/json", "root_password": "$3z!b9YHBhH8#kSt$", "root_user": "root@pam"}, "ansible_included_var_files": ["/Users/craig/Projects/homelab/ansible/playbooks/caddy/../../../secrets.yaml"], "changed": false}
2023-03-26 11:11:34,260 p=56323 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:11:34,273 p=56323 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:11:34,283 p=56323 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:11:36,778 p=56323 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:11:36,789 p=56323 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:11:38,112 p=56323 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:11:39,435 p=56323 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:11:40,768 p=56323 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:11:42,058 p=56323 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:11:43,535 p=56323 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:11:45,023 p=56323 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:11:45,034 p=56323 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:11:46,227 p=56323 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:11:46,238 p=56323 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:11:47,297 p=56323 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:11:47,308 p=56323 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:11:48,644 p=56323 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:11:48,655 p=56323 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:11:49,927 p=56323 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "53948122000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "75046912", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:11:49,935 p=56323 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:11:50,893 p=56323 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:11:50,904 p=56323 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:11:51,819 p=56323 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:11:51,831 p=56323 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:11:53,376 p=56323 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 11:11:53,386 p=56323 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:11:54,863 p=56323 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 11:11:54,871 p=56323 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:11:56,314 p=56323 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "c43724b971717b15ffebd8d050204a7db84c3473", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 300, "state": "file", "uid": 0}
2023-03-26 11:11:56,324 p=56323 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-26 11:11:57,295 p=56323 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ModuleNotFoundError: No module named 'requests'
2023-03-26 11:11:57,296 p=56323 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Failed to import the required Python library (Docker SDK for Python: docker above 5.0.0 (Python >= 3.6) or docker before 5.0.0 (Python 2.7) or docker-py (Python 2.6)) on caddy's Python /usr/bin/python3. Please read the module documentation and install it in the appropriate location. If the required library is installed, but Ansible is using the wrong Python interpreter, please consult the documentation on ansible_python_interpreter, for example via `pip install docker` (Python >= 3.6) or `pip install docker==4.4.4` (Python 2.7) or `pip install docker-py` (Python 2.6). The error was: No module named 'requests'"}
2023-03-26 11:11:57,298 p=56323 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:11:57,298 p=56323 u=craig n=ansible | caddy                      : ok=15   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:17:34,386 p=57018 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:17:34,581 p=57018 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:17:34,592 p=57018 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:17:37,256 p=57018 u=craig n=ansible | ok: [caddy]
2023-03-26 11:17:37,265 p=57018 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:17:37,277 p=57018 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:17:37,284 p=57018 u=craig n=ansible | TASK [Include secrets file=../../../secrets.yaml] **********************************************************************************************************************************************************
2023-03-26 11:17:37,307 p=57018 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "host_ip": "192.168.1.99", "proxmox_api_token_id": "root@pam!terraform", "proxmox_api_token_secret": "6165417e-cfcb-4839-a136-4f9e243968be", "proxmox_api_url": "https://192.168.1.99:8006/api2/json", "root_password": "$3z!b9YHBhH8#kSt$", "root_user": "root@pam"}, "ansible_included_var_files": ["/Users/craig/Projects/homelab/ansible/playbooks/caddy/../../../secrets.yaml"], "changed": false}
2023-03-26 11:17:37,313 p=57018 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:17:37,326 p=57018 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:17:37,339 p=57018 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:17:39,336 p=57018 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:17:39,346 p=57018 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:17:40,718 p=57018 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:17:41,936 p=57018 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:17:43,261 p=57018 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:17:44,470 p=57018 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:17:45,731 p=57018 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:17:46,926 p=57018 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:17:46,935 p=57018 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:17:48,049 p=57018 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:17:48,055 p=57018 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:17:49,072 p=57018 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:17:49,079 p=57018 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:17:50,249 p=57018 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:17:50,256 p=57018 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:17:51,443 p=57018 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "54367056000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "75051008", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:17:51,451 p=57018 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:17:52,405 p=57018 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:17:52,416 p=57018 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-26 11:18:19,861 p=57018 u=craig n=ansible | changed: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": true, "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  binutils binutils-common binutils-x86-64-linux-gnu build-essential bzip2 cpp\n  cpp-11 dpkg-dev fakeroot fontconfig-config fonts-dejavu-core g++ g++-11 gcc\n  gcc-11 gcc-11-base javascript-common libalgorithm-diff-perl\n  libalgorithm-diff-xs-perl libalgorithm-merge-perl libasan6 libatomic1\n  libbinutils libc-dev-bin libc-devtools libc6-dev libcc1-0 libcrypt-dev\n  libctf-nobfd0 libctf0 libdeflate0 libdpkg-perl libexpat1-dev libfakeroot\n  libfile-fcntllock-perl libfontconfig1 libfreetype6 libgcc-11-dev libgd3\n  libgomp1 libisl23 libitm1 libjbig0 libjpeg-turbo8 libjpeg8 libjs-jquery\n  libjs-sphinxdoc libjs-underscore liblsan0 libmpc3 libmpfr6 libnsl-dev\n  libpython3-dev libpython3.10 libpython3.10-dev libquadmath0 libstdc++-11-dev\n  libtiff5 libtirpc-dev libtsan0 libubsan1 libwebp7 libxpm4 linux-libc-dev\n  lto-disabled-list make manpages-dev python3-dev python3-distutils\n  python3-lib2to3 python3-setuptools python3-wheel python3.10-dev rpcsvc-proto\n  zlib1g-dev\nSuggested packages:\n  binutils-doc bzip2-doc cpp-doc gcc-11-locales debian-keyring g++-multilib\n  g++-11-multilib gcc-11-doc gcc-multilib autoconf automake libtool flex bison\n  gdb gcc-doc gcc-11-multilib apache2 | lighttpd | httpd glibc-doc bzr\n  libgd-tools libstdc++-11-doc make-doc python-setuptools-doc\nThe following NEW packages will be installed:\n  binutils binutils-common binutils-x86-64-linux-gnu build-essential bzip2 cpp\n  cpp-11 dpkg-dev fakeroot fontconfig-config fonts-dejavu-core g++ g++-11 gcc\n  gcc-11 gcc-11-base javascript-common libalgorithm-diff-perl\n  libalgorithm-diff-xs-perl libalgorithm-merge-perl libasan6 libatomic1\n  libbinutils libc-dev-bin libc-devtools libc6-dev libcc1-0 libcrypt-dev\n  libctf-nobfd0 libctf0 libdeflate0 libdpkg-perl libexpat1-dev libfakeroot\n  libfile-fcntllock-perl libfontconfig1 libfreetype6 libgcc-11-dev libgd3\n  libgomp1 libisl23 libitm1 libjbig0 libjpeg-turbo8 libjpeg8 libjs-jquery\n  libjs-sphinxdoc libjs-underscore liblsan0 libmpc3 libmpfr6 libnsl-dev\n  libpython3-dev libpython3.10 libpython3.10-dev libquadmath0 libstdc++-11-dev\n  libtiff5 libtirpc-dev libtsan0 libubsan1 libwebp7 libxpm4 linux-libc-dev\n  lto-disabled-list make manpages-dev python3-dev python3-distutils\n  python3-lib2to3 python3-pip python3-setuptools python3-wheel python3.10-dev\n  rpcsvc-proto zlib1g-dev\n0 upgraded, 76 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 78.9 MB of archives.\nAfter this operation, 267 MB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 binutils-common amd64 2.38-4ubuntu2.1 [221 kB]\nGet:2 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libbinutils amd64 2.38-4ubuntu2.1 [661 kB]\nGet:3 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libctf-nobfd0 amd64 2.38-4ubuntu2.1 [107 kB]\nGet:4 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libctf0 amd64 2.38-4ubuntu2.1 [103 kB]\nGet:5 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 binutils-x86-64-linux-gnu amd64 2.38-4ubuntu2.1 [2328 kB]\nGet:6 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 binutils amd64 2.38-4ubuntu2.1 [3198 B]\nGet:7 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libc-dev-bin amd64 2.35-0ubuntu3.1 [20.4 kB]\nGet:8 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 linux-libc-dev amd64 5.15.0-67.74 [1329 kB]\nGet:9 http://archive.ubuntu.com/ubuntu jammy/main amd64 libcrypt-dev amd64 1:4.4.27-1 [112 kB]\nGet:10 http://archive.ubuntu.com/ubuntu jammy/main amd64 rpcsvc-proto amd64 1.4.2-0ubuntu6 [68.5 kB]\nGet:11 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libtirpc-dev amd64 1.3.2-2ubuntu0.1 [192 kB]\nGet:12 http://archive.ubuntu.com/ubuntu jammy/main amd64 libnsl-dev amd64 1.3.0-2build2 [71.3 kB]\nGet:13 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libc6-dev amd64 2.35-0ubuntu3.1 [2099 kB]\nGet:14 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 gcc-11-base amd64 11.3.0-1ubuntu1~22.04 [20.8 kB]\nGet:15 http://archive.ubuntu.com/ubuntu jammy/main amd64 libisl23 amd64 0.24-2build1 [727 kB]\nGet:16 http://archive.ubuntu.com/ubuntu jammy/main amd64 libmpfr6 amd64 4.1.0-3build3 [1425 kB]\nGet:17 http://archive.ubuntu.com/ubuntu jammy/main amd64 libmpc3 amd64 1.2.1-2build1 [46.9 kB]\nGet:18 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 cpp-11 amd64 11.3.0-1ubuntu1~22.04 [9967 kB]\nGet:19 http://archive.ubuntu.com/ubuntu jammy/main amd64 cpp amd64 4:11.2.0-1ubuntu1 [27.7 kB]\nGet:20 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libcc1-0 amd64 12.1.0-2ubuntu1~22.04 [47.4 kB]\nGet:21 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgomp1 amd64 12.1.0-2ubuntu1~22.04 [126 kB]\nGet:22 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libitm1 amd64 12.1.0-2ubuntu1~22.04 [30.2 kB]\nGet:23 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libatomic1 amd64 12.1.0-2ubuntu1~22.04 [10.4 kB]\nGet:24 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libasan6 amd64 11.3.0-1ubuntu1~22.04 [2284 kB]\nGet:25 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 liblsan0 amd64 12.1.0-2ubuntu1~22.04 [1069 kB]\nGet:26 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libtsan0 amd64 11.3.0-1ubuntu1~22.04 [2262 kB]\nGet:27 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libubsan1 amd64 12.1.0-2ubuntu1~22.04 [976 kB]\nGet:28 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libquadmath0 amd64 12.1.0-2ubuntu1~22.04 [154 kB]\nGet:29 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgcc-11-dev amd64 11.3.0-1ubuntu1~22.04 [2517 kB]\nGet:30 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 gcc-11 amd64 11.3.0-1ubuntu1~22.04 [20.1 MB]\nGet:31 http://archive.ubuntu.com/ubuntu jammy/main amd64 gcc amd64 4:11.2.0-1ubuntu1 [5112 B]\nGet:32 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libstdc++-11-dev amd64 11.3.0-1ubuntu1~22.04 [2087 kB]\nGet:33 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 g++-11 amd64 11.3.0-1ubuntu1~22.04 [11.4 MB]\nGet:34 http://archive.ubuntu.com/ubuntu jammy/main amd64 g++ amd64 4:11.2.0-1ubuntu1 [1412 B]\nGet:35 http://archive.ubuntu.com/ubuntu jammy/main amd64 make amd64 4.3-4.1build1 [180 kB]\nGet:36 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libdpkg-perl all 1.21.1ubuntu2.1 [237 kB]\nGet:37 http://archive.ubuntu.com/ubuntu jammy/main amd64 bzip2 amd64 1.0.8-5build1 [34.8 kB]\nGet:38 http://archive.ubuntu.com/ubuntu jammy/main amd64 lto-disabled-list all 24 [12.5 kB]\nGet:39 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 dpkg-dev all 1.21.1ubuntu2.1 [922 kB]\nGet:40 http://archive.ubuntu.com/ubuntu jammy/main amd64 build-essential amd64 12.9ubuntu3 [4744 B]\nGet:41 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfakeroot amd64 1.28-1ubuntu1 [31.5 kB]\nGet:42 http://archive.ubuntu.com/ubuntu jammy/main amd64 fakeroot amd64 1.28-1ubuntu1 [60.4 kB]\nGet:43 http://archive.ubuntu.com/ubuntu jammy/main amd64 fonts-dejavu-core all 2.37-2build1 [1041 kB]\nGet:44 http://archive.ubuntu.com/ubuntu jammy/main amd64 fontconfig-config all 2.13.1-4.2ubuntu5 [29.1 kB]\nGet:45 http://archive.ubuntu.com/ubuntu jammy/main amd64 javascript-common all 11+nmu1 [5936 B]\nGet:46 http://archive.ubuntu.com/ubuntu jammy/main amd64 libalgorithm-diff-perl all 1.201-1 [41.8 kB]\nGet:47 http://archive.ubuntu.com/ubuntu jammy/main amd64 libalgorithm-diff-xs-perl amd64 0.04-6build3 [11.9 kB]\nGet:48 http://archive.ubuntu.com/ubuntu jammy/main amd64 libalgorithm-merge-perl all 0.08-3 [12.0 kB]\nGet:49 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libfreetype6 amd64 2.11.1+dfsg-1ubuntu0.1 [389 kB]\nGet:50 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfontconfig1 amd64 2.13.1-4.2ubuntu5 [131 kB]\nGet:51 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjpeg-turbo8 amd64 2.1.2-0ubuntu1 [134 kB]\nGet:52 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjpeg8 amd64 8c-2ubuntu10 [2264 B]\nGet:53 http://archive.ubuntu.com/ubuntu jammy/main amd64 libdeflate0 amd64 1.10-2 [70.9 kB]\nGet:54 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libjbig0 amd64 2.1-3.1ubuntu0.22.04.1 [29.2 kB]\nGet:55 http://archive.ubuntu.com/ubuntu jammy/main amd64 libwebp7 amd64 1.2.2-2 [206 kB]\nGet:56 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libtiff5 amd64 4.3.0-6ubuntu0.4 [183 kB]\nGet:57 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libxpm4 amd64 1:3.5.12-1ubuntu0.22.04.1 [36.4 kB]\nGet:58 http://archive.ubuntu.com/ubuntu jammy/main amd64 libgd3 amd64 2.3.0-2ubuntu2 [129 kB]\nGet:59 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libc-devtools amd64 2.35-0ubuntu3.1 [28.9 kB]\nGet:60 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libexpat1-dev amd64 2.4.7-1ubuntu0.2 [147 kB]\nGet:61 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfile-fcntllock-perl amd64 0.22-3build7 [33.9 kB]\nGet:62 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-jquery all 3.6.0+dfsg+~3.5.13-1 [321 kB]\nGet:63 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-underscore all 1.13.2~dfsg-2 [118 kB]\nGet:64 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-sphinxdoc all 4.3.2-1 [139 kB]\nGet:65 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpython3.10 amd64 3.10.6-1~22.04.2ubuntu1 [1958 kB]\nGet:66 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 zlib1g-dev amd64 1:1.2.11.dfsg-2ubuntu9.2 [164 kB]\nGet:67 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpython3.10-dev amd64 3.10.6-1~22.04.2ubuntu1 [4755 kB]\nGet:68 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpython3-dev amd64 3.10.6-1~22.04 [7166 B]\nGet:69 http://archive.ubuntu.com/ubuntu jammy/main amd64 manpages-dev all 5.10-1ubuntu1 [2309 kB]\nGet:70 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3.10-dev amd64 3.10.6-1~22.04.2ubuntu1 [507 kB]\nGet:71 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-lib2to3 all 3.10.6-1~22.04 [77.6 kB]\nGet:72 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-distutils all 3.10.6-1~22.04 [139 kB]\nGet:73 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-dev amd64 3.10.6-1~22.04 [26.0 kB]\nGet:74 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-setuptools all 59.6.0-1.2ubuntu0.22.04.1 [339 kB]\nGet:75 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 python3-wheel all 0.37.1-2ubuntu0.22.04.1 [32.0 kB]\nGet:76 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 python3-pip all 22.0.2+dfsg-1ubuntu0.2 [1305 kB]\nFetched 78.9 MB in 3s (22.9 MB/s)\nSelecting previously unselected package binutils-common:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 21463 files and directories currently installed.)\r\nPreparing to unpack .../00-binutils-common_2.38-4ubuntu2.1_amd64.deb ...\r\nUnpacking binutils-common:amd64 (2.38-4ubuntu2.1) ...\r\nSelecting previously unselected package libbinutils:amd64.\r\nPreparing to unpack .../01-libbinutils_2.38-4ubuntu2.1_amd64.deb ...\r\nUnpacking libbinutils:amd64 (2.38-4ubuntu2.1) ...\r\nSelecting previously unselected package libctf-nobfd0:amd64.\r\nPreparing to unpack .../02-libctf-nobfd0_2.38-4ubuntu2.1_amd64.deb ...\r\nUnpacking libctf-nobfd0:amd64 (2.38-4ubuntu2.1) ...\r\nSelecting previously unselected package libctf0:amd64.\r\nPreparing to unpack .../03-libctf0_2.38-4ubuntu2.1_amd64.deb ...\r\nUnpacking libctf0:amd64 (2.38-4ubuntu2.1) ...\r\nSelecting previously unselected package binutils-x86-64-linux-gnu.\r\nPreparing to unpack .../04-binutils-x86-64-linux-gnu_2.38-4ubuntu2.1_amd64.deb ...\r\nUnpacking binutils-x86-64-linux-gnu (2.38-4ubuntu2.1) ...\r\nSelecting previously unselected package binutils.\r\nPreparing to unpack .../05-binutils_2.38-4ubuntu2.1_amd64.deb ...\r\nUnpacking binutils (2.38-4ubuntu2.1) ...\r\nSelecting previously unselected package libc-dev-bin.\r\nPreparing to unpack .../06-libc-dev-bin_2.35-0ubuntu3.1_amd64.deb ...\r\nUnpacking libc-dev-bin (2.35-0ubuntu3.1) ...\r\nSelecting previously unselected package linux-libc-dev:amd64.\r\nPreparing to unpack .../07-linux-libc-dev_5.15.0-67.74_amd64.deb ...\r\nUnpacking linux-libc-dev:amd64 (5.15.0-67.74) ...\r\nSelecting previously unselected package libcrypt-dev:amd64.\r\nPreparing to unpack .../08-libcrypt-dev_1%3a4.4.27-1_amd64.deb ...\r\nUnpacking libcrypt-dev:amd64 (1:4.4.27-1) ...\r\nSelecting previously unselected package rpcsvc-proto.\r\nPreparing to unpack .../09-rpcsvc-proto_1.4.2-0ubuntu6_amd64.deb ...\r\nUnpacking rpcsvc-proto (1.4.2-0ubuntu6) ...\r\nSelecting previously unselected package libtirpc-dev:amd64.\r\nPreparing to unpack .../10-libtirpc-dev_1.3.2-2ubuntu0.1_amd64.deb ...\r\nUnpacking libtirpc-dev:amd64 (1.3.2-2ubuntu0.1) ...\r\nSelecting previously unselected package libnsl-dev:amd64.\r\nPreparing to unpack .../11-libnsl-dev_1.3.0-2build2_amd64.deb ...\r\nUnpacking libnsl-dev:amd64 (1.3.0-2build2) ...\r\nSelecting previously unselected package libc6-dev:amd64.\r\nPreparing to unpack .../12-libc6-dev_2.35-0ubuntu3.1_amd64.deb ...\r\nUnpacking libc6-dev:amd64 (2.35-0ubuntu3.1) ...\r\nSelecting previously unselected package gcc-11-base:amd64.\r\nPreparing to unpack .../13-gcc-11-base_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking gcc-11-base:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package libisl23:amd64.\r\nPreparing to unpack .../14-libisl23_0.24-2build1_amd64.deb ...\r\nUnpacking libisl23:amd64 (0.24-2build1) ...\r\nSelecting previously unselected package libmpfr6:amd64.\r\nPreparing to unpack .../15-libmpfr6_4.1.0-3build3_amd64.deb ...\r\nUnpacking libmpfr6:amd64 (4.1.0-3build3) ...\r\nSelecting previously unselected package libmpc3:amd64.\r\nPreparing to unpack .../16-libmpc3_1.2.1-2build1_amd64.deb ...\r\nUnpacking libmpc3:amd64 (1.2.1-2build1) ...\r\nSelecting previously unselected package cpp-11.\r\nPreparing to unpack .../17-cpp-11_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking cpp-11 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package cpp.\r\nPreparing to unpack .../18-cpp_4%3a11.2.0-1ubuntu1_amd64.deb ...\r\nUnpacking cpp (4:11.2.0-1ubuntu1) ...\r\nSelecting previously unselected package libcc1-0:amd64.\r\nPreparing to unpack .../19-libcc1-0_12.1.0-2ubuntu1~22.04_amd64.deb ...\r\nUnpacking libcc1-0:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSelecting previously unselected package libgomp1:amd64.\r\nPreparing to unpack .../20-libgomp1_12.1.0-2ubuntu1~22.04_amd64.deb ...\r\nUnpacking libgomp1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSelecting previously unselected package libitm1:amd64.\r\nPreparing to unpack .../21-libitm1_12.1.0-2ubuntu1~22.04_amd64.deb ...\r\nUnpacking libitm1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSelecting previously unselected package libatomic1:amd64.\r\nPreparing to unpack .../22-libatomic1_12.1.0-2ubuntu1~22.04_amd64.deb ...\r\nUnpacking libatomic1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSelecting previously unselected package libasan6:amd64.\r\nPreparing to unpack .../23-libasan6_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking libasan6:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package liblsan0:amd64.\r\nPreparing to unpack .../24-liblsan0_12.1.0-2ubuntu1~22.04_amd64.deb ...\r\nUnpacking liblsan0:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSelecting previously unselected package libtsan0:amd64.\r\nPreparing to unpack .../25-libtsan0_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking libtsan0:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package libubsan1:amd64.\r\nPreparing to unpack .../26-libubsan1_12.1.0-2ubuntu1~22.04_amd64.deb ...\r\nUnpacking libubsan1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSelecting previously unselected package libquadmath0:amd64.\r\nPreparing to unpack .../27-libquadmath0_12.1.0-2ubuntu1~22.04_amd64.deb ...\r\nUnpacking libquadmath0:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSelecting previously unselected package libgcc-11-dev:amd64.\r\nPreparing to unpack .../28-libgcc-11-dev_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking libgcc-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package gcc-11.\r\nPreparing to unpack .../29-gcc-11_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking gcc-11 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package gcc.\r\nPreparing to unpack .../30-gcc_4%3a11.2.0-1ubuntu1_amd64.deb ...\r\nUnpacking gcc (4:11.2.0-1ubuntu1) ...\r\nSelecting previously unselected package libstdc++-11-dev:amd64.\r\nPreparing to unpack .../31-libstdc++-11-dev_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking libstdc++-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package g++-11.\r\nPreparing to unpack .../32-g++-11_11.3.0-1ubuntu1~22.04_amd64.deb ...\r\nUnpacking g++-11 (11.3.0-1ubuntu1~22.04) ...\r\nSelecting previously unselected package g++.\r\nPreparing to unpack .../33-g++_4%3a11.2.0-1ubuntu1_amd64.deb ...\r\nUnpacking g++ (4:11.2.0-1ubuntu1) ...\r\nSelecting previously unselected package make.\r\nPreparing to unpack .../34-make_4.3-4.1build1_amd64.deb ...\r\nUnpacking make (4.3-4.1build1) ...\r\nSelecting previously unselected package libdpkg-perl.\r\nPreparing to unpack .../35-libdpkg-perl_1.21.1ubuntu2.1_all.deb ...\r\nUnpacking libdpkg-perl (1.21.1ubuntu2.1) ...\r\nSelecting previously unselected package bzip2.\r\nPreparing to unpack .../36-bzip2_1.0.8-5build1_amd64.deb ...\r\nUnpacking bzip2 (1.0.8-5build1) ...\r\nSelecting previously unselected package lto-disabled-list.\r\nPreparing to unpack .../37-lto-disabled-list_24_all.deb ...\r\nUnpacking lto-disabled-list (24) ...\r\nSelecting previously unselected package dpkg-dev.\r\nPreparing to unpack .../38-dpkg-dev_1.21.1ubuntu2.1_all.deb ...\r\nUnpacking dpkg-dev (1.21.1ubuntu2.1) ...\r\nSelecting previously unselected package build-essential.\r\nPreparing to unpack .../39-build-essential_12.9ubuntu3_amd64.deb ...\r\nUnpacking build-essential (12.9ubuntu3) ...\r\nSelecting previously unselected package libfakeroot:amd64.\r\nPreparing to unpack .../40-libfakeroot_1.28-1ubuntu1_amd64.deb ...\r\nUnpacking libfakeroot:amd64 (1.28-1ubuntu1) ...\r\nSelecting previously unselected package fakeroot.\r\nPreparing to unpack .../41-fakeroot_1.28-1ubuntu1_amd64.deb ...\r\nUnpacking fakeroot (1.28-1ubuntu1) ...\r\nSelecting previously unselected package fonts-dejavu-core.\r\nPreparing to unpack .../42-fonts-dejavu-core_2.37-2build1_all.deb ...\r\nUnpacking fonts-dejavu-core (2.37-2build1) ...\r\nSelecting previously unselected package fontconfig-config.\r\nPreparing to unpack .../43-fontconfig-config_2.13.1-4.2ubuntu5_all.deb ...\r\nUnpacking fontconfig-config (2.13.1-4.2ubuntu5) ...\r\nSelecting previously unselected package javascript-common.\r\nPreparing to unpack .../44-javascript-common_11+nmu1_all.deb ...\r\nUnpacking javascript-common (11+nmu1) ...\r\nSelecting previously unselected package libalgorithm-diff-perl.\r\nPreparing to unpack .../45-libalgorithm-diff-perl_1.201-1_all.deb ...\r\nUnpacking libalgorithm-diff-perl (1.201-1) ...\r\nSelecting previously unselected package libalgorithm-diff-xs-perl.\r\nPreparing to unpack .../46-libalgorithm-diff-xs-perl_0.04-6build3_amd64.deb ...\r\nUnpacking libalgorithm-diff-xs-perl (0.04-6build3) ...\r\nSelecting previously unselected package libalgorithm-merge-perl.\r\nPreparing to unpack .../47-libalgorithm-merge-perl_0.08-3_all.deb ...\r\nUnpacking libalgorithm-merge-perl (0.08-3) ...\r\nSelecting previously unselected package libfreetype6:amd64.\r\nPreparing to unpack .../48-libfreetype6_2.11.1+dfsg-1ubuntu0.1_amd64.deb ...\r\nUnpacking libfreetype6:amd64 (2.11.1+dfsg-1ubuntu0.1) ...\r\nSelecting previously unselected package libfontconfig1:amd64.\r\nPreparing to unpack .../49-libfontconfig1_2.13.1-4.2ubuntu5_amd64.deb ...\r\nUnpacking libfontconfig1:amd64 (2.13.1-4.2ubuntu5) ...\r\nSelecting previously unselected package libjpeg-turbo8:amd64.\r\nPreparing to unpack .../50-libjpeg-turbo8_2.1.2-0ubuntu1_amd64.deb ...\r\nUnpacking libjpeg-turbo8:amd64 (2.1.2-0ubuntu1) ...\r\nSelecting previously unselected package libjpeg8:amd64.\r\nPreparing to unpack .../51-libjpeg8_8c-2ubuntu10_amd64.deb ...\r\nUnpacking libjpeg8:amd64 (8c-2ubuntu10) ...\r\nSelecting previously unselected package libdeflate0:amd64.\r\nPreparing to unpack .../52-libdeflate0_1.10-2_amd64.deb ...\r\nUnpacking libdeflate0:amd64 (1.10-2) ...\r\nSelecting previously unselected package libjbig0:amd64.\r\nPreparing to unpack .../53-libjbig0_2.1-3.1ubuntu0.22.04.1_amd64.deb ...\r\nUnpacking libjbig0:amd64 (2.1-3.1ubuntu0.22.04.1) ...\r\nSelecting previously unselected package libwebp7:amd64.\r\nPreparing to unpack .../54-libwebp7_1.2.2-2_amd64.deb ...\r\nUnpacking libwebp7:amd64 (1.2.2-2) ...\r\nSelecting previously unselected package libtiff5:amd64.\r\nPreparing to unpack .../55-libtiff5_4.3.0-6ubuntu0.4_amd64.deb ...\r\nUnpacking libtiff5:amd64 (4.3.0-6ubuntu0.4) ...\r\nSelecting previously unselected package libxpm4:amd64.\r\nPreparing to unpack .../56-libxpm4_1%3a3.5.12-1ubuntu0.22.04.1_amd64.deb ...\r\nUnpacking libxpm4:amd64 (1:3.5.12-1ubuntu0.22.04.1) ...\r\nSelecting previously unselected package libgd3:amd64.\r\nPreparing to unpack .../57-libgd3_2.3.0-2ubuntu2_amd64.deb ...\r\nUnpacking libgd3:amd64 (2.3.0-2ubuntu2) ...\r\nSelecting previously unselected package libc-devtools.\r\nPreparing to unpack .../58-libc-devtools_2.35-0ubuntu3.1_amd64.deb ...\r\nUnpacking libc-devtools (2.35-0ubuntu3.1) ...\r\nSelecting previously unselected package libexpat1-dev:amd64.\r\nPreparing to unpack .../59-libexpat1-dev_2.4.7-1ubuntu0.2_amd64.deb ...\r\nUnpacking libexpat1-dev:amd64 (2.4.7-1ubuntu0.2) ...\r\nSelecting previously unselected package libfile-fcntllock-perl.\r\nPreparing to unpack .../60-libfile-fcntllock-perl_0.22-3build7_amd64.deb ...\r\nUnpacking libfile-fcntllock-perl (0.22-3build7) ...\r\nSelecting previously unselected package libjs-jquery.\r\nPreparing to unpack .../61-libjs-jquery_3.6.0+dfsg+~3.5.13-1_all.deb ...\r\nUnpacking libjs-jquery (3.6.0+dfsg+~3.5.13-1) ...\r\nSelecting previously unselected package libjs-underscore.\r\nPreparing to unpack .../62-libjs-underscore_1.13.2~dfsg-2_all.deb ...\r\nUnpacking libjs-underscore (1.13.2~dfsg-2) ...\r\nSelecting previously unselected package libjs-sphinxdoc.\r\nPreparing to unpack .../63-libjs-sphinxdoc_4.3.2-1_all.deb ...\r\nUnpacking libjs-sphinxdoc (4.3.2-1) ...\r\nSelecting previously unselected package libpython3.10:amd64.\r\nPreparing to unpack .../64-libpython3.10_3.10.6-1~22.04.2ubuntu1_amd64.deb ...\r\nUnpacking libpython3.10:amd64 (3.10.6-1~22.04.2ubuntu1) ...\r\nSelecting previously unselected package zlib1g-dev:amd64.\r\nPreparing to unpack .../65-zlib1g-dev_1%3a1.2.11.dfsg-2ubuntu9.2_amd64.deb ...\r\nUnpacking zlib1g-dev:amd64 (1:1.2.11.dfsg-2ubuntu9.2) ...\r\nSelecting previously unselected package libpython3.10-dev:amd64.\r\nPreparing to unpack .../66-libpython3.10-dev_3.10.6-1~22.04.2ubuntu1_amd64.deb ...\r\nUnpacking libpython3.10-dev:amd64 (3.10.6-1~22.04.2ubuntu1) ...\r\nSelecting previously unselected package libpython3-dev:amd64.\r\nPreparing to unpack .../67-libpython3-dev_3.10.6-1~22.04_amd64.deb ...\r\nUnpacking libpython3-dev:amd64 (3.10.6-1~22.04) ...\r\nSelecting previously unselected package manpages-dev.\r\nPreparing to unpack .../68-manpages-dev_5.10-1ubuntu1_all.deb ...\r\nUnpacking manpages-dev (5.10-1ubuntu1) ...\r\nSelecting previously unselected package python3.10-dev.\r\nPreparing to unpack .../69-python3.10-dev_3.10.6-1~22.04.2ubuntu1_amd64.deb ...\r\nUnpacking python3.10-dev (3.10.6-1~22.04.2ubuntu1) ...\r\nSelecting previously unselected package python3-lib2to3.\r\nPreparing to unpack .../70-python3-lib2to3_3.10.6-1~22.04_all.deb ...\r\nUnpacking python3-lib2to3 (3.10.6-1~22.04) ...\r\nSelecting previously unselected package python3-distutils.\r\nPreparing to unpack .../71-python3-distutils_3.10.6-1~22.04_all.deb ...\r\nUnpacking python3-distutils (3.10.6-1~22.04) ...\r\nSelecting previously unselected package python3-dev.\r\nPreparing to unpack .../72-python3-dev_3.10.6-1~22.04_amd64.deb ...\r\nUnpacking python3-dev (3.10.6-1~22.04) ...\r\nSelecting previously unselected package python3-setuptools.\r\nPreparing to unpack .../73-python3-setuptools_59.6.0-1.2ubuntu0.22.04.1_all.deb ...\r\nUnpacking python3-setuptools (59.6.0-1.2ubuntu0.22.04.1) ...\r\nSelecting previously unselected package python3-wheel.\r\nPreparing to unpack .../74-python3-wheel_0.37.1-2ubuntu0.22.04.1_all.deb ...\r\nUnpacking python3-wheel (0.37.1-2ubuntu0.22.04.1) ...\r\nSelecting previously unselected package python3-pip.\r\nPreparing to unpack .../75-python3-pip_22.0.2+dfsg-1ubuntu0.2_all.deb ...\r\nUnpacking python3-pip (22.0.2+dfsg-1ubuntu0.2) ...\r\nSetting up javascript-common (11+nmu1) ...\r\nSetting up gcc-11-base:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up manpages-dev (5.10-1ubuntu1) ...\r\nSetting up libpython3.10:amd64 (3.10.6-1~22.04.2ubuntu1) ...\r\nSetting up lto-disabled-list (24) ...\r\nSetting up libxpm4:amd64 (1:3.5.12-1ubuntu0.22.04.1) ...\r\nSetting up libfile-fcntllock-perl (0.22-3build7) ...\r\nSetting up libalgorithm-diff-perl (1.201-1) ...\r\nSetting up binutils-common:amd64 (2.38-4ubuntu2.1) ...\r\nSetting up libdeflate0:amd64 (1.10-2) ...\r\nSetting up linux-libc-dev:amd64 (5.15.0-67.74) ...\r\nSetting up libctf-nobfd0:amd64 (2.38-4ubuntu2.1) ...\r\nSetting up libgomp1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSetting up bzip2 (1.0.8-5build1) ...\r\nSetting up libjbig0:amd64 (2.1-3.1ubuntu0.22.04.1) ...\r\nSetting up libfakeroot:amd64 (1.28-1ubuntu1) ...\r\nSetting up libasan6:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up fakeroot (1.28-1ubuntu1) ...\r\nupdate-alternatives: using /usr/bin/fakeroot-sysv to provide /usr/bin/fakeroot (fakeroot) in auto mode\r\nSetting up libtirpc-dev:amd64 (1.3.2-2ubuntu0.1) ...\r\nSetting up rpcsvc-proto (1.4.2-0ubuntu6) ...\r\nSetting up libfreetype6:amd64 (2.11.1+dfsg-1ubuntu0.1) ...\r\nSetting up make (4.3-4.1build1) ...\r\nSetting up libmpfr6:amd64 (4.1.0-3build3) ...\r\nSetting up libquadmath0:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSetting up libmpc3:amd64 (1.2.1-2build1) ...\r\nSetting up libatomic1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSetting up fonts-dejavu-core (2.37-2build1) ...\r\nSetting up libjpeg-turbo8:amd64 (2.1.2-0ubuntu1) ...\r\nSetting up libdpkg-perl (1.21.1ubuntu2.1) ...\r\nSetting up libwebp7:amd64 (1.2.2-2) ...\r\nSetting up libubsan1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSetting up libnsl-dev:amd64 (1.3.0-2build2) ...\r\nSetting up libcrypt-dev:amd64 (1:4.4.27-1) ...\r\nSetting up libjs-jquery (3.6.0+dfsg+~3.5.13-1) ...\r\nSetting up libbinutils:amd64 (2.38-4ubuntu2.1) ...\r\nSetting up libisl23:amd64 (0.24-2build1) ...\r\nSetting up libc-dev-bin (2.35-0ubuntu3.1) ...\r\nSetting up python3-lib2to3 (3.10.6-1~22.04) ...\r\nSetting up libalgorithm-diff-xs-perl (0.04-6build3) ...\r\nSetting up libcc1-0:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSetting up liblsan0:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSetting up libitm1:amd64 (12.1.0-2ubuntu1~22.04) ...\r\nSetting up libjs-underscore (1.13.2~dfsg-2) ...\r\nSetting up libalgorithm-merge-perl (0.08-3) ...\r\nSetting up libtsan0:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up libctf0:amd64 (2.38-4ubuntu2.1) ...\r\nSetting up libjpeg8:amd64 (8c-2ubuntu10) ...\r\nSetting up python3-distutils (3.10.6-1~22.04) ...\r\nSetting up cpp-11 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up python3-setuptools (59.6.0-1.2ubuntu0.22.04.1) ...\r\nSetting up fontconfig-config (2.13.1-4.2ubuntu5) ...\r\nSetting up python3-wheel (0.37.1-2ubuntu0.22.04.1) ...\r\nSetting up python3-pip (22.0.2+dfsg-1ubuntu0.2) ...\r\nSetting up libjs-sphinxdoc (4.3.2-1) ...\r\nSetting up libgcc-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up cpp (4:11.2.0-1ubuntu1) ...\r\nSetting up libc6-dev:amd64 (2.35-0ubuntu3.1) ...\r\nSetting up libtiff5:amd64 (4.3.0-6ubuntu0.4) ...\r\nSetting up libfontconfig1:amd64 (2.13.1-4.2ubuntu5) ...\r\nSetting up binutils-x86-64-linux-gnu (2.38-4ubuntu2.1) ...\r\nSetting up binutils (2.38-4ubuntu2.1) ...\r\nSetting up dpkg-dev (1.21.1ubuntu2.1) ...\r\nSetting up libexpat1-dev:amd64 (2.4.7-1ubuntu0.2) ...\r\nSetting up libgd3:amd64 (2.3.0-2ubuntu2) ...\r\nSetting up libstdc++-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up zlib1g-dev:amd64 (1:1.2.11.dfsg-2ubuntu9.2) ...\r\nSetting up gcc-11 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up libc-devtools (2.35-0ubuntu3.1) ...\r\nSetting up g++-11 (11.3.0-1ubuntu1~22.04) ...\r\nSetting up gcc (4:11.2.0-1ubuntu1) ...\r\nSetting up libpython3.10-dev:amd64 (3.10.6-1~22.04.2ubuntu1) ...\r\nSetting up python3.10-dev (3.10.6-1~22.04.2ubuntu1) ...\r\nSetting up g++ (4:11.2.0-1ubuntu1) ...\r\nupdate-alternatives: using /usr/bin/g++ to provide /usr/bin/c++ (c++) in auto mode\r\nSetting up build-essential (12.9ubuntu3) ...\r\nSetting up libpython3-dev:amd64 (3.10.6-1~22.04) ...\r\nSetting up python3-dev (3.10.6-1~22.04) ...\r\nProcessing triggers for man-db (2.10.2-1) ...\r\nProcessing triggers for libc-bin (2.35-0ubuntu3.1) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following additional packages will be installed:", "  binutils binutils-common binutils-x86-64-linux-gnu build-essential bzip2 cpp", "  cpp-11 dpkg-dev fakeroot fontconfig-config fonts-dejavu-core g++ g++-11 gcc", "  gcc-11 gcc-11-base javascript-common libalgorithm-diff-perl", "  libalgorithm-diff-xs-perl libalgorithm-merge-perl libasan6 libatomic1", "  libbinutils libc-dev-bin libc-devtools libc6-dev libcc1-0 libcrypt-dev", "  libctf-nobfd0 libctf0 libdeflate0 libdpkg-perl libexpat1-dev libfakeroot", "  libfile-fcntllock-perl libfontconfig1 libfreetype6 libgcc-11-dev libgd3", "  libgomp1 libisl23 libitm1 libjbig0 libjpeg-turbo8 libjpeg8 libjs-jquery", "  libjs-sphinxdoc libjs-underscore liblsan0 libmpc3 libmpfr6 libnsl-dev", "  libpython3-dev libpython3.10 libpython3.10-dev libquadmath0 libstdc++-11-dev", "  libtiff5 libtirpc-dev libtsan0 libubsan1 libwebp7 libxpm4 linux-libc-dev", "  lto-disabled-list make manpages-dev python3-dev python3-distutils", "  python3-lib2to3 python3-setuptools python3-wheel python3.10-dev rpcsvc-proto", "  zlib1g-dev", "Suggested packages:", "  binutils-doc bzip2-doc cpp-doc gcc-11-locales debian-keyring g++-multilib", "  g++-11-multilib gcc-11-doc gcc-multilib autoconf automake libtool flex bison", "  gdb gcc-doc gcc-11-multilib apache2 | lighttpd | httpd glibc-doc bzr", "  libgd-tools libstdc++-11-doc make-doc python-setuptools-doc", "The following NEW packages will be installed:", "  binutils binutils-common binutils-x86-64-linux-gnu build-essential bzip2 cpp", "  cpp-11 dpkg-dev fakeroot fontconfig-config fonts-dejavu-core g++ g++-11 gcc", "  gcc-11 gcc-11-base javascript-common libalgorithm-diff-perl", "  libalgorithm-diff-xs-perl libalgorithm-merge-perl libasan6 libatomic1", "  libbinutils libc-dev-bin libc-devtools libc6-dev libcc1-0 libcrypt-dev", "  libctf-nobfd0 libctf0 libdeflate0 libdpkg-perl libexpat1-dev libfakeroot", "  libfile-fcntllock-perl libfontconfig1 libfreetype6 libgcc-11-dev libgd3", "  libgomp1 libisl23 libitm1 libjbig0 libjpeg-turbo8 libjpeg8 libjs-jquery", "  libjs-sphinxdoc libjs-underscore liblsan0 libmpc3 libmpfr6 libnsl-dev", "  libpython3-dev libpython3.10 libpython3.10-dev libquadmath0 libstdc++-11-dev", "  libtiff5 libtirpc-dev libtsan0 libubsan1 libwebp7 libxpm4 linux-libc-dev", "  lto-disabled-list make manpages-dev python3-dev python3-distutils", "  python3-lib2to3 python3-pip python3-setuptools python3-wheel python3.10-dev", "  rpcsvc-proto zlib1g-dev", "0 upgraded, 76 newly installed, 0 to remove and 0 not upgraded.", "Need to get 78.9 MB of archives.", "After this operation, 267 MB of additional disk space will be used.", "Get:1 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 binutils-common amd64 2.38-4ubuntu2.1 [221 kB]", "Get:2 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libbinutils amd64 2.38-4ubuntu2.1 [661 kB]", "Get:3 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libctf-nobfd0 amd64 2.38-4ubuntu2.1 [107 kB]", "Get:4 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libctf0 amd64 2.38-4ubuntu2.1 [103 kB]", "Get:5 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 binutils-x86-64-linux-gnu amd64 2.38-4ubuntu2.1 [2328 kB]", "Get:6 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 binutils amd64 2.38-4ubuntu2.1 [3198 B]", "Get:7 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libc-dev-bin amd64 2.35-0ubuntu3.1 [20.4 kB]", "Get:8 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 linux-libc-dev amd64 5.15.0-67.74 [1329 kB]", "Get:9 http://archive.ubuntu.com/ubuntu jammy/main amd64 libcrypt-dev amd64 1:4.4.27-1 [112 kB]", "Get:10 http://archive.ubuntu.com/ubuntu jammy/main amd64 rpcsvc-proto amd64 1.4.2-0ubuntu6 [68.5 kB]", "Get:11 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libtirpc-dev amd64 1.3.2-2ubuntu0.1 [192 kB]", "Get:12 http://archive.ubuntu.com/ubuntu jammy/main amd64 libnsl-dev amd64 1.3.0-2build2 [71.3 kB]", "Get:13 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libc6-dev amd64 2.35-0ubuntu3.1 [2099 kB]", "Get:14 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 gcc-11-base amd64 11.3.0-1ubuntu1~22.04 [20.8 kB]", "Get:15 http://archive.ubuntu.com/ubuntu jammy/main amd64 libisl23 amd64 0.24-2build1 [727 kB]", "Get:16 http://archive.ubuntu.com/ubuntu jammy/main amd64 libmpfr6 amd64 4.1.0-3build3 [1425 kB]", "Get:17 http://archive.ubuntu.com/ubuntu jammy/main amd64 libmpc3 amd64 1.2.1-2build1 [46.9 kB]", "Get:18 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 cpp-11 amd64 11.3.0-1ubuntu1~22.04 [9967 kB]", "Get:19 http://archive.ubuntu.com/ubuntu jammy/main amd64 cpp amd64 4:11.2.0-1ubuntu1 [27.7 kB]", "Get:20 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libcc1-0 amd64 12.1.0-2ubuntu1~22.04 [47.4 kB]", "Get:21 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgomp1 amd64 12.1.0-2ubuntu1~22.04 [126 kB]", "Get:22 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libitm1 amd64 12.1.0-2ubuntu1~22.04 [30.2 kB]", "Get:23 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libatomic1 amd64 12.1.0-2ubuntu1~22.04 [10.4 kB]", "Get:24 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libasan6 amd64 11.3.0-1ubuntu1~22.04 [2284 kB]", "Get:25 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 liblsan0 amd64 12.1.0-2ubuntu1~22.04 [1069 kB]", "Get:26 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libtsan0 amd64 11.3.0-1ubuntu1~22.04 [2262 kB]", "Get:27 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libubsan1 amd64 12.1.0-2ubuntu1~22.04 [976 kB]", "Get:28 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libquadmath0 amd64 12.1.0-2ubuntu1~22.04 [154 kB]", "Get:29 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgcc-11-dev amd64 11.3.0-1ubuntu1~22.04 [2517 kB]", "Get:30 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 gcc-11 amd64 11.3.0-1ubuntu1~22.04 [20.1 MB]", "Get:31 http://archive.ubuntu.com/ubuntu jammy/main amd64 gcc amd64 4:11.2.0-1ubuntu1 [5112 B]", "Get:32 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libstdc++-11-dev amd64 11.3.0-1ubuntu1~22.04 [2087 kB]", "Get:33 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 g++-11 amd64 11.3.0-1ubuntu1~22.04 [11.4 MB]", "Get:34 http://archive.ubuntu.com/ubuntu jammy/main amd64 g++ amd64 4:11.2.0-1ubuntu1 [1412 B]", "Get:35 http://archive.ubuntu.com/ubuntu jammy/main amd64 make amd64 4.3-4.1build1 [180 kB]", "Get:36 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libdpkg-perl all 1.21.1ubuntu2.1 [237 kB]", "Get:37 http://archive.ubuntu.com/ubuntu jammy/main amd64 bzip2 amd64 1.0.8-5build1 [34.8 kB]", "Get:38 http://archive.ubuntu.com/ubuntu jammy/main amd64 lto-disabled-list all 24 [12.5 kB]", "Get:39 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 dpkg-dev all 1.21.1ubuntu2.1 [922 kB]", "Get:40 http://archive.ubuntu.com/ubuntu jammy/main amd64 build-essential amd64 12.9ubuntu3 [4744 B]", "Get:41 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfakeroot amd64 1.28-1ubuntu1 [31.5 kB]", "Get:42 http://archive.ubuntu.com/ubuntu jammy/main amd64 fakeroot amd64 1.28-1ubuntu1 [60.4 kB]", "Get:43 http://archive.ubuntu.com/ubuntu jammy/main amd64 fonts-dejavu-core all 2.37-2build1 [1041 kB]", "Get:44 http://archive.ubuntu.com/ubuntu jammy/main amd64 fontconfig-config all 2.13.1-4.2ubuntu5 [29.1 kB]", "Get:45 http://archive.ubuntu.com/ubuntu jammy/main amd64 javascript-common all 11+nmu1 [5936 B]", "Get:46 http://archive.ubuntu.com/ubuntu jammy/main amd64 libalgorithm-diff-perl all 1.201-1 [41.8 kB]", "Get:47 http://archive.ubuntu.com/ubuntu jammy/main amd64 libalgorithm-diff-xs-perl amd64 0.04-6build3 [11.9 kB]", "Get:48 http://archive.ubuntu.com/ubuntu jammy/main amd64 libalgorithm-merge-perl all 0.08-3 [12.0 kB]", "Get:49 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libfreetype6 amd64 2.11.1+dfsg-1ubuntu0.1 [389 kB]", "Get:50 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfontconfig1 amd64 2.13.1-4.2ubuntu5 [131 kB]", "Get:51 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjpeg-turbo8 amd64 2.1.2-0ubuntu1 [134 kB]", "Get:52 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjpeg8 amd64 8c-2ubuntu10 [2264 B]", "Get:53 http://archive.ubuntu.com/ubuntu jammy/main amd64 libdeflate0 amd64 1.10-2 [70.9 kB]", "Get:54 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libjbig0 amd64 2.1-3.1ubuntu0.22.04.1 [29.2 kB]", "Get:55 http://archive.ubuntu.com/ubuntu jammy/main amd64 libwebp7 amd64 1.2.2-2 [206 kB]", "Get:56 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libtiff5 amd64 4.3.0-6ubuntu0.4 [183 kB]", "Get:57 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libxpm4 amd64 1:3.5.12-1ubuntu0.22.04.1 [36.4 kB]", "Get:58 http://archive.ubuntu.com/ubuntu jammy/main amd64 libgd3 amd64 2.3.0-2ubuntu2 [129 kB]", "Get:59 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libc-devtools amd64 2.35-0ubuntu3.1 [28.9 kB]", "Get:60 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libexpat1-dev amd64 2.4.7-1ubuntu0.2 [147 kB]", "Get:61 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfile-fcntllock-perl amd64 0.22-3build7 [33.9 kB]", "Get:62 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-jquery all 3.6.0+dfsg+~3.5.13-1 [321 kB]", "Get:63 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-underscore all 1.13.2~dfsg-2 [118 kB]", "Get:64 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-sphinxdoc all 4.3.2-1 [139 kB]", "Get:65 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpython3.10 amd64 3.10.6-1~22.04.2ubuntu1 [1958 kB]", "Get:66 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 zlib1g-dev amd64 1:1.2.11.dfsg-2ubuntu9.2 [164 kB]", "Get:67 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpython3.10-dev amd64 3.10.6-1~22.04.2ubuntu1 [4755 kB]", "Get:68 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libpython3-dev amd64 3.10.6-1~22.04 [7166 B]", "Get:69 http://archive.ubuntu.com/ubuntu jammy/main amd64 manpages-dev all 5.10-1ubuntu1 [2309 kB]", "Get:70 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3.10-dev amd64 3.10.6-1~22.04.2ubuntu1 [507 kB]", "Get:71 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-lib2to3 all 3.10.6-1~22.04 [77.6 kB]", "Get:72 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-distutils all 3.10.6-1~22.04 [139 kB]", "Get:73 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-dev amd64 3.10.6-1~22.04 [26.0 kB]", "Get:74 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-setuptools all 59.6.0-1.2ubuntu0.22.04.1 [339 kB]", "Get:75 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 python3-wheel all 0.37.1-2ubuntu0.22.04.1 [32.0 kB]", "Get:76 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 python3-pip all 22.0.2+dfsg-1ubuntu0.2 [1305 kB]", "Fetched 78.9 MB in 3s (22.9 MB/s)", "Selecting previously unselected package binutils-common:amd64.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 21463 files and directories currently installed.)", "Preparing to unpack .../00-binutils-common_2.38-4ubuntu2.1_amd64.deb ...", "Unpacking binutils-common:amd64 (2.38-4ubuntu2.1) ...", "Selecting previously unselected package libbinutils:amd64.", "Preparing to unpack .../01-libbinutils_2.38-4ubuntu2.1_amd64.deb ...", "Unpacking libbinutils:amd64 (2.38-4ubuntu2.1) ...", "Selecting previously unselected package libctf-nobfd0:amd64.", "Preparing to unpack .../02-libctf-nobfd0_2.38-4ubuntu2.1_amd64.deb ...", "Unpacking libctf-nobfd0:amd64 (2.38-4ubuntu2.1) ...", "Selecting previously unselected package libctf0:amd64.", "Preparing to unpack .../03-libctf0_2.38-4ubuntu2.1_amd64.deb ...", "Unpacking libctf0:amd64 (2.38-4ubuntu2.1) ...", "Selecting previously unselected package binutils-x86-64-linux-gnu.", "Preparing to unpack .../04-binutils-x86-64-linux-gnu_2.38-4ubuntu2.1_amd64.deb ...", "Unpacking binutils-x86-64-linux-gnu (2.38-4ubuntu2.1) ...", "Selecting previously unselected package binutils.", "Preparing to unpack .../05-binutils_2.38-4ubuntu2.1_amd64.deb ...", "Unpacking binutils (2.38-4ubuntu2.1) ...", "Selecting previously unselected package libc-dev-bin.", "Preparing to unpack .../06-libc-dev-bin_2.35-0ubuntu3.1_amd64.deb ...", "Unpacking libc-dev-bin (2.35-0ubuntu3.1) ...", "Selecting previously unselected package linux-libc-dev:amd64.", "Preparing to unpack .../07-linux-libc-dev_5.15.0-67.74_amd64.deb ...", "Unpacking linux-libc-dev:amd64 (5.15.0-67.74) ...", "Selecting previously unselected package libcrypt-dev:amd64.", "Preparing to unpack .../08-libcrypt-dev_1%3a4.4.27-1_amd64.deb ...", "Unpacking libcrypt-dev:amd64 (1:4.4.27-1) ...", "Selecting previously unselected package rpcsvc-proto.", "Preparing to unpack .../09-rpcsvc-proto_1.4.2-0ubuntu6_amd64.deb ...", "Unpacking rpcsvc-proto (1.4.2-0ubuntu6) ...", "Selecting previously unselected package libtirpc-dev:amd64.", "Preparing to unpack .../10-libtirpc-dev_1.3.2-2ubuntu0.1_amd64.deb ...", "Unpacking libtirpc-dev:amd64 (1.3.2-2ubuntu0.1) ...", "Selecting previously unselected package libnsl-dev:amd64.", "Preparing to unpack .../11-libnsl-dev_1.3.0-2build2_amd64.deb ...", "Unpacking libnsl-dev:amd64 (1.3.0-2build2) ...", "Selecting previously unselected package libc6-dev:amd64.", "Preparing to unpack .../12-libc6-dev_2.35-0ubuntu3.1_amd64.deb ...", "Unpacking libc6-dev:amd64 (2.35-0ubuntu3.1) ...", "Selecting previously unselected package gcc-11-base:amd64.", "Preparing to unpack .../13-gcc-11-base_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking gcc-11-base:amd64 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package libisl23:amd64.", "Preparing to unpack .../14-libisl23_0.24-2build1_amd64.deb ...", "Unpacking libisl23:amd64 (0.24-2build1) ...", "Selecting previously unselected package libmpfr6:amd64.", "Preparing to unpack .../15-libmpfr6_4.1.0-3build3_amd64.deb ...", "Unpacking libmpfr6:amd64 (4.1.0-3build3) ...", "Selecting previously unselected package libmpc3:amd64.", "Preparing to unpack .../16-libmpc3_1.2.1-2build1_amd64.deb ...", "Unpacking libmpc3:amd64 (1.2.1-2build1) ...", "Selecting previously unselected package cpp-11.", "Preparing to unpack .../17-cpp-11_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking cpp-11 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package cpp.", "Preparing to unpack .../18-cpp_4%3a11.2.0-1ubuntu1_amd64.deb ...", "Unpacking cpp (4:11.2.0-1ubuntu1) ...", "Selecting previously unselected package libcc1-0:amd64.", "Preparing to unpack .../19-libcc1-0_12.1.0-2ubuntu1~22.04_amd64.deb ...", "Unpacking libcc1-0:amd64 (12.1.0-2ubuntu1~22.04) ...", "Selecting previously unselected package libgomp1:amd64.", "Preparing to unpack .../20-libgomp1_12.1.0-2ubuntu1~22.04_amd64.deb ...", "Unpacking libgomp1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Selecting previously unselected package libitm1:amd64.", "Preparing to unpack .../21-libitm1_12.1.0-2ubuntu1~22.04_amd64.deb ...", "Unpacking libitm1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Selecting previously unselected package libatomic1:amd64.", "Preparing to unpack .../22-libatomic1_12.1.0-2ubuntu1~22.04_amd64.deb ...", "Unpacking libatomic1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Selecting previously unselected package libasan6:amd64.", "Preparing to unpack .../23-libasan6_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking libasan6:amd64 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package liblsan0:amd64.", "Preparing to unpack .../24-liblsan0_12.1.0-2ubuntu1~22.04_amd64.deb ...", "Unpacking liblsan0:amd64 (12.1.0-2ubuntu1~22.04) ...", "Selecting previously unselected package libtsan0:amd64.", "Preparing to unpack .../25-libtsan0_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking libtsan0:amd64 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package libubsan1:amd64.", "Preparing to unpack .../26-libubsan1_12.1.0-2ubuntu1~22.04_amd64.deb ...", "Unpacking libubsan1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Selecting previously unselected package libquadmath0:amd64.", "Preparing to unpack .../27-libquadmath0_12.1.0-2ubuntu1~22.04_amd64.deb ...", "Unpacking libquadmath0:amd64 (12.1.0-2ubuntu1~22.04) ...", "Selecting previously unselected package libgcc-11-dev:amd64.", "Preparing to unpack .../28-libgcc-11-dev_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking libgcc-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package gcc-11.", "Preparing to unpack .../29-gcc-11_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking gcc-11 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package gcc.", "Preparing to unpack .../30-gcc_4%3a11.2.0-1ubuntu1_amd64.deb ...", "Unpacking gcc (4:11.2.0-1ubuntu1) ...", "Selecting previously unselected package libstdc++-11-dev:amd64.", "Preparing to unpack .../31-libstdc++-11-dev_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking libstdc++-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package g++-11.", "Preparing to unpack .../32-g++-11_11.3.0-1ubuntu1~22.04_amd64.deb ...", "Unpacking g++-11 (11.3.0-1ubuntu1~22.04) ...", "Selecting previously unselected package g++.", "Preparing to unpack .../33-g++_4%3a11.2.0-1ubuntu1_amd64.deb ...", "Unpacking g++ (4:11.2.0-1ubuntu1) ...", "Selecting previously unselected package make.", "Preparing to unpack .../34-make_4.3-4.1build1_amd64.deb ...", "Unpacking make (4.3-4.1build1) ...", "Selecting previously unselected package libdpkg-perl.", "Preparing to unpack .../35-libdpkg-perl_1.21.1ubuntu2.1_all.deb ...", "Unpacking libdpkg-perl (1.21.1ubuntu2.1) ...", "Selecting previously unselected package bzip2.", "Preparing to unpack .../36-bzip2_1.0.8-5build1_amd64.deb ...", "Unpacking bzip2 (1.0.8-5build1) ...", "Selecting previously unselected package lto-disabled-list.", "Preparing to unpack .../37-lto-disabled-list_24_all.deb ...", "Unpacking lto-disabled-list (24) ...", "Selecting previously unselected package dpkg-dev.", "Preparing to unpack .../38-dpkg-dev_1.21.1ubuntu2.1_all.deb ...", "Unpacking dpkg-dev (1.21.1ubuntu2.1) ...", "Selecting previously unselected package build-essential.", "Preparing to unpack .../39-build-essential_12.9ubuntu3_amd64.deb ...", "Unpacking build-essential (12.9ubuntu3) ...", "Selecting previously unselected package libfakeroot:amd64.", "Preparing to unpack .../40-libfakeroot_1.28-1ubuntu1_amd64.deb ...", "Unpacking libfakeroot:amd64 (1.28-1ubuntu1) ...", "Selecting previously unselected package fakeroot.", "Preparing to unpack .../41-fakeroot_1.28-1ubuntu1_amd64.deb ...", "Unpacking fakeroot (1.28-1ubuntu1) ...", "Selecting previously unselected package fonts-dejavu-core.", "Preparing to unpack .../42-fonts-dejavu-core_2.37-2build1_all.deb ...", "Unpacking fonts-dejavu-core (2.37-2build1) ...", "Selecting previously unselected package fontconfig-config.", "Preparing to unpack .../43-fontconfig-config_2.13.1-4.2ubuntu5_all.deb ...", "Unpacking fontconfig-config (2.13.1-4.2ubuntu5) ...", "Selecting previously unselected package javascript-common.", "Preparing to unpack .../44-javascript-common_11+nmu1_all.deb ...", "Unpacking javascript-common (11+nmu1) ...", "Selecting previously unselected package libalgorithm-diff-perl.", "Preparing to unpack .../45-libalgorithm-diff-perl_1.201-1_all.deb ...", "Unpacking libalgorithm-diff-perl (1.201-1) ...", "Selecting previously unselected package libalgorithm-diff-xs-perl.", "Preparing to unpack .../46-libalgorithm-diff-xs-perl_0.04-6build3_amd64.deb ...", "Unpacking libalgorithm-diff-xs-perl (0.04-6build3) ...", "Selecting previously unselected package libalgorithm-merge-perl.", "Preparing to unpack .../47-libalgorithm-merge-perl_0.08-3_all.deb ...", "Unpacking libalgorithm-merge-perl (0.08-3) ...", "Selecting previously unselected package libfreetype6:amd64.", "Preparing to unpack .../48-libfreetype6_2.11.1+dfsg-1ubuntu0.1_amd64.deb ...", "Unpacking libfreetype6:amd64 (2.11.1+dfsg-1ubuntu0.1) ...", "Selecting previously unselected package libfontconfig1:amd64.", "Preparing to unpack .../49-libfontconfig1_2.13.1-4.2ubuntu5_amd64.deb ...", "Unpacking libfontconfig1:amd64 (2.13.1-4.2ubuntu5) ...", "Selecting previously unselected package libjpeg-turbo8:amd64.", "Preparing to unpack .../50-libjpeg-turbo8_2.1.2-0ubuntu1_amd64.deb ...", "Unpacking libjpeg-turbo8:amd64 (2.1.2-0ubuntu1) ...", "Selecting previously unselected package libjpeg8:amd64.", "Preparing to unpack .../51-libjpeg8_8c-2ubuntu10_amd64.deb ...", "Unpacking libjpeg8:amd64 (8c-2ubuntu10) ...", "Selecting previously unselected package libdeflate0:amd64.", "Preparing to unpack .../52-libdeflate0_1.10-2_amd64.deb ...", "Unpacking libdeflate0:amd64 (1.10-2) ...", "Selecting previously unselected package libjbig0:amd64.", "Preparing to unpack .../53-libjbig0_2.1-3.1ubuntu0.22.04.1_amd64.deb ...", "Unpacking libjbig0:amd64 (2.1-3.1ubuntu0.22.04.1) ...", "Selecting previously unselected package libwebp7:amd64.", "Preparing to unpack .../54-libwebp7_1.2.2-2_amd64.deb ...", "Unpacking libwebp7:amd64 (1.2.2-2) ...", "Selecting previously unselected package libtiff5:amd64.", "Preparing to unpack .../55-libtiff5_4.3.0-6ubuntu0.4_amd64.deb ...", "Unpacking libtiff5:amd64 (4.3.0-6ubuntu0.4) ...", "Selecting previously unselected package libxpm4:amd64.", "Preparing to unpack .../56-libxpm4_1%3a3.5.12-1ubuntu0.22.04.1_amd64.deb ...", "Unpacking libxpm4:amd64 (1:3.5.12-1ubuntu0.22.04.1) ...", "Selecting previously unselected package libgd3:amd64.", "Preparing to unpack .../57-libgd3_2.3.0-2ubuntu2_amd64.deb ...", "Unpacking libgd3:amd64 (2.3.0-2ubuntu2) ...", "Selecting previously unselected package libc-devtools.", "Preparing to unpack .../58-libc-devtools_2.35-0ubuntu3.1_amd64.deb ...", "Unpacking libc-devtools (2.35-0ubuntu3.1) ...", "Selecting previously unselected package libexpat1-dev:amd64.", "Preparing to unpack .../59-libexpat1-dev_2.4.7-1ubuntu0.2_amd64.deb ...", "Unpacking libexpat1-dev:amd64 (2.4.7-1ubuntu0.2) ...", "Selecting previously unselected package libfile-fcntllock-perl.", "Preparing to unpack .../60-libfile-fcntllock-perl_0.22-3build7_amd64.deb ...", "Unpacking libfile-fcntllock-perl (0.22-3build7) ...", "Selecting previously unselected package libjs-jquery.", "Preparing to unpack .../61-libjs-jquery_3.6.0+dfsg+~3.5.13-1_all.deb ...", "Unpacking libjs-jquery (3.6.0+dfsg+~3.5.13-1) ...", "Selecting previously unselected package libjs-underscore.", "Preparing to unpack .../62-libjs-underscore_1.13.2~dfsg-2_all.deb ...", "Unpacking libjs-underscore (1.13.2~dfsg-2) ...", "Selecting previously unselected package libjs-sphinxdoc.", "Preparing to unpack .../63-libjs-sphinxdoc_4.3.2-1_all.deb ...", "Unpacking libjs-sphinxdoc (4.3.2-1) ...", "Selecting previously unselected package libpython3.10:amd64.", "Preparing to unpack .../64-libpython3.10_3.10.6-1~22.04.2ubuntu1_amd64.deb ...", "Unpacking libpython3.10:amd64 (3.10.6-1~22.04.2ubuntu1) ...", "Selecting previously unselected package zlib1g-dev:amd64.", "Preparing to unpack .../65-zlib1g-dev_1%3a1.2.11.dfsg-2ubuntu9.2_amd64.deb ...", "Unpacking zlib1g-dev:amd64 (1:1.2.11.dfsg-2ubuntu9.2) ...", "Selecting previously unselected package libpython3.10-dev:amd64.", "Preparing to unpack .../66-libpython3.10-dev_3.10.6-1~22.04.2ubuntu1_amd64.deb ...", "Unpacking libpython3.10-dev:amd64 (3.10.6-1~22.04.2ubuntu1) ...", "Selecting previously unselected package libpython3-dev:amd64.", "Preparing to unpack .../67-libpython3-dev_3.10.6-1~22.04_amd64.deb ...", "Unpacking libpython3-dev:amd64 (3.10.6-1~22.04) ...", "Selecting previously unselected package manpages-dev.", "Preparing to unpack .../68-manpages-dev_5.10-1ubuntu1_all.deb ...", "Unpacking manpages-dev (5.10-1ubuntu1) ...", "Selecting previously unselected package python3.10-dev.", "Preparing to unpack .../69-python3.10-dev_3.10.6-1~22.04.2ubuntu1_amd64.deb ...", "Unpacking python3.10-dev (3.10.6-1~22.04.2ubuntu1) ...", "Selecting previously unselected package python3-lib2to3.", "Preparing to unpack .../70-python3-lib2to3_3.10.6-1~22.04_all.deb ...", "Unpacking python3-lib2to3 (3.10.6-1~22.04) ...", "Selecting previously unselected package python3-distutils.", "Preparing to unpack .../71-python3-distutils_3.10.6-1~22.04_all.deb ...", "Unpacking python3-distutils (3.10.6-1~22.04) ...", "Selecting previously unselected package python3-dev.", "Preparing to unpack .../72-python3-dev_3.10.6-1~22.04_amd64.deb ...", "Unpacking python3-dev (3.10.6-1~22.04) ...", "Selecting previously unselected package python3-setuptools.", "Preparing to unpack .../73-python3-setuptools_59.6.0-1.2ubuntu0.22.04.1_all.deb ...", "Unpacking python3-setuptools (59.6.0-1.2ubuntu0.22.04.1) ...", "Selecting previously unselected package python3-wheel.", "Preparing to unpack .../74-python3-wheel_0.37.1-2ubuntu0.22.04.1_all.deb ...", "Unpacking python3-wheel (0.37.1-2ubuntu0.22.04.1) ...", "Selecting previously unselected package python3-pip.", "Preparing to unpack .../75-python3-pip_22.0.2+dfsg-1ubuntu0.2_all.deb ...", "Unpacking python3-pip (22.0.2+dfsg-1ubuntu0.2) ...", "Setting up javascript-common (11+nmu1) ...", "Setting up gcc-11-base:amd64 (11.3.0-1ubuntu1~22.04) ...", "Setting up manpages-dev (5.10-1ubuntu1) ...", "Setting up libpython3.10:amd64 (3.10.6-1~22.04.2ubuntu1) ...", "Setting up lto-disabled-list (24) ...", "Setting up libxpm4:amd64 (1:3.5.12-1ubuntu0.22.04.1) ...", "Setting up libfile-fcntllock-perl (0.22-3build7) ...", "Setting up libalgorithm-diff-perl (1.201-1) ...", "Setting up binutils-common:amd64 (2.38-4ubuntu2.1) ...", "Setting up libdeflate0:amd64 (1.10-2) ...", "Setting up linux-libc-dev:amd64 (5.15.0-67.74) ...", "Setting up libctf-nobfd0:amd64 (2.38-4ubuntu2.1) ...", "Setting up libgomp1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Setting up bzip2 (1.0.8-5build1) ...", "Setting up libjbig0:amd64 (2.1-3.1ubuntu0.22.04.1) ...", "Setting up libfakeroot:amd64 (1.28-1ubuntu1) ...", "Setting up libasan6:amd64 (11.3.0-1ubuntu1~22.04) ...", "Setting up fakeroot (1.28-1ubuntu1) ...", "update-alternatives: using /usr/bin/fakeroot-sysv to provide /usr/bin/fakeroot (fakeroot) in auto mode", "Setting up libtirpc-dev:amd64 (1.3.2-2ubuntu0.1) ...", "Setting up rpcsvc-proto (1.4.2-0ubuntu6) ...", "Setting up libfreetype6:amd64 (2.11.1+dfsg-1ubuntu0.1) ...", "Setting up make (4.3-4.1build1) ...", "Setting up libmpfr6:amd64 (4.1.0-3build3) ...", "Setting up libquadmath0:amd64 (12.1.0-2ubuntu1~22.04) ...", "Setting up libmpc3:amd64 (1.2.1-2build1) ...", "Setting up libatomic1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Setting up fonts-dejavu-core (2.37-2build1) ...", "Setting up libjpeg-turbo8:amd64 (2.1.2-0ubuntu1) ...", "Setting up libdpkg-perl (1.21.1ubuntu2.1) ...", "Setting up libwebp7:amd64 (1.2.2-2) ...", "Setting up libubsan1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Setting up libnsl-dev:amd64 (1.3.0-2build2) ...", "Setting up libcrypt-dev:amd64 (1:4.4.27-1) ...", "Setting up libjs-jquery (3.6.0+dfsg+~3.5.13-1) ...", "Setting up libbinutils:amd64 (2.38-4ubuntu2.1) ...", "Setting up libisl23:amd64 (0.24-2build1) ...", "Setting up libc-dev-bin (2.35-0ubuntu3.1) ...", "Setting up python3-lib2to3 (3.10.6-1~22.04) ...", "Setting up libalgorithm-diff-xs-perl (0.04-6build3) ...", "Setting up libcc1-0:amd64 (12.1.0-2ubuntu1~22.04) ...", "Setting up liblsan0:amd64 (12.1.0-2ubuntu1~22.04) ...", "Setting up libitm1:amd64 (12.1.0-2ubuntu1~22.04) ...", "Setting up libjs-underscore (1.13.2~dfsg-2) ...", "Setting up libalgorithm-merge-perl (0.08-3) ...", "Setting up libtsan0:amd64 (11.3.0-1ubuntu1~22.04) ...", "Setting up libctf0:amd64 (2.38-4ubuntu2.1) ...", "Setting up libjpeg8:amd64 (8c-2ubuntu10) ...", "Setting up python3-distutils (3.10.6-1~22.04) ...", "Setting up cpp-11 (11.3.0-1ubuntu1~22.04) ...", "Setting up python3-setuptools (59.6.0-1.2ubuntu0.22.04.1) ...", "Setting up fontconfig-config (2.13.1-4.2ubuntu5) ...", "Setting up python3-wheel (0.37.1-2ubuntu0.22.04.1) ...", "Setting up python3-pip (22.0.2+dfsg-1ubuntu0.2) ...", "Setting up libjs-sphinxdoc (4.3.2-1) ...", "Setting up libgcc-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...", "Setting up cpp (4:11.2.0-1ubuntu1) ...", "Setting up libc6-dev:amd64 (2.35-0ubuntu3.1) ...", "Setting up libtiff5:amd64 (4.3.0-6ubuntu0.4) ...", "Setting up libfontconfig1:amd64 (2.13.1-4.2ubuntu5) ...", "Setting up binutils-x86-64-linux-gnu (2.38-4ubuntu2.1) ...", "Setting up binutils (2.38-4ubuntu2.1) ...", "Setting up dpkg-dev (1.21.1ubuntu2.1) ...", "Setting up libexpat1-dev:amd64 (2.4.7-1ubuntu0.2) ...", "Setting up libgd3:amd64 (2.3.0-2ubuntu2) ...", "Setting up libstdc++-11-dev:amd64 (11.3.0-1ubuntu1~22.04) ...", "Setting up zlib1g-dev:amd64 (1:1.2.11.dfsg-2ubuntu9.2) ...", "Setting up gcc-11 (11.3.0-1ubuntu1~22.04) ...", "Setting up libc-devtools (2.35-0ubuntu3.1) ...", "Setting up g++-11 (11.3.0-1ubuntu1~22.04) ...", "Setting up gcc (4:11.2.0-1ubuntu1) ...", "Setting up libpython3.10-dev:amd64 (3.10.6-1~22.04.2ubuntu1) ...", "Setting up python3.10-dev (3.10.6-1~22.04.2ubuntu1) ...", "Setting up g++ (4:11.2.0-1ubuntu1) ...", "update-alternatives: using /usr/bin/g++ to provide /usr/bin/c++ (c++) in auto mode", "Setting up build-essential (12.9ubuntu3) ...", "Setting up libpython3-dev:amd64 (3.10.6-1~22.04) ...", "Setting up python3-dev (3.10.6-1~22.04) ...", "Processing triggers for man-db (2.10.2-1) ...", "Processing triggers for libc-bin (2.35-0ubuntu3.1) ..."]}
2023-03-26 11:18:19,871 p=57018 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests'], state=present] *******************************************************************************************************************
2023-03-26 11:18:23,107 p=57018 u=craig n=ansible | changed: [caddy] => {"changed": true, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "docker", "requests"], "name": ["docker", "requests"], "requirements": null, "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv"], "stdout": "Collecting docker\n  Downloading docker-6.0.1-py3-none-any.whl (147 kB)\n      147.5/147.5 KB 1.9 MB/s eta 0:00:00\nCollecting requests\n  Downloading requests-2.28.2-py3-none-any.whl (62 kB)\n      62.8/62.8 KB 3.9 MB/s eta 0:00:00\nCollecting websocket-client>=0.32.0\n  Downloading websocket_client-1.5.1-py3-none-any.whl (55 kB)\n      55.9/55.9 KB 2.9 MB/s eta 0:00:00\nCollecting packaging>=14.0\n  Downloading packaging-23.0-py3-none-any.whl (42 kB)\n      42.7/42.7 KB 2.4 MB/s eta 0:00:00\nCollecting urllib3>=1.26.0\n  Downloading urllib3-1.26.15-py2.py3-none-any.whl (140 kB)\n      140.9/140.9 KB 5.0 MB/s eta 0:00:00\nCollecting charset-normalizer<4,>=2\n  Downloading charset_normalizer-3.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (199 kB)\n      199.3/199.3 KB 7.6 MB/s eta 0:00:00\nCollecting certifi>=2017.4.17\n  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)\n      155.3/155.3 KB 5.8 MB/s eta 0:00:00\nCollecting idna<4,>=2.5\n  Downloading idna-3.4-py3-none-any.whl (61 kB)\n      61.5/61.5 KB 3.9 MB/s eta 0:00:00\nInstalling collected packages: websocket-client, urllib3, packaging, idna, charset-normalizer, certifi, requests, docker\nSuccessfully installed certifi-2022.12.7 charset-normalizer-3.1.0 docker-6.0.1 idna-3.4 packaging-23.0 requests-2.28.2 urllib3-1.26.15 websocket-client-1.5.1\n", "stdout_lines": ["Collecting docker", "  Downloading docker-6.0.1-py3-none-any.whl (147 kB)", "      147.5/147.5 KB 1.9 MB/s eta 0:00:00", "Collecting requests", "  Downloading requests-2.28.2-py3-none-any.whl (62 kB)", "      62.8/62.8 KB 3.9 MB/s eta 0:00:00", "Collecting websocket-client>=0.32.0", "  Downloading websocket_client-1.5.1-py3-none-any.whl (55 kB)", "      55.9/55.9 KB 2.9 MB/s eta 0:00:00", "Collecting packaging>=14.0", "  Downloading packaging-23.0-py3-none-any.whl (42 kB)", "      42.7/42.7 KB 2.4 MB/s eta 0:00:00", "Collecting urllib3>=1.26.0", "  Downloading urllib3-1.26.15-py2.py3-none-any.whl (140 kB)", "      140.9/140.9 KB 5.0 MB/s eta 0:00:00", "Collecting charset-normalizer<4,>=2", "  Downloading charset_normalizer-3.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (199 kB)", "      199.3/199.3 KB 7.6 MB/s eta 0:00:00", "Collecting certifi>=2017.4.17", "  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)", "      155.3/155.3 KB 5.8 MB/s eta 0:00:00", "Collecting idna<4,>=2.5", "  Downloading idna-3.4-py3-none-any.whl (61 kB)", "      61.5/61.5 KB 3.9 MB/s eta 0:00:00", "Installing collected packages: websocket-client, urllib3, packaging, idna, charset-normalizer, certifi, requests, docker", "Successfully installed certifi-2022.12.7 charset-normalizer-3.1.0 docker-6.0.1 idna-3.4 packaging-23.0 requests-2.28.2 urllib3-1.26.15 websocket-client-1.5.1"], "version": null, "virtualenv": null}
2023-03-26 11:18:23,126 p=57018 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:18:24,077 p=57018 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:18:24,089 p=57018 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:18:25,835 p=57018 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 11:18:25,845 p=57018 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:18:27,273 p=57018 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 11:18:27,284 p=57018 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:18:28,769 p=57018 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "c43724b971717b15ffebd8d050204a7db84c3473", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 300, "state": "file", "uid": 0}
2023-03-26 11:18:28,780 p=57018 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-26 11:18:29,860 p=57018 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Unable to load docker-compose. Try `pip install docker-compose`. Error: Traceback (most recent call last):\n  File \"/tmp/ansible_ansible.builtin.docker_compose_payload_dc7i117r/ansible_ansible.builtin.docker_compose_payload.zip/ansible_collections/community/docker/plugins/modules/docker_compose.py\", line 497, in <module>\nModuleNotFoundError: No module named 'compose'\n"}
2023-03-26 11:18:29,862 p=57018 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:18:29,862 p=57018 u=craig n=ansible | caddy                      : ok=17   changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:19:39,490 p=57384 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:19:39,664 p=57384 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:19:39,675 p=57384 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:19:42,125 p=57384 u=craig n=ansible | ok: [caddy]
2023-03-26 11:19:42,134 p=57384 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:19:42,146 p=57384 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:19:42,153 p=57384 u=craig n=ansible | TASK [Include secrets file=../../../secrets.yaml] **********************************************************************************************************************************************************
2023-03-26 11:19:42,176 p=57384 u=craig n=ansible | ok: [caddy] => {"ansible_facts": {"google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "host_ip": "192.168.1.99", "proxmox_api_token_id": "root@pam!terraform", "proxmox_api_token_secret": "6165417e-cfcb-4839-a136-4f9e243968be", "proxmox_api_url": "https://192.168.1.99:8006/api2/json", "root_password": "$3z!b9YHBhH8#kSt$", "root_user": "root@pam"}, "ansible_included_var_files": ["/Users/craig/Projects/homelab/ansible/playbooks/caddy/../../../secrets.yaml"], "changed": false}
2023-03-26 11:19:42,182 p=57384 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:19:42,195 p=57384 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:19:42,206 p=57384 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:19:44,337 p=57384 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:19:44,347 p=57384 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:19:45,732 p=57384 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:19:47,174 p=57384 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:19:48,516 p=57384 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:19:49,940 p=57384 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:19:51,408 p=57384 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:19:52,809 p=57384 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:19:52,823 p=57384 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:19:54,046 p=57384 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:19:54,056 p=57384 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:19:55,260 p=57384 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:19:55,271 p=57384 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:19:56,610 p=57384 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:19:56,619 p=57384 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:19:57,831 p=57384 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "54513868000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "55984128", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:19:57,837 p=57384 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:19:58,751 p=57384 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:19:58,757 p=57384 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-26 11:20:00,037 p=57384 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:20:00,046 p=57384 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-26 11:20:04,869 p=57384 u=craig n=ansible | changed: [caddy] => {"changed": true, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "docker", "requests", "docker-compose"], "name": ["docker", "requests", "docker-compose"], "requirements": null, "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv"], "stdout": "Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)\nRequirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)\nCollecting docker-compose\n  Downloading docker_compose-1.29.2-py2.py3-none-any.whl (114 kB)\n      114.8/114.8 KB 2.4 MB/s eta 0:00:00\nRequirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.5.1)\nRequirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)\nRequirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)\nRequirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)\nRequirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)\nRequirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)\nRequirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)\nCollecting jsonschema<4,>=2.5.1\n  Downloading jsonschema-3.2.0-py2.py3-none-any.whl (56 kB)\n      56.3/56.3 KB 3.6 MB/s eta 0:00:00\nCollecting texttable<2,>=0.9.0\n  Downloading texttable-1.6.7-py2.py3-none-any.whl (10 kB)\nRequirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)\nCollecting docopt<1,>=0.6.1\n  Downloading docopt-0.6.2.tar.gz (25 kB)\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting python-dotenv<1,>=0.13.0\n  Downloading python_dotenv-0.21.1-py3-none-any.whl (19 kB)\nCollecting dockerpty<1,>=0.4.1\n  Downloading dockerpty-0.4.1.tar.gz (13 kB)\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting websocket-client>=0.32.0\n  Downloading websocket_client-0.59.0-py2.py3-none-any.whl (67 kB)\n      67.2/67.2 KB 4.4 MB/s eta 0:00:00\nCollecting paramiko>=2.4.3\n  Downloading paramiko-3.1.0-py3-none-any.whl (211 kB)\n      211.2/211.2 KB 6.6 MB/s eta 0:00:00\nRequirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)\nRequirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)\nCollecting attrs>=17.4.0\n  Downloading attrs-22.2.0-py3-none-any.whl (60 kB)\n      60.0/60.0 KB 5.6 MB/s eta 0:00:00\nCollecting pyrsistent>=0.14.0\n  Downloading pyrsistent-0.19.3-py3-none-any.whl (57 kB)\n      57.5/57.5 KB 5.9 MB/s eta 0:00:00\nCollecting bcrypt>=3.2\n  Downloading bcrypt-4.0.1-cp36-abi3-manylinux_2_28_x86_64.whl (593 kB)\n      593.7/593.7 KB 16.4 MB/s eta 0:00:00\nRequirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)\nCollecting pynacl>=1.5\n  Downloading PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (856 kB)\n      856.7/856.7 KB 28.5 MB/s eta 0:00:00\nCollecting cffi>=1.4.1\n  Downloading cffi-1.15.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (441 kB)\n      441.8/441.8 KB 21.8 MB/s eta 0:00:00\nCollecting pycparser\n  Downloading pycparser-2.21-py2.py3-none-any.whl (118 kB)\n      118.7/118.7 KB 7.1 MB/s eta 0:00:00\nBuilding wheels for collected packages: dockerpty, docopt\n  Building wheel for dockerpty (setup.py): started\n  Building wheel for dockerpty (setup.py): finished with status 'done'\n  Created wheel for dockerpty: filename=dockerpty-0.4.1-py3-none-any.whl size=16614 sha256=bed87f3066b1c449a545868826785e960022909aaec5bec7b80ca0ea3b4dfd1a\n  Stored in directory: /root/.cache/pip/wheels/18/00/32/f75cd03098074f988a01c59a2e3a55ae9c0773eb66acb4cb5e\n  Building wheel for docopt (setup.py): started\n  Building wheel for docopt (setup.py): finished with status 'done'\n  Created wheel for docopt: filename=docopt-0.6.2-py2.py3-none-any.whl size=13723 sha256=f9412b6ff438e4bf79fba3dad6115bc3acf2d9e9a250de3153704cdef8599289\n  Stored in directory: /root/.cache/pip/wheels/fc/ab/d4/5da2067ac95b36618c629a5f93f809425700506f72c9732fac\nSuccessfully built dockerpty docopt\nInstalling collected packages: texttable, docopt, websocket-client, python-dotenv, pyrsistent, pycparser, dockerpty, bcrypt, attrs, jsonschema, cffi, pynacl, paramiko, docker-compose\n  Attempting uninstall: websocket-client\n    Found existing installation: websocket-client 1.5.1\n    Uninstalling websocket-client-1.5.1:\n      Successfully uninstalled websocket-client-1.5.1\nSuccessfully installed attrs-22.2.0 bcrypt-4.0.1 cffi-1.15.1 docker-compose-1.29.2 dockerpty-0.4.1 docopt-0.6.2 jsonschema-3.2.0 paramiko-3.1.0 pycparser-2.21 pynacl-1.5.0 pyrsistent-0.19.3 python-dotenv-0.21.1 texttable-1.6.7 websocket-client-0.59.0\n", "stdout_lines": ["Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)", "Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)", "Collecting docker-compose", "  Downloading docker_compose-1.29.2-py2.py3-none-any.whl (114 kB)", "      114.8/114.8 KB 2.4 MB/s eta 0:00:00", "Requirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.5.1)", "Requirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)", "Requirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)", "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)", "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)", "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)", "Requirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)", "Collecting jsonschema<4,>=2.5.1", "  Downloading jsonschema-3.2.0-py2.py3-none-any.whl (56 kB)", "      56.3/56.3 KB 3.6 MB/s eta 0:00:00", "Collecting texttable<2,>=0.9.0", "  Downloading texttable-1.6.7-py2.py3-none-any.whl (10 kB)", "Requirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)", "Collecting docopt<1,>=0.6.1", "  Downloading docopt-0.6.2.tar.gz (25 kB)", "  Preparing metadata (setup.py): started", "  Preparing metadata (setup.py): finished with status 'done'", "Collecting python-dotenv<1,>=0.13.0", "  Downloading python_dotenv-0.21.1-py3-none-any.whl (19 kB)", "Collecting dockerpty<1,>=0.4.1", "  Downloading dockerpty-0.4.1.tar.gz (13 kB)", "  Preparing metadata (setup.py): started", "  Preparing metadata (setup.py): finished with status 'done'", "Collecting websocket-client>=0.32.0", "  Downloading websocket_client-0.59.0-py2.py3-none-any.whl (67 kB)", "      67.2/67.2 KB 4.4 MB/s eta 0:00:00", "Collecting paramiko>=2.4.3", "  Downloading paramiko-3.1.0-py3-none-any.whl (211 kB)", "      211.2/211.2 KB 6.6 MB/s eta 0:00:00", "Requirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)", "Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)", "Collecting attrs>=17.4.0", "  Downloading attrs-22.2.0-py3-none-any.whl (60 kB)", "      60.0/60.0 KB 5.6 MB/s eta 0:00:00", "Collecting pyrsistent>=0.14.0", "  Downloading pyrsistent-0.19.3-py3-none-any.whl (57 kB)", "      57.5/57.5 KB 5.9 MB/s eta 0:00:00", "Collecting bcrypt>=3.2", "  Downloading bcrypt-4.0.1-cp36-abi3-manylinux_2_28_x86_64.whl (593 kB)", "      593.7/593.7 KB 16.4 MB/s eta 0:00:00", "Requirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)", "Collecting pynacl>=1.5", "  Downloading PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (856 kB)", "      856.7/856.7 KB 28.5 MB/s eta 0:00:00", "Collecting cffi>=1.4.1", "  Downloading cffi-1.15.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (441 kB)", "      441.8/441.8 KB 21.8 MB/s eta 0:00:00", "Collecting pycparser", "  Downloading pycparser-2.21-py2.py3-none-any.whl (118 kB)", "      118.7/118.7 KB 7.1 MB/s eta 0:00:00", "Building wheels for collected packages: dockerpty, docopt", "  Building wheel for dockerpty (setup.py): started", "  Building wheel for dockerpty (setup.py): finished with status 'done'", "  Created wheel for dockerpty: filename=dockerpty-0.4.1-py3-none-any.whl size=16614 sha256=bed87f3066b1c449a545868826785e960022909aaec5bec7b80ca0ea3b4dfd1a", "  Stored in directory: /root/.cache/pip/wheels/18/00/32/f75cd03098074f988a01c59a2e3a55ae9c0773eb66acb4cb5e", "  Building wheel for docopt (setup.py): started", "  Building wheel for docopt (setup.py): finished with status 'done'", "  Created wheel for docopt: filename=docopt-0.6.2-py2.py3-none-any.whl size=13723 sha256=f9412b6ff438e4bf79fba3dad6115bc3acf2d9e9a250de3153704cdef8599289", "  Stored in directory: /root/.cache/pip/wheels/fc/ab/d4/5da2067ac95b36618c629a5f93f809425700506f72c9732fac", "Successfully built dockerpty docopt", "Installing collected packages: texttable, docopt, websocket-client, python-dotenv, pyrsistent, pycparser, dockerpty, bcrypt, attrs, jsonschema, cffi, pynacl, paramiko, docker-compose", "  Attempting uninstall: websocket-client", "    Found existing installation: websocket-client 1.5.1", "    Uninstalling websocket-client-1.5.1:", "      Successfully uninstalled websocket-client-1.5.1", "Successfully installed attrs-22.2.0 bcrypt-4.0.1 cffi-1.15.1 docker-compose-1.29.2 dockerpty-0.4.1 docopt-0.6.2 jsonschema-3.2.0 paramiko-3.1.0 pycparser-2.21 pynacl-1.5.0 pyrsistent-0.19.3 python-dotenv-0.21.1 texttable-1.6.7 websocket-client-0.59.0"], "version": null, "virtualenv": null}
2023-03-26 11:20:04,887 p=57384 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:20:05,866 p=57384 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:20:05,877 p=57384 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:20:07,448 p=57384 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 11:20:07,458 p=57384 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:20:08,921 p=57384 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8029405e9fec980590d1a15305fbe0aa4373702f", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 202, "state": "file", "uid": 0}
2023-03-26 11:20:08,932 p=57384 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:20:10,360 p=57384 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "c43724b971717b15ffebd8d050204a7db84c3473", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 300, "state": "file", "uid": 0}
2023-03-26 11:20:10,368 p=57384 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-26 11:20:12,326 p=57384 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "", "msg": "Error: pull failed with 404 Client Error for http+docker://localhost/v1.42/images/create?tag=latest&fromImage=caddy-custom: Not Found (\"pull access denied for caddy-custom, repository does not exist or may require 'docker login': denied: requested access to the resource is denied\")"}
2023-03-26 11:20:12,327 p=57384 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:20:12,327 p=57384 u=craig n=ansible | caddy                      : ok=17   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:22:43,431 p=57827 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:22:43,612 p=57827 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:22:43,623 p=57827 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:22:46,103 p=57827 u=craig n=ansible | ok: [caddy]
2023-03-26 11:22:46,112 p=57827 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:22:46,124 p=57827 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:22:46,131 p=57827 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-26 11:22:46,152 p=57827 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 11:22:46,158 p=57827 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:22:46,169 p=57827 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:22:46,179 p=57827 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:22:48,254 p=57827 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:22:48,261 p=57827 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:22:49,667 p=57827 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:22:51,001 p=57827 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:22:52,341 p=57827 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:22:53,756 p=57827 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:22:55,201 p=57827 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:22:56,548 p=57827 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:22:56,568 p=57827 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:22:57,794 p=57827 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:22:57,808 p=57827 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:22:58,892 p=57827 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:22:58,909 p=57827 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:23:00,266 p=57827 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:23:00,281 p=57827 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:23:01,564 p=57827 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "54760069000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "67706880", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:23:01,577 p=57827 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:23:02,636 p=57827 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:23:02,651 p=57827 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-26 11:23:03,960 p=57827 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:23:03,975 p=57827 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-26 11:23:05,560 p=57827 u=craig n=ansible | ok: [caddy] => {"changed": false, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "docker", "requests", "docker-compose"], "name": ["docker", "requests", "docker-compose"], "requirements": null, "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv"], "stdout": "Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)\nRequirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)\nRequirement already satisfied: docker-compose in /usr/local/lib/python3.10/dist-packages (1.29.2)\nRequirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)\nRequirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)\nRequirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (0.59.0)\nRequirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)\nRequirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)\nRequirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)\nRequirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)\nRequirement already satisfied: docopt<1,>=0.6.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.6.2)\nRequirement already satisfied: jsonschema<4,>=2.5.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (3.2.0)\nRequirement already satisfied: python-dotenv<1,>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.21.1)\nRequirement already satisfied: dockerpty<1,>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.4.1)\nRequirement already satisfied: texttable<2,>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (1.6.7)\nRequirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)\nRequirement already satisfied: paramiko>=2.4.3 in /usr/local/lib/python3.10/dist-packages (from docker) (3.1.0)\nRequirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)\nRequirement already satisfied: attrs>=17.4.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (22.2.0)\nRequirement already satisfied: pyrsistent>=0.14.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (0.19.3)\nRequirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)\nRequirement already satisfied: pynacl>=1.5 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (1.5.0)\nRequirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)\nRequirement already satisfied: bcrypt>=3.2 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (4.0.1)\nRequirement already satisfied: cffi>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from pynacl>=1.5->paramiko>=2.4.3->docker) (1.15.1)\nRequirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.4.1->pynacl>=1.5->paramiko>=2.4.3->docker) (2.21)\n", "stdout_lines": ["Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)", "Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)", "Requirement already satisfied: docker-compose in /usr/local/lib/python3.10/dist-packages (1.29.2)", "Requirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)", "Requirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)", "Requirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (0.59.0)", "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)", "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)", "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)", "Requirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)", "Requirement already satisfied: docopt<1,>=0.6.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.6.2)", "Requirement already satisfied: jsonschema<4,>=2.5.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (3.2.0)", "Requirement already satisfied: python-dotenv<1,>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.21.1)", "Requirement already satisfied: dockerpty<1,>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.4.1)", "Requirement already satisfied: texttable<2,>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (1.6.7)", "Requirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)", "Requirement already satisfied: paramiko>=2.4.3 in /usr/local/lib/python3.10/dist-packages (from docker) (3.1.0)", "Requirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)", "Requirement already satisfied: attrs>=17.4.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (22.2.0)", "Requirement already satisfied: pyrsistent>=0.14.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (0.19.3)", "Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)", "Requirement already satisfied: pynacl>=1.5 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (1.5.0)", "Requirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)", "Requirement already satisfied: bcrypt>=3.2 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (4.0.1)", "Requirement already satisfied: cffi>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from pynacl>=1.5->paramiko>=2.4.3->docker) (1.15.1)", "Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.4.1->pynacl>=1.5->paramiko>=2.4.3->docker) (2.21)"], "version": null, "virtualenv": null}
2023-03-26 11:23:05,582 p=57827 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:23:06,525 p=57827 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:23:06,531 p=57827 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:23:08,069 p=57827 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 11:23:08,079 p=57827 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:23:09,980 p=57827 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "md5sum": "ed51e4e5295743836b13064ea447c062", "mode": "0644", "owner": "root", "size": 196, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679844188.156943-58014-120695324728142/source", "state": "file", "uid": 0}
2023-03-26 11:23:09,992 p=57827 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:23:11,424 p=57827 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "c43724b971717b15ffebd8d050204a7db84c3473", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 300, "state": "file", "uid": 0}
2023-03-26 11:23:11,434 p=57827 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-26 11:23:13,139 p=57827 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "", "msg": "Error: pull failed with 404 Client Error for http+docker://localhost/v1.42/images/create?tag=latest&fromImage=caddy-custom: Not Found (\"pull access denied for caddy-custom, repository does not exist or may require 'docker login': denied: requested access to the resource is denied\")"}
2023-03-26 11:23:13,141 p=57827 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:23:13,141 p=57827 u=craig n=ansible | caddy                      : ok=17   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 11:24:55,075 p=58223 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:24:55,252 p=58223 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:24:55,261 p=58223 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:24:57,591 p=58223 u=craig n=ansible | ok: [caddy]
2023-03-26 11:24:57,599 p=58223 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:24:57,611 p=58223 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:24:57,618 p=58223 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-26 11:24:57,643 p=58223 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 11:24:57,652 p=58223 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:24:57,670 p=58223 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:24:57,682 p=58223 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:25:00,126 p=58223 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:25:00,133 p=58223 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:25:01,422 p=58223 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:25:02,691 p=58223 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:25:03,951 p=58223 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:25:05,190 p=58223 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:25:06,442 p=58223 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:25:07,735 p=58223 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:25:07,748 p=58223 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:25:08,950 p=58223 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:25:08,960 p=58223 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:25:09,980 p=58223 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:25:09,985 p=58223 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:25:11,294 p=58223 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:25:11,304 p=58223 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:25:12,504 p=58223 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "54916014000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "67321856", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "7", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:25:12,514 p=58223 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:25:13,519 p=58223 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:25:13,529 p=58223 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-26 11:25:14,850 p=58223 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:25:14,861 p=58223 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-26 11:25:16,363 p=58223 u=craig n=ansible | ok: [caddy] => {"changed": false, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "docker", "requests", "docker-compose"], "name": ["docker", "requests", "docker-compose"], "requirements": null, "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv"], "stdout": "Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)\nRequirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)\nRequirement already satisfied: docker-compose in /usr/local/lib/python3.10/dist-packages (1.29.2)\nRequirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)\nRequirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)\nRequirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (0.59.0)\nRequirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)\nRequirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)\nRequirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)\nRequirement already satisfied: python-dotenv<1,>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.21.1)\nRequirement already satisfied: texttable<2,>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (1.6.7)\nRequirement already satisfied: jsonschema<4,>=2.5.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (3.2.0)\nRequirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)\nRequirement already satisfied: dockerpty<1,>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.4.1)\nRequirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)\nRequirement already satisfied: docopt<1,>=0.6.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.6.2)\nRequirement already satisfied: paramiko>=2.4.3 in /usr/local/lib/python3.10/dist-packages (from docker) (3.1.0)\nRequirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)\nRequirement already satisfied: pyrsistent>=0.14.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (0.19.3)\nRequirement already satisfied: attrs>=17.4.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (22.2.0)\nRequirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)\nRequirement already satisfied: bcrypt>=3.2 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (4.0.1)\nRequirement already satisfied: pynacl>=1.5 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (1.5.0)\nRequirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)\nRequirement already satisfied: cffi>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from pynacl>=1.5->paramiko>=2.4.3->docker) (1.15.1)\nRequirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.4.1->pynacl>=1.5->paramiko>=2.4.3->docker) (2.21)\n", "stdout_lines": ["Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)", "Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)", "Requirement already satisfied: docker-compose in /usr/local/lib/python3.10/dist-packages (1.29.2)", "Requirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)", "Requirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)", "Requirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (0.59.0)", "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)", "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)", "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)", "Requirement already satisfied: python-dotenv<1,>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.21.1)", "Requirement already satisfied: texttable<2,>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (1.6.7)", "Requirement already satisfied: jsonschema<4,>=2.5.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (3.2.0)", "Requirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)", "Requirement already satisfied: dockerpty<1,>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.4.1)", "Requirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)", "Requirement already satisfied: docopt<1,>=0.6.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.6.2)", "Requirement already satisfied: paramiko>=2.4.3 in /usr/local/lib/python3.10/dist-packages (from docker) (3.1.0)", "Requirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)", "Requirement already satisfied: pyrsistent>=0.14.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (0.19.3)", "Requirement already satisfied: attrs>=17.4.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (22.2.0)", "Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)", "Requirement already satisfied: bcrypt>=3.2 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (4.0.1)", "Requirement already satisfied: pynacl>=1.5 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (1.5.0)", "Requirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)", "Requirement already satisfied: cffi>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from pynacl>=1.5->paramiko>=2.4.3->docker) (1.15.1)", "Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.4.1->pynacl>=1.5->paramiko>=2.4.3->docker) (2.21)"], "version": null, "virtualenv": null}
2023-03-26 11:25:16,380 p=58223 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:25:17,312 p=58223 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:25:17,323 p=58223 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:25:18,831 p=58223 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "fedccc7b7e4aaa2b9488d74c7f2c69f3ae92fbc6", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 124, "state": "file", "uid": 0}
2023-03-26 11:25:18,841 p=58223 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:25:20,287 p=58223 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 11:25:20,299 p=58223 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:25:22,211 p=58223 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "md5sum": "f88dcaaf613b65ee412d49aafbdad86c", "mode": "0644", "owner": "root", "size": 293, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679844320.38412-58422-180764051406495/source", "state": "file", "uid": 0}
2023-03-26 11:25:22,223 p=58223 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-26 11:31:15,813 p=58223 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 11:31:15,827 p=58223 u=craig n=ansible | TASK [docker_swarm_node : Check if Docker Swarm is already initialized _raw_params=docker info -f "{{ '{{.Swarm.LocalNodeState}}' }}"] *********************************************************************
2023-03-26 11:31:17,476 p=58223 u=craig n=ansible | ok: [caddy] => {"changed": false, "cmd": ["docker", "info", "-f", "{{.Swarm.LocalNodeState}}"], "delta": "0:00:00.675289", "end": "2023-03-26 15:31:17.365060", "msg": "", "rc": 0, "start": "2023-03-26 15:31:16.689771", "stderr": "", "stderr_lines": [], "stdout": "active", "stdout_lines": ["active"]}
2023-03-26 11:31:17,486 p=58223 u=craig n=ansible | TASK [docker_swarm_node : Initialize Docker Swarm _raw_params=docker swarm init] ***************************************************************************************************************************
2023-03-26 11:31:17,500 p=58223 u=craig n=ansible | skipping: [caddy] => {"changed": false, "skip_reason": "Conditional result was False"}
2023-03-26 11:31:17,507 p=58223 u=craig n=ansible | TASK [docker_swarm_node : Join Docker Swarm as a worker _raw_params=docker swarm join --token "{{ hostvars[groups['lxc']['swarm-master']].swarm_init_result.stdout_lines[-2].split(' ')[-1] }}" "{{ hostvars[groups['lxc']['swarm-master']].ansible_host }}:2377"] ***
2023-03-26 11:31:17,522 p=58223 u=craig n=ansible | fatal: [caddy]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'list object' has no attribute 'swarm-master'\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/docker_swarm_node/tasks/main.yaml': line 13, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Join Docker Swarm as a worker\n  ^ here\n"}
2023-03-26 11:31:17,523 p=58223 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:31:17,523 p=58223 u=craig n=ansible | caddy                      : ok=19   changed=2    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-26 11:48:42,741 p=60301 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 11:48:42,942 p=60301 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-26 11:48:42,953 p=60301 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-26 11:48:45,797 p=60301 u=craig n=ansible | ok: [caddy]
2023-03-26 11:48:45,806 p=60301 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-26 11:48:45,821 p=60301 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 11:48:45,828 p=60301 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-26 11:48:45,849 p=60301 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 11:48:45,855 p=60301 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-26 11:48:45,867 p=60301 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 11:48:45,878 p=60301 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-26 11:48:48,900 p=60301 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:48:48,911 p=60301 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-26 11:48:50,338 p=60301 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "apt-transport-https"}
2023-03-26 11:48:51,708 p=60301 u=craig n=ansible | ok: [caddy] => (item=ca-certificates) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "ca-certificates"}
2023-03-26 11:48:53,088 p=60301 u=craig n=ansible | ok: [caddy] => (item=curl) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "curl"}
2023-03-26 11:48:54,534 p=60301 u=craig n=ansible | ok: [caddy] => (item=gnupg) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "gnupg"}
2023-03-26 11:48:55,899 p=60301 u=craig n=ansible | ok: [caddy] => (item=lsb-release) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "lsb-release"}
2023-03-26 11:48:57,337 p=60301 u=craig n=ansible | ok: [caddy] => (item=software-properties-common) => {"ansible_loop_var": "item", "cache_update_time": 1679837102, "cache_updated": false, "changed": false, "item": "software-properties-common"}
2023-03-26 11:48:57,351 p=60301 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-26 11:48:58,604 p=60301 u=craig n=ansible | ok: [caddy] => {"before": ["8D81803C0EBFCD88", "7EA0A9C3F273FCD8", "D94AA3F0EFE21092", "871920D1991BC93C"], "changed": false, "fp": "8D81803C0EBFCD88", "id": "8D81803C0EBFCD88", "key_id": "8D81803C0EBFCD88", "short_id": "0EBFCD88"}
2023-03-26 11:48:58,615 p=60301 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-26 11:48:59,804 p=60301 u=craig n=ansible | ok: [caddy] => {"changed": false, "repo": "deb [arch=amd64] https://download.docker.com/linux/ubuntu jammy stable", "state": "present"}
2023-03-26 11:48:59,815 p=60301 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-26 11:49:01,365 p=60301 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:49:01,376 p=60301 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-26 11:49:02,617 p=60301 u=craig n=ansible | ok: [caddy] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2023-03-26 02:17:04 UTC", "ActiveEnterTimestampMonotonic": "2432800035853", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice docker.socket containerd.service network-online.target firewalld.service basic.target sysinit.target time-set.target systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2023-03-26 02:17:02 UTC", "AssertTimestampMonotonic": "2432798834761", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "82183411000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ConditionTimestampMonotonic": "2432798834760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "9", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13591", "ExecMainStartTimestamp": "Sun 2023-03-26 02:17:02 UTC", "ExecMainStartTimestampMonotonic": "2432798835264", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2023-03-26 02:17:02 UTC] ; stop_time=[n/a] ; pid=13591 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2023-03-26 02:17:02 UTC", "InactiveExitTimestampMonotonic": "2432798836125", "InvocationID": "32434b5b68044e38a1ca9c98fec0ae80", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "127619", "LimitSIGPENDINGSoft": "127619", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13591", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "168050688", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2023-03-26 02:17:04 UTC", "StateChangeTimestampMonotonic": "2432800035853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "36", "TasksMax": "infinity", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2023-03-26 11:49:02,627 p=60301 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-26 11:49:03,660 p=60301 u=craig n=ansible | ok: [caddy] => {"append": true, "changed": false, "comment": "", "group": 1000, "groups": "docker", "home": "/home/stantonius", "move_home": false, "name": "stantonius", "shell": "/bin/bash", "state": "present", "uid": 1000}
2023-03-26 11:49:03,670 p=60301 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-26 11:49:05,037 p=60301 u=craig n=ansible | ok: [caddy] => {"cache_update_time": 1679837102, "cache_updated": false, "changed": false}
2023-03-26 11:49:05,047 p=60301 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-26 11:49:07,361 p=60301 u=craig n=ansible | ok: [caddy] => {"changed": false, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "docker", "requests", "docker-compose"], "name": ["docker", "requests", "docker-compose"], "requirements": null, "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv"], "stdout": "Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)\nRequirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)\nRequirement already satisfied: docker-compose in /usr/local/lib/python3.10/dist-packages (1.29.2)\nRequirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (0.59.0)\nRequirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)\nRequirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)\nRequirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)\nRequirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)\nRequirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)\nRequirement already satisfied: docopt<1,>=0.6.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.6.2)\nRequirement already satisfied: dockerpty<1,>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.4.1)\nRequirement already satisfied: jsonschema<4,>=2.5.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (3.2.0)\nRequirement already satisfied: texttable<2,>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (1.6.7)\nRequirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)\nRequirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)\nRequirement already satisfied: python-dotenv<1,>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.21.1)\nRequirement already satisfied: paramiko>=2.4.3 in /usr/local/lib/python3.10/dist-packages (from docker) (3.1.0)\nRequirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)\nRequirement already satisfied: attrs>=17.4.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (22.2.0)\nRequirement already satisfied: pyrsistent>=0.14.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (0.19.3)\nRequirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)\nRequirement already satisfied: bcrypt>=3.2 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (4.0.1)\nRequirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)\nRequirement already satisfied: pynacl>=1.5 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (1.5.0)\nRequirement already satisfied: cffi>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from pynacl>=1.5->paramiko>=2.4.3->docker) (1.15.1)\nRequirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.4.1->pynacl>=1.5->paramiko>=2.4.3->docker) (2.21)\n", "stdout_lines": ["Requirement already satisfied: docker in /usr/local/lib/python3.10/dist-packages (6.0.1)", "Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.28.2)", "Requirement already satisfied: docker-compose in /usr/local/lib/python3.10/dist-packages (1.29.2)", "Requirement already satisfied: websocket-client>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from docker) (0.59.0)", "Requirement already satisfied: packaging>=14.0 in /usr/local/lib/python3.10/dist-packages (from docker) (23.0)", "Requirement already satisfied: urllib3>=1.26.0 in /usr/local/lib/python3.10/dist-packages (from docker) (1.26.15)", "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)", "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2022.12.7)", "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.1.0)", "Requirement already satisfied: docopt<1,>=0.6.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.6.2)", "Requirement already satisfied: dockerpty<1,>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.4.1)", "Requirement already satisfied: jsonschema<4,>=2.5.1 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (3.2.0)", "Requirement already satisfied: texttable<2,>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (1.6.7)", "Requirement already satisfied: distro<2,>=1.5.0 in /usr/lib/python3/dist-packages (from docker-compose) (1.7.0)", "Requirement already satisfied: PyYAML<6,>=3.10 in /usr/lib/python3/dist-packages (from docker-compose) (5.4.1)", "Requirement already satisfied: python-dotenv<1,>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from docker-compose) (0.21.1)", "Requirement already satisfied: paramiko>=2.4.3 in /usr/local/lib/python3.10/dist-packages (from docker) (3.1.0)", "Requirement already satisfied: six>=1.3.0 in /usr/lib/python3/dist-packages (from dockerpty<1,>=0.4.1->docker-compose) (1.16.0)", "Requirement already satisfied: attrs>=17.4.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (22.2.0)", "Requirement already satisfied: pyrsistent>=0.14.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (0.19.3)", "Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from jsonschema<4,>=2.5.1->docker-compose) (59.6.0)", "Requirement already satisfied: bcrypt>=3.2 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (4.0.1)", "Requirement already satisfied: cryptography>=3.3 in /usr/lib/python3/dist-packages (from paramiko>=2.4.3->docker) (3.4.8)", "Requirement already satisfied: pynacl>=1.5 in /usr/local/lib/python3.10/dist-packages (from paramiko>=2.4.3->docker) (1.5.0)", "Requirement already satisfied: cffi>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from pynacl>=1.5->paramiko>=2.4.3->docker) (1.15.1)", "Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.4.1->pynacl>=1.5->paramiko>=2.4.3->docker) (2.21)"], "version": null, "virtualenv": null}
2023-03-26 11:49:07,375 p=60301 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-26 11:49:08,344 p=60301 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 11:49:08,356 p=60301 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-26 11:49:10,429 p=60301 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "1395e26ae63d30bafa741c2cad03d0f01b01888b", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "md5sum": "30fb1afa201baa94a2199b3a926c9e4e", "mode": "0644", "owner": "root", "size": 120, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679845748.441556-60496-235038296010312/source", "state": "file", "uid": 0}
2023-03-26 11:49:10,440 p=60301 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-26 11:49:11,906 p=60301 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 11:49:11,917 p=60301 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-26 11:49:13,400 p=60301 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 11:49:13,412 p=60301 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-26 11:49:16,514 p=60301 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 11:49:16,533 p=60301 u=craig n=ansible | TASK [docker_swarm_node : Check if Docker Swarm is already initialized _raw_params=docker info -f "{{ '{{.Swarm.LocalNodeState}}' }}"] *********************************************************************
2023-03-26 11:49:18,231 p=60301 u=craig n=ansible | ok: [caddy] => {"changed": false, "cmd": ["docker", "info", "-f", "{{.Swarm.LocalNodeState}}"], "delta": "0:00:00.700462", "end": "2023-03-26 15:49:18.034547", "msg": "", "rc": 0, "start": "2023-03-26 15:49:17.334085", "stderr": "", "stderr_lines": [], "stdout": "active", "stdout_lines": ["active"]}
2023-03-26 11:49:18,242 p=60301 u=craig n=ansible | TASK [docker_swarm_node : Initialize Docker Swarm _raw_params=docker swarm init] ***************************************************************************************************************************
2023-03-26 11:49:18,257 p=60301 u=craig n=ansible | skipping: [caddy] => {"changed": false, "skip_reason": "Conditional result was False"}
2023-03-26 11:49:18,265 p=60301 u=craig n=ansible | TASK [docker_swarm_node : Join Docker Swarm as a worker _raw_params=docker swarm join --token "{{ hostvars[groups['lxc']['swarm-master']].swarm_init_result.stdout_lines[-2].split(' ')[-1] }}" "{{ hostvars[groups['lxc']['swarm-master']].ansible_host }}:2377"] ***
2023-03-26 11:49:18,278 p=60301 u=craig n=ansible | fatal: [caddy]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'list object' has no attribute 'swarm-master'\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/docker_swarm_node/tasks/main.yaml': line 13, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Join Docker Swarm as a worker\n  ^ here\n"}
2023-03-26 11:49:18,279 p=60301 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-26 11:49:18,279 p=60301 u=craig n=ansible | caddy                      : ok=19   changed=2    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-26 20:31:55,741 p=83124 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 20:31:56,044 p=83124 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 20:31:56,053 p=83124 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 20:31:57,519 p=83124 u=craig n=ansible | ok: [caddy]
2023-03-26 20:31:57,526 p=83124 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 20:31:57,536 p=83124 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 20:31:57,542 p=83124 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 20:31:57,563 p=83124 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 20:31:57,569 p=83124 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 20:31:57,580 p=83124 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 20:31:57,591 p=83124 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 20:31:58,196 p=83124 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": null, "exists": false}
2023-03-26 20:31:58,205 p=83124 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 20:31:58,575 p=83124 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 20:31:58,582 p=83124 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 20:31:59,330 p=83124 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "dc5c7e7e588e8cda2c6cc3f0eee1d1150e1c2623", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "md5sum": "c70a8880f6a3c12b73acc33af7067a16", "mode": "0644", "owner": "root", "size": 56, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679877118.608-83168-210984145075035/source", "state": "file", "uid": 0}
2023-03-26 20:31:59,337 p=83124 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 20:31:59,848 p=83124 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 20:31:59,859 p=83124 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 20:32:00,378 p=83124 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 20:32:00,387 p=83124 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 20:32:03,050 p=83124 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 20:32:03,071 p=83124 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 20:32:03,071 p=83124 u=craig n=ansible | caddy                      : ok=10   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 20:38:41,732 p=83755 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 20:38:41,882 p=83755 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 20:38:41,890 p=83755 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 20:38:43,338 p=83755 u=craig n=ansible | ok: [caddy]
2023-03-26 20:38:43,344 p=83755 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 20:38:43,354 p=83755 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 20:38:43,361 p=83755 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 20:38:43,381 p=83755 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 20:38:43,387 p=83755 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 20:38:43,397 p=83755 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 20:38:43,409 p=83755 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 20:38:43,918 p=83755 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": null, "exists": false}
2023-03-26 20:38:43,927 p=83755 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 20:38:44,285 p=83755 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 20:38:44,293 p=83755 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 20:38:45,023 p=83755 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "57a7c2de5d981aff241776a2b3a66694615f4d73", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "md5sum": "f02cfb3b08a3b8a0c9ac21febd0fd385", "mode": "0644", "owner": "root", "size": 80, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679877524.318804-83798-238947400724017/source", "state": "file", "uid": 0}
2023-03-26 20:38:45,030 p=83755 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 20:38:45,515 p=83755 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 20:38:45,522 p=83755 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 20:38:46,019 p=83755 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 20:38:46,027 p=83755 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 20:38:48,313 p=83755 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 20:38:48,332 p=83755 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 20:38:48,332 p=83755 u=craig n=ansible | caddy                      : ok=10   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 20:40:54,044 p=84039 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 20:40:54,184 p=84039 u=craig n=ansible | ERROR! couldn't resolve module/action 'ansible.builtin.docker_exec'. This often indicates a misspelling, missing collection, or incorrect module path.

The error appears to be in '/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/main.yaml': line 39, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Reload Caddy configuration
  ^ here

2023-03-26 20:44:26,842 p=84323 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 20:44:26,991 p=84323 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 20:44:26,999 p=84323 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 20:44:28,427 p=84323 u=craig n=ansible | ok: [caddy]
2023-03-26 20:44:28,433 p=84323 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 20:44:28,444 p=84323 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 20:44:28,451 p=84323 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 20:44:28,470 p=84323 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 20:44:28,476 p=84323 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 20:44:28,487 p=84323 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 20:44:28,499 p=84323 u=craig n=ansible | TASK [caddy_docker : Check Caddy service status _raw_params=systemctl is-active caddy] ************************
2023-03-26 20:44:28,850 p=84323 u=craig n=ansible | ok: [caddy] => {"changed": false, "cmd": ["systemctl", "is-active", "caddy"], "delta": "0:00:00.003810", "end": "2023-03-27 00:44:28.834366", "failed_when_result": false, "msg": "non-zero return code", "rc": 3, "start": "2023-03-27 00:44:28.830556", "stderr": "", "stderr_lines": [], "stdout": "inactive", "stdout_lines": ["inactive"]}
2023-03-26 20:44:28,857 p=84323 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 20:44:29,218 p=84323 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 20:44:29,226 p=84323 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 20:44:29,815 p=84323 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "57a7c2de5d981aff241776a2b3a66694615f4d73", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 80, "state": "file", "uid": 0}
2023-03-26 20:44:29,824 p=84323 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 20:44:30,348 p=84323 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 20:44:30,358 p=84323 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 20:44:30,880 p=84323 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 20:44:30,890 p=84323 u=craig n=ansible | TASK [caddy_docker : Reload Caddy service name=caddy, state=reloaded] *****************************************
2023-03-26 20:44:30,901 p=84323 u=craig n=ansible | skipping: [caddy] => {"changed": false, "skip_reason": "Conditional result was False"}
2023-03-26 20:44:30,909 p=84323 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ******
2023-03-26 20:44:33,211 p=84323 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 20:44:33,231 p=84323 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 20:44:33,231 p=84323 u=craig n=ansible | caddy                      : ok=10   changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-26 20:44:53,857 p=84479 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 20:44:54,005 p=84479 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 20:44:54,013 p=84479 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 20:44:55,109 p=84479 u=craig n=ansible | ok: [caddy]
2023-03-26 20:44:55,116 p=84479 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 20:44:55,127 p=84479 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 20:44:55,133 p=84479 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 20:44:55,153 p=84479 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 20:44:55,159 p=84479 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 20:44:55,170 p=84479 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 20:44:55,195 p=84479 u=craig n=ansible | TASK [caddy_docker : Check Caddy service status _raw_params=systemctl is-active caddy] ************************
2023-03-26 20:44:55,543 p=84479 u=craig n=ansible | ok: [caddy] => {"changed": false, "cmd": ["systemctl", "is-active", "caddy"], "delta": "0:00:00.004116", "end": "2023-03-27 00:44:55.528975", "failed_when_result": false, "msg": "non-zero return code", "rc": 3, "start": "2023-03-27 00:44:55.524859", "stderr": "", "stderr_lines": [], "stdout": "inactive", "stdout_lines": ["inactive"]}
2023-03-26 20:44:55,549 p=84479 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 20:44:55,903 p=84479 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 20:44:55,911 p=84479 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 20:44:56,485 p=84479 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "57a7c2de5d981aff241776a2b3a66694615f4d73", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 80, "state": "file", "uid": 0}
2023-03-26 20:44:56,494 p=84479 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 20:44:57,029 p=84479 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 20:44:57,039 p=84479 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 20:44:57,560 p=84479 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 20:44:57,569 p=84479 u=craig n=ansible | TASK [caddy_docker : Reload Caddy service name=caddy, state=reloaded] *****************************************
2023-03-26 20:44:57,582 p=84479 u=craig n=ansible | skipping: [caddy] => {"changed": false, "skip_reason": "Conditional result was False"}
2023-03-26 20:44:57,589 p=84479 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ******
2023-03-26 20:44:59,727 p=84479 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 20:44:59,745 p=84479 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 20:44:59,746 p=84479 u=craig n=ansible | caddy                      : ok=10   changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-26 21:10:24,638 p=86319 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 21:10:24,811 p=86319 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 21:10:24,820 p=86319 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 21:10:26,254 p=86319 u=craig n=ansible | ok: [caddy]
2023-03-26 21:10:26,260 p=86319 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 21:10:26,270 p=86319 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 21:10:26,277 p=86319 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 21:10:26,298 p=86319 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 21:10:26,304 p=86319 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 21:10:26,315 p=86319 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 21:10:26,326 p=86319 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 21:10:26,869 p=86319 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": null, "exists": false}
2023-03-26 21:10:26,877 p=86319 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 21:10:27,233 p=86319 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 21:10:27,241 p=86319 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 21:10:27,813 p=86319 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "57a7c2de5d981aff241776a2b3a66694615f4d73", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 80, "state": "file", "uid": 0}
2023-03-26 21:10:27,821 p=86319 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 21:10:28,336 p=86319 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 21:10:28,346 p=86319 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 21:10:28,887 p=86319 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 21:10:28,896 p=86319 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 21:10:31,117 p=86319 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 21:10:31,136 p=86319 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 21:10:31,136 p=86319 u=craig n=ansible | caddy                      : ok=10   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 21:34:16,379 p=88010 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 21:34:16,569 p=88010 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 21:34:16,578 p=88010 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 21:34:18,057 p=88010 u=craig n=ansible | ok: [caddy]
2023-03-26 21:34:18,065 p=88010 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 21:34:18,076 p=88010 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 21:34:18,083 p=88010 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 21:34:18,104 p=88010 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 21:34:18,110 p=88010 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 21:34:18,121 p=88010 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 21:34:18,146 p=88010 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 21:34:18,669 p=88010 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": null, "exists": false}
2023-03-26 21:34:18,678 p=88010 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 21:34:19,048 p=88010 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 21:34:19,056 p=88010 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 21:34:19,802 p=88010 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "5efd48c92c16c9292feda050277d7b2b62aec87a", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "md5sum": "b834975325db383b1e5d259863ae83b9", "mode": "0644", "owner": "root", "size": 55, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679880859.082603-88053-20764241860258/source", "state": "file", "uid": 0}
2023-03-26 21:34:19,808 p=88010 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 21:34:20,312 p=88010 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 21:34:20,322 p=88010 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 21:34:20,833 p=88010 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 21:34:20,842 p=88010 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 21:34:23,173 p=88010 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 21:34:23,194 p=88010 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 21:34:23,194 p=88010 u=craig n=ansible | caddy                      : ok=10   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 21:37:18,800 p=88358 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 21:37:18,963 p=88358 u=craig n=ansible | ERROR! couldn't resolve module/action 'ansible.builtin.docker_exec'. This often indicates a misspelling, missing collection, or incorrect module path.

The error appears to be in '/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/main.yaml': line 39, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Reload Caddy configuration
  ^ here

2023-03-26 21:38:25,934 p=88472 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 21:38:26,130 p=88472 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 21:38:26,140 p=88472 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 21:38:27,604 p=88472 u=craig n=ansible | ok: [caddy]
2023-03-26 21:38:27,611 p=88472 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 21:38:27,621 p=88472 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 21:38:27,628 p=88472 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 21:38:27,649 p=88472 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 21:38:27,655 p=88472 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 21:38:27,666 p=88472 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 21:38:27,693 p=88472 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 21:38:28,208 p=88472 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": null, "exists": false}
2023-03-26 21:38:28,217 p=88472 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 21:38:28,587 p=88472 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 21:38:28,594 p=88472 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 21:38:29,164 p=88472 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "5efd48c92c16c9292feda050277d7b2b62aec87a", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 55, "state": "file", "uid": 0}
2023-03-26 21:38:29,172 p=88472 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 21:38:29,689 p=88472 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 21:38:29,699 p=88472 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 21:38:30,222 p=88472 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 21:38:30,231 p=88472 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 21:38:32,574 p=88472 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 21:38:32,583 p=88472 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, workdir=/etc/caddy] ****
2023-03-26 21:38:33,117 p=88472 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (community.docker.docker_container_exec) module: workdir. Supported parameters include: tls_hostname, command, docker_host (docker_url), tty, tls, stdin, api_version (docker_api_version), client_cert (cert_path, tls_client_cert), stdin_add_newline, user, timeout, use_ssh_client, debug, validate_certs (tls_verify), detach, ca_cert (cacert_path, tls_ca_cert), container, chdir, argv, ssl_version, client_key (key_path, tls_client_key), strip_empty_ends, env."}
2023-03-26 21:38:33,118 p=88472 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 21:38:33,118 p=88472 u=craig n=ansible | caddy                      : ok=10   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 21:39:05,453 p=88635 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 21:39:05,621 p=88635 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 21:39:05,629 p=88635 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 21:39:06,734 p=88635 u=craig n=ansible | ok: [caddy]
2023-03-26 21:39:06,743 p=88635 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 21:39:06,754 p=88635 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 21:39:06,761 p=88635 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 21:39:06,781 p=88635 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 21:39:06,787 p=88635 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 21:39:06,798 p=88635 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 21:39:06,824 p=88635 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 21:39:07,429 p=88635 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": null, "exists": false}
2023-03-26 21:39:07,438 p=88635 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 21:39:07,797 p=88635 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 21:39:07,805 p=88635 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 21:39:08,405 p=88635 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "5efd48c92c16c9292feda050277d7b2b62aec87a", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 55, "state": "file", "uid": 0}
2023-03-26 21:39:08,414 p=88635 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 21:39:08,950 p=88635 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 21:39:08,960 p=88635 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 21:39:09,475 p=88635 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "2415e8bf441442b281af4abee7092b5296eac25d", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 293, "state": "file", "uid": 0}
2023-03-26 21:39:09,484 p=88635 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 21:39:11,761 p=88635 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy_caddy_1": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "f2aec47042d136d10df205a8290da9a1e1cac338d24031fb51c4360a154ceaa7", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "503fdf99db18"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 21:39:11,770 p=88635 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ******
2023-03-26 21:39:12,359 p=88635 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Could not find container \"caddy\""}
2023-03-26 21:39:12,360 p=88635 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 21:39:12,360 p=88635 u=craig n=ansible | caddy                      : ok=10   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 21:45:34,164 p=89200 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 21:45:34,336 p=89200 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 21:45:34,344 p=89200 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 21:45:35,854 p=89200 u=craig n=ansible | ok: [caddy]
2023-03-26 21:45:35,861 p=89200 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 21:45:35,871 p=89200 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 21:45:35,878 p=89200 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 21:45:35,899 p=89200 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 21:45:35,905 p=89200 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 21:45:35,917 p=89200 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 21:45:35,942 p=89200 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 21:45:36,573 p=89200 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": null, "exists": false}
2023-03-26 21:45:36,582 p=89200 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 21:45:36,955 p=89200 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 21:45:36,964 p=89200 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 21:45:37,557 p=89200 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "5efd48c92c16c9292feda050277d7b2b62aec87a", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 55, "state": "file", "uid": 0}
2023-03-26 21:45:37,565 p=89200 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 21:45:38,087 p=89200 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 21:45:38,097 p=89200 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 21:45:38,798 p=89200 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "566db96a84acf3052a5e73f74402cd613def6bc5", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "md5sum": "058627ac487ceb02d022989a426948fc", "mode": "0644", "owner": "root", "size": 319, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679881538.1252532-89266-223235338491420/source", "state": "file", "uid": 0}
2023-03-26 21:45:38,804 p=89200 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 21:45:42,002 p=89200 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "b0333da8c0b8"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 21:45:42,012 p=89200 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ******
2023-03-26 21:45:42,696 p=89200 u=craig n=ansible | changed: [caddy] => {"changed": true, "rc": 0, "stderr": "{\"level\":\"info\",\"ts\":1679881542.6482234,\"msg\":\"using adjacent Caddyfile\"}", "stderr_lines": ["{\"level\":\"info\",\"ts\":1679881542.6482234,\"msg\":\"using adjacent Caddyfile\"}"], "stdout": "", "stdout_lines": []}
2023-03-26 21:45:42,716 p=89200 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 21:45:42,716 p=89200 u=craig n=ansible | caddy                      : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 22:02:30,729 p=90637 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 22:02:30,918 p=90637 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 22:02:30,927 p=90637 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 22:02:32,383 p=90637 u=craig n=ansible | ok: [caddy]
2023-03-26 22:02:32,389 p=90637 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 22:02:32,400 p=90637 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 22:02:32,407 p=90637 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 22:02:32,428 p=90637 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 22:02:32,434 p=90637 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 22:02:32,446 p=90637 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 22:02:32,457 p=90637 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 22:02:32,947 p=90637 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Domainname": "", "Entrypoint": null, "Env": ["CADDY_DNS_API_KEY=QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "CADDY_VERSION=v2.6.4", "XDG_CONFIG_HOME=/config", "XDG_DATA_HOME=/data"], "ExposedPorts": {"2019/tcp": {}, "443/tcp": {}, "443/udp": {}, "80/tcp": {}}, "Hostname": "b0333da8c0b8", "Image": "caddy", "Labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/config": {}, "/data": {}}, "WorkingDir": "/srv"}, "Created": "2023-03-27T01:45:41.198375022Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6-init/diff:/var/lib/docker/overlay2/a82620ad56cac80997e9fd45034f1ae82a8ab4bc12e280aa4041448f9300398d/diff:/var/lib/docker/overlay2/e8a5c0b4fadc4c292e11d5efa64fb7dc45bb6e31e5eb54725eccb01952822d2e/diff:/var/lib/docker/overlay2/0c7522c45447fc80d43791b1fd70ffc2e0c8c2f7c78274e15af23b5f28e76feb/diff:/var/lib/docker/overlay2/887a28d027cffe9aaab9aaf7d10121ae2448e915fa29448432866b5f18250ab4/diff:/var/lib/docker/overlay2/b53b37a6a143b00290caeccb5a0855c65aa59011a9de4c773e1a5d947e2d6396/diff", "MergedDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/merged", "UpperDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/diff", "WorkDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["caddy_caddy_data:/data:rw", "caddy_caddy_config:/config:rw"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "caddy_default", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"443/tcp": [{"HostIp": "", "HostPort": "443"}], "80/tcp": [{"HostIp": "", "HostPort": "80"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": []}, "HostnamePath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hostname", "HostsPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hosts", "Id": "b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39", "Image": "sha256:a994e8295eb8d3397814558efd1d6d4efd6df0e3ebccb020584fe4febfe9de3e", "LogPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39-json.log", "MountLabel": "", "Mounts": [{"Destination": "/data", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_data", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_data/_data", "Type": "volume"}, {"Destination": "/config", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_config", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_config/_data", "Type": "volume"}], "Name": "/caddy", "NetworkSettings": {"Bridge": "", "EndpointID": "", "Gateway": "", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "", "IPPrefixLen": 0, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "", "Networks": {"caddy_default": {"Aliases": ["caddy", "b0333da8c0b8"], "DriverOpts": null, "EndpointID": "a69fdfdef331db01ce90e01b84e257dbd1c97b2cad884b60bb2f6b499b72f950", "Gateway": "172.19.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.19.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:13:00:02", "NetworkID": "3010e077b1bda059908b4f385356ab4513c293df9a8b0f33edf388f5ae22c82d"}}, "Ports": {"2019/tcp": null, "443/tcp": [{"HostIp": "0.0.0.0", "HostPort": "443"}, {"HostIp": "::", "HostPort": "443"}], "443/udp": null, "80/tcp": [{"HostIp": "0.0.0.0", "HostPort": "80"}, {"HostIp": "::", "HostPort": "80"}]}, "SandboxID": "817adeaeb9071897f0063d4c1df580df6d6e58ef39ae673eb5243269a6dd7dd8", "SandboxKey": "/var/run/docker/netns/817adeaeb907", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "caddy", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 72355, "Restarting": false, "Running": true, "StartedAt": "2023-03-27T01:45:41.939447226Z", "Status": "running"}}, "exists": true}
2023-03-26 22:02:32,955 p=90637 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 22:02:33,305 p=90637 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 22:02:33,312 p=90637 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 22:02:34,062 p=90637 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "8abc2e3f774e29606f21f0c04185d65b58ad3bcf", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "md5sum": "afc39d00bde7eec24698b374f2008ebd", "mode": "0644", "owner": "root", "size": 84, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679882553.338469-90678-38903887922585/source", "state": "file", "uid": 0}
2023-03-26 22:02:34,069 p=90637 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 22:02:34,584 p=90637 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 22:02:34,594 p=90637 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 22:02:35,100 p=90637 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "566db96a84acf3052a5e73f74402cd613def6bc5", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 319, "state": "file", "uid": 0}
2023-03-26 22:02:35,109 p=90637 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state={{ 'started' if caddy_container.exists and caddy_container.container.State.Running else 'present' }}, build=True, pull=True] ***
2023-03-26 22:02:35,700 p=90637 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "value of state must be one of: absent, present, got: started"}
2023-03-26 22:02:35,701 p=90637 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 22:02:35,702 p=90637 u=craig n=ansible | caddy                      : ok=9    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-26 22:03:56,553 p=90853 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 22:03:56,728 p=90853 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 22:03:56,737 p=90853 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 22:03:58,120 p=90853 u=craig n=ansible | ok: [caddy]
2023-03-26 22:03:58,127 p=90853 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 22:03:58,138 p=90853 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 22:03:58,144 p=90853 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 22:03:58,166 p=90853 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 22:03:58,172 p=90853 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 22:03:58,184 p=90853 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 22:03:58,195 p=90853 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 22:03:58,723 p=90853 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Domainname": "", "Entrypoint": null, "Env": ["CADDY_DNS_API_KEY=QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "CADDY_VERSION=v2.6.4", "XDG_CONFIG_HOME=/config", "XDG_DATA_HOME=/data"], "ExposedPorts": {"2019/tcp": {}, "443/tcp": {}, "443/udp": {}, "80/tcp": {}}, "Hostname": "b0333da8c0b8", "Image": "caddy", "Labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/config": {}, "/data": {}}, "WorkingDir": "/srv"}, "Created": "2023-03-27T01:45:41.198375022Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6-init/diff:/var/lib/docker/overlay2/a82620ad56cac80997e9fd45034f1ae82a8ab4bc12e280aa4041448f9300398d/diff:/var/lib/docker/overlay2/e8a5c0b4fadc4c292e11d5efa64fb7dc45bb6e31e5eb54725eccb01952822d2e/diff:/var/lib/docker/overlay2/0c7522c45447fc80d43791b1fd70ffc2e0c8c2f7c78274e15af23b5f28e76feb/diff:/var/lib/docker/overlay2/887a28d027cffe9aaab9aaf7d10121ae2448e915fa29448432866b5f18250ab4/diff:/var/lib/docker/overlay2/b53b37a6a143b00290caeccb5a0855c65aa59011a9de4c773e1a5d947e2d6396/diff", "MergedDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/merged", "UpperDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/diff", "WorkDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["caddy_caddy_data:/data:rw", "caddy_caddy_config:/config:rw"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "caddy_default", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"443/tcp": [{"HostIp": "", "HostPort": "443"}], "80/tcp": [{"HostIp": "", "HostPort": "80"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": []}, "HostnamePath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hostname", "HostsPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hosts", "Id": "b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39", "Image": "sha256:a994e8295eb8d3397814558efd1d6d4efd6df0e3ebccb020584fe4febfe9de3e", "LogPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39-json.log", "MountLabel": "", "Mounts": [{"Destination": "/data", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_data", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_data/_data", "Type": "volume"}, {"Destination": "/config", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_config", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_config/_data", "Type": "volume"}], "Name": "/caddy", "NetworkSettings": {"Bridge": "", "EndpointID": "", "Gateway": "", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "", "IPPrefixLen": 0, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "", "Networks": {"caddy_default": {"Aliases": ["caddy", "b0333da8c0b8"], "DriverOpts": null, "EndpointID": "a69fdfdef331db01ce90e01b84e257dbd1c97b2cad884b60bb2f6b499b72f950", "Gateway": "172.19.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.19.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:13:00:02", "NetworkID": "3010e077b1bda059908b4f385356ab4513c293df9a8b0f33edf388f5ae22c82d"}}, "Ports": {"2019/tcp": null, "443/tcp": [{"HostIp": "0.0.0.0", "HostPort": "443"}, {"HostIp": "::", "HostPort": "443"}], "443/udp": null, "80/tcp": [{"HostIp": "0.0.0.0", "HostPort": "80"}, {"HostIp": "::", "HostPort": "80"}]}, "SandboxID": "817adeaeb9071897f0063d4c1df580df6d6e58ef39ae673eb5243269a6dd7dd8", "SandboxKey": "/var/run/docker/netns/817adeaeb907", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "caddy", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 72355, "Restarting": false, "Running": true, "StartedAt": "2023-03-27T01:45:41.939447226Z", "Status": "running"}}, "exists": true}
2023-03-26 22:03:58,732 p=90853 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 22:03:59,104 p=90853 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 22:03:59,112 p=90853 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 22:03:59,697 p=90853 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "8abc2e3f774e29606f21f0c04185d65b58ad3bcf", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Caddyfile", "size": 84, "state": "file", "uid": 0}
2023-03-26 22:03:59,706 p=90853 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 22:04:00,235 p=90853 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 22:04:00,244 p=90853 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 22:04:00,762 p=90853 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "566db96a84acf3052a5e73f74402cd613def6bc5", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 319, "state": "file", "uid": 0}
2023-03-26 22:04:00,771 p=90853 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ******
2023-03-26 22:04:03,113 p=90853 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "b0333da8c0b8"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 22:04:03,122 p=90853 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ******
2023-03-26 22:04:03,803 p=90853 u=craig n=ansible | changed: [caddy] => {"changed": true, "rc": 0, "stderr": "{\"level\":\"info\",\"ts\":1679882643.7776155,\"msg\":\"using adjacent Caddyfile\"}", "stderr_lines": ["{\"level\":\"info\",\"ts\":1679882643.7776155,\"msg\":\"using adjacent Caddyfile\"}"], "stdout": "", "stdout_lines": []}
2023-03-26 22:04:03,822 p=90853 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 22:04:03,822 p=90853 u=craig n=ansible | caddy                      : ok=11   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 22:11:48,529 p=91534 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 22:11:48,724 p=91534 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 22:11:48,734 p=91534 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 22:11:50,167 p=91534 u=craig n=ansible | ok: [caddy]
2023-03-26 22:11:50,173 p=91534 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 22:11:50,184 p=91534 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 22:11:50,190 p=91534 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 22:11:50,211 p=91534 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 22:11:50,217 p=91534 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 22:11:50,228 p=91534 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 22:11:50,239 p=91534 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 22:11:50,793 p=91534 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Domainname": "", "Entrypoint": null, "Env": ["CADDY_DNS_API_KEY=QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "CADDY_VERSION=v2.6.4", "XDG_CONFIG_HOME=/config", "XDG_DATA_HOME=/data"], "ExposedPorts": {"2019/tcp": {}, "443/tcp": {}, "443/udp": {}, "80/tcp": {}}, "Hostname": "b0333da8c0b8", "Image": "caddy", "Labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/config": {}, "/data": {}}, "WorkingDir": "/srv"}, "Created": "2023-03-27T01:45:41.198375022Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6-init/diff:/var/lib/docker/overlay2/a82620ad56cac80997e9fd45034f1ae82a8ab4bc12e280aa4041448f9300398d/diff:/var/lib/docker/overlay2/e8a5c0b4fadc4c292e11d5efa64fb7dc45bb6e31e5eb54725eccb01952822d2e/diff:/var/lib/docker/overlay2/0c7522c45447fc80d43791b1fd70ffc2e0c8c2f7c78274e15af23b5f28e76feb/diff:/var/lib/docker/overlay2/887a28d027cffe9aaab9aaf7d10121ae2448e915fa29448432866b5f18250ab4/diff:/var/lib/docker/overlay2/b53b37a6a143b00290caeccb5a0855c65aa59011a9de4c773e1a5d947e2d6396/diff", "MergedDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/merged", "UpperDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/diff", "WorkDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["caddy_caddy_data:/data:rw", "caddy_caddy_config:/config:rw"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "caddy_default", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"443/tcp": [{"HostIp": "", "HostPort": "443"}], "80/tcp": [{"HostIp": "", "HostPort": "80"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": []}, "HostnamePath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hostname", "HostsPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hosts", "Id": "b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39", "Image": "sha256:a994e8295eb8d3397814558efd1d6d4efd6df0e3ebccb020584fe4febfe9de3e", "LogPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39-json.log", "MountLabel": "", "Mounts": [{"Destination": "/data", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_data", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_data/_data", "Type": "volume"}, {"Destination": "/config", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_config", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_config/_data", "Type": "volume"}], "Name": "/caddy", "NetworkSettings": {"Bridge": "", "EndpointID": "", "Gateway": "", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "", "IPPrefixLen": 0, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "", "Networks": {"caddy_default": {"Aliases": ["caddy", "b0333da8c0b8"], "DriverOpts": null, "EndpointID": "a69fdfdef331db01ce90e01b84e257dbd1c97b2cad884b60bb2f6b499b72f950", "Gateway": "172.19.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.19.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:13:00:02", "NetworkID": "3010e077b1bda059908b4f385356ab4513c293df9a8b0f33edf388f5ae22c82d"}}, "Ports": {"2019/tcp": null, "443/tcp": [{"HostIp": "0.0.0.0", "HostPort": "443"}, {"HostIp": "::", "HostPort": "443"}], "443/udp": null, "80/tcp": [{"HostIp": "0.0.0.0", "HostPort": "80"}, {"HostIp": "::", "HostPort": "80"}]}, "SandboxID": "817adeaeb9071897f0063d4c1df580df6d6e58ef39ae673eb5243269a6dd7dd8", "SandboxKey": "/var/run/docker/netns/817adeaeb907", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "caddy", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 72355, "Restarting": false, "Running": true, "StartedAt": "2023-03-27T01:45:41.939447226Z", "Status": "running"}}, "exists": true}
2023-03-26 22:11:50,801 p=91534 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 22:11:51,186 p=91534 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 22:11:51,195 p=91534 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 22:11:51,961 p=91534 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "5dc6b437babc62616bbff28f4f131e2079766c7d", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "md5sum": "2c38ffb00c3fe92bb81b9d371c1206a6", "mode": "0644", "owner": "root", "size": 269, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679883111.221332-91579-50975617252834/source", "state": "file", "uid": 0}
2023-03-26 22:11:51,968 p=91534 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 22:11:52,473 p=91534 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 22:11:52,482 p=91534 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 22:11:53,010 p=91534 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "566db96a84acf3052a5e73f74402cd613def6bc5", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 319, "state": "file", "uid": 0}
2023-03-26 22:11:53,019 p=91534 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ******
2023-03-26 22:11:55,307 p=91534 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "b0333da8c0b8"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 22:11:55,317 p=91534 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ******
2023-03-26 22:11:56,030 p=91534 u=craig n=ansible | changed: [caddy] => {"changed": true, "rc": 0, "stderr": "{\"level\":\"info\",\"ts\":1679883116.0039456,\"msg\":\"using adjacent Caddyfile\"}", "stderr_lines": ["{\"level\":\"info\",\"ts\":1679883116.0039456,\"msg\":\"using adjacent Caddyfile\"}"], "stdout": "", "stdout_lines": []}
2023-03-26 22:11:56,048 p=91534 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 22:11:56,048 p=91534 u=craig n=ansible | caddy                      : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-26 22:14:03,157 p=91818 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-03-26 22:14:03,330 p=91818 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *****************************************************************************
2023-03-26 22:14:03,339 p=91818 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************
2023-03-26 22:14:04,756 p=91818 u=craig n=ansible | ok: [caddy]
2023-03-26 22:14:04,762 p=91818 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ***********************************************************
2023-03-26 22:14:04,772 p=91818 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-26 22:14:04,779 p=91818 u=craig n=ansible | TASK [Include secrets] ****************************************************************************************
2023-03-26 22:14:04,799 p=91818 u=craig n=ansible | ok: [caddy] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2023-03-26 22:14:04,805 p=91818 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] ************************************************
2023-03-26 22:14:04,816 p=91818 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw=="
}
2023-03-26 22:14:04,827 p=91818 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] *************************************************
2023-03-26 22:14:05,307 p=91818 u=craig n=ansible | ok: [caddy] => {"changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "Domainname": "", "Entrypoint": null, "Env": ["CADDY_DNS_API_KEY=QWdBRUsxZnR5VG90LTJZTTZTWTV4Zw==", "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "CADDY_VERSION=v2.6.4", "XDG_CONFIG_HOME=/config", "XDG_DATA_HOME=/data"], "ExposedPorts": {"2019/tcp": {}, "443/tcp": {}, "443/udp": {}, "80/tcp": {}}, "Hostname": "b0333da8c0b8", "Image": "caddy", "Labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": {"/config": {}, "/data": {}}, "WorkingDir": "/srv"}, "Created": "2023-03-27T01:45:41.198375022Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"LowerDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6-init/diff:/var/lib/docker/overlay2/a82620ad56cac80997e9fd45034f1ae82a8ab4bc12e280aa4041448f9300398d/diff:/var/lib/docker/overlay2/e8a5c0b4fadc4c292e11d5efa64fb7dc45bb6e31e5eb54725eccb01952822d2e/diff:/var/lib/docker/overlay2/0c7522c45447fc80d43791b1fd70ffc2e0c8c2f7c78274e15af23b5f28e76feb/diff:/var/lib/docker/overlay2/887a28d027cffe9aaab9aaf7d10121ae2448e915fa29448432866b5f18250ab4/diff:/var/lib/docker/overlay2/b53b37a6a143b00290caeccb5a0855c65aa59011a9de4c773e1a5d947e2d6396/diff", "MergedDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/merged", "UpperDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/diff", "WorkDir": "/var/lib/docker/overlay2/80c2f164ca69c7b58fb4506960df860a3d0704e6ac1eba52a6571e506c7a3dd6/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["caddy_caddy_data:/data:rw", "caddy_caddy_config:/config:rw"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "caddy_default", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"443/tcp": [{"HostIp": "", "HostPort": "443"}], "80/tcp": [{"HostIp": "", "HostPort": "80"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": ""}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": []}, "HostnamePath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hostname", "HostsPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/hosts", "Id": "b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39", "Image": "sha256:a994e8295eb8d3397814558efd1d6d4efd6df0e3ebccb020584fe4febfe9de3e", "LogPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39-json.log", "MountLabel": "", "Mounts": [{"Destination": "/data", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_data", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_data/_data", "Type": "volume"}, {"Destination": "/config", "Driver": "local", "Mode": "rw", "Name": "caddy_caddy_config", "Propagation": "", "RW": true, "Source": "/var/lib/docker/volumes/caddy_caddy_config/_data", "Type": "volume"}], "Name": "/caddy", "NetworkSettings": {"Bridge": "", "EndpointID": "", "Gateway": "", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "", "IPPrefixLen": 0, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "", "Networks": {"caddy_default": {"Aliases": ["caddy", "b0333da8c0b8"], "DriverOpts": null, "EndpointID": "a69fdfdef331db01ce90e01b84e257dbd1c97b2cad884b60bb2f6b499b72f950", "Gateway": "172.19.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "IPAMConfig": null, "IPAddress": "172.19.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:42:ac:13:00:02", "NetworkID": "3010e077b1bda059908b4f385356ab4513c293df9a8b0f33edf388f5ae22c82d"}}, "Ports": {"2019/tcp": null, "443/tcp": [{"HostIp": "0.0.0.0", "HostPort": "443"}, {"HostIp": "::", "HostPort": "443"}], "443/udp": null, "80/tcp": [{"HostIp": "0.0.0.0", "HostPort": "80"}, {"HostIp": "::", "HostPort": "80"}]}, "SandboxID": "817adeaeb9071897f0063d4c1df580df6d6e58ef39ae673eb5243269a6dd7dd8", "SandboxKey": "/var/run/docker/netns/817adeaeb907", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "caddy", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 72355, "Restarting": false, "Running": true, "StartedAt": "2023-03-27T01:45:41.939447226Z", "Status": "running"}}, "exists": true}
2023-03-26 22:14:05,315 p=91818 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] *********************************
2023-03-26 22:14:05,676 p=91818 u=craig n=ansible | ok: [caddy] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/caddy", "size": 4096, "state": "directory", "uid": 0}
2023-03-26 22:14:05,683 p=91818 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] *********************************
2023-03-26 22:14:06,467 p=91818 u=craig n=ansible | changed: [caddy] => {"changed": true, "checksum": "7338945564416ad0ffdee978cc8fc5c267ace8fd", "dest": "/opt/caddy/Caddyfile", "gid": 0, "group": "root", "md5sum": "3dda908f5f4c3931c2dcfeb3466e3ff1", "mode": "0644", "owner": "root", "size": 284, "src": "/home/stantonius/.ansible/tmp/ansible-tmp-1679883245.7146251-91863-36881181022190/source", "state": "file", "uid": 0}
2023-03-26 22:14:06,473 p=91818 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ******************************
2023-03-26 22:14:06,962 p=91818 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "1ccdd07ddf798c5bfb2cf2f1fb4bd03609361e73", "dest": "/opt/caddy/Dockerfile", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/Dockerfile", "size": 196, "state": "file", "uid": 0}
2023-03-26 22:14:06,972 p=91818 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] ***
2023-03-26 22:14:07,469 p=91818 u=craig n=ansible | ok: [caddy] => {"changed": false, "checksum": "566db96a84acf3052a5e73f74402cd613def6bc5", "dest": "/opt/caddy/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/caddy/docker-compose.yml", "size": 319, "state": "file", "uid": 0}
2023-03-26 22:14:07,476 p=91818 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ******
2023-03-26 22:14:09,865 p=91818 u=craig n=ansible | changed: [caddy] => {"changed": true, "services": {"caddy": {"caddy": {"cmd": ["caddy", "run", "--config", "/etc/caddy/Caddyfile", "--adapter", "caddyfile"], "image": "caddy", "labels": {"com.docker.compose.config-hash": "81af0f8bf35811803850168b275a3189f7792ac25e3633dda9ecac6cec4f5296", "com.docker.compose.container-number": "1", "com.docker.compose.oneoff": "False", "com.docker.compose.project": "caddy", "com.docker.compose.project.config_files": "/opt/caddy/docker-compose.yml", "com.docker.compose.project.working_dir": "/opt/caddy", "com.docker.compose.service": "caddy", "com.docker.compose.version": "1.29.2", "org.opencontainers.image.description": "a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go", "org.opencontainers.image.documentation": "https://caddyserver.com/docs", "org.opencontainers.image.licenses": "Apache-2.0", "org.opencontainers.image.source": "https://github.com/caddyserver/caddy-docker", "org.opencontainers.image.title": "Caddy", "org.opencontainers.image.url": "https://caddyserver.com", "org.opencontainers.image.vendor": "Light Code Labs", "org.opencontainers.image.version": "v2.6.4"}, "networks": {"caddy_default": {"IPAddress": "172.19.0.2", "IPPrefixLen": 16, "aliases": ["caddy", "b0333da8c0b8"], "globalIPv6": "", "globalIPv6PrefixLen": 0, "links": null, "macAddress": "02:42:ac:13:00:02"}}, "state": {"running": true, "status": "running"}}}}}
2023-03-26 22:14:09,874 p=91818 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ******
2023-03-26 22:14:10,660 p=91818 u=craig n=ansible | changed: [caddy] => {"changed": true, "rc": 0, "stderr": "{\"level\":\"info\",\"ts\":1679883250.6366224,\"msg\":\"using adjacent Caddyfile\"}", "stderr_lines": ["{\"level\":\"info\",\"ts\":1679883250.6366224,\"msg\":\"using adjacent Caddyfile\"}"], "stdout": "", "stdout_lines": []}
2023-03-26 22:14:10,682 p=91818 u=craig n=ansible | PLAY RECAP ****************************************************************************************************
2023-03-26 22:14:10,682 p=91818 u=craig n=ansible | caddy                      : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-27 21:35:07,641 p=54031 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-27 21:35:07,641 p=54031 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-27 21:35:07,641 p=54031 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-27 21:35:07,648 p=54031 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-27 21:35:08,070 p=54031 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-27 21:35:08,083 p=54031 u=craig n=ansible | ERROR! vars file ~/Projects/homelab/vault.yaml was not found
Could not find file on the Ansible Controller.
If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-03-27 21:36:23,139 p=54310 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-27 21:36:23,139 p=54310 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-27 21:36:23,139 p=54310 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-27 21:36:23,143 p=54310 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-27 21:36:23,444 p=54310 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-27 21:36:23,463 p=54310 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-27 21:36:25,010 p=54310 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:36:25,041 p=54310 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-27 21:36:26,005 p=54310 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:36:26,024 p=54310 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-27 21:36:26,408 p=54310 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:36:26,426 p=54310 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-27 21:36:27,190 p=54310 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:36:27,221 p=54310 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-27 21:36:27,530 p=54310 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-27 21:36:27,546 p=54310 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 21:36:27,556 p=54310 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-27 21:36:27,571 p=54310 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 21:37:00,578 p=54310 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'n': 1, 't': '  Logical volume \"vm-108-disk-0\" created.'}]"}
2023-03-27 21:37:00,582 p=54310 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-27 21:37:00,582 p=54310 u=craig n=ansible | 192.168.1.99               : ok=5    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-27 21:39:47,522 p=54645 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-27 21:39:47,522 p=54645 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-27 21:39:47,522 p=54645 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-27 21:39:47,526 p=54645 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-27 21:39:47,801 p=54645 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-27 21:39:47,819 p=54645 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-27 21:39:49,324 p=54645 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:39:49,355 p=54645 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-27 21:39:50,180 p=54645 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:39:50,196 p=54645 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-27 21:39:50,563 p=54645 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:39:50,581 p=54645 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-27 21:39:51,380 p=54645 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:39:51,411 p=54645 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-27 21:39:51,714 p=54645 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-27 21:39:51,730 p=54645 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 21:39:51,742 p=54645 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-27 21:39:51,758 p=54645 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 21:39:52,204 p=54645 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:39:52,223 p=54645 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *******************************************************
2023-03-27 21:40:21,782 p=54645 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-27 21:40:21,783 p=54645 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for starting VM. Last line in task before timeout: [{'t': 'no content', 'n': 1}]"}
2023-03-27 21:40:21,785 p=54645 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-27 21:40:21,785 p=54645 u=craig n=ansible | 192.168.1.99               : ok=6    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-27 21:42:55,080 p=54983 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-27 21:42:55,080 p=54983 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-27 21:42:55,080 p=54983 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-27 21:42:55,084 p=54983 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-27 21:42:55,363 p=54983 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-27 21:42:55,381 p=54983 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-27 21:42:56,888 p=54983 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:42:56,919 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-27 21:42:57,778 p=54983 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:42:57,798 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-27 21:42:58,175 p=54983 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:42:58,193 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-27 21:42:58,979 p=54983 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:42:59,010 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-27 21:42:59,316 p=54983 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-27 21:42:59,333 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 21:42:59,343 p=54983 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-27 21:42:59,358 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 21:42:59,852 p=54983 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:42:59,872 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *******************************************************
2023-03-27 21:43:00,242 p=54983 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-27 21:43:00,242 p=54983 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 21:43:00,263 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] *********************************************************************************
2023-03-27 21:43:00,298 p=54983 u=craig n=ansible | changed: [192.168.1.99]
2023-03-27 21:43:00,324 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] ********************************************
2023-03-27 21:43:00,655 p=54983 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-03-27 21:43:00,691 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-03-27 21:43:07,760 p=54983 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.5]
2023-03-27 21:43:07,791 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-03-27 21:43:09,260 p=54983 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-27 21:43:09,291 p=54983 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-03-27 21:44:20,265 p=54983 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.5]
2023-03-27 21:44:20,298 p=54983 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] *******************************************************************************
2023-03-27 21:44:20,905 p=54983 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-27 21:44:20,977 p=54983 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: dnsmasq

2023-03-27 21:44:20,978 p=54983 u=craig n=ansible | PLAY [Create a user and lock down the container] ***********************************************************************************************************************************************************
2023-03-27 21:44:20,978 p=54983 u=craig n=ansible | skipping: no hosts matched
2023-03-27 21:44:20,995 p=54983 u=craig n=ansible | PLAY [Install gui] *****************************************************************************************************************************************************************************************
2023-03-27 21:44:20,995 p=54983 u=craig n=ansible | skipping: no hosts matched
2023-03-27 21:44:20,995 p=54983 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-27 21:44:20,995 p=54983 u=craig n=ansible | 192.168.1.99               : ok=13   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-27 22:00:24,642 p=56389 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-27 22:00:24,642 p=56389 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-27 22:00:24,642 p=56389 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-27 22:00:24,646 p=56389 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-27 22:00:24,925 p=56389 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-27 22:00:24,942 p=56389 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-27 22:00:26,479 p=56389 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 22:00:26,511 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-27 22:00:27,312 p=56389 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 22:00:27,331 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-27 22:00:27,691 p=56389 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 22:00:27,710 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-27 22:00:28,476 p=56389 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 22:00:28,506 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-27 22:00:28,817 p=56389 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-27 22:00:28,833 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 22:00:28,843 p=56389 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-27 22:00:28,859 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-27 22:00:29,298 p=56389 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 22:00:29,314 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *******************************************************
2023-03-27 22:00:29,679 p=56389 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-27 22:00:29,679 p=56389 u=craig n=ansible | ok: [192.168.1.99]
2023-03-27 22:00:29,701 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] *********************************************************************************
2023-03-27 22:00:29,727 p=56389 u=craig n=ansible | changed: [192.168.1.99]
2023-03-27 22:00:29,752 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] ********************************************
2023-03-27 22:00:30,074 p=56389 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-03-27 22:00:30,111 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-03-27 22:00:32,177 p=56389 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.5]
2023-03-27 22:00:32,207 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-03-27 22:00:33,638 p=56389 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-27 22:00:33,668 p=56389 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-03-27 22:00:34,685 p=56389 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-27 22:00:34,716 p=56389 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] *******************************************************************************
2023-03-27 22:00:35,190 p=56389 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-27 22:00:35,254 p=56389 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: dnsmasq

2023-03-27 22:00:35,254 p=56389 u=craig n=ansible | PLAY [Create a user and lock down the container] ***********************************************************************************************************************************************************
2023-03-27 22:00:35,254 p=56389 u=craig n=ansible | skipping: no hosts matched
2023-03-27 22:00:35,272 p=56389 u=craig n=ansible | PLAY [Install gui] *****************************************************************************************************************************************************************************************
2023-03-27 22:00:35,272 p=56389 u=craig n=ansible | skipping: no hosts matched
2023-03-27 22:00:35,272 p=56389 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-27 22:00:35,272 p=56389 u=craig n=ansible | 192.168.1.99               : ok=13   changed=3    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-29 18:58:02,024 p=70468 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-29 18:58:02,042 p=70468 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 18:58:03,806 p=70468 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 18:58:03,838 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-29 18:58:04,699 p=70468 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 18:58:04,721 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-29 18:58:05,072 p=70468 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 18:58:05,089 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-29 18:58:05,806 p=70468 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 18:58:05,837 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-29 18:58:06,148 p=70468 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 18:58:06,164 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 18:58:06,175 p=70468 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 18:58:06,191 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 18:58:06,654 p=70468 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 18:58:06,674 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *******************************************************
2023-03-29 18:58:07,024 p=70468 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-29 18:58:07,024 p=70468 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 18:58:07,042 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] *********************************************************************************
2023-03-29 18:58:07,074 p=70468 u=craig n=ansible | changed: [192.168.1.99]
2023-03-29 18:58:07,100 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] ********************************************
2023-03-29 18:58:07,432 p=70468 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-03-29 18:58:07,467 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-03-29 18:58:11,126 p=70468 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.5]
2023-03-29 18:58:11,157 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-03-29 18:58:12,461 p=70468 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-29 18:58:12,496 p=70468 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-03-29 18:58:13,392 p=70468 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-29 18:58:13,420 p=70468 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] *******************************************************************************
2023-03-29 18:58:13,901 p=70468 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.5]
2023-03-29 18:58:13,977 p=70468 u=craig n=ansible | PLAY [Create a user and lock down the container] ***********************************************************************************************************************************************************
2023-03-29 18:58:14,005 p=70468 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 18:58:14,961 p=70468 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 18:58:14,992 p=70468 u=craig n=ansible | TASK [create_user : Ensure group sudo exists name=sudo, state=present] *************************************************************************************************************************************
2023-03-29 18:58:15,357 p=70468 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 18:58:15,373 p=70468 u=craig n=ansible | TASK [create_user : Allow sudo group to have passwordless sudo path=/etc/sudoers, state=present, regexp=^%sudo, line=%sudo ALL=(ALL) NOPASSWD: ALL, validate=/usr/sbin/visudo -cf %s] **********************
2023-03-29 18:58:15,757 p=70468 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 18:58:15,772 p=70468 u=craig n=ansible | TASK [create_user : Create a new user name={{machine_user}}, password={{machine_password | string | password_hash('sha512')}}, shell=/bin/bash, groups=sudo, append=True] **********************************
2023-03-29 18:58:16,958 p=70468 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 18:58:16,974 p=70468 u=craig n=ansible | TASK [create_user : Create the .ssh directory path=/home/{{machine_user}}/.ssh, state=directory, mode=0700, owner={{machine_user}}, group={{machine_user}}] ************************************************
2023-03-29 18:58:17,249 p=70468 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 18:58:17,265 p=70468 u=craig n=ansible | TASK [create_user : Copy the ssh key to the new user src={{machine_ssh_key}}, dest=/home/{{machine_user}}/.ssh/authorized_keys, mode=0600, owner={{machine_user}}, group={{machine_user}}] *****************
2023-03-29 18:58:17,907 p=70468 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 18:58:17,937 p=70468 u=craig n=ansible | TASK [lockdown : Ensure the /run/sshd directory exists path=/run/sshd, state=directory, mode=493] **********************************************************************************************************
2023-03-29 18:58:18,204 p=70468 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 18:58:18,220 p=70468 u=craig n=ansible | TASK [lockdown : Update SSH configuration to be more secure dest=/etc/ssh/sshd_config, regexp={{ item.regexp }}, line={{ item.line }}, state=present, validate=sshd -T -f %s, mode=420] ********************
2023-03-29 18:58:18,502 p=70468 u=craig n=ansible | changed: [dnsmasq] => (item={'regexp': '^#?PasswordAuthentication', 'line': 'PasswordAuthentication no'})
2023-03-29 18:58:18,768 p=70468 u=craig n=ansible | changed: [dnsmasq] => (item={'regexp': '^#?PermitRootLogin', 'line': 'PermitRootLogin no'})
2023-03-29 18:58:19,039 p=70468 u=craig n=ansible | changed: [dnsmasq] => (item={'regexp': '^#?Port', 'line': 'Port 22'})
2023-03-29 18:58:19,310 p=70468 u=craig n=ansible | changed: [dnsmasq] => (item={'regexp': '^#?PermitEmptyPasswords', 'line': 'PermitEmptyPasswords no'})
2023-03-29 18:58:19,346 p=70468 u=craig n=ansible | RUNNING HANDLER [restart ssh name=sshd, state=restarted] ***************************************************************************************************************************************************
2023-03-29 18:58:19,989 p=70468 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 18:58:20,035 p=70468 u=craig n=ansible | PLAY [Install gui] *****************************************************************************************************************************************************************************************
2023-03-29 18:58:20,050 p=70468 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 18:58:21,105 p=70468 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 18:58:21,134 p=70468 u=craig n=ansible | TASK [lxc_gui : Ensure system is up to date update_cache=True, upgrade=True] *******************************************************************************************************************************
2023-03-29 18:58:21,144 p=70468 u=craig n=ansible | skipping: [dnsmasq]
2023-03-29 18:58:21,159 p=70468 u=craig n=ansible | TASK [lxc_gui : Install xrdp and Xfce4 desktop and force if needed and install dependencies and recommends name={{item}}, state=present, force=True, install_recommends=True] ******************************
2023-03-29 18:58:21,173 p=70468 u=craig n=ansible | skipping: [dnsmasq] => (item=xfce4) 
2023-03-29 18:58:21,174 p=70468 u=craig n=ansible | skipping: [dnsmasq] => (item=xfce4-session) 
2023-03-29 18:58:21,174 p=70468 u=craig n=ansible | skipping: [dnsmasq] => (item=xrdp) 
2023-03-29 18:58:21,190 p=70468 u=craig n=ansible | TASK [lxc_gui : Make sure xrdp is running name=xrdp, state=started, enabled=True] **************************************************************************************************************************
2023-03-29 18:58:21,201 p=70468 u=craig n=ansible | skipping: [dnsmasq]
2023-03-29 18:58:21,216 p=70468 u=craig n=ansible | TASK [lxc_gui : Install chrome using wget and apt install deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb, state=present, force=True, install_recommends=True] ***************
2023-03-29 18:58:21,227 p=70468 u=craig n=ansible | skipping: [dnsmasq]
2023-03-29 18:58:21,270 p=70468 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 18:58:21,270 p=70468 u=craig n=ansible | 192.168.1.99               : ok=13   changed=3    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-29 18:58:21,270 p=70468 u=craig n=ansible | dnsmasq                    : ok=10   changed=6    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2023-03-29 18:59:41,403 p=70923 u=craig n=ansible | PLAY [Install and run dnsmasq in Docker] *******************************************************************************************************************************************************************
2023-03-29 18:59:41,420 p=70923 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 18:59:42,705 p=70923 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 18:59:42,722 p=70923 u=craig n=ansible | TASK [ansible.builtin.include_vars file=./config.json] *****************************************************************************************************************************************************
2023-03-29 18:59:42,734 p=70923 u=craig n=ansible | fatal: [dnsmasq]: FAILED! => {"ansible_facts": {}, "ansible_included_var_files": [], "changed": false, "message": "Could not find or access './config.json'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/vars/./config.json\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/./config.json\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/vars/./config.json\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/./config.json on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-03-29 18:59:42,735 p=70923 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 18:59:42,735 p=70923 u=craig n=ansible | dnsmasq                    : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-29 19:00:40,112 p=71037 u=craig n=ansible | PLAY [Install and run dnsmasq in Docker] *******************************************************************************************************************************************************************
2023-03-29 19:00:40,129 p=71037 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 19:00:41,190 p=71037 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 19:00:41,219 p=71037 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-29 19:00:42,420 p=71037 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 19:00:42,439 p=71037 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-29 19:00:44,362 p=71037 u=craig n=ansible | changed: [dnsmasq] => (item=apt-transport-https)
2023-03-29 19:00:45,061 p=71037 u=craig n=ansible | ok: [dnsmasq] => (item=ca-certificates)
2023-03-29 19:00:48,661 p=71037 u=craig n=ansible | changed: [dnsmasq] => (item=curl)
2023-03-29 19:00:54,230 p=71037 u=craig n=ansible | changed: [dnsmasq] => (item=gnupg)
2023-03-29 19:00:54,998 p=71037 u=craig n=ansible | ok: [dnsmasq] => (item=lsb-release)
2023-03-29 19:01:09,271 p=71037 u=craig n=ansible | changed: [dnsmasq] => (item=software-properties-common)
2023-03-29 19:01:09,295 p=71037 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-29 19:01:10,089 p=71037 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 19:01:10,107 p=71037 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-29 19:01:12,399 p=71037 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 19:01:12,417 p=71037 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-29 19:01:36,400 p=71037 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 19:01:36,420 p=71037 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-29 19:01:37,138 p=71037 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 19:01:37,157 p=71037 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-29 19:01:37,624 p=71037 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 19:01:37,640 p=71037 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-29 19:02:10,474 p=71037 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 19:02:10,495 p=71037 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-29 19:02:16,192 p=71037 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 19:02:16,225 p=71037 u=craig n=ansible | TASK [Create configuration directory path=/opt/dnsmasq/config, state=directory, owner=root, group=root, mode=493] ******************************************************************************************
2023-03-29 19:02:16,613 p=71037 u=craig n=ansible | changed: [dnsmasq]
2023-03-29 19:02:16,630 p=71037 u=craig n=ansible | TASK [Configure dnsmasq src=config_dnsmasq.conf.j2, dest=/opt/dnsmasq/config/dnsmasq.conf, owner=root, group=root, mode=420] *******************************************************************************
2023-03-29 19:02:16,699 p=71037 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-03-29 19:02:16,699 p=71037 u=craig n=ansible | fatal: [dnsmasq]: FAILED! => {"changed": false, "msg": "Could not find or access 'config_dnsmasq.conf.j2'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/templates/config_dnsmasq.conf.j2\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/config_dnsmasq.conf.j2\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/templates/config_dnsmasq.conf.j2\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/config_dnsmasq.conf.j2 on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-03-29 19:02:16,700 p=71037 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 19:02:16,700 p=71037 u=craig n=ansible | dnsmasq                    : ok=11   changed=8    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-29 19:03:20,209 p=71413 u=craig n=ansible | PLAY [Install and run dnsmasq in Docker] *******************************************************************************************************************************************************************
2023-03-29 19:03:20,226 p=71413 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 19:03:21,647 p=71413 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 19:03:21,661 p=71413 u=craig n=ansible | TASK [Create configuration directory path=/opt/dnsmasq/config, state=directory, owner=root, group=root, mode=493] ******************************************************************************************
2023-03-29 19:03:22,018 p=71413 u=craig n=ansible | ok: [dnsmasq]
2023-03-29 19:03:22,035 p=71413 u=craig n=ansible | TASK [Configure dnsmasq src=config_dnsmasq.conf.j2, dest=/opt/dnsmasq/config/dnsmasq.conf, owner=root, group=root, mode=420] *******************************************************************************
2023-03-29 19:03:22,106 p=71413 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-03-29 19:03:22,106 p=71413 u=craig n=ansible | fatal: [dnsmasq]: FAILED! => {"changed": false, "msg": "Could not find or access 'config_dnsmasq.conf.j2'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/templates/config_dnsmasq.conf.j2\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/config_dnsmasq.conf.j2\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/templates/config_dnsmasq.conf.j2\n\t/Users/craig/Projects/homelab/ansible/playbooks/dns/config_dnsmasq.conf.j2 on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-03-29 19:03:22,107 p=71413 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 19:03:22,107 p=71413 u=craig n=ansible | dnsmasq                    : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-29 19:54:37,251 p=73663 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-29 19:54:37,251 p=73663 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-29 19:54:37,251 p=73663 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-29 19:54:37,255 p=73663 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-29 19:54:37,557 p=73663 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-29 19:54:37,575 p=73663 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 19:54:39,023 p=73663 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:54:39,055 p=73663 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-29 19:54:39,864 p=73663 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:54:39,882 p=73663 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-29 19:54:40,240 p=73663 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:54:40,258 p=73663 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-29 19:54:40,971 p=73663 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:54:41,000 p=73663 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-29 19:54:41,306 p=73663 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 19:54:41,321 p=73663 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 19:54:41,332 p=73663 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 19:54:41,347 p=73663 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 19:55:20,045 p=73663 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'t': '  Logical volume \"vm-112-disk-0\" created.', 'n': 1}]"}
2023-03-29 19:55:20,047 p=73663 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 19:55:20,047 p=73663 u=craig n=ansible | 192.168.1.99               : ok=5    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-29 19:56:39,913 p=74005 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-29 19:56:39,913 p=74005 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-29 19:56:39,913 p=74005 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-29 19:56:39,917 p=74005 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-29 19:56:40,214 p=74005 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ********************************************************************************************************************************************************************
2023-03-29 19:56:40,232 p=74005 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************
2023-03-29 19:56:41,733 p=74005 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:56:41,764 p=74005 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************
2023-03-29 19:56:42,589 p=74005 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:56:42,611 p=74005 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************
2023-03-29 19:56:42,969 p=74005 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:56:42,987 p=74005 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************
2023-03-29 19:56:43,734 p=74005 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:56:43,769 p=74005 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ****************************************************************************************************
2023-03-29 19:56:44,084 p=74005 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 19:56:44,099 p=74005 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 19:56:44,111 p=74005 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 19:56:44,127 p=74005 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 19:56:44,580 p=74005 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 19:56:44,602 p=74005 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *********************************************************
2023-03-29 19:57:14,136 p=74005 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-29 19:57:14,137 p=74005 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for starting VM. Last line in task before timeout: [{'n': 1, 't': 'no content'}]"}
2023-03-29 19:57:14,138 p=74005 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************
2023-03-29 19:57:14,138 p=74005 u=craig n=ansible | 192.168.1.99               : ok=6    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-29 20:06:32,060 p=74945 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-29 20:06:32,060 p=74945 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-29 20:06:32,060 p=74945 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-29 20:06:32,065 p=74945 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-29 20:06:32,447 p=74945 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-29 20:06:32,465 p=74945 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 20:06:34,102 p=74945 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:06:34,134 p=74945 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-29 20:06:34,991 p=74945 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:06:35,007 p=74945 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-29 20:06:35,374 p=74945 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:06:35,391 p=74945 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-29 20:06:36,104 p=74945 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:06:36,134 p=74945 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-29 20:06:36,457 p=74945 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 20:06:36,473 p=74945 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:06:36,483 p=74945 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 20:06:36,500 p=74945 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:06:36,948 p=74945 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:06:36,964 p=74945 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *******************************************************
2023-03-29 20:07:15,347 p=74945 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-29 20:07:15,348 p=74945 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for starting VM. Last line in task before timeout: [{'t': \"TASK ERROR: Configuration file 'nodes/bigprox/lxc/112.conf' does not exist\", 'n': 1}]"}
2023-03-29 20:07:15,349 p=74945 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 20:07:15,349 p=74945 u=craig n=ansible | 192.168.1.99               : ok=6    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-29 20:15:32,385 p=75714 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-29 20:15:32,385 p=75714 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-29 20:15:32,386 p=75714 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-29 20:15:32,390 p=75714 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-29 20:15:32,686 p=75714 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-29 20:15:32,704 p=75714 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 20:15:34,229 p=75714 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:15:34,259 p=75714 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-29 20:15:35,096 p=75714 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:15:35,113 p=75714 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-29 20:15:35,467 p=75714 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:15:35,484 p=75714 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-29 20:15:36,201 p=75714 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:15:36,228 p=75714 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-29 20:15:36,584 p=75714 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 20:15:36,600 p=75714 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:15:36,610 p=75714 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 20:15:36,626 p=75714 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:16:11,903 p=75714 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'n': 1, 't': '  Logical volume \"vm-112-disk-0\" created.'}]"}
2023-03-29 20:16:11,905 p=75714 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 20:16:11,905 p=75714 u=craig n=ansible | 192.168.1.99               : ok=5    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-29 20:19:13,806 p=76154 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-03-29 20:19:13,806 p=76154 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-03-29 20:19:13,806 p=76154 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-03-29 20:19:13,810 p=76154 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-03-29 20:19:14,115 p=76154 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-29 20:19:14,133 p=76154 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 20:19:15,627 p=76154 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:19:15,658 p=76154 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-29 20:19:16,528 p=76154 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:19:16,546 p=76154 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-29 20:19:16,890 p=76154 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:19:16,906 p=76154 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-29 20:19:17,600 p=76154 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:19:17,627 p=76154 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-29 20:19:17,950 p=76154 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 20:19:17,967 p=76154 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:19:17,977 p=76154 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 20:19:17,993 p=76154 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:20:06,887 p=76154 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'t': '  Logical volume \"vm-112-disk-0\" created.', 'n': 1}]"}
2023-03-29 20:20:06,889 p=76154 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 20:20:06,890 p=76154 u=craig n=ansible | 192.168.1.99               : ok=5    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-29 20:21:30,711 p=76453 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-29 20:21:30,729 p=76453 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 20:21:32,221 p=76453 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:21:32,252 p=76453 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-29 20:21:33,068 p=76453 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:21:33,087 p=76453 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-29 20:21:33,439 p=76453 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:21:33,456 p=76453 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-29 20:21:34,207 p=76453 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:21:34,238 p=76453 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-29 20:21:34,542 p=76453 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 20:21:34,558 p=76453 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:21:34,569 p=76453 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 20:21:34,585 p=76453 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:21:35,031 p=76453 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:21:35,049 p=76453 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *******************************************************
2023-03-29 20:22:04,566 p=76453 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-29 20:22:04,567 p=76453 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for starting VM. Last line in task before timeout: [{'n': 1, 't': 'no content'}]"}
2023-03-29 20:22:04,568 p=76453 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 20:22:04,568 p=76453 u=craig n=ansible | 192.168.1.99               : ok=6    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-29 20:22:09,927 p=76633 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ******************************************************************************************************************************************************************
2023-03-29 20:22:09,944 p=76633 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 20:22:11,247 p=76633 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:22:11,279 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-03-29 20:22:12,082 p=76633 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:22:12,101 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-03-29 20:22:12,450 p=76633 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:22:12,468 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-03-29 20:22:13,208 p=76633 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:22:13,239 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] **************************************************************************************************
2023-03-29 20:22:13,548 p=76633 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-03-29 20:22:13,564 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:22:13,574 p=76633 u=craig n=ansible | skipping: [192.168.1.99]
2023-03-29 20:22:13,590 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-03-29 20:22:14,049 p=76633 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:22:14,068 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *******************************************************
2023-03-29 20:22:14,418 p=76633 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-03-29 20:22:14,419 p=76633 u=craig n=ansible | ok: [192.168.1.99]
2023-03-29 20:22:14,439 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] *********************************************************************************
2023-03-29 20:22:14,473 p=76633 u=craig n=ansible | changed: [192.168.1.99]
2023-03-29 20:22:14,499 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] ********************************************
2023-03-29 20:22:14,836 p=76633 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-03-29 20:22:14,871 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-03-29 20:22:19,467 p=76633 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.8]
2023-03-29 20:22:19,498 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-03-29 20:22:20,661 p=76633 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.8]
2023-03-29 20:22:20,688 p=76633 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-03-29 20:23:23,255 p=76633 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.8]
2023-03-29 20:23:23,285 p=76633 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] *******************************************************************************
2023-03-29 20:23:23,841 p=76633 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.8]
2023-03-29 20:23:23,916 p=76633 u=craig n=ansible | PLAY [Create a user and lock down the container] ***********************************************************************************************************************************************************
2023-03-29 20:23:23,929 p=76633 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 20:23:24,863 p=76633 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 20:23:24,894 p=76633 u=craig n=ansible | TASK [create_user : Ensure group sudo exists name=sudo, state=present] *************************************************************************************************************************************
2023-03-29 20:23:25,273 p=76633 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 20:23:25,289 p=76633 u=craig n=ansible | TASK [create_user : Allow sudo group to have passwordless sudo path=/etc/sudoers, state=present, regexp=^%sudo, line=%sudo ALL=(ALL) NOPASSWD: ALL, validate=/usr/sbin/visudo -cf %s] **********************
2023-03-29 20:23:25,674 p=76633 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 20:23:25,690 p=76633 u=craig n=ansible | TASK [create_user : Create a new user name={{machine_user}}, password={{machine_password | string | password_hash('sha512')}}, shell=/bin/bash, groups=sudo, append=True] **********************************
2023-03-29 20:23:26,902 p=76633 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 20:23:26,921 p=76633 u=craig n=ansible | TASK [create_user : Create the .ssh directory path=/home/{{machine_user}}/.ssh, state=directory, mode=0700, owner={{machine_user}}, group={{machine_user}}] ************************************************
2023-03-29 20:23:27,208 p=76633 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 20:23:27,227 p=76633 u=craig n=ansible | TASK [create_user : Copy the ssh key to the new user src={{machine_ssh_key}}, dest=/home/{{machine_user}}/.ssh/authorized_keys, mode=0600, owner={{machine_user}}, group={{machine_user}}] *****************
2023-03-29 20:23:27,901 p=76633 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 20:23:27,931 p=76633 u=craig n=ansible | TASK [lockdown : Ensure the /run/sshd directory exists path=/run/sshd, state=directory, mode=493] **********************************************************************************************************
2023-03-29 20:23:28,232 p=76633 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 20:23:28,251 p=76633 u=craig n=ansible | TASK [lockdown : Update SSH configuration to be more secure dest=/etc/ssh/sshd_config, regexp={{ item.regexp }}, line={{ item.line }}, state=present, validate=sshd -T -f %s, mode=420] ********************
2023-03-29 20:23:28,551 p=76633 u=craig n=ansible | changed: [unbound-dns] => (item={'regexp': '^#?PasswordAuthentication', 'line': 'PasswordAuthentication no'})
2023-03-29 20:23:28,843 p=76633 u=craig n=ansible | changed: [unbound-dns] => (item={'regexp': '^#?PermitRootLogin', 'line': 'PermitRootLogin no'})
2023-03-29 20:23:29,130 p=76633 u=craig n=ansible | changed: [unbound-dns] => (item={'regexp': '^#?Port', 'line': 'Port 22'})
2023-03-29 20:23:29,402 p=76633 u=craig n=ansible | changed: [unbound-dns] => (item={'regexp': '^#?PermitEmptyPasswords', 'line': 'PermitEmptyPasswords no'})
2023-03-29 20:23:29,434 p=76633 u=craig n=ansible | RUNNING HANDLER [restart ssh name=sshd, state=restarted] ***************************************************************************************************************************************************
2023-03-29 20:23:30,174 p=76633 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 20:23:30,221 p=76633 u=craig n=ansible | PLAY [Install gui] *****************************************************************************************************************************************************************************************
2023-03-29 20:23:30,236 p=76633 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 20:23:31,557 p=76633 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 20:23:31,587 p=76633 u=craig n=ansible | TASK [lxc_gui : Ensure system is up to date update_cache=True, upgrade=True] *******************************************************************************************************************************
2023-03-29 20:23:31,599 p=76633 u=craig n=ansible | skipping: [unbound-dns]
2023-03-29 20:23:31,614 p=76633 u=craig n=ansible | TASK [lxc_gui : Install xrdp and Xfce4 desktop and force if needed and install dependencies and recommends name={{item}}, state=present, force=True, install_recommends=True] ******************************
2023-03-29 20:23:31,629 p=76633 u=craig n=ansible | skipping: [unbound-dns] => (item=xfce4) 
2023-03-29 20:23:31,632 p=76633 u=craig n=ansible | skipping: [unbound-dns] => (item=xfce4-session) 
2023-03-29 20:23:31,632 p=76633 u=craig n=ansible | skipping: [unbound-dns] => (item=xrdp) 
2023-03-29 20:23:31,650 p=76633 u=craig n=ansible | TASK [lxc_gui : Make sure xrdp is running name=xrdp, state=started, enabled=True] **************************************************************************************************************************
2023-03-29 20:23:31,661 p=76633 u=craig n=ansible | skipping: [unbound-dns]
2023-03-29 20:23:31,680 p=76633 u=craig n=ansible | TASK [lxc_gui : Install chrome using wget and apt install deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb, state=present, force=True, install_recommends=True] ***************
2023-03-29 20:23:31,691 p=76633 u=craig n=ansible | skipping: [unbound-dns]
2023-03-29 20:23:31,738 p=76633 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 20:23:31,738 p=76633 u=craig n=ansible | 192.168.1.99               : ok=13   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-03-29 20:23:31,738 p=76633 u=craig n=ansible | unbound-dns                : ok=10   changed=7    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2023-03-29 22:30:50,387 p=83873 u=craig n=ansible | PLAY [Configure and Deploy Unbound container using Ansible] ************************************************************************************************************************************************
2023-03-29 22:30:50,405 p=83873 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 22:30:51,768 p=83873 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:30:51,798 p=83873 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-29 22:30:53,681 p=83873 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:30:53,702 p=83873 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-29 22:30:55,790 p=83873 u=craig n=ansible | changed: [unbound-dns] => (item=apt-transport-https)
2023-03-29 22:30:56,547 p=83873 u=craig n=ansible | ok: [unbound-dns] => (item=ca-certificates)
2023-03-29 22:31:00,664 p=83873 u=craig n=ansible | changed: [unbound-dns] => (item=curl)
2023-03-29 22:31:04,939 p=83873 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-29 22:32:11,066 p=84066 u=craig n=ansible | PLAY [Configure and Deploy Unbound container using Ansible] ************************************************************************************************************************************************
2023-03-29 22:32:11,084 p=84066 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 22:32:12,435 p=84066 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:32:12,463 p=84066 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-29 22:32:13,861 p=84066 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:32:13,881 p=84066 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-29 22:32:14,688 p=84066 u=craig n=ansible | ok: [unbound-dns] => (item=apt-transport-https)
2023-03-29 22:32:15,429 p=84066 u=craig n=ansible | ok: [unbound-dns] => (item=ca-certificates)
2023-03-29 22:32:16,156 p=84066 u=craig n=ansible | ok: [unbound-dns] => (item=curl)
2023-03-29 22:32:16,932 p=84066 u=craig n=ansible | ok: [unbound-dns] => (item=gnupg)
2023-03-29 22:32:17,668 p=84066 u=craig n=ansible | ok: [unbound-dns] => (item=lsb-release)
2023-03-29 22:32:31,499 p=84066 u=craig n=ansible | changed: [unbound-dns] => (item=software-properties-common)
2023-03-29 22:32:31,522 p=84066 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-29 22:32:32,390 p=84066 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:32:32,411 p=84066 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-29 22:32:34,740 p=84066 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:32:34,762 p=84066 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-29 22:32:58,616 p=84066 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:32:58,637 p=84066 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-29 22:32:59,381 p=84066 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:32:59,400 p=84066 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-29 22:32:59,898 p=84066 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:32:59,920 p=84066 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-29 22:33:31,975 p=84066 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:33:31,998 p=84066 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-29 22:33:37,836 p=84066 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:33:37,873 p=84066 u=craig n=ansible | TASK [Generate unbound.conf from Jinja2 template src=unbound.conf.j2, dest=/path/to/output/unbound.conf] ***************************************************************************************************
2023-03-29 22:33:38,707 p=84066 u=craig n=ansible | fatal: [unbound-dns]: FAILED! => {"changed": false, "checksum": "b7eb0ed85b7e2ee25e3963f770d082235e67ca24", "msg": "Destination directory /path/to/output does not exist"}
2023-03-29 22:33:38,708 p=84066 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 22:33:38,708 p=84066 u=craig n=ansible | unbound-dns                : ok=10   changed=7    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-29 22:34:44,249 p=84449 u=craig n=ansible | PLAY [Configure and Deploy Unbound container using Ansible] ************************************************************************************************************************************************
2023-03-29 22:34:44,267 p=84449 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 22:34:45,667 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:45,696 p=84449 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-29 22:34:47,640 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:47,662 p=84449 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-29 22:34:48,502 p=84449 u=craig n=ansible | ok: [unbound-dns] => (item=apt-transport-https)
2023-03-29 22:34:49,322 p=84449 u=craig n=ansible | ok: [unbound-dns] => (item=ca-certificates)
2023-03-29 22:34:50,137 p=84449 u=craig n=ansible | ok: [unbound-dns] => (item=curl)
2023-03-29 22:34:50,947 p=84449 u=craig n=ansible | ok: [unbound-dns] => (item=gnupg)
2023-03-29 22:34:51,867 p=84449 u=craig n=ansible | ok: [unbound-dns] => (item=lsb-release)
2023-03-29 22:34:52,686 p=84449 u=craig n=ansible | ok: [unbound-dns] => (item=software-properties-common)
2023-03-29 22:34:52,710 p=84449 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-29 22:34:53,395 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:53,414 p=84449 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-29 22:34:54,019 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:54,040 p=84449 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-29 22:34:54,938 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:54,959 p=84449 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-29 22:34:55,630 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:55,648 p=84449 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-29 22:34:56,103 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:56,121 p=84449 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-29 22:34:56,937 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:56,959 p=84449 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-29 22:34:58,118 p=84449 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:34:58,154 p=84449 u=craig n=ansible | TASK [Generate unbound.conf from Jinja2 template src=unbound.conf.j2, dest=/path/to/output/unbound.conf] ***************************************************************************************************
2023-03-29 22:34:58,957 p=84449 u=craig n=ansible | fatal: [unbound-dns]: FAILED! => {"changed": false, "checksum": "b7eb0ed85b7e2ee25e3963f770d082235e67ca24", "msg": "Destination directory /path/to/output does not exist"}
2023-03-29 22:34:58,958 p=84449 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 22:34:58,958 p=84449 u=craig n=ansible | unbound-dns                : ok=10   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-29 22:39:45,790 p=84982 u=craig n=ansible | PLAY [Configure and Deploy Unbound container using Ansible] ************************************************************************************************************************************************
2023-03-29 22:39:45,808 p=84982 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 22:39:47,202 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:47,230 p=84982 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-29 22:39:48,925 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:48,945 p=84982 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-29 22:39:49,790 p=84982 u=craig n=ansible | ok: [unbound-dns] => (item=apt-transport-https)
2023-03-29 22:39:50,611 p=84982 u=craig n=ansible | ok: [unbound-dns] => (item=ca-certificates)
2023-03-29 22:39:51,406 p=84982 u=craig n=ansible | ok: [unbound-dns] => (item=curl)
2023-03-29 22:39:52,198 p=84982 u=craig n=ansible | ok: [unbound-dns] => (item=gnupg)
2023-03-29 22:39:53,010 p=84982 u=craig n=ansible | ok: [unbound-dns] => (item=lsb-release)
2023-03-29 22:39:53,805 p=84982 u=craig n=ansible | ok: [unbound-dns] => (item=software-properties-common)
2023-03-29 22:39:53,828 p=84982 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-29 22:39:54,499 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:54,518 p=84982 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-29 22:39:55,094 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:55,113 p=84982 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-29 22:39:55,871 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:55,887 p=84982 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-29 22:39:56,580 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:56,598 p=84982 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-29 22:39:57,064 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:57,083 p=84982 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-29 22:39:57,944 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:57,965 p=84982 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-29 22:39:59,052 p=84982 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:39:59,084 p=84982 u=craig n=ansible | TASK [Create output directory for generated configs path={{ config_output_dir }}, state=directory, mode=0755] **********************************************************************************************
2023-03-29 22:39:59,480 p=84982 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:39:59,499 p=84982 u=craig n=ansible | TASK [Generate unbound.conf from Jinja2 template src=unbound.conf.j2, dest={{ config_output_dir }}/unbound.conf] *******************************************************************************************
2023-03-29 22:40:00,325 p=84982 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:40:00,342 p=84982 u=craig n=ansible | TASK [Ensure Unbound container is running name=unbound-dns, image=mvance/unbound:latest, state=started, restart_policy=always, ports=['53:53/udp', '53:53/tcp'], volumes=['{{ config_output_dir }}/unbound.conf:/opt/unbound/etc/unbound/unbound.conf:ro']] ***
2023-03-29 22:40:13,445 p=84982 u=craig n=ansible | fatal: [unbound-dns]: FAILED! => {"changed": false, "msg": "Error starting container 75aa27d2ecd13fc46fdb32541faa4f4f6b18e830cf30177a951e79fc6e15eef0: 500 Server Error for http+docker://localhost/v1.42/containers/75aa27d2ecd13fc46fdb32541faa4f4f6b18e830cf30177a951e79fc6e15eef0/start: Internal Server Error (\"driver failed programming external connectivity on endpoint unbound-dns (c584fa1d35bea10760db73c97b8b74daefeff742dea03d9802fd21ba42c5a5f2): Error starting userland proxy: listen tcp4 0.0.0.0:53: bind: address already in use\")"}
2023-03-29 22:40:13,447 p=84982 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 22:40:13,447 p=84982 u=craig n=ansible | unbound-dns                : ok=12   changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-29 22:44:50,718 p=85518 u=craig n=ansible | PLAY [Configure and Deploy Unbound container using Ansible] ************************************************************************************************************************************************
2023-03-29 22:44:50,735 p=85518 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 22:44:52,256 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:44:52,285 p=85518 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-29 22:44:54,008 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:44:54,027 p=85518 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-29 22:44:54,892 p=85518 u=craig n=ansible | ok: [unbound-dns] => (item=apt-transport-https)
2023-03-29 22:44:55,698 p=85518 u=craig n=ansible | ok: [unbound-dns] => (item=ca-certificates)
2023-03-29 22:44:56,536 p=85518 u=craig n=ansible | ok: [unbound-dns] => (item=curl)
2023-03-29 22:44:57,370 p=85518 u=craig n=ansible | ok: [unbound-dns] => (item=gnupg)
2023-03-29 22:44:58,160 p=85518 u=craig n=ansible | ok: [unbound-dns] => (item=lsb-release)
2023-03-29 22:44:59,008 p=85518 u=craig n=ansible | ok: [unbound-dns] => (item=software-properties-common)
2023-03-29 22:44:59,033 p=85518 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-29 22:44:59,689 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:44:59,709 p=85518 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-29 22:45:00,279 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:00,298 p=85518 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-29 22:45:01,151 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:01,170 p=85518 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-29 22:45:01,839 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:01,857 p=85518 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-29 22:45:02,315 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:02,333 p=85518 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-29 22:45:03,200 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:03,220 p=85518 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-29 22:45:04,429 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:04,461 p=85518 u=craig n=ansible | TASK [Check if systemd-resolved is running name=systemd-resolved, state=stopped, enabled=False] ************************************************************************************************************
2023-03-29 22:45:05,148 p=85518 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:45:05,167 p=85518 u=craig n=ansible | TASK [Stop systemd-resolved name=systemd-resolved, state=stopped] ******************************************************************************************************************************************
2023-03-29 22:45:05,565 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:05,586 p=85518 u=craig n=ansible | TASK [Disable systemd-resolved name=systemd-resolved, enabled=False] ***************************************************************************************************************************************
2023-03-29 22:45:05,987 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:06,006 p=85518 u=craig n=ansible | TASK [Create output directory for generated configs path={{ config_output_dir }}, state=directory, mode=0755] **********************************************************************************************
2023-03-29 22:45:06,387 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:06,404 p=85518 u=craig n=ansible | TASK [Generate unbound.conf from Jinja2 template src=unbound.conf.j2, dest={{ config_output_dir }}/unbound.conf] *******************************************************************************************
2023-03-29 22:45:07,023 p=85518 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:45:07,041 p=85518 u=craig n=ansible | TASK [Ensure Unbound container is running name=unbound-dns, image=mvance/unbound:latest, state=started, restart_policy=always, ports=['53:53/udp', '53:53/tcp'], volumes=['{{ config_output_dir }}/unbound.conf:/opt/unbound/etc/unbound/unbound.conf:ro']] ***
2023-03-29 22:45:08,423 p=85518 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:45:08,454 p=85518 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 22:45:08,454 p=85518 u=craig n=ansible | unbound-dns                : ok=16   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-03-29 22:54:36,333 p=86590 u=craig n=ansible | PLAY [Configure and Deploy Unbound container using Ansible] ************************************************************************************************************************************************
2023-03-29 22:54:36,350 p=86590 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-29 22:54:37,846 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:37,876 p=86590 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-03-29 22:54:42,749 p=86590 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:54:42,774 p=86590 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-03-29 22:54:43,712 p=86590 u=craig n=ansible | ok: [unbound-dns] => (item=apt-transport-https)
2023-03-29 22:54:44,440 p=86590 u=craig n=ansible | ok: [unbound-dns] => (item=ca-certificates)
2023-03-29 22:54:45,174 p=86590 u=craig n=ansible | ok: [unbound-dns] => (item=curl)
2023-03-29 22:54:45,926 p=86590 u=craig n=ansible | ok: [unbound-dns] => (item=gnupg)
2023-03-29 22:54:46,648 p=86590 u=craig n=ansible | ok: [unbound-dns] => (item=lsb-release)
2023-03-29 22:54:47,382 p=86590 u=craig n=ansible | ok: [unbound-dns] => (item=software-properties-common)
2023-03-29 22:54:47,406 p=86590 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-03-29 22:54:48,069 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:48,091 p=86590 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-03-29 22:54:48,614 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:48,632 p=86590 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-03-29 22:54:49,359 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:49,378 p=86590 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-03-29 22:54:49,998 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:50,014 p=86590 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-03-29 22:54:50,439 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:50,457 p=86590 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-03-29 22:54:51,193 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:51,213 p=86590 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] *************************************************************************************************
2023-03-29 22:54:52,550 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:52,583 p=86590 u=craig n=ansible | TASK [Check if systemd-resolved is running name=systemd-resolved, state=stopped, enabled=False] ************************************************************************************************************
2023-03-29 22:54:52,984 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:53,005 p=86590 u=craig n=ansible | TASK [Stop systemd-resolved name=systemd-resolved, state=stopped] ******************************************************************************************************************************************
2023-03-29 22:54:53,016 p=86590 u=craig n=ansible | skipping: [unbound-dns]
2023-03-29 22:54:53,031 p=86590 u=craig n=ansible | TASK [Disable systemd-resolved name=systemd-resolved, enabled=False] ***************************************************************************************************************************************
2023-03-29 22:54:53,046 p=86590 u=craig n=ansible | skipping: [unbound-dns]
2023-03-29 22:54:53,061 p=86590 u=craig n=ansible | TASK [Create output directory for generated configs path={{ config_output_dir }}, state=directory, mode=0755] **********************************************************************************************
2023-03-29 22:54:53,439 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:53,457 p=86590 u=craig n=ansible | TASK [Generate unbound.conf from Jinja2 template src=unbound.conf.j2, dest={{ config_output_dir }}/unbound.conf] *******************************************************************************************
2023-03-29 22:54:54,280 p=86590 u=craig n=ansible | changed: [unbound-dns]
2023-03-29 22:54:54,296 p=86590 u=craig n=ansible | TASK [Ensure Unbound container is running name=unbound-dns, image=mvance/unbound:latest, state=started, restart_policy=always, ports=['53:53/udp', '53:53/tcp'], volumes=['{{ config_output_dir }}/unbound.conf:/opt/unbound/etc/unbound/unbound.conf:ro']] ***
2023-03-29 22:54:55,145 p=86590 u=craig n=ansible | ok: [unbound-dns]
2023-03-29 22:54:55,178 p=86590 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-29 22:54:55,178 p=86590 u=craig n=ansible | unbound-dns                : ok=14   changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-03-30 21:01:52,585 p=21474 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:01:52,595 p=21474 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:01:54,283 p=21474 u=craig n=ansible | ok: [caddy]
2023-03-30 21:01:54,311 p=21474 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:01:54,965 p=21474 u=craig n=ansible | ok: [caddy]
2023-03-30 21:01:54,975 p=21474 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:01:55,359 p=21474 u=craig n=ansible | ok: [caddy]
2023-03-30 21:01:55,369 p=21474 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-30 21:01:56,147 p=21474 u=craig n=ansible | changed: [caddy]
2023-03-30 21:01:56,154 p=21474 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:01:56,676 p=21474 u=craig n=ansible | ok: [caddy]
2023-03-30 21:01:56,687 p=21474 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:01:56,761 p=21474 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'google_domains_api_key' is undefined
2023-03-30 21:01:56,761 p=21474 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'google_domains_api_key' is undefined"}
2023-03-30 21:01:56,762 p=21474 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:01:56,762 p=21474 u=craig n=ansible | caddy                      : ok=5    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-03-30 21:03:49,009 p=21743 u=craig n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context

The error appears to be in '/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/caddy.yaml': line 4, column 14, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


   vars_files: ../../../secrets.yaml
             ^ here

2023-03-30 21:04:03,855 p=21796 u=craig n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context

The error appears to be in '/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/caddy.yaml': line 4, column 14, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


   vars_files:
             ^ here

2023-03-30 21:04:43,845 p=21854 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:04:43,855 p=21854 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:04:45,289 p=21854 u=craig n=ansible | ok: [caddy]
2023-03-30 21:04:45,296 p=21854 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:04:45,319 p=21854 u=craig n=ansible | ok: [caddy]
2023-03-30 21:04:45,331 p=21854 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:04:45,904 p=21854 u=craig n=ansible | ok: [caddy]
2023-03-30 21:04:45,914 p=21854 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:04:46,288 p=21854 u=craig n=ansible | ok: [caddy]
2023-03-30 21:04:46,297 p=21854 u=craig n=ansible | TASK [caddy_docker : Copy Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ******************************************************************************************************************************
2023-03-30 21:04:47,179 p=21854 u=craig n=ansible | ok: [caddy]
2023-03-30 21:04:47,190 p=21854 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:04:47,891 p=21854 u=craig n=ansible | ok: [caddy]
2023-03-30 21:04:47,902 p=21854 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:04:48,419 p=21854 u=craig n=ansible | ok: [caddy]
2023-03-30 21:04:48,429 p=21854 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 21:08:07,325 p=21854 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-03-30 21:08:09,770 p=22225 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:08:09,779 p=22225 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:08:10,989 p=22225 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:10,998 p=22225 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:08:11,020 p=22225 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:11,032 p=22225 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:08:11,685 p=22225 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:11,695 p=22225 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:08:12,064 p=22225 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:12,074 p=22225 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:08:12,086 p=22225 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:08:12,092 p=22225 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=updated_Caddyfile, dest=/opt/caddy/Caddyfile] ********************************************************************************************************************
2023-03-30 21:08:12,166 p=22225 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-03-30 21:08:12,166 p=22225 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Could not find or access 'updated_Caddyfile'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/updated_Caddyfile on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-03-30 21:08:12,167 p=22225 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:08:12,167 p=22225 u=craig n=ansible | caddy                      : ok=4    changed=0    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-30 21:08:45,345 p=22332 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:08:45,353 p=22332 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:08:46,457 p=22332 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:46,465 p=22332 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:08:46,488 p=22332 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:46,499 p=22332 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:08:47,035 p=22332 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:47,044 p=22332 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:08:47,413 p=22332 u=craig n=ansible | ok: [caddy]
2023-03-30 21:08:47,422 p=22332 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:08:47,434 p=22332 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:08:47,441 p=22332 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=updated_Caddyfile, dest=/opt/caddy/Caddyfile] ********************************************************************************************************************
2023-03-30 21:08:47,554 p=22332 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-03-30 21:08:47,554 p=22332 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Could not find or access 'updated_Caddyfile'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/updated_Caddyfile on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-03-30 21:08:47,555 p=22332 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:08:47,555 p=22332 u=craig n=ansible | caddy                      : ok=4    changed=0    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-30 21:10:43,425 p=22540 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:10:43,435 p=22540 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:10:44,893 p=22540 u=craig n=ansible | ok: [caddy]
2023-03-30 21:10:44,900 p=22540 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:10:44,921 p=22540 u=craig n=ansible | ok: [caddy]
2023-03-30 21:10:44,933 p=22540 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:10:45,447 p=22540 u=craig n=ansible | ok: [caddy]
2023-03-30 21:10:45,457 p=22540 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:10:45,837 p=22540 u=craig n=ansible | ok: [caddy]
2023-03-30 21:10:45,844 p=22540 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:10:45,857 p=22540 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:10:45,863 p=22540 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=updated_Caddyfile, dest=/opt/caddy/Caddyfile] ********************************************************************************************************************
2023-03-30 21:10:45,937 p=22540 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-03-30 21:10:45,938 p=22540 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Could not find or access 'updated_Caddyfile'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/files/updated_Caddyfile\n\t/Users/craig/Projects/homelab/ansible/playbooks/caddy_update/updated_Caddyfile on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-03-30 21:10:45,938 p=22540 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:10:45,938 p=22540 u=craig n=ansible | caddy                      : ok=4    changed=0    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-03-30 21:11:26,264 p=22658 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:11:26,273 p=22658 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:11:27,390 p=22658 u=craig n=ansible | ok: [caddy]
2023-03-30 21:11:27,399 p=22658 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:11:27,422 p=22658 u=craig n=ansible | ok: [caddy]
2023-03-30 21:11:27,433 p=22658 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:11:27,990 p=22658 u=craig n=ansible | ok: [caddy]
2023-03-30 21:11:28,000 p=22658 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:11:28,376 p=22658 u=craig n=ansible | ok: [caddy]
2023-03-30 21:11:28,385 p=22658 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:11:28,397 p=22658 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:11:28,403 p=22658 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 21:11:29,002 p=22658 u=craig n=ansible | ok: [caddy]
2023-03-30 21:11:29,011 p=22658 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:11:29,550 p=22658 u=craig n=ansible | ok: [caddy]
2023-03-30 21:11:29,560 p=22658 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:11:30,087 p=22658 u=craig n=ansible | ok: [caddy]
2023-03-30 21:11:30,097 p=22658 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 21:11:30,111 p=22658 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:11:30,118 p=22658 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 21:11:30,131 p=22658 u=craig n=ansible | fatal: [caddy]: FAILED! => {"msg": "The conditional check 'caddy_container.exists == True and updated_caddyfile.changed == True' failed. The error was: error while evaluating conditional (caddy_container.exists == True and updated_caddyfile.changed == True): 'updated_caddyfile' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/main.yaml': line 48, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Reload Caddy configuration\n  ^ here\n"}
2023-03-30 21:11:30,132 p=22658 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:11:30,132 p=22658 u=craig n=ansible | caddy                      : ok=7    changed=0    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2023-03-30 21:13:23,008 p=22889 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:13:23,018 p=22889 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:13:24,366 p=22889 u=craig n=ansible | ok: [caddy]
2023-03-30 21:13:24,392 p=22889 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:13:24,419 p=22889 u=craig n=ansible | ok: [caddy]
2023-03-30 21:13:24,432 p=22889 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:13:24,978 p=22889 u=craig n=ansible | ok: [caddy]
2023-03-30 21:13:24,987 p=22889 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:13:25,374 p=22889 u=craig n=ansible | ok: [caddy]
2023-03-30 21:13:25,384 p=22889 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:13:25,395 p=22889 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:13:25,401 p=22889 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 21:13:25,981 p=22889 u=craig n=ansible | ok: [caddy]
2023-03-30 21:13:25,990 p=22889 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:13:26,506 p=22889 u=craig n=ansible | ok: [caddy]
2023-03-30 21:13:26,518 p=22889 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:13:27,024 p=22889 u=craig n=ansible | ok: [caddy]
2023-03-30 21:13:27,034 p=22889 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 21:13:27,049 p=22889 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:13:27,057 p=22889 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 21:13:27,069 p=22889 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:13:27,086 p=22889 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:13:27,087 p=22889 u=craig n=ansible | caddy                      : ok=7    changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
2023-03-30 21:14:01,422 p=23038 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:14:01,431 p=23038 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:14:02,519 p=23038 u=craig n=ansible | ok: [caddy]
2023-03-30 21:14:02,525 p=23038 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:14:02,550 p=23038 u=craig n=ansible | ok: [caddy]
2023-03-30 21:14:02,560 p=23038 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:14:03,082 p=23038 u=craig n=ansible | ok: [caddy]
2023-03-30 21:14:03,091 p=23038 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:14:03,483 p=23038 u=craig n=ansible | ok: [caddy]
2023-03-30 21:14:03,492 p=23038 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:14:03,505 p=23038 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:14:03,511 p=23038 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 21:14:04,171 p=23038 u=craig n=ansible | ok: [caddy]
2023-03-30 21:14:04,181 p=23038 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:14:04,702 p=23038 u=craig n=ansible | ok: [caddy]
2023-03-30 21:14:04,710 p=23038 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:14:05,244 p=23038 u=craig n=ansible | ok: [caddy]
2023-03-30 21:14:05,253 p=23038 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 21:14:05,267 p=23038 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:14:05,275 p=23038 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 21:14:05,863 p=23038 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: docker.errors.APIError: 409 Client Error for http+docker://localhost/v1.42/containers/caddy/exec: Conflict ("Container b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39 is not running")
2023-03-30 21:14:05,863 p=23038 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "An unexpected docker error occurred: 409 Client Error for http+docker://localhost/v1.42/containers/caddy/exec: Conflict (\"Container b0333da8c0b865ebcfa71cd2169a3091fbc721f57a969acab3e237e7a7224f39 is not running\")"}
2023-03-30 21:14:05,868 p=23038 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:14:05,869 p=23038 u=craig n=ansible | caddy                      : ok=7    changed=0    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2023-03-30 21:20:16,332 p=23598 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:20:16,342 p=23598 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:20:17,814 p=23598 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:17,820 p=23598 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:20:17,843 p=23598 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:17,854 p=23598 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:20:18,353 p=23598 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:18,362 p=23598 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:20:18,732 p=23598 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:18,741 p=23598 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:20:18,752 p=23598 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:20:18,759 p=23598 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 21:20:19,333 p=23598 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:19,342 p=23598 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:20:19,831 p=23598 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:19,842 p=23598 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:20:20,347 p=23598 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:20,353 p=23598 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 21:20:20,365 p=23598 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:20:20,373 p=23598 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 21:20:20,385 p=23598 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:20:20,402 p=23598 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:20:20,403 p=23598 u=craig n=ansible | caddy                      : ok=7    changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
2023-03-30 21:20:53,537 p=23742 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:20:53,547 p=23742 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:20:54,613 p=23742 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:54,619 p=23742 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:20:54,643 p=23742 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:54,656 p=23742 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:20:55,152 p=23742 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:55,160 p=23742 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:20:55,518 p=23742 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:55,527 p=23742 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:20:55,540 p=23742 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:20:55,546 p=23742 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 21:20:56,098 p=23742 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:56,107 p=23742 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:20:56,611 p=23742 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:56,621 p=23742 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:20:57,133 p=23742 u=craig n=ansible | ok: [caddy]
2023-03-30 21:20:57,143 p=23742 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 21:25:56,605 p=23742 u=craig n=ansible | changed: [caddy]
2023-03-30 21:25:56,618 p=23742 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 21:25:56,632 p=23742 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:25:56,648 p=23742 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:25:56,649 p=23742 u=craig n=ansible | caddy                      : ok=8    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-03-30 21:30:46,714 p=24609 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 21:30:46,724 p=24609 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 21:30:48,397 p=24609 u=craig n=ansible | ok: [caddy]
2023-03-30 21:30:48,407 p=24609 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 21:30:48,429 p=24609 u=craig n=ansible | ok: [caddy]
2023-03-30 21:30:48,455 p=24609 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 21:30:49,054 p=24609 u=craig n=ansible | ok: [caddy]
2023-03-30 21:30:49,064 p=24609 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 21:30:49,426 p=24609 u=craig n=ansible | ok: [caddy]
2023-03-30 21:30:49,435 p=24609 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 21:30:49,446 p=24609 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:30:49,452 p=24609 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 21:30:50,207 p=24609 u=craig n=ansible | changed: [caddy]
2023-03-30 21:30:50,215 p=24609 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 21:30:50,758 p=24609 u=craig n=ansible | ok: [caddy]
2023-03-30 21:30:50,770 p=24609 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 21:30:51,324 p=24609 u=craig n=ansible | ok: [caddy]
2023-03-30 21:30:51,334 p=24609 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 21:30:51,349 p=24609 u=craig n=ansible | skipping: [caddy]
2023-03-30 21:30:51,356 p=24609 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 21:30:52,168 p=24609 u=craig n=ansible | changed: [caddy]
2023-03-30 21:30:52,190 p=24609 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 21:30:52,190 p=24609 u=craig n=ansible | caddy                      : ok=8    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-03-30 23:29:49,795 p=27432 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 23:29:49,806 p=27432 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 23:29:51,289 p=27432 u=craig n=ansible | ok: [caddy]
2023-03-30 23:29:51,298 p=27432 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 23:29:51,323 p=27432 u=craig n=ansible | ok: [caddy]
2023-03-30 23:29:51,335 p=27432 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 23:29:51,867 p=27432 u=craig n=ansible | ok: [caddy]
2023-03-30 23:29:51,878 p=27432 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 23:29:52,260 p=27432 u=craig n=ansible | ok: [caddy]
2023-03-30 23:29:52,269 p=27432 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 23:29:52,281 p=27432 u=craig n=ansible | skipping: [caddy]
2023-03-30 23:29:52,288 p=27432 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 23:29:53,025 p=27432 u=craig n=ansible | changed: [caddy]
2023-03-30 23:29:53,032 p=27432 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 23:29:53,528 p=27432 u=craig n=ansible | ok: [caddy]
2023-03-30 23:29:53,539 p=27432 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 23:29:54,053 p=27432 u=craig n=ansible | ok: [caddy]
2023-03-30 23:29:54,062 p=27432 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 23:29:54,077 p=27432 u=craig n=ansible | skipping: [caddy]
2023-03-30 23:29:54,084 p=27432 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 23:29:54,812 p=27432 u=craig n=ansible | changed: [caddy]
2023-03-30 23:29:54,835 p=27432 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 23:29:54,835 p=27432 u=craig n=ansible | caddy                      : ok=8    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-03-30 23:32:04,760 p=27720 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-03-30 23:32:04,769 p=27720 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-30 23:32:06,239 p=27720 u=craig n=ansible | ok: [caddy]
2023-03-30 23:32:06,246 p=27720 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-30 23:32:06,267 p=27720 u=craig n=ansible | ok: [caddy]
2023-03-30 23:32:06,278 p=27720 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-30 23:32:06,795 p=27720 u=craig n=ansible | ok: [caddy]
2023-03-30 23:32:06,804 p=27720 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-30 23:32:07,149 p=27720 u=craig n=ansible | ok: [caddy]
2023-03-30 23:32:07,157 p=27720 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-30 23:32:07,168 p=27720 u=craig n=ansible | skipping: [caddy]
2023-03-30 23:32:07,174 p=27720 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-30 23:32:07,926 p=27720 u=craig n=ansible | changed: [caddy]
2023-03-30 23:32:07,933 p=27720 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-30 23:32:08,427 p=27720 u=craig n=ansible | ok: [caddy]
2023-03-30 23:32:08,435 p=27720 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-30 23:32:08,952 p=27720 u=craig n=ansible | ok: [caddy]
2023-03-30 23:32:08,961 p=27720 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-30 23:32:08,974 p=27720 u=craig n=ansible | skipping: [caddy]
2023-03-30 23:32:08,982 p=27720 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-30 23:32:09,669 p=27720 u=craig n=ansible | changed: [caddy]
2023-03-30 23:32:09,687 p=27720 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-30 23:32:09,687 p=27720 u=craig n=ansible | caddy                      : ok=8    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-03-31 21:33:49,966 p=62491 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-03-31 21:33:49,976 p=62491 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-03-31 21:33:51,604 p=62491 u=craig n=ansible | ok: [caddy]
2023-03-31 21:33:51,611 p=62491 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-03-31 21:33:51,622 p=62491 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-03-31 21:33:51,645 p=62491 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-03-31 21:33:51,666 p=62491 u=craig n=ansible | ok: [caddy]
2023-03-31 21:33:51,672 p=62491 u=craig n=ansible | TASK [Debug Google Domains API key var=google_domains_api_key] *********************************************************************************************************************************************
2023-03-31 21:33:51,684 p=62491 u=craig n=ansible | ok: [caddy] => {
    "google_domains_api_key": "VARIABLE IS NOT DEFINED!"
}
2023-03-31 21:33:51,695 p=62491 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-03-31 21:33:52,336 p=62491 u=craig n=ansible | ok: [caddy]
2023-03-31 21:33:52,346 p=62491 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-03-31 21:33:52,732 p=62491 u=craig n=ansible | ok: [caddy]
2023-03-31 21:33:52,741 p=62491 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-03-31 21:33:53,521 p=62491 u=craig n=ansible | changed: [caddy]
2023-03-31 21:33:53,529 p=62491 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-03-31 21:33:53,540 p=62491 u=craig n=ansible | skipping: [caddy]
2023-03-31 21:33:53,547 p=62491 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-03-31 21:33:54,159 p=62491 u=craig n=ansible | changed: [caddy]
2023-03-31 21:33:54,170 p=62491 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-03-31 21:33:54,801 p=62491 u=craig n=ansible | changed: [caddy]
2023-03-31 21:33:54,810 p=62491 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-03-31 21:39:30,596 p=62491 u=craig n=ansible | changed: [caddy]
2023-03-31 21:39:30,607 p=62491 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-03-31 21:39:30,622 p=62491 u=craig n=ansible | skipping: [caddy]
2023-03-31 21:39:30,647 p=62491 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-03-31 21:39:30,647 p=62491 u=craig n=ansible | caddy                      : ok=10   changed=4    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 20:23:35,745 p=91092 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 20:23:35,755 p=91092 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 20:23:37,476 p=91092 u=craig n=ansible | ok: [caddy]
2023-04-01 20:23:37,498 p=91092 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 20:23:37,509 p=91092 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 20:23:37,515 p=91092 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 20:23:37,538 p=91092 u=craig n=ansible | ok: [caddy]
2023-04-01 20:23:37,550 p=91092 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 20:23:38,304 p=91092 u=craig n=ansible | ok: [caddy]
2023-04-01 20:23:38,313 p=91092 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 20:23:38,741 p=91092 u=craig n=ansible | ok: [caddy]
2023-04-01 20:23:38,752 p=91092 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 20:23:39,338 p=91092 u=craig n=ansible | ok: [caddy]
2023-04-01 20:23:39,347 p=91092 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 20:23:39,358 p=91092 u=craig n=ansible | skipping: [caddy]
2023-04-01 20:23:39,364 p=91092 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 20:23:39,891 p=91092 u=craig n=ansible | ok: [caddy]
2023-04-01 20:23:39,902 p=91092 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 20:23:40,605 p=91092 u=craig n=ansible | changed: [caddy]
2023-04-01 20:23:40,614 p=91092 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 20:23:45,080 p=91092 u=craig n=ansible | changed: [caddy]
2023-04-01 20:23:45,089 p=91092 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 20:23:45,101 p=91092 u=craig n=ansible | skipping: [caddy]
2023-04-01 20:23:45,118 p=91092 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 20:23:45,118 p=91092 u=craig n=ansible | caddy                      : ok=9    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 20:38:04,145 p=92277 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 20:38:04,155 p=92277 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 20:38:05,609 p=92277 u=craig n=ansible | ok: [caddy]
2023-04-01 20:38:05,615 p=92277 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 20:38:05,626 p=92277 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 20:38:05,633 p=92277 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 20:38:05,654 p=92277 u=craig n=ansible | ok: [caddy]
2023-04-01 20:38:05,665 p=92277 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 20:38:06,242 p=92277 u=craig n=ansible | ok: [caddy]
2023-04-01 20:38:06,251 p=92277 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 20:38:06,611 p=92277 u=craig n=ansible | ok: [caddy]
2023-04-01 20:38:06,620 p=92277 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 20:38:07,495 p=92277 u=craig n=ansible | changed: [caddy]
2023-04-01 20:38:07,502 p=92277 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 20:38:07,514 p=92277 u=craig n=ansible | skipping: [caddy]
2023-04-01 20:38:07,520 p=92277 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 20:38:08,022 p=92277 u=craig n=ansible | ok: [caddy]
2023-04-01 20:38:08,032 p=92277 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 20:38:08,557 p=92277 u=craig n=ansible | ok: [caddy]
2023-04-01 20:38:08,567 p=92277 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 20:38:13,099 p=92277 u=craig n=ansible | changed: [caddy]
2023-04-01 20:38:13,109 p=92277 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 20:38:13,121 p=92277 u=craig n=ansible | skipping: [caddy]
2023-04-01 20:38:13,138 p=92277 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 20:38:13,138 p=92277 u=craig n=ansible | caddy                      : ok=9    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 21:32:28,309 p=96252 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-04-01 21:32:28,319 p=96252 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 21:32:29,838 p=96252 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:29,846 p=96252 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 21:32:29,869 p=96252 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:29,880 p=96252 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 21:32:30,618 p=96252 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:30,628 p=96252 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 21:32:30,998 p=96252 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:31,007 p=96252 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 21:32:31,019 p=96252 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:32:31,025 p=96252 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 21:32:31,615 p=96252 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:31,625 p=96252 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 21:32:32,156 p=96252 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:32,168 p=96252 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 21:32:32,697 p=96252 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:32,706 p=96252 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 21:32:32,719 p=96252 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:32:32,726 p=96252 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 21:32:33,457 p=96252 u=craig n=ansible | changed: [caddy]
2023-04-01 21:32:33,477 p=96252 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 21:32:33,477 p=96252 u=craig n=ansible | caddy                      : ok=8    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 21:32:52,223 p=96389 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-04-01 21:32:52,232 p=96389 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 21:32:53,334 p=96389 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:53,342 p=96389 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 21:32:53,365 p=96389 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:53,376 p=96389 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 21:32:53,929 p=96389 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:53,937 p=96389 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 21:32:54,308 p=96389 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:54,316 p=96389 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 21:32:54,327 p=96389 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:32:54,333 p=96389 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 21:32:55,116 p=96389 u=craig n=ansible | changed: [caddy]
2023-04-01 21:32:55,124 p=96389 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 21:32:55,649 p=96389 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:55,660 p=96389 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 21:32:56,194 p=96389 u=craig n=ansible | ok: [caddy]
2023-04-01 21:32:56,203 p=96389 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 21:32:56,218 p=96389 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:32:56,225 p=96389 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 21:32:56,988 p=96389 u=craig n=ansible | changed: [caddy]
2023-04-01 21:32:57,009 p=96389 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 21:32:57,009 p=96389 u=craig n=ansible | caddy                      : ok=8    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 21:37:22,854 p=96799 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 21:37:22,864 p=96799 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 21:37:24,590 p=96799 u=craig n=ansible | ok: [caddy]
2023-04-01 21:37:24,612 p=96799 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 21:37:24,622 p=96799 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 21:37:24,629 p=96799 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 21:37:24,652 p=96799 u=craig n=ansible | ok: [caddy]
2023-04-01 21:37:24,663 p=96799 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 21:37:25,209 p=96799 u=craig n=ansible | ok: [caddy]
2023-04-01 21:37:25,218 p=96799 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 21:37:25,573 p=96799 u=craig n=ansible | ok: [caddy]
2023-04-01 21:37:25,582 p=96799 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 21:37:26,159 p=96799 u=craig n=ansible | ok: [caddy]
2023-04-01 21:37:26,168 p=96799 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 21:37:26,178 p=96799 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:37:26,185 p=96799 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 21:37:26,681 p=96799 u=craig n=ansible | ok: [caddy]
2023-04-01 21:37:26,692 p=96799 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 21:37:27,217 p=96799 u=craig n=ansible | ok: [caddy]
2023-04-01 21:37:27,226 p=96799 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 21:37:31,986 p=96799 u=craig n=ansible | changed: [caddy]
2023-04-01 21:37:31,997 p=96799 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 21:37:32,008 p=96799 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:37:32,026 p=96799 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 21:37:32,026 p=96799 u=craig n=ansible | caddy                      : ok=9    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 21:43:59,011 p=97421 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ****************************************************************************************************************************************************************
2023-04-01 21:43:59,021 p=97421 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 21:44:00,557 p=97421 u=craig n=ansible | ok: [caddy]
2023-04-01 21:44:00,564 p=97421 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 21:44:00,587 p=97421 u=craig n=ansible | ok: [caddy]
2023-04-01 21:44:00,598 p=97421 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 21:44:01,255 p=97421 u=craig n=ansible | ok: [caddy]
2023-04-01 21:44:01,265 p=97421 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 21:44:01,673 p=97421 u=craig n=ansible | ok: [caddy]
2023-04-01 21:44:01,683 p=97421 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 21:44:01,693 p=97421 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:44:01,700 p=97421 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 21:44:02,458 p=97421 u=craig n=ansible | changed: [caddy]
2023-04-01 21:44:02,465 p=97421 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 21:44:02,978 p=97421 u=craig n=ansible | ok: [caddy]
2023-04-01 21:44:02,989 p=97421 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 21:44:03,548 p=97421 u=craig n=ansible | ok: [caddy]
2023-04-01 21:44:03,558 p=97421 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 21:44:03,573 p=97421 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:44:03,581 p=97421 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 21:44:04,339 p=97421 u=craig n=ansible | changed: [caddy]
2023-04-01 21:44:04,359 p=97421 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 21:44:04,359 p=97421 u=craig n=ansible | caddy                      : ok=8    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 21:45:51,501 p=97661 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 21:45:51,512 p=97661 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 21:45:52,975 p=97661 u=craig n=ansible | ok: [caddy]
2023-04-01 21:45:52,982 p=97661 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 21:45:52,994 p=97661 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 21:45:53,000 p=97661 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 21:45:53,023 p=97661 u=craig n=ansible | ok: [caddy]
2023-04-01 21:45:53,036 p=97661 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 21:45:53,548 p=97661 u=craig n=ansible | ok: [caddy]
2023-04-01 21:45:53,559 p=97661 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 21:45:53,920 p=97661 u=craig n=ansible | ok: [caddy]
2023-04-01 21:45:53,929 p=97661 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 21:45:54,518 p=97661 u=craig n=ansible | ok: [caddy]
2023-04-01 21:45:54,528 p=97661 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 21:45:54,538 p=97661 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:45:54,545 p=97661 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 21:45:55,055 p=97661 u=craig n=ansible | ok: [caddy]
2023-04-01 21:45:55,065 p=97661 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 21:45:55,600 p=97661 u=craig n=ansible | ok: [caddy]
2023-04-01 21:45:55,611 p=97661 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 21:46:00,044 p=97661 u=craig n=ansible | changed: [caddy]
2023-04-01 21:46:00,054 p=97661 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 21:46:00,066 p=97661 u=craig n=ansible | skipping: [caddy]
2023-04-01 21:46:00,083 p=97661 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 21:46:00,083 p=97661 u=craig n=ansible | caddy                      : ok=9    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 22:01:01,448 p=98911 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 22:01:01,459 p=98911 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 22:01:03,004 p=98911 u=craig n=ansible | ok: [caddy]
2023-04-01 22:01:03,011 p=98911 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 22:01:03,023 p=98911 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 22:01:03,030 p=98911 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 22:01:03,052 p=98911 u=craig n=ansible | ok: [caddy]
2023-04-01 22:01:03,080 p=98911 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 22:01:03,757 p=98911 u=craig n=ansible | ok: [caddy]
2023-04-01 22:01:03,763 p=98911 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 22:01:04,134 p=98911 u=craig n=ansible | ok: [caddy]
2023-04-01 22:01:04,142 p=98911 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 22:01:04,153 p=98911 u=craig n=ansible | skipping: [caddy]
2023-04-01 22:01:04,160 p=98911 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 22:01:04,929 p=98911 u=craig n=ansible | changed: [caddy]
2023-04-01 22:01:04,935 p=98911 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 22:01:05,454 p=98911 u=craig n=ansible | ok: [caddy]
2023-04-01 22:01:05,461 p=98911 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 22:01:05,982 p=98911 u=craig n=ansible | ok: [caddy]
2023-04-01 22:01:05,988 p=98911 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 22:01:06,000 p=98911 u=craig n=ansible | skipping: [caddy]
2023-04-01 22:01:06,006 p=98911 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 22:01:06,696 p=98911 u=craig n=ansible | changed: [caddy]
2023-04-01 22:01:06,713 p=98911 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 22:01:06,713 p=98911 u=craig n=ansible | caddy                      : ok=9    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 22:02:01,944 p=99084 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 22:02:01,954 p=99084 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 22:02:03,069 p=99084 u=craig n=ansible | ok: [caddy]
2023-04-01 22:02:03,078 p=99084 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 22:02:03,091 p=99084 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 22:02:03,097 p=99084 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 22:02:03,120 p=99084 u=craig n=ansible | ok: [caddy]
2023-04-01 22:02:03,132 p=99084 u=craig n=ansible | TASK [caddy_docker : Check Caddy container status name=caddy] **********************************************************************************************************************************************
2023-04-01 22:02:03,671 p=99084 u=craig n=ansible | ok: [caddy]
2023-04-01 22:02:03,681 p=99084 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 22:02:04,056 p=99084 u=craig n=ansible | ok: [caddy]
2023-04-01 22:02:04,065 p=99084 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] **********************************************************************************************************************
2023-04-01 22:02:04,662 p=99084 u=craig n=ansible | ok: [caddy]
2023-04-01 22:02:04,672 p=99084 u=craig n=ansible | TASK [caddy_docker : Update Caddyfile src=Caddyfile, dest=/opt/caddy/Caddyfile] ****************************************************************************************************************************
2023-04-01 22:02:04,682 p=99084 u=craig n=ansible | skipping: [caddy]
2023-04-01 22:02:04,689 p=99084 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile] ***************************************************************************************************************************
2023-04-01 22:02:05,211 p=99084 u=craig n=ansible | ok: [caddy]
2023-04-01 22:02:05,222 p=99084 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml] **************************************************************************************
2023-04-01 22:02:05,746 p=99084 u=craig n=ansible | ok: [caddy]
2023-04-01 22:02:05,756 p=99084 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 22:02:10,222 p=99084 u=craig n=ansible | changed: [caddy]
2023-04-01 22:02:10,232 p=99084 u=craig n=ansible | TASK [caddy_docker : Reload Caddy configuration container=caddy, command=caddy reload, chdir=/etc/caddy] ***************************************************************************************************
2023-04-01 22:02:10,244 p=99084 u=craig n=ansible | skipping: [caddy]
2023-04-01 22:02:10,261 p=99084 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 22:02:10,261 p=99084 u=craig n=ansible | caddy                      : ok=9    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-04-01 22:37:03,835 p=2059 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 22:37:03,845 p=2059 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 22:37:05,400 p=2059 u=craig n=ansible | ok: [caddy]
2023-04-01 22:37:05,407 p=2059 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 22:37:05,419 p=2059 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 22:37:05,426 p=2059 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 22:37:05,448 p=2059 u=craig n=ansible | ok: [caddy]
2023-04-01 22:37:05,475 p=2059 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-01 22:37:07,193 p=2059 u=craig n=ansible | changed: [caddy]
2023-04-01 22:37:07,203 p=2059 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 22:37:07,587 p=2059 u=craig n=ansible | ok: [caddy]
2023-04-01 22:37:07,596 p=2059 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-01 22:37:08,357 p=2059 u=craig n=ansible | changed: [caddy]
2023-04-01 22:37:08,365 p=2059 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-01 22:37:08,862 p=2059 u=craig n=ansible | ok: [caddy]
2023-04-01 22:37:08,872 p=2059 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-01 22:37:09,457 p=2059 u=craig n=ansible | changed: [caddy]
2023-04-01 22:37:09,467 p=2059 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 22:37:12,880 p=2059 u=craig n=ansible | changed: [caddy]
2023-04-01 22:37:12,900 p=2059 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 22:37:12,900 p=2059 u=craig n=ansible | caddy                      : ok=9    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-01 22:38:22,361 p=2292 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 22:38:22,371 p=2292 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 22:38:23,998 p=2292 u=craig n=ansible | ok: [caddy]
2023-04-01 22:38:24,006 p=2292 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 22:38:24,019 p=2292 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 22:38:24,042 p=2292 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 22:38:24,065 p=2292 u=craig n=ansible | ok: [caddy]
2023-04-01 22:38:24,076 p=2292 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-01 22:38:24,789 p=2292 u=craig n=ansible | changed: [caddy]
2023-04-01 22:38:24,799 p=2292 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 22:38:25,186 p=2292 u=craig n=ansible | ok: [caddy]
2023-04-01 22:38:25,195 p=2292 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-01 22:38:25,782 p=2292 u=craig n=ansible | ok: [caddy]
2023-04-01 22:38:25,792 p=2292 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-01 22:38:26,486 p=2292 u=craig n=ansible | changed: [caddy]
2023-04-01 22:38:26,495 p=2292 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-01 22:38:27,015 p=2292 u=craig n=ansible | ok: [caddy]
2023-04-01 22:38:27,024 p=2292 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 22:39:59,224 p=2292 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:b47f0ab06d7bfe6a470f8dc0fd80467165e62867e0b4cf9a10de74157c0ca20e\nStatus: Image is up to date for caddy:2-builder\n ---> 66c494ede8be\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/google_domains\n ---> Running in 3fcd469d5021\np/buildenv_2023-04-02-0238.2884899706\n2023/04/02 02:38:29 [INFO] Writing main module: /tmp/buildenv_2023-04-02-0238.2884899706/main.go\npackage main\n\nimport (\n\tcaddycmd \"github.com/caddyserver/caddy/v2/cmd\"\n\n\t// plug in Caddy modules here\n\t_ \"github.com/caddyserver/caddy/v2/modules/standard\"\n\t_ \"github.com/caddy-dns/google_domains\"\n)\n\nfunc main() {\n\tcaddycmd.Main()\n}\n2023/04/02 02:38:29 [INFO] Initializing Go module\n2023/04/02 02:38:29 [INFO] exec (timeout=10s): /usr/local/go/bin/go mod init caddy \nodule caddy\ns:\n\tgo mod tidy\n2023/04/02 02:38:29 [INFO] Pinning versions\n/caddyserver/caddy/v2@v2.6.4 \n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/google/uuid v1.3.0\netheus/client_golang v1.14.0\n/quic-go/quic-go v0.32.0\ngo: downloading go.uber.org/zap v1.24.0\ngo: downloading golang.org/x/sys v0.5.0\n v0.5.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\nez v1.1.0\niekg/dns v1.1.50\ngo: downloading golang.org/x/crypto v0.5.0\ngo: downloading golang.org/x/net v0.7.0\n/beorn7/perks v1.0.1\n/cespare/xxhash/v2 v2.1.2\n/cespare/xxhash v1.1.0\n/golang/protobuf v1.5.2\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\ngo: downloading google.golang.org/protobuf v1.28.1\nock v1.6.0\n/onsi/ginkgo/v2 v2.2.0\n/quic-go/qpack v0.4.0\nic v1.9.0\nultierr v1.6.0\ngo: downloading golang.org/x/tools v0.2.0\ngo: downloading golang.org/x/text v0.7.0\natttproud/golang_protobuf_extensions v1.0.1\nod v0.6.0\ngo: downloading golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n-sprig v0.0.0-20210107165309-348f09dbbbc0\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/beorn7/perks v1.0.1\n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/cespare/xxhash/v2 v2.1.2\n-sprig v0.0.0-20210107165309-348f09dbbbc0\nock v1.6.0\n/golang/protobuf v1.5.2\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/google/uuid v1.3.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\natttproud/golang_protobuf_extensions v1.0.1\nez v1.1.0\niekg/dns v1.1.50\n/onsi/ginkgo/v2 v2.2.0\netheus/client_golang v1.14.0\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\n/quic-go/qpack v0.4.0\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n/quic-go/quic-go v0.32.0\nic v1.9.0\nultierr v1.6.0\ngo: added go.uber.org/zap v1.24.0\ngo: added golang.org/x/crypto v0.5.0\ngo: added golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\nod v0.6.0\ngo: added golang.org/x/net v0.7.0\ngo: added golang.org/x/sys v0.5.0\n v0.5.0\ngo: added golang.org/x/text v0.7.0\ngo: added golang.org/x/tools v0.2.0\ngo: added google.golang.org/protobuf v1.28.1\n/caddyserver/caddy/v2@v2.6.4 \nod/cache/vcs/e3d210753c935151f22938c6618b100c18cb0dfaf38a1531932da9ae2b56bc07: exit status 128:\n\tfatal: could not read Username for 'https://github.com': terminal prompts disabled\nConfirm the import path was entered correctly.\nIf this is a private repository, see https://golang.org/doc/faq#git_https for additional information.\n2023/04/02 02:39:58 [FATAL] exit status 1\n", "msg": "Error: build failed with (<Service: caddy>, \"The command '/bin/sh -c xcaddy build     --with github.com/caddy-dns/google_domains' returned a non-zero code: 1\")"}
2023-04-01 22:39:59,226 p=2292 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 22:39:59,226 p=2292 u=craig n=ansible | caddy                      : ok=8    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-01 22:41:20,874 p=2633 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-01 22:41:20,884 p=2633 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-01 22:41:22,354 p=2633 u=craig n=ansible | ok: [caddy]
2023-04-01 22:41:22,361 p=2633 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-01 22:41:22,373 p=2633 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-01 22:41:22,380 p=2633 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-01 22:41:22,403 p=2633 u=craig n=ansible | ok: [caddy]
2023-04-01 22:41:22,414 p=2633 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-01 22:41:23,047 p=2633 u=craig n=ansible | ok: [caddy]
2023-04-01 22:41:23,054 p=2633 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-01 22:41:23,434 p=2633 u=craig n=ansible | ok: [caddy]
2023-04-01 22:41:23,443 p=2633 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-01 22:41:24,037 p=2633 u=craig n=ansible | ok: [caddy]
2023-04-01 22:41:24,046 p=2633 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-01 22:41:24,742 p=2633 u=craig n=ansible | changed: [caddy]
2023-04-01 22:41:24,751 p=2633 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-01 22:41:25,269 p=2633 u=craig n=ansible | ok: [caddy]
2023-04-01 22:41:25,279 p=2633 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-01 22:46:49,747 p=2633 u=craig n=ansible | changed: [caddy]
2023-04-01 22:46:49,773 p=2633 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-01 22:46:49,773 p=2633 u=craig n=ansible | caddy                      : ok=9    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 13:58:20,000 p=15215 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-02 13:58:20,010 p=15215 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-02 13:58:21,646 p=15215 u=craig n=ansible | ok: [caddy]
2023-04-02 13:58:21,654 p=15215 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-02 13:58:21,666 p=15215 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 13:58:21,691 p=15215 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-02 13:58:21,715 p=15215 u=craig n=ansible | ok: [caddy]
2023-04-02 13:58:21,726 p=15215 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-02 13:58:23,335 p=15215 u=craig n=ansible | changed: [caddy]
2023-04-02 13:58:23,345 p=15215 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-02 13:58:23,766 p=15215 u=craig n=ansible | ok: [caddy]
2023-04-02 13:58:23,775 p=15215 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-02 13:58:24,532 p=15215 u=craig n=ansible | changed: [caddy]
2023-04-02 13:58:24,539 p=15215 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-02 13:58:25,071 p=15215 u=craig n=ansible | ok: [caddy]
2023-04-02 13:58:25,081 p=15215 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-02 13:58:25,738 p=15215 u=craig n=ansible | changed: [caddy]
2023-04-02 13:58:25,748 p=15215 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-02 13:58:29,340 p=15215 u=craig n=ansible | changed: [caddy]
2023-04-02 13:58:29,360 p=15215 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-02 13:58:29,360 p=15215 u=craig n=ansible | caddy                      : ok=9    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 13:59:41,417 p=15452 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-02 13:59:41,426 p=15452 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-02 13:59:42,866 p=15452 u=craig n=ansible | ok: [caddy]
2023-04-02 13:59:42,872 p=15452 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-02 13:59:42,883 p=15452 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 13:59:42,890 p=15452 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-02 13:59:42,911 p=15452 u=craig n=ansible | ok: [caddy]
2023-04-02 13:59:42,923 p=15452 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-02 13:59:43,555 p=15452 u=craig n=ansible | changed: [caddy]
2023-04-02 13:59:43,565 p=15452 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-02 13:59:43,946 p=15452 u=craig n=ansible | ok: [caddy]
2023-04-02 13:59:43,955 p=15452 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-02 13:59:44,563 p=15452 u=craig n=ansible | ok: [caddy]
2023-04-02 13:59:44,572 p=15452 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-02 13:59:45,267 p=15452 u=craig n=ansible | changed: [caddy]
2023-04-02 13:59:45,276 p=15452 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-02 13:59:45,795 p=15452 u=craig n=ansible | ok: [caddy]
2023-04-02 13:59:45,805 p=15452 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-02 13:59:49,001 p=15452 u=craig n=ansible | changed: [caddy]
2023-04-02 13:59:49,020 p=15452 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-02 13:59:49,021 p=15452 u=craig n=ansible | caddy                      : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 14:37:07,962 p=16756 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-02 14:37:07,970 p=16756 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-02 14:37:09,627 p=16756 u=craig n=ansible | ok: [caddy]
2023-04-02 14:37:09,634 p=16756 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-02 14:37:09,644 p=16756 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 14:37:09,664 p=16756 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-02 14:37:09,680 p=16756 u=craig n=ansible | ok: [caddy]
2023-04-02 14:37:09,687 p=16756 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-02 14:37:11,438 p=16756 u=craig n=ansible | changed: [caddy]
2023-04-02 14:37:11,448 p=16756 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-02 14:37:11,791 p=16756 u=craig n=ansible | ok: [caddy]
2023-04-02 14:37:11,800 p=16756 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-02 14:37:12,364 p=16756 u=craig n=ansible | ok: [caddy]
2023-04-02 14:37:12,374 p=16756 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-02 14:37:12,873 p=16756 u=craig n=ansible | ok: [caddy]
2023-04-02 14:37:12,885 p=16756 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-02 14:37:13,553 p=16756 u=craig n=ansible | changed: [caddy]
2023-04-02 14:37:13,561 p=16756 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-02 14:37:16,799 p=16756 u=craig n=ansible | changed: [caddy]
2023-04-02 14:37:16,815 p=16756 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-02 14:37:16,815 p=16756 u=craig n=ansible | caddy                      : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 15:02:27,252 p=19498 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:27,260 p=19498 u=craig n=ansible | TASK [Gathering Facts ] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:28,683 p=19498 u=craig n=ansible | ok: [caddy]
2023-04-02 15:02:28,687 p=19498 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:28,702 p=19498 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 15:02:28,708 p=19498 u=craig n=ansible | TASK [Include secrets] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:28,732 p=19498 u=craig n=ansible | ok: [caddy]
2023-04-02 15:02:28,741 p=19498 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:30,308 p=19498 u=craig n=ansible | changed: [caddy]
2023-04-02 15:02:30,313 p=19498 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:30,665 p=19498 u=craig n=ansible | ok: [caddy]
2023-04-02 15:02:30,670 p=19498 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:31,368 p=19498 u=craig n=ansible | changed: [caddy]
2023-04-02 15:02:31,373 p=19498 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:31,858 p=19498 u=craig n=ansible | ok: [caddy]
2023-04-02 15:02:31,863 p=19498 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:32,365 p=19498 u=craig n=ansible | ok: [caddy]
2023-04-02 15:02:32,370 p=19498 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:35,400 p=19498 u=craig n=ansible | changed: [caddy]
2023-04-02 15:02:35,413 p=19498 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:02:35,414 p=19498 u=craig n=ansible | caddy                      : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 15:03:59,327 p=19863 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:03:59,335 p=19863 u=craig n=ansible | TASK [Gathering Facts ] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:00,777 p=19863 u=craig n=ansible | ok: [caddy]
2023-04-02 15:04:00,784 p=19863 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:00,795 p=19863 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 15:04:00,801 p=19863 u=craig n=ansible | TASK [Include secrets] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:00,817 p=19863 u=craig n=ansible | ok: [caddy]
2023-04-02 15:04:00,825 p=19863 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:02,280 p=19863 u=craig n=ansible | changed: [caddy]
2023-04-02 15:04:02,290 p=19863 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:02,616 p=19863 u=craig n=ansible | ok: [caddy]
2023-04-02 15:04:02,625 p=19863 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:03,196 p=19863 u=craig n=ansible | ok: [caddy]
2023-04-02 15:04:03,206 p=19863 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:03,696 p=19863 u=craig n=ansible | ok: [caddy]
2023-04-02 15:04:03,707 p=19863 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:04,366 p=19863 u=craig n=ansible | changed: [caddy]
2023-04-02 15:04:04,374 p=19863 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:07,615 p=19863 u=craig n=ansible | changed: [caddy]
2023-04-02 15:04:07,632 p=19863 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-02 15:04:07,632 p=19863 u=craig n=ansible | caddy                      : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 20:25:09,257 p=23092 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-02 20:25:09,266 p=23092 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-02 20:25:10,750 p=23092 u=craig n=ansible | ok: [caddy]
2023-04-02 20:25:10,756 p=23092 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-02 20:25:10,767 p=23092 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 20:25:10,774 p=23092 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-02 20:25:10,796 p=23092 u=craig n=ansible | ok: [caddy]
2023-04-02 20:25:10,810 p=23092 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-02 20:25:12,301 p=23092 u=craig n=ansible | changed: [caddy]
2023-04-02 20:25:12,308 p=23092 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-02 20:25:12,725 p=23092 u=craig n=ansible | ok: [caddy]
2023-04-02 20:25:12,732 p=23092 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-02 20:25:13,322 p=23092 u=craig n=ansible | ok: [caddy]
2023-04-02 20:25:13,328 p=23092 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-02 20:25:13,815 p=23092 u=craig n=ansible | ok: [caddy]
2023-04-02 20:25:13,822 p=23092 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-02 20:25:14,331 p=23092 u=craig n=ansible | ok: [caddy]
2023-04-02 20:25:14,337 p=23092 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-02 20:25:17,547 p=23092 u=craig n=ansible | changed: [caddy]
2023-04-02 20:25:17,566 p=23092 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-02 20:25:17,566 p=23092 u=craig n=ansible | caddy                      : ok=9    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 21:02:19,906 p=25852 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-02 21:02:19,916 p=25852 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-02 21:02:21,494 p=25852 u=craig n=ansible | ok: [caddy]
2023-04-02 21:02:21,502 p=25852 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-02 21:02:21,513 p=25852 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 21:02:21,520 p=25852 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-02 21:02:21,542 p=25852 u=craig n=ansible | ok: [caddy]
2023-04-02 21:02:21,570 p=25852 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-02 21:02:23,065 p=25852 u=craig n=ansible | changed: [caddy]
2023-04-02 21:02:23,072 p=25852 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-02 21:02:23,488 p=25852 u=craig n=ansible | ok: [caddy]
2023-04-02 21:02:23,497 p=25852 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-02 21:02:24,253 p=25852 u=craig n=ansible | changed: [caddy]
2023-04-02 21:02:24,260 p=25852 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-02 21:02:24,772 p=25852 u=craig n=ansible | ok: [caddy]
2023-04-02 21:02:24,782 p=25852 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-02 21:02:25,380 p=25852 u=craig n=ansible | changed: [caddy]
2023-04-02 21:02:25,389 p=25852 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-02 21:02:28,556 p=25852 u=craig n=ansible | changed: [caddy]
2023-04-02 21:02:28,577 p=25852 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-02 21:02:28,577 p=25852 u=craig n=ansible | caddy                      : ok=9    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 21:17:11,266 p=27111 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-02 21:17:11,275 p=27111 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-02 21:17:12,775 p=27111 u=craig n=ansible | ok: [caddy]
2023-04-02 21:17:12,783 p=27111 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-02 21:17:12,793 p=27111 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 21:17:12,800 p=27111 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-02 21:17:12,822 p=27111 u=craig n=ansible | ok: [caddy]
2023-04-02 21:17:12,834 p=27111 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-02 21:17:14,495 p=27111 u=craig n=ansible | changed: [caddy]
2023-04-02 21:17:14,504 p=27111 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-02 21:17:14,903 p=27111 u=craig n=ansible | ok: [caddy]
2023-04-02 21:17:14,913 p=27111 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-02 21:17:15,544 p=27111 u=craig n=ansible | ok: [caddy]
2023-04-02 21:17:15,553 p=27111 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-02 21:17:16,053 p=27111 u=craig n=ansible | ok: [caddy]
2023-04-02 21:17:16,060 p=27111 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-02 21:17:16,766 p=27111 u=craig n=ansible | changed: [caddy]
2023-04-02 21:17:16,773 p=27111 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-02 21:17:19,950 p=27111 u=craig n=ansible | changed: [caddy]
2023-04-02 21:17:19,973 p=27111 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-02 21:17:19,973 p=27111 u=craig n=ansible | caddy                      : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-02 21:24:11,842 p=27687 u=craig n=ansible | PLAY [Set up Caddy reverse proxy] **************************************************************************************************************************************************************************
2023-04-02 21:24:11,851 p=27687 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-04-02 21:24:13,314 p=27687 u=craig n=ansible | ok: [caddy]
2023-04-02 21:24:13,320 p=27687 u=craig n=ansible | TASK [Test debug msg=Running Caddy playbook ARGHHH] ********************************************************************************************************************************************************
2023-04-02 21:24:13,332 p=27687 u=craig n=ansible | ok: [caddy] => {
    "msg": "Running Caddy playbook ARGHHH"
}
2023-04-02 21:24:13,339 p=27687 u=craig n=ansible | TASK [Include secrets] *************************************************************************************************************************************************************************************
2023-04-02 21:24:13,360 p=27687 u=craig n=ansible | ok: [caddy]
2023-04-02 21:24:13,371 p=27687 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ****************************************************************************************************************
2023-04-02 21:24:15,089 p=27687 u=craig n=ansible | changed: [caddy]
2023-04-02 21:24:15,098 p=27687 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-04-02 21:24:15,491 p=27687 u=craig n=ansible | ok: [caddy]
2023-04-02 21:24:15,500 p=27687 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-04-02 21:24:16,256 p=27687 u=craig n=ansible | changed: [caddy]
2023-04-02 21:24:16,263 p=27687 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-04-02 21:24:16,780 p=27687 u=craig n=ansible | ok: [caddy]
2023-04-02 21:24:16,790 p=27687 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-04-02 21:24:17,315 p=27687 u=craig n=ansible | ok: [caddy]
2023-04-02 21:24:17,325 p=27687 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] ***************************************************************************************************
2023-04-02 21:24:20,427 p=27687 u=craig n=ansible | changed: [caddy]
2023-04-02 21:24:20,448 p=27687 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-04-02 21:24:20,448 p=27687 u=craig n=ansible | caddy                      : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-03 20:38:35,213 p=81335 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-04-03 20:38:35,214 p=81335 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-04-03 20:38:35,214 p=81335 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-04-03 20:38:35,231 p=81335 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-04-03 20:38:36,261 p=81335 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-04-03 20:38:36,301 p=81335 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************
2023-04-03 20:38:38,712 p=81335 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:38:38,806 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-04-03 20:38:40,018 p=81335 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:38:40,047 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-04-03 20:38:40,975 p=81335 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:38:41,002 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-04-03 20:38:42,556 p=81335 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:38:42,623 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *****************************************************************************************************
2023-04-03 20:38:43,583 p=81335 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-03 20:38:43,618 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-03 20:38:43,660 p=81335 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-03 20:38:43,695 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-03 20:39:22,893 p=81335 u=craig n=ansible | changed: [192.168.1.99]
2023-04-03 20:39:22,974 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-04-03 20:39:37,925 p=81335 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-03 20:39:37,926 p=81335 u=craig n=ansible | changed: [192.168.1.99]
2023-04-03 20:39:38,001 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ************************************************************************************
2023-04-03 20:39:38,181 p=81335 u=craig n=ansible | changed: [192.168.1.99]
2023-04-03 20:39:38,246 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] ***********************************************
2023-04-03 20:39:40,023 p=81335 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-03 20:39:40,164 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] *****************************************************************************
2023-04-03 20:39:47,447 p=81335 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:39:47,634 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ***********************************************************************************************************
2023-04-03 20:39:49,961 p=81335 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:39:50,078 p=81335 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] ***********************************************************************************************************************
2023-04-03 20:40:56,770 p=81335 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:40:56,867 p=81335 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] **********************************************************************************
2023-04-03 20:40:58,099 p=81335 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:40:58,228 p=81335 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: vscode

2023-04-03 20:40:58,228 p=81335 u=craig n=ansible | PLAY [Create a user and lock down the container] **************************************************************************************************************************************************************
2023-04-03 20:40:58,228 p=81335 u=craig n=ansible | skipping: no hosts matched
2023-04-03 20:40:58,262 p=81335 u=craig n=ansible | PLAY [Install gui] ********************************************************************************************************************************************************************************************
2023-04-03 20:40:58,263 p=81335 u=craig n=ansible | skipping: no hosts matched
2023-04-03 20:40:58,263 p=81335 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************
2023-04-03 20:40:58,263 p=81335 u=craig n=ansible | 192.168.1.99               : ok=13   changed=6    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-03 20:41:26,895 p=82069 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] *******************************************************************************************************************************************************************************
2023-04-03 20:41:26,929 p=82069 u=craig n=ansible | TASK [Gathering Facts ] *************************************************************************************************************************************************************************************************
2023-04-03 20:41:29,576 p=82069 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:41:29,655 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ****************************************************************************************************************************************************
2023-04-03 20:41:30,929 p=82069 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:41:30,983 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ******************************************************************************
2023-04-03 20:41:31,887 p=82069 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:41:31,920 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ****************************************************************
2023-04-03 20:41:33,715 p=82069 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:41:33,766 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ***************************************************************************************************************
2023-04-03 20:41:34,818 p=82069 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-03 20:41:34,853 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-03 20:41:34,888 p=82069 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-03 20:41:34,922 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-03 20:41:35,859 p=82069 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:41:35,881 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ********************************************************************
2023-04-03 20:41:36,388 p=82069 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation 
warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-03 20:41:36,389 p=82069 u=craig n=ansible | ok: [192.168.1.99]
2023-04-03 20:41:36,425 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] **********************************************************************************************
2023-04-03 20:41:36,491 p=82069 u=craig n=ansible | changed: [192.168.1.99]
2023-04-03 20:41:36,539 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] *********************************************************
2023-04-03 20:41:37,460 p=82069 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-03 20:41:37,541 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ***************************************************************************************
2023-04-03 20:41:39,567 p=82069 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:41:39,654 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] *********************************************************************************************************************
2023-04-03 20:41:41,640 p=82069 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:41:41,719 p=82069 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] *********************************************************************************************************************************
2023-04-03 20:41:43,158 p=82069 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:41:43,219 p=82069 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] ********************************************************************************************
2023-04-03 20:41:44,367 p=82069 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.112]
2023-04-03 20:41:44,497 p=82069 u=craig n=ansible | PLAY [Create a user and lock down the container] ************************************************************************************************************************************************************************
2023-04-03 20:41:44,515 p=82069 u=craig n=ansible | TASK [Gathering Facts ] *************************************************************************************************************************************************************************************************
2023-04-03 20:41:45,921 p=82069 u=craig n=ansible | ok: [vscode]
2023-04-03 20:41:45,978 p=82069 u=craig n=ansible | TASK [create_user : Ensure group sudo exists name=sudo, state=present] **************************************************************************************************************************************************
2023-04-03 20:41:46,866 p=82069 u=craig n=ansible | ok: [vscode]
2023-04-03 20:41:46,896 p=82069 u=craig n=ansible | TASK [create_user : Allow sudo group to have passwordless sudo path=/etc/sudoers, state=present, regexp=^%sudo, line=%sudo ALL=(ALL) NOPASSWD: ALL, validate=/usr/sbin/visudo -cf %s] ***********************************
2023-04-03 20:41:47,642 p=82069 u=craig n=ansible | changed: [vscode]
2023-04-03 20:41:47,682 p=82069 u=craig n=ansible | TASK [create_user : Create a new user name={{machine_user}}, password={{machine_password | string | password_hash('sha512')}}, shell=/bin/bash, groups=sudo, append=True] ***********************************************
2023-04-03 20:41:49,997 p=82069 u=craig n=ansible | changed: [vscode]
2023-04-03 20:41:50,025 p=82069 u=craig n=ansible | TASK [create_user : Create the .ssh directory path=/home/{{machine_user}}/.ssh, state=directory, mode=0700, owner={{machine_user}}, group={{machine_user}}] *************************************************************
2023-04-03 20:41:50,543 p=82069 u=craig n=ansible | changed: [vscode]
2023-04-03 20:41:50,580 p=82069 u=craig n=ansible | TASK [create_user : Copy the ssh key to the new user src={{machine_ssh_key}}, dest=/home/{{machine_user}}/.ssh/authorized_keys, mode=0600, owner={{machine_user}}, group={{machine_user}}] ******************************
2023-04-03 20:41:51,834 p=82069 u=craig n=ansible | changed: [vscode]
2023-04-03 20:41:51,911 p=82069 u=craig n=ansible | TASK [lockdown : Ensure the /run/sshd directory exists path=/run/sshd, state=directory, mode=493] ***********************************************************************************************************************
2023-04-03 20:41:52,599 p=82069 u=craig n=ansible | ok: [vscode]
2023-04-03 20:41:52,624 p=82069 u=craig n=ansible | TASK [lockdown : Update SSH configuration to be more secure dest=/etc/ssh/sshd_config, regexp={{ item.regexp }}, line={{ item.line }}, state=present, validate=sshd -T -f %s, mode=420] *********************************
2023-04-03 20:41:53,162 p=82069 u=craig n=ansible | changed: [vscode] => (item={'regexp': '^#?PasswordAuthentication', 'line': 'PasswordAuthentication no'})
2023-04-03 20:41:53,668 p=82069 u=craig n=ansible | changed: [vscode] => (item={'regexp': '^#?PermitRootLogin', 'line': 'PermitRootLogin no'})
2023-04-03 20:41:54,203 p=82069 u=craig n=ansible | changed: [vscode] => (item={'regexp': '^#?Port', 'line': 'Port 22'})
2023-04-03 20:41:54,715 p=82069 u=craig n=ansible | changed: [vscode] => (item={'regexp': '^#?PermitEmptyPasswords', 'line': 'PermitEmptyPasswords no'})
2023-04-03 20:41:54,791 p=82069 u=craig n=ansible | RUNNING HANDLER [restart ssh name=sshd, state=restarted] ****************************************************************************************************************************************************************
2023-04-03 20:41:56,266 p=82069 u=craig n=ansible | changed: [vscode]
2023-04-03 20:41:56,360 p=82069 u=craig n=ansible | PLAY [Install gui] ******************************************************************************************************************************************************************************************************
2023-04-03 20:41:56,388 p=82069 u=craig n=ansible | TASK [Gathering Facts ] *************************************************************************************************************************************************************************************************
2023-04-03 20:41:57,991 p=82069 u=craig n=ansible | ok: [vscode]
2023-04-03 20:41:58,056 p=82069 u=craig n=ansible | TASK [lxc_gui : Ensure system is up to date update_cache=True, upgrade=True] ********************************************************************************************************************************************
2023-04-03 20:41:58,099 p=82069 u=craig n=ansible | skipping: [vscode]
2023-04-03 20:41:58,132 p=82069 u=craig n=ansible | TASK [lxc_gui : Install xrdp and Xfce4 desktop and force if needed and install dependencies and recommends name={{item}}, state=present, force=True, install_recommends=True] *******************************************
2023-04-03 20:41:58,173 p=82069 u=craig n=ansible | skipping: [vscode] => (item=xfce4) 
2023-04-03 20:41:58,176 p=82069 u=craig n=ansible | skipping: [vscode] => (item=xfce4-session) 
2023-04-03 20:41:58,177 p=82069 u=craig n=ansible | skipping: [vscode] => (item=xrdp) 
2023-04-03 20:41:58,219 p=82069 u=craig n=ansible | TASK [lxc_gui : Make sure xrdp is running name=xrdp, state=started, enabled=True] ***************************************************************************************************************************************
2023-04-03 20:41:58,250 p=82069 u=craig n=ansible | skipping: [vscode]
2023-04-03 20:41:58,365 p=82069 u=craig n=ansible | TASK [lxc_gui : Install chrome using wget and apt install deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb, state=present, force=True, install_recommends=True] ****************************
2023-04-03 20:41:58,424 p=82069 u=craig n=ansible | skipping: [vscode]
2023-04-03 20:41:58,526 p=82069 u=craig n=ansible | PLAY RECAP **************************************************************************************************************************************************************************************************************
2023-04-03 20:41:58,527 p=82069 u=craig n=ansible | 192.168.1.99               : ok=13   changed=3    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-03 20:41:58,527 p=82069 u=craig n=ansible | vscode                     : ok=10   changed=6    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2023-04-03 20:43:40,846 p=82682 u=craig n=ansible | PLAY [Install VSCode Server on a fresh ubuntu LXC container] ************************************************************************************************************************************************************
2023-04-03 20:43:40,856 p=82682 u=craig n=ansible | ERROR! vars file ../../vault.yaml was not found
Could not find file on the Ansible Controller.
If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-04-03 20:45:06,306 p=82821 u=craig n=ansible | PLAY [Install VSCode Server on a fresh ubuntu LXC container] ************************************************************************************************************************************************************
2023-04-03 20:45:06,323 p=82821 u=craig n=ansible | TASK [Gathering Facts ] *************************************************************************************************************************************************************************************************
2023-04-03 20:45:07,843 p=82821 u=craig n=ansible | ok: [vscode]
2023-04-03 20:45:07,859 p=82821 u=craig n=ansible | TASK [ansible.builtin.include_vars file=../../config.json] **************************************************************************************************************************************************************
2023-04-03 20:45:07,871 p=82821 u=craig n=ansible | fatal: [vscode]: FAILED! => {"ansible_facts": {}, "ansible_included_var_files": [], "changed": false, "message": "Could not find or access '../../config.json'\nSearched in:\n\t/Users/craig/Projects/homelab/ansible/playbooks/vscode_server/vars/../../config.json\n\t/Users/craig/Projects/homelab/ansible/playbooks/vscode_server/../../config.json\n\t/Users/craig/Projects/homelab/ansible/playbooks/vscode_server/vars/../../config.json\n\t/Users/craig/Projects/homelab/ansible/playbooks/vscode_server/../../config.json on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2023-04-03 20:45:07,871 p=82821 u=craig n=ansible | PLAY RECAP **************************************************************************************************************************************************************************************************************
2023-04-03 20:45:07,872 p=82821 u=craig n=ansible | vscode                     : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-03 20:46:03,157 p=82959 u=craig n=ansible | PLAY [Install VSCode Server on a fresh ubuntu LXC container] ************************************************************************************************************************************************************
2023-04-03 20:46:03,173 p=82959 u=craig n=ansible | TASK [Gathering Facts ] *************************************************************************************************************************************************************************************************
2023-04-03 20:46:04,344 p=82959 u=craig n=ansible | ok: [vscode]
2023-04-03 20:46:04,373 p=82959 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ****************************************************************************************************************************************************
2023-04-03 20:46:04,930 p=82959 u=craig n=ansible | fatal: [vscode]: FAILED! => {"changed": false, "msg": "Unable to find any of pip3 to use.  pip needs to be installed."}
2023-04-03 20:46:04,931 p=82959 u=craig n=ansible | PLAY RECAP **************************************************************************************************************************************************************************************************************
2023-04-03 20:46:04,932 p=82959 u=craig n=ansible | vscode                     : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-03 20:46:58,020 p=83057 u=craig n=ansible | PLAY [Install VSCode Server on a fresh ubuntu LXC container] ************************************************************************************************************************************************************
2023-04-03 20:46:58,035 p=83057 u=craig n=ansible | TASK [Gathering Facts ] *************************************************************************************************************************************************************************************************
2023-04-03 20:46:59,451 p=83057 u=craig n=ansible | ok: [vscode]
2023-04-03 20:46:59,479 p=83057 u=craig n=ansible | TASK [Verify that the target is online/contactable ] ********************************************************************************************************************************************************************
2023-04-03 20:47:00,018 p=83057 u=craig n=ansible | ok: [vscode]
2023-04-03 20:47:00,039 p=83057 u=craig n=ansible | TASK [Install VSCode Server from this url 'https://code.visualstudio.com/sha/download?build=stable&os=cli-alpine-x64' url=https://code.visualstudio.com/sha/download?build=stable&os=cli-alpine-x64, dest=/tmp/vscode-server.tar.gz, mode=493] ***
2023-04-03 20:47:01,581 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:01,603 p=83057 u=craig n=ansible | TASK [Unpack the VSCode Server src=/tmp/vscode-server.tar.gz, dest=/tmp/, remote_src=True] ******************************************************************************************************************************
2023-04-03 20:47:02,982 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:03,007 p=83057 u=craig n=ansible | TASK [Move the VSCode Server to the correct location _raw_params=mv /tmp/code /root/code] *******************************************************************************************************************************
2023-04-03 20:47:03,487 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:03,508 p=83057 u=craig n=ansible | TASK [Remove the VSCode Server tarball path=/tmp/vscode-server.tar.gz, state=absent] ************************************************************************************************************************************
2023-04-03 20:47:04,010 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:04,031 p=83057 u=craig n=ansible | TASK [Remove the VSCode Server directory path=/tmp/code, state=absent] **************************************************************************************************************************************************
2023-04-03 20:47:04,320 p=83057 u=craig n=ansible | ok: [vscode]
2023-04-03 20:47:04,339 p=83057 u=craig n=ansible | TASK [Create a script called 'codeserverstart.sh' content=#!/bin/sh
./code tunnel
, dest=/usr/local/bin/codeserverstart.sh, mode=493] *************************************************************************************
2023-04-03 20:47:05,235 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:05,250 p=83057 u=craig n=ansible | TASK [Create the VSCode Server systemd service to run './code tunnel' on boot content=[Unit]
Description=VSCode Server
After=network.target

[Service]
Type=simple
User=root
ExecStart=/usr/local/bin/codeserverstart.sh
Restart=always

[Install]
WantedBy=multi-user.target
, dest=/etc/systemd/system/vscode-server.service, mode=420] ***
2023-04-03 20:47:05,919 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:05,940 p=83057 u=craig n=ansible | TASK [Enable the VSCode Server systemd service name=vscode-server, enabled=True] ****************************************************************************************************************************************
2023-04-03 20:47:06,767 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:06,788 p=83057 u=craig n=ansible | TASK [Start the VSCode Server systemd service name=vscode-server, state=started] ****************************************************************************************************************************************
2023-04-03 20:47:07,238 p=83057 u=craig n=ansible | changed: [vscode]
2023-04-03 20:47:07,274 p=83057 u=craig n=ansible | PLAY RECAP **************************************************************************************************************************************************************************************************************
2023-04-03 20:47:07,274 p=83057 u=craig n=ansible | vscode                     : ok=11   changed=8    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-07 11:21:49,738 p=37856 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:21:49,748 p=37856 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:21:49,952 p=37856 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": "vsce package", "msg": "[Errno 2] No such file or directory: b'vsce'", "rc": 2, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2023-04-07 11:21:49,953 p=37856 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:21:49,953 p=37856 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:24:06,498 p=38068 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:24:06,503 p=38068 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:24:06,693 p=38068 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": null, "end": null, "msg": "Unable to change directory before execution: [Errno 2] No such file or directory: b'craiGPT'", "rc": null, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2023-04-07 11:24:06,693 p=38068 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:24:06,693 p=38068 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:25:05,946 p=38208 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:25:05,951 p=38208 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:25:05,960 p=38208 u=craig n=ansible | fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: {{ ansible_env.PWD }}: 'ansible_env' is undefined\n\nThe error appears to be in '/Users/craig/Projects/craigpt/craigpt/ansible.yaml': line 11, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n  tasks:\n    - name: Package VSCode extension\n      ^ here\n"}
2023-04-07 11:25:05,961 p=38208 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:25:05,961 p=38208 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:26:45,525 p=38346 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:26:45,533 p=38346 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:26:45,738 p=38346 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": "vsce package", "msg": "[Errno 2] No such file or directory: b'vsce'", "rc": 2, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2023-04-07 11:26:45,739 p=38346 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:26:45,739 p=38346 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:27:47,056 p=38501 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:27:47,064 p=38501 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:27:49,272 p=38501 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:02.013785", "end": "2023-04-07 11:27:49.253220", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 11:27:47.239435", "stderr": " ERROR  npm failed with exit code 1", "stderr_lines": [" ERROR  npm failed with exit code 1"], "stdout": "Executing prepublish script 'npm run vscode:prepublish'...\n\n> craigpt@0.0.1 vscode:prepublish\n> pnpm run compile\n\n\n> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt\n> tsc -p ./\n\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1898,24): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1928,30): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1928,59): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1940,35): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1971,33): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1983,31): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2151,22): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2181,28): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2181,57): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2193,33): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2224,31): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2236,29): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2404,22): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2434,28): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2434,57): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2446,33): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2477,31): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2489,29): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2667,22): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2700,28): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2700,57): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2713,33): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2747,31): error TS2304: Cannot find name 'File'.\nnode_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2760,29): error TS2304: Cannot find name 'File'.\nsrc/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.\n  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.\n    Types of property ''role'' are incompatible.\n      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.\nsrc/extension.ts(284,33): error TS18046: 'row' is of type 'unknown'.\nsrc/extension.ts(312,23): error TS18048: 'selectedSession' is possibly 'undefined'.\nsrc/extension.ts(328,21): error TS18046: 'row' is of type 'unknown'.\nsrc/extension.ts(328,47): error TS18046: 'row' is of type 'unknown'.\nsrc/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.\nsrc/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.\nELIFECYCLE Command failed with exit code 2.", "stdout_lines": ["Executing prepublish script 'npm run vscode:prepublish'...", "", "> craigpt@0.0.1 vscode:prepublish", "> pnpm run compile", "", "", "> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt", "> tsc -p ./", "", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1898,24): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1928,30): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1928,59): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1940,35): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1971,33): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(1983,31): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2151,22): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2181,28): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2181,57): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2193,33): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2224,31): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2236,29): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2404,22): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2434,28): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2434,57): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2446,33): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2477,31): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2489,29): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2667,22): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2700,28): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2700,57): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2713,33): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2747,31): error TS2304: Cannot find name 'File'.", "node_modules/.pnpm/openai@3.2.1/node_modules/openai/dist/api.d.ts(2760,29): error TS2304: Cannot find name 'File'.", "src/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.", "  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.", "    Types of property ''role'' are incompatible.", "      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.", "src/extension.ts(284,33): error TS18046: 'row' is of type 'unknown'.", "src/extension.ts(312,23): error TS18048: 'selectedSession' is possibly 'undefined'.", "src/extension.ts(328,21): error TS18046: 'row' is of type 'unknown'.", "src/extension.ts(328,47): error TS18046: 'row' is of type 'unknown'.", "src/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.", "src/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.", "ELIFECYCLE Command failed with exit code 2."]}
2023-04-07 11:27:49,273 p=38501 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:27:49,273 p=38501 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:30:30,003 p=38845 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:30:30,010 p=38845 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:30:32,104 p=38845 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:01.889787", "end": "2023-04-07 11:30:32.084961", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 11:30:30.195174", "stderr": " ERROR  npm failed with exit code 1", "stderr_lines": [" ERROR  npm failed with exit code 1"], "stdout": "Executing prepublish script 'npm run vscode:prepublish'...\n\n> craigpt@0.0.1 vscode:prepublish\n> pnpm run compile\n\n\n> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt\n> tsc -p ./\n\nsrc/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.\n  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.\n    Types of property ''role'' are incompatible.\n      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.\nsrc/extension.ts(284,33): error TS18046: 'row' is of type 'unknown'.\nsrc/extension.ts(312,23): error TS18048: 'selectedSession' is possibly 'undefined'.\nsrc/extension.ts(328,21): error TS18046: 'row' is of type 'unknown'.\nsrc/extension.ts(328,47): error TS18046: 'row' is of type 'unknown'.\nsrc/fetchOAI.ts(14,43): error TS2379: Argument of type '{ apiKey: string | undefined; }' is not assignable to parameter of type 'ConfigurationParameters' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.\n  Types of property 'apiKey' are incompatible.\n    Type 'string | undefined' is not assignable to type 'string | Promise<string> | ((name: string) => string) | ((name: string) => Promise<string>)'.\n      Type 'undefined' is not assignable to type 'string | Promise<string> | ((name: string) => string) | ((name: string) => Promise<string>)'.\nsrc/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.\nsrc/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.\nELIFECYCLE Command failed with exit code 2.", "stdout_lines": ["Executing prepublish script 'npm run vscode:prepublish'...", "", "> craigpt@0.0.1 vscode:prepublish", "> pnpm run compile", "", "", "> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt", "> tsc -p ./", "", "src/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.", "  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.", "    Types of property ''role'' are incompatible.", "      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.", "src/extension.ts(284,33): error TS18046: 'row' is of type 'unknown'.", "src/extension.ts(312,23): error TS18048: 'selectedSession' is possibly 'undefined'.", "src/extension.ts(328,21): error TS18046: 'row' is of type 'unknown'.", "src/extension.ts(328,47): error TS18046: 'row' is of type 'unknown'.", "src/fetchOAI.ts(14,43): error TS2379: Argument of type '{ apiKey: string | undefined; }' is not assignable to parameter of type 'ConfigurationParameters' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.", "  Types of property 'apiKey' are incompatible.", "    Type 'string | undefined' is not assignable to type 'string | Promise<string> | ((name: string) => string) | ((name: string) => Promise<string>)'.", "      Type 'undefined' is not assignable to type 'string | Promise<string> | ((name: string) => string) | ((name: string) => Promise<string>)'.", "src/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.", "src/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.", "ELIFECYCLE Command failed with exit code 2."]}
2023-04-07 11:30:32,105 p=38845 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:30:32,105 p=38845 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:31:01,433 p=38997 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:31:01,438 p=38997 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:31:03,408 p=38997 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:01.767025", "end": "2023-04-07 11:31:03.388824", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 11:31:01.621799", "stderr": " ERROR  npm failed with exit code 1", "stderr_lines": [" ERROR  npm failed with exit code 1"], "stdout": "Executing prepublish script 'npm run vscode:prepublish'...\n\n> craigpt@0.0.1 vscode:prepublish\n> pnpm run compile\n\n\n> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt\n> tsc -p ./\n\ntsconfig.json(13,3): error TS5052: Option 'exactOptionalPropertyTypes' cannot be specified without specifying option 'strictNullChecks'.\nELIFECYCLE Command failed with exit code 2.", "stdout_lines": ["Executing prepublish script 'npm run vscode:prepublish'...", "", "> craigpt@0.0.1 vscode:prepublish", "> pnpm run compile", "", "", "> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt", "> tsc -p ./", "", "tsconfig.json(13,3): error TS5052: Option 'exactOptionalPropertyTypes' cannot be specified without specifying option 'strictNullChecks'.", "ELIFECYCLE Command failed with exit code 2."]}
2023-04-07 11:31:03,408 p=38997 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:31:03,408 p=38997 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:31:21,405 p=39143 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:31:21,411 p=39143 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:31:23,332 p=39143 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:01.715868", "end": "2023-04-07 11:31:23.314160", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 11:31:21.598292", "stderr": " ERROR  npm failed with exit code 1", "stderr_lines": [" ERROR  npm failed with exit code 1"], "stdout": "Executing prepublish script 'npm run vscode:prepublish'...\n\n> craigpt@0.0.1 vscode:prepublish\n> pnpm run compile\n\n\n> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt\n> tsc -p ./\n\nsrc/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.\n  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.\n    Types of property ''role'' are incompatible.\n      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.\nsrc/extension.ts(284,37): error TS2339: Property 'sessionId' does not exist on type 'unknown'.\nsrc/extension.ts(328,25): error TS2339: Property 'messageRole' does not exist on type 'unknown'.\nsrc/extension.ts(328,51): error TS2339: Property 'messageContent' does not exist on type 'unknown'.\nsrc/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.\nsrc/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.\nELIFECYCLE Command failed with exit code 2.", "stdout_lines": ["Executing prepublish script 'npm run vscode:prepublish'...", "", "> craigpt@0.0.1 vscode:prepublish", "> pnpm run compile", "", "", "> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt", "> tsc -p ./", "", "src/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.", "  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.", "    Types of property ''role'' are incompatible.", "      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.", "src/extension.ts(284,37): error TS2339: Property 'sessionId' does not exist on type 'unknown'.", "src/extension.ts(328,25): error TS2339: Property 'messageRole' does not exist on type 'unknown'.", "src/extension.ts(328,51): error TS2339: Property 'messageContent' does not exist on type 'unknown'.", "src/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.", "src/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.", "ELIFECYCLE Command failed with exit code 2."]}
2023-04-07 11:31:23,333 p=39143 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:31:23,333 p=39143 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:34:23,984 p=39486 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:34:23,989 p=39486 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:34:26,006 p=39486 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:01.819789", "end": "2023-04-07 11:34:25.986476", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 11:34:24.166687", "stderr": " ERROR  npm failed with exit code 1", "stderr_lines": [" ERROR  npm failed with exit code 1"], "stdout": "Executing prepublish script 'npm run vscode:prepublish'...\n\n> craigpt@0.0.1 vscode:prepublish\n> pnpm run compile\n\n\n> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt\n> tsc -p ./\n\nsrc/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.\n  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.\n    Types of property ''role'' are incompatible.\n      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.\nsrc/extension.ts(284,33): error TS18046: 'row' is of type 'unknown'.\nsrc/extension.ts(312,23): error TS18048: 'selectedSession' is possibly 'undefined'.\nsrc/extension.ts(328,21): error TS18046: 'row' is of type 'unknown'.\nsrc/extension.ts(328,47): error TS18046: 'row' is of type 'unknown'.\nsrc/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.\nsrc/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.\nELIFECYCLE Command failed with exit code 1.", "stdout_lines": ["Executing prepublish script 'npm run vscode:prepublish'...", "", "> craigpt@0.0.1 vscode:prepublish", "> pnpm run compile", "", "", "> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt", "> tsc -p ./", "", "src/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.", "  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.", "    Types of property ''role'' are incompatible.", "      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.", "src/extension.ts(284,33): error TS18046: 'row' is of type 'unknown'.", "src/extension.ts(312,23): error TS18048: 'selectedSession' is possibly 'undefined'.", "src/extension.ts(328,21): error TS18046: 'row' is of type 'unknown'.", "src/extension.ts(328,47): error TS18046: 'row' is of type 'unknown'.", "src/fetchOAI.ts(38,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.", "src/fetchOAI.ts(59,48): error TS2345: Argument of type 'CreateChatCompletionResponse' is not assignable to parameter of type 'string'.", "ELIFECYCLE Command failed with exit code 1."]}
2023-04-07 11:34:26,007 p=39486 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:34:26,007 p=39486 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:55:56,394 p=41356 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:55:56,402 p=41356 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:55:56,827 p=41356 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:00.228206", "end": "2023-04-07 11:55:56.808884", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 11:55:56.580678", "stderr": " ERROR  @types/vscode ^1.77.0 greater than engines.vscode ^1.76.0. Consider upgrade engines.vscode or use an older @types/vscode version", "stderr_lines": [" ERROR  @types/vscode ^1.77.0 greater than engines.vscode ^1.76.0. Consider upgrade engines.vscode or use an older @types/vscode version"], "stdout": "", "stdout_lines": []}
2023-04-07 11:55:56,827 p=41356 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:55:56,827 p=41356 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 11:57:55,367 p=41539 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:57:55,372 p=41539 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:57:57,660 p=41539 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:02.095057", "end": "2023-04-07 11:57:57.641044", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 11:57:55.545987", "stderr": " ERROR  npm failed with exit code 1", "stderr_lines": [" ERROR  npm failed with exit code 1"], "stdout": "Executing prepublish script 'npm run vscode:prepublish'...\n\n> craigpt@0.0.1 vscode:prepublish\n> pnpm run compile\n\n\n> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt\n> tsc -p ./\n\nsrc/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.\n  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.\n    Types of property ''role'' are incompatible.\n      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.\nsrc/fetchOAI.ts(39,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.\nELIFECYCLE Command failed with exit code 1.", "stdout_lines": ["Executing prepublish script 'npm run vscode:prepublish'...", "", "> craigpt@0.0.1 vscode:prepublish", "> pnpm run compile", "", "", "> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt", "> tsc -p ./", "", "src/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.", "  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.", "    Types of property ''role'' are incompatible.", "      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.", "src/fetchOAI.ts(39,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.", "ELIFECYCLE Command failed with exit code 1."]}
2023-04-07 11:57:57,660 p=41539 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 11:57:57,660 p=41539 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-07 12:04:42,541 p=42183 u=craig n=ansible | PLAY [Create and update VSCode extension] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 12:04:42,548 p=42183 u=craig n=ansible | TASK [Package VSCode extension chdir={{ extension_dir }}, _raw_params=vsce package] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 12:04:44,571 p=42183 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["vsce", "package"], "delta": "0:00:01.820553", "end": "2023-04-07 12:04:44.552695", "msg": "non-zero return code", "rc": 1, "start": "2023-04-07 12:04:42.732142", "stderr": " ERROR  npm failed with exit code 1", "stderr_lines": [" ERROR  npm failed with exit code 1"], "stdout": "Executing prepublish script 'npm run vscode:prepublish'...\n\n> craigpt@0.0.1 vscode:prepublish\n> pnpm run compile\n\n\n> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt\n> tsc -p ./\n\nsrc/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.\n  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.\n    Types of property ''role'' are incompatible.\n      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.\nsrc/extension.ts(330,12): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'GPTContext[] | PromiseLike<GPTContext[]>'.\n  Type '{ role: string; content: string; }[]' is not assignable to type 'GPTContext[]'.\n    Type '{ role: string; content: string; }' is not assignable to type 'GPTContext'.\n      Types of property 'role' are incompatible.\n        Type 'string' is not assignable to type 'ChatCompletionResponseMessageRoleEnum'.\nsrc/fetchOAI.ts(39,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.\nELIFECYCLE Command failed with exit code 1.", "stdout_lines": ["Executing prepublish script 'npm run vscode:prepublish'...", "", "> craigpt@0.0.1 vscode:prepublish", "> pnpm run compile", "", "", "> craigpt@0.0.1 compile /Users/craig/Projects/craigpt/craigpt", "> tsc -p ./", "", "src/extension.ts(112,55): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'ChatCompletionRequestMessage[]'.", "  Type '{ role: string; content: string; }' is not assignable to type 'ChatCompletionRequestMessage'.", "    Types of property ''role'' are incompatible.", "      Type 'string' is not assignable to type 'ChatCompletionRequestMessageRoleEnum'.", "src/extension.ts(330,12): error TS2345: Argument of type '{ role: string; content: string; }[]' is not assignable to parameter of type 'GPTContext[] | PromiseLike<GPTContext[]>'.", "  Type '{ role: string; content: string; }[]' is not assignable to type 'GPTContext[]'.", "    Type '{ role: string; content: string; }' is not assignable to type 'GPTContext'.", "      Types of property 'role' are incompatible.", "        Type 'string' is not assignable to type 'ChatCompletionResponseMessageRoleEnum'.", "src/fetchOAI.ts(39,48): error TS2339: Property 'delta' does not exist on type 'CreateChatCompletionResponseChoicesInner'.", "ELIFECYCLE Command failed with exit code 1."]}
2023-04-07 12:04:44,572 p=42183 u=craig n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-04-07 12:04:44,572 p=42183 u=craig n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 10:53:12,722 p=66082 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 10:53:12,755 p=66082 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 10:53:14,149 p=66082 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:53:14,170 p=66082 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 10:53:15,187 p=66082 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:53:15,193 p=66082 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 10:53:15,845 p=66082 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:53:15,850 p=66082 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 10:53:16,369 p=66082 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:53:16,375 p=66082 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 10:53:22,413 p=66082 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:53:22,419 p=66082 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 10:53:23,082 p=66082 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:53:23,088 p=66082 u=craig n=ansible | TASK [Initialize Docker Swarm creates=/var/lib/docker/swarm, _raw_params=docker swarm init --advertise-addr {{ ansible_host }}] *************************************************************************************************
2023-04-23 10:53:23,484 p=66082 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:53:23,491 p=66082 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yml.j2, dest=/root/portainer-agent.yml, owner=root, group=root, mode=0644] **********************************************************************************
2023-04-23 10:53:24,322 p=66082 u=craig n=ansible | changed: [swarm-master]
2023-04-23 10:53:24,329 p=66082 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, compose_file_name=portainer-agent.yml, state=present] ***************************************************************************************************************************
2023-04-23 10:53:24,782 p=66082 u=craig n=ansible | fatal: [swarm-master]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (community.docker.docker_compose) module: compose_file_name. Supported parameters include: api_version, build, ca_cert, client_cert, client_key, debug, definition, dependencies, docker_host, env_file, files, hostname_check, nocache, profiles, project_name, project_src, pull, recreate, remove_images, remove_orphans, remove_volumes, restarted, scale, services, ssl_version, state, stopped, timeout, tls, tls_hostname, use_ssh_client, validate_certs (cacert_path, cert_path, docker_api_version, docker_url, key_path, tls_ca_cert, tls_client_cert, tls_client_key, tls_verify)."}
2023-04-23 10:53:24,783 p=66082 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 10:53:24,783 p=66082 u=craig n=ansible | swarm-master               : ok=8    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 10:55:27,742 p=66382 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 10:55:27,755 p=66382 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 10:55:29,092 p=66382 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:55:29,111 p=66382 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 10:55:30,010 p=66382 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:55:30,023 p=66382 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 10:55:30,713 p=66382 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:55:30,719 p=66382 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 10:55:31,241 p=66382 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:55:31,267 p=66382 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 10:55:32,963 p=66382 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:55:32,969 p=66382 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 10:55:33,658 p=66382 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:55:33,665 p=66382 u=craig n=ansible | TASK [Initialize Docker Swarm creates=/var/lib/docker/swarm, _raw_params=docker swarm init --advertise-addr {{ ansible_host }}] *************************************************************************************************
2023-04-23 10:55:34,112 p=66382 u=craig n=ansible | ok: [swarm-master]
2023-04-23 10:55:34,119 p=66382 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 10:55:34,924 p=66382 u=craig n=ansible | changed: [swarm-master]
2023-04-23 10:55:34,930 p=66382 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 10:55:35,385 p=66382 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ModuleNotFoundError: No module named 'requests'
2023-04-23 10:55:35,385 p=66382 u=craig n=ansible | fatal: [swarm-master]: FAILED! => {"changed": false, "msg": "Failed to import the required Python library (Docker SDK for Python: docker>=5.0.0 (Python >= 3.6) or docker<5.0.0 (Python 2.7)) on swarm-master's Python /usr/bin/python3. Please read the module documentation and install it in the appropriate location. If the required library is installed, but Ansible is using the wrong Python interpreter, please consult the documentation on ansible_python_interpreter, for example via `pip install docker` (Python >= 3.6) or `pip install docker==4.4.4` (Python 2.7). The error was: No module named 'requests'"}
2023-04-23 10:55:35,386 p=66382 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 10:55:35,386 p=66382 u=craig n=ansible | swarm-master               : ok=8    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 11:06:31,797 p=67334 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 11:06:31,817 p=67334 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 11:06:33,172 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:06:33,187 p=67334 u=craig n=ansible | TASK [python_setup : Install Python3 and required packages name=['python3', 'python3-pip'], state=present] **********************************************************************************************************************
2023-04-23 11:06:57,821 p=67334 u=craig n=ansible | changed: [swarm-master]
2023-04-23 11:06:57,828 p=67334 u=craig n=ansible | TASK [python_setup : Install requests package name=requests, state=present, executable=pip3] ************************************************************************************************************************************
2023-04-23 11:06:59,943 p=67334 u=craig n=ansible | changed: [swarm-master]
2023-04-23 11:06:59,953 p=67334 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 11:07:00,800 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:07:00,805 p=67334 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 11:07:01,466 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:07:01,472 p=67334 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 11:07:02,063 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:07:02,069 p=67334 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 11:07:03,687 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:07:03,693 p=67334 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 11:07:04,353 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:07:04,367 p=67334 u=craig n=ansible | TASK [Initialize Docker Swarm creates=/var/lib/docker/swarm, _raw_params=docker swarm init --advertise-addr {{ ansible_host }}] *************************************************************************************************
2023-04-23 11:07:04,761 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:07:04,768 p=67334 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 11:07:05,526 p=67334 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:07:05,532 p=67334 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 11:07:06,045 p=67334 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ModuleNotFoundError: No module named 'docker'
2023-04-23 11:07:06,046 p=67334 u=craig n=ansible | fatal: [swarm-master]: FAILED! => {"changed": false, "msg": "Failed to import the required Python library (Docker SDK for Python: docker>=5.0.0 (Python >= 3.6) or docker<5.0.0 (Python 2.7)) on swarm-master's Python /usr/bin/python3. Please read the module documentation and install it in the appropriate location. If the required library is installed, but Ansible is using the wrong Python interpreter, please consult the documentation on ansible_python_interpreter, for example via `pip install docker` (Python >= 3.6) or `pip install docker==4.4.4` (Python 2.7). The error was: No module named 'docker'"}
2023-04-23 11:07:06,047 p=67334 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 11:07:06,047 p=67334 u=craig n=ansible | swarm-master               : ok=10   changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 11:10:32,581 p=67758 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 11:10:32,593 p=67758 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 11:10:34,013 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:10:34,028 p=67758 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 11:10:35,484 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:10:35,490 p=67758 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 11:10:36,352 p=67758 u=craig n=ansible | ok: [swarm-master] => (item=apt-transport-https)
2023-04-23 11:10:37,105 p=67758 u=craig n=ansible | ok: [swarm-master] => (item=ca-certificates)
2023-04-23 11:10:37,839 p=67758 u=craig n=ansible | ok: [swarm-master] => (item=curl)
2023-04-23 11:10:38,710 p=67758 u=craig n=ansible | ok: [swarm-master] => (item=gnupg)
2023-04-23 11:10:39,539 p=67758 u=craig n=ansible | ok: [swarm-master] => (item=lsb-release)
2023-04-23 11:10:54,165 p=67758 u=craig n=ansible | changed: [swarm-master] => (item=software-properties-common)
2023-04-23 11:10:54,174 p=67758 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 11:10:54,884 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:10:54,890 p=67758 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 11:10:55,447 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:10:55,452 p=67758 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 11:10:56,242 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:10:56,248 p=67758 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 11:10:56,903 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:10:56,911 p=67758 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 11:10:57,427 p=67758 u=craig n=ansible | changed: [swarm-master]
2023-04-23 11:10:57,432 p=67758 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 11:10:58,264 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:10:58,276 p=67758 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 11:11:02,973 p=67758 u=craig n=ansible | changed: [swarm-master]
2023-04-23 11:11:02,984 p=67758 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 11:11:03,790 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:11:03,796 p=67758 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 11:11:04,302 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:11:04,308 p=67758 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 11:11:04,710 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:11:04,716 p=67758 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 11:11:06,352 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:11:06,365 p=67758 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 11:11:06,861 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:11:06,867 p=67758 u=craig n=ansible | TASK [Initialize Docker Swarm creates=/var/lib/docker/swarm, _raw_params=docker swarm init --advertise-addr {{ ansible_host }}] *************************************************************************************************
2023-04-23 11:11:07,268 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:11:07,274 p=67758 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 11:11:08,042 p=67758 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:11:08,048 p=67758 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 11:11:08,722 p=67758 u=craig n=ansible | fatal: [swarm-master]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "", "msg": "Error starting project 500 Server Error for http+docker://localhost/v1.42/networks/create: Internal Server Error (\"This node is not a swarm manager. Use \"docker swarm init\" or \"docker swarm join\" to connect this node to swarm and try again.\")"}
2023-04-23 11:11:08,723 p=67758 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 11:11:08,723 p=67758 u=craig n=ansible | swarm-master               : ok=17   changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 11:16:23,596 p=68374 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 11:16:23,606 p=68374 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 11:16:24,900 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:24,920 p=68374 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 11:16:26,383 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:26,388 p=68374 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 11:16:27,374 p=68374 u=craig n=ansible | ok: [swarm-master] => (item=apt-transport-https)
2023-04-23 11:16:28,305 p=68374 u=craig n=ansible | ok: [swarm-master] => (item=ca-certificates)
2023-04-23 11:16:29,079 p=68374 u=craig n=ansible | ok: [swarm-master] => (item=curl)
2023-04-23 11:16:29,848 p=68374 u=craig n=ansible | ok: [swarm-master] => (item=gnupg)
2023-04-23 11:16:30,596 p=68374 u=craig n=ansible | ok: [swarm-master] => (item=lsb-release)
2023-04-23 11:16:31,377 p=68374 u=craig n=ansible | ok: [swarm-master] => (item=software-properties-common)
2023-04-23 11:16:31,386 p=68374 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 11:16:32,063 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:32,068 p=68374 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 11:16:32,641 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:32,653 p=68374 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 11:16:33,509 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:33,515 p=68374 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 11:16:34,161 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:34,172 p=68374 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 11:16:34,652 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:34,665 p=68374 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 11:16:35,457 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:35,470 p=68374 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 11:16:36,544 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:36,555 p=68374 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 11:16:37,402 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:37,408 p=68374 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 11:16:37,902 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:37,907 p=68374 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 11:16:38,316 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:38,322 p=68374 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 11:16:39,899 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:39,905 p=68374 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 11:16:40,309 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:40,315 p=68374 u=craig n=ansible | TASK [Initialize Docker Swarm creates=/var/lib/docker/swarm, _raw_params=docker swarm init --advertise-addr {{ ansible_host }}] *************************************************************************************************
2023-04-23 11:16:40,750 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:40,756 p=68374 u=craig n=ansible | TASK [Wait for Docker Swarm to be initialized timeout=10] ***********************************************************************************************************************************************************************
2023-04-23 11:16:51,174 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:51,180 p=68374 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 11:16:51,953 p=68374 u=craig n=ansible | ok: [swarm-master]
2023-04-23 11:16:51,959 p=68374 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 11:16:52,684 p=68374 u=craig n=ansible | fatal: [swarm-master]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "", "msg": "Error starting project 500 Server Error for http+docker://localhost/v1.42/networks/create: Internal Server Error (\"This node is not a swarm manager. Use \"docker swarm init\" or \"docker swarm join\" to connect this node to swarm and try again.\")"}
2023-04-23 11:16:52,685 p=68374 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 11:16:52,685 p=68374 u=craig n=ansible | swarm-master               : ok=18   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 13:51:13,680 p=78589 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 13:51:13,687 p=78589 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 13:51:14,956 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:14,971 p=78589 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 13:51:17,900 p=78589 u=craig n=ansible | changed: [swarm-master]
2023-04-23 13:51:17,908 p=78589 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 13:51:18,709 p=78589 u=craig n=ansible | ok: [swarm-master] => (item=apt-transport-https)
2023-04-23 13:51:19,534 p=78589 u=craig n=ansible | ok: [swarm-master] => (item=ca-certificates)
2023-04-23 13:51:20,303 p=78589 u=craig n=ansible | ok: [swarm-master] => (item=curl)
2023-04-23 13:51:21,080 p=78589 u=craig n=ansible | ok: [swarm-master] => (item=gnupg)
2023-04-23 13:51:21,883 p=78589 u=craig n=ansible | ok: [swarm-master] => (item=lsb-release)
2023-04-23 13:51:22,712 p=78589 u=craig n=ansible | ok: [swarm-master] => (item=software-properties-common)
2023-04-23 13:51:22,725 p=78589 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 13:51:23,327 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:23,335 p=78589 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 13:51:23,815 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:23,824 p=78589 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 13:51:24,657 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:24,663 p=78589 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 13:51:25,182 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:25,190 p=78589 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 13:51:25,574 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:25,581 p=78589 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 13:51:26,505 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:26,514 p=78589 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 13:51:27,630 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:27,645 p=78589 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 13:51:28,552 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:28,560 p=78589 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 13:51:29,078 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:29,085 p=78589 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 13:51:29,562 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:29,566 p=78589 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 13:51:31,237 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:31,245 p=78589 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 13:51:31,679 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:31,687 p=78589 u=craig n=ansible | TASK [Initialize Docker Swarm creates=/var/lib/docker/swarm, _raw_params=docker swarm init --advertise-addr {{ ansible_host }}] *************************************************************************************************
2023-04-23 13:51:32,032 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:32,038 p=78589 u=craig n=ansible | TASK [Wait for Docker Swarm to be initialized timeout=10] ***********************************************************************************************************************************************************************
2023-04-23 13:51:42,416 p=78589 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:51:42,426 p=78589 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 13:51:43,209 p=78589 u=craig n=ansible | changed: [swarm-master]
2023-04-23 13:51:43,217 p=78589 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 13:51:43,840 p=78589 u=craig n=ansible | fatal: [swarm-master]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "", "msg": "Error starting project 500 Server Error for http+docker://localhost/v1.42/networks/create: Internal Server Error (\"This node is not a swarm manager. Use \"docker swarm init\" or \"docker swarm join\" to connect this node to swarm and try again.\")"}
2023-04-23 13:51:43,841 p=78589 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 13:51:43,841 p=78589 u=craig n=ansible | swarm-master               : ok=18   changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 13:58:34,655 p=79336 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 13:58:34,662 p=79336 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 13:58:35,968 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:35,984 p=79336 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 13:58:37,636 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:37,645 p=79336 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 13:58:38,452 p=79336 u=craig n=ansible | ok: [swarm-master] => (item=apt-transport-https)
2023-04-23 13:58:39,217 p=79336 u=craig n=ansible | ok: [swarm-master] => (item=ca-certificates)
2023-04-23 13:58:40,077 p=79336 u=craig n=ansible | ok: [swarm-master] => (item=curl)
2023-04-23 13:58:40,890 p=79336 u=craig n=ansible | ok: [swarm-master] => (item=gnupg)
2023-04-23 13:58:41,716 p=79336 u=craig n=ansible | ok: [swarm-master] => (item=lsb-release)
2023-04-23 13:58:42,492 p=79336 u=craig n=ansible | ok: [swarm-master] => (item=software-properties-common)
2023-04-23 13:58:42,504 p=79336 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 13:58:43,111 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:43,119 p=79336 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 13:58:43,654 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:43,663 p=79336 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 13:58:44,438 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:44,446 p=79336 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 13:58:44,992 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:45,000 p=79336 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 13:58:45,399 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:45,407 p=79336 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 13:58:46,162 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:46,170 p=79336 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 13:58:47,163 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:47,178 p=79336 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 13:58:48,006 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:48,014 p=79336 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 13:58:48,573 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:48,581 p=79336 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 13:58:48,987 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:48,991 p=79336 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 13:58:50,668 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:50,676 p=79336 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 13:58:51,098 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:51,106 p=79336 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 13:58:52,319 p=79336 u=craig n=ansible | changed: [swarm-master]
2023-04-23 13:58:52,328 p=79336 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 13:58:53,144 p=79336 u=craig n=ansible | ok: [swarm-master]
2023-04-23 13:58:53,153 p=79336 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 13:59:11,192 p=79336 u=craig n=ansible | changed: [swarm-master]
2023-04-23 13:59:11,217 p=79336 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 13:59:11,217 p=79336 u=craig n=ansible | swarm-master               : ok=18   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 14:10:39,125 p=80385 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 14:10:39,132 p=80385 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:10:40,363 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:40,379 p=80385 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 14:10:41,987 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:41,995 p=80385 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 14:10:42,778 p=80385 u=craig n=ansible | ok: [swarm-master] => (item=apt-transport-https)
2023-04-23 14:10:43,644 p=80385 u=craig n=ansible | ok: [swarm-master] => (item=ca-certificates)
2023-04-23 14:10:44,431 p=80385 u=craig n=ansible | ok: [swarm-master] => (item=curl)
2023-04-23 14:10:45,286 p=80385 u=craig n=ansible | ok: [swarm-master] => (item=gnupg)
2023-04-23 14:10:46,083 p=80385 u=craig n=ansible | ok: [swarm-master] => (item=lsb-release)
2023-04-23 14:10:46,882 p=80385 u=craig n=ansible | ok: [swarm-master] => (item=software-properties-common)
2023-04-23 14:10:46,894 p=80385 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 14:10:47,477 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:47,485 p=80385 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 14:10:47,967 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:47,975 p=80385 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 14:10:48,754 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:48,763 p=80385 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 14:10:49,318 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:49,326 p=80385 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 14:10:49,728 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:49,733 p=80385 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 14:10:50,498 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:50,505 p=80385 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 14:10:51,598 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:51,612 p=80385 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 14:10:52,378 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:52,387 p=80385 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 14:10:52,962 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:52,971 p=80385 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 14:10:53,471 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:53,480 p=80385 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 14:10:55,213 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:55,222 p=80385 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 14:10:55,628 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:55,635 p=80385 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 14:10:56,238 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:56,247 p=80385 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 14:10:56,939 p=80385 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:10:56,946 p=80385 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 14:11:00,562 p=80385 u=craig n=ansible | changed: [swarm-master]
2023-04-23 14:11:00,572 p=80385 u=craig n=ansible | TASK [Show deployment result var=deploy_result] *********************************************************************************************************************************************************************************
2023-04-23 14:11:00,595 p=80385 u=craig n=ansible | ok: [swarm-master] => {
    "deploy_result": {
        "changed": true,
        "failed": false,
        "services": {
            "agent": {
                "root_agent_1": {
                    "cmd": [],
                    "image": "portainer/agent:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "7c9b0c17a0cb9cc41dd12a68fa5a7cdab1372e8005e65f2bd7aa587c03d37eba",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "agent",
                        "com.docker.compose.version": "1.29.2",
                        "io.portainer.agent": "true"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "10.0.1.7",
                            "IPPrefixLen": 24,
                            "aliases": [
                                "agent",
                                "f39c3e819813"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": "02:42:0a:00:01:07"
                        }
                    },
                    "state": {
                        "running": true,
                        "status": "running"
                    }
                }
            },
            "portainer": {
                "root_portainer_1": {
                    "cmd": [
                        "-H",
                        "tcp://tasks.agent:9001",
                        "--tlsskipverify"
                    ],
                    "image": "portainer/portainer-ce:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "367b3b6ef0314131d70681afc91e9bd3c916ebda2fa44437558462f17fe180fc",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "portainer",
                        "com.docker.compose.version": "1.29.2",
                        "com.docker.desktop.extension.api.version": ">= 0.2.2",
                        "com.docker.desktop.extension.icon": "https://portainer-io-assets.sfo2.cdn.digitaloceanspaces.com/logos/portainer.png",
                        "com.docker.extension.additional-urls": "[{\"title\":\"Website\",\"url\":\"https://www.portainer.io?utm_campaign=DockerCon&utm_source=DockerDesktop\"},{\"title\":\"Documentation\",\"url\":\"https://docs.portainer.io\"},{\"title\":\"Support\",\"url\":\"https://join.slack.com/t/portainer/shared_invite/zt-txh3ljab-52QHTyjCqbe5RibC2lcjKA\"}]",
                        "com.docker.extension.detailed-description": "<p data-renderer-start-pos=\"226\">Portainer&rsquo;s Docker Desktop extension gives you access to all of Portainer&rsquo;s rich management functionality within your docker desktop experience.</p><h2 data-renderer-start-pos=\"374\">With Portainer you can:</h2><ul><li>See all your running containers</li><li>Easily view all of your container logs</li><li>Console into containers</li><li>Easily deploy your code into containers using a simple form</li><li>Turn your YAML into custom templates for easy reuse</li></ul><h2 data-renderer-start-pos=\"660\">About Portainer&nbsp;</h2><p data-renderer-start-pos=\"680\">Portainer is the worlds&rsquo; most popular universal container management platform with more than 650,000 active monthly users. Portainer can be used to manage Docker Standalone, Kubernetes, Docker Swarm and Nomad environments through a single common interface. It includes a simple GitOps automation engine and a Kube API.&nbsp;</p><p data-renderer-start-pos=\"1006\">Portainer Business Edition is our fully supported commercial grade product for business-wide use. It includes all the functionality that businesses need to manage containers at scale. Visit <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/\" title=\"http://Portainer.io\" data-renderer-mark=\"true\">Portainer.io</a> to learn more about Portainer Business and <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" title=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" data-renderer-mark=\"true\">get 5 free nodes.</a></p>",
                        "com.docker.extension.publisher-url": "https://www.portainer.io",
                        "com.docker.extension.screenshots": "[{\"alt\": \"screenshot one\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-1.png\"},{\"alt\": \"screenshot two\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-2.png\"},{\"alt\": \"screenshot three\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-3.png\"},{\"alt\": \"screenshot four\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-4.png\"},{\"alt\": \"screenshot five\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-5.png\"},{\"alt\": \"screenshot six\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-6.png\"},{\"alt\": \"screenshot seven\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-7.png\"},{\"alt\": \"screenshot eight\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-8.png\"},{\"alt\": \"screenshot nine\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-9.png\"}]",
                        "io.portainer.server": "true",
                        "org.opencontainers.image.description": "Docker container management made simple, with the worlds most popular GUI-based container management platform.",
                        "org.opencontainers.image.title": "Portainer",
                        "org.opencontainers.image.vendor": "Portainer.io"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "",
                            "IPPrefixLen": 0,
                            "aliases": [
                                "portainer",
                                "319243d2b958"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": ""
                        }
                    },
                    "state": {
                        "running": false,
                        "status": "exited"
                    }
                }
            }
        }
    }
}
2023-04-23 14:11:00,613 p=80385 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:11:00,613 p=80385 u=craig n=ansible | swarm-master               : ok=19   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 14:16:56,222 p=81022 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 14:16:56,229 p=81022 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:16:57,619 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:16:57,635 p=81022 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 14:16:59,162 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:16:59,171 p=81022 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 14:17:00,061 p=81022 u=craig n=ansible | ok: [swarm-master] => (item=apt-transport-https)
2023-04-23 14:17:00,819 p=81022 u=craig n=ansible | ok: [swarm-master] => (item=ca-certificates)
2023-04-23 14:17:01,598 p=81022 u=craig n=ansible | ok: [swarm-master] => (item=curl)
2023-04-23 14:17:02,387 p=81022 u=craig n=ansible | ok: [swarm-master] => (item=gnupg)
2023-04-23 14:17:03,140 p=81022 u=craig n=ansible | ok: [swarm-master] => (item=lsb-release)
2023-04-23 14:17:03,947 p=81022 u=craig n=ansible | ok: [swarm-master] => (item=software-properties-common)
2023-04-23 14:17:03,959 p=81022 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 14:17:04,545 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:04,554 p=81022 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 14:17:05,030 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:05,038 p=81022 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 14:17:05,893 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:05,901 p=81022 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 14:17:06,450 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:06,458 p=81022 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 14:17:06,852 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:06,859 p=81022 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 14:17:07,636 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:07,644 p=81022 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 14:17:08,666 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:08,681 p=81022 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 14:17:09,450 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:09,459 p=81022 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 14:17:09,988 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:09,997 p=81022 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 14:17:10,401 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:10,409 p=81022 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 14:17:12,148 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:12,157 p=81022 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 14:17:12,656 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:12,664 p=81022 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 14:17:13,204 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:13,214 p=81022 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 14:17:13,861 p=81022 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:17:13,867 p=81022 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 14:17:16,523 p=81022 u=craig n=ansible | changed: [swarm-master]
2023-04-23 14:17:16,532 p=81022 u=craig n=ansible | TASK [Show deployment result var=deploy_result] *********************************************************************************************************************************************************************************
2023-04-23 14:17:16,554 p=81022 u=craig n=ansible | ok: [swarm-master] => {
    "deploy_result": {
        "changed": true,
        "failed": false,
        "services": {
            "agent": {
                "root_agent_1": {
                    "cmd": [],
                    "image": "portainer/agent:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "7c9b0c17a0cb9cc41dd12a68fa5a7cdab1372e8005e65f2bd7aa587c03d37eba",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "agent",
                        "com.docker.compose.version": "1.29.2",
                        "io.portainer.agent": "true"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "10.0.1.8",
                            "IPPrefixLen": 24,
                            "aliases": [
                                "agent",
                                "f39c3e819813"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": "02:42:0a:00:01:08"
                        }
                    },
                    "state": {
                        "running": true,
                        "status": "running"
                    }
                }
            },
            "portainer": {
                "root_portainer_1": {
                    "cmd": [
                        "-H",
                        "tcp://tasks.agent:9001",
                        "--tlsskipverify"
                    ],
                    "image": "portainer/portainer-ce:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "367b3b6ef0314131d70681afc91e9bd3c916ebda2fa44437558462f17fe180fc",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "portainer",
                        "com.docker.compose.version": "1.29.2",
                        "com.docker.desktop.extension.api.version": ">= 0.2.2",
                        "com.docker.desktop.extension.icon": "https://portainer-io-assets.sfo2.cdn.digitaloceanspaces.com/logos/portainer.png",
                        "com.docker.extension.additional-urls": "[{\"title\":\"Website\",\"url\":\"https://www.portainer.io?utm_campaign=DockerCon&utm_source=DockerDesktop\"},{\"title\":\"Documentation\",\"url\":\"https://docs.portainer.io\"},{\"title\":\"Support\",\"url\":\"https://join.slack.com/t/portainer/shared_invite/zt-txh3ljab-52QHTyjCqbe5RibC2lcjKA\"}]",
                        "com.docker.extension.detailed-description": "<p data-renderer-start-pos=\"226\">Portainer&rsquo;s Docker Desktop extension gives you access to all of Portainer&rsquo;s rich management functionality within your docker desktop experience.</p><h2 data-renderer-start-pos=\"374\">With Portainer you can:</h2><ul><li>See all your running containers</li><li>Easily view all of your container logs</li><li>Console into containers</li><li>Easily deploy your code into containers using a simple form</li><li>Turn your YAML into custom templates for easy reuse</li></ul><h2 data-renderer-start-pos=\"660\">About Portainer&nbsp;</h2><p data-renderer-start-pos=\"680\">Portainer is the worlds&rsquo; most popular universal container management platform with more than 650,000 active monthly users. Portainer can be used to manage Docker Standalone, Kubernetes, Docker Swarm and Nomad environments through a single common interface. It includes a simple GitOps automation engine and a Kube API.&nbsp;</p><p data-renderer-start-pos=\"1006\">Portainer Business Edition is our fully supported commercial grade product for business-wide use. It includes all the functionality that businesses need to manage containers at scale. Visit <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/\" title=\"http://Portainer.io\" data-renderer-mark=\"true\">Portainer.io</a> to learn more about Portainer Business and <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" title=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" data-renderer-mark=\"true\">get 5 free nodes.</a></p>",
                        "com.docker.extension.publisher-url": "https://www.portainer.io",
                        "com.docker.extension.screenshots": "[{\"alt\": \"screenshot one\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-1.png\"},{\"alt\": \"screenshot two\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-2.png\"},{\"alt\": \"screenshot three\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-3.png\"},{\"alt\": \"screenshot four\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-4.png\"},{\"alt\": \"screenshot five\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-5.png\"},{\"alt\": \"screenshot six\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-6.png\"},{\"alt\": \"screenshot seven\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-7.png\"},{\"alt\": \"screenshot eight\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-8.png\"},{\"alt\": \"screenshot nine\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-9.png\"}]",
                        "io.portainer.server": "true",
                        "org.opencontainers.image.description": "Docker container management made simple, with the worlds most popular GUI-based container management platform.",
                        "org.opencontainers.image.title": "Portainer",
                        "org.opencontainers.image.vendor": "Portainer.io"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "10.0.1.10",
                            "IPPrefixLen": 24,
                            "aliases": [
                                "portainer",
                                "319243d2b958"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": "02:42:0a:00:01:0a"
                        }
                    },
                    "state": {
                        "running": true,
                        "status": "running"
                    }
                }
            }
        }
    }
}
2023-04-23 14:17:16,572 p=81022 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:17:16,572 p=81022 u=craig n=ansible | swarm-master               : ok=19   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 14:35:42,139 p=82530 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 14:35:42,146 p=82530 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:35:43,404 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:43,420 p=82530 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 14:35:45,428 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:45,436 p=82530 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 14:35:46,271 p=82530 u=craig n=ansible | ok: [swarm-master] => (item=apt-transport-https)
2023-04-23 14:35:47,176 p=82530 u=craig n=ansible | ok: [swarm-master] => (item=ca-certificates)
2023-04-23 14:35:47,991 p=82530 u=craig n=ansible | ok: [swarm-master] => (item=curl)
2023-04-23 14:35:48,839 p=82530 u=craig n=ansible | ok: [swarm-master] => (item=gnupg)
2023-04-23 14:35:49,629 p=82530 u=craig n=ansible | ok: [swarm-master] => (item=lsb-release)
2023-04-23 14:35:50,442 p=82530 u=craig n=ansible | ok: [swarm-master] => (item=software-properties-common)
2023-04-23 14:35:50,453 p=82530 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 14:35:51,062 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:51,070 p=82530 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 14:35:51,574 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:51,582 p=82530 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 14:35:52,387 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:52,396 p=82530 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 14:35:52,944 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:52,952 p=82530 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 14:35:53,356 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:53,363 p=82530 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 14:35:54,234 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:54,242 p=82530 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 14:35:55,363 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:55,378 p=82530 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 14:35:56,173 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:56,182 p=82530 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 14:35:56,795 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:56,803 p=82530 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 14:35:57,228 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:57,237 p=82530 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 14:35:59,310 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:59,319 p=82530 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 14:35:59,741 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:35:59,749 p=82530 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 14:36:00,310 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:36:00,316 p=82530 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 14:36:01,031 p=82530 u=craig n=ansible | ok: [swarm-master]
2023-04-23 14:36:01,039 p=82530 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 14:36:03,590 p=82530 u=craig n=ansible | fatal: [swarm-master]: FAILED! => {"changed": false, "errors": ["ERROR: for root_portainer_1  Cannot start service portainer: container 319243d2b958b07db35a96a4e42c237647e39b2a25dfec31830b60e8e238e6bd: endpoint join on GW Network failed: driver failed programming external connectivity on endpoint gateway_cfe4de2fc709 (df4bedbbe060555a84c6ea6c06dba4c16ff7aec8b594b3bd1c7c5ab8fcea0e2f): Bind for 0.0.0.0:9443 failed: port is already allocated"], "module_stderr": "Starting root_agent_1 ... \nStarting root_portainer_1 ... \nHost is already in use by another container\nStarting root_portainer_1 ... error\n\nERROR: for root_portainer_1  Cannot start service portainer: container 319243d2b958b07db35a96a4e42c237647e39b2a25dfec31830b60e8e238e6bd: endpoint join on GW Network failed: driver failed programming external connectivity on endpoint gateway_cfe4de2fc709 (df4bedbbe060555a84c6ea6c06dba4c16ff7aec8b594b3bd1c7c5ab8fcea0e2f): Bind for 0.0.0.0:9443 failed: port is already allocated\nStarting root_agent_1     ... done\n", "module_stdout": "", "msg": "Error starting project Encountered errors while bringing up the project."}
2023-04-23 14:36:03,592 p=82530 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:36:03,592 p=82530 u=craig n=ansible | swarm-master               : ok=17   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 14:41:53,901 p=83177 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ***************************************************************************************************************************************************************************************
2023-04-23 14:41:53,913 p=83177 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:41:55,547 p=83177 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:41:55,589 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ************************************************************************************************************************************************************
2023-04-23 14:41:56,467 p=83177 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:41:56,488 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] **************************************************************************************
2023-04-23 14:41:56,791 p=83177 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:41:56,808 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ************************************************************************
2023-04-23 14:41:57,519 p=83177 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:41:57,552 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ***********************************************************************************************************************
2023-04-23 14:41:57,751 p=83177 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-23 14:41:57,761 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 14:41:57,770 p=83177 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-23 14:41:57,780 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 14:41:58,198 p=83177 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:41:58,218 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ****************************************************************************
2023-04-23 14:41:58,581 p=83177 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings 
can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-23 14:41:58,581 p=83177 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:41:58,604 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ******************************************************************************************************
2023-04-23 14:41:58,659 p=83177 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 14:41:58,676 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] *****************************************************************
2023-04-23 14:41:58,907 p=83177 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-23 14:41:58,930 p=83177 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ***********************************************************************************************
2023-04-23 14:41:59,147 p=83177 u=craig n=ansible | fatal: [192.168.1.99 -> 192.168.1.112]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.112' (ED25519) to the list of known hosts.\r\nroot@192.168.1.112: Permission denied (publickey).", "unreachable": true}
2023-04-23 14:41:59,148 p=83177 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:41:59,148 p=83177 u=craig n=ansible | 192.168.1.99               : ok=9    changed=2    unreachable=1    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-23 14:43:59,223 p=83475 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-04-23 14:43:59,223 p=83475 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-04-23 14:43:59,223 p=83475 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-04-23 14:43:59,226 p=83475 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-04-23 14:43:59,402 p=83475 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ***************************************************************************************************************************************************************************************
2023-04-23 14:43:59,413 p=83475 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:44:00,823 p=83475 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:44:00,862 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ************************************************************************************************************************************************************
2023-04-23 14:44:01,671 p=83475 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:44:01,692 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] **************************************************************************************
2023-04-23 14:44:02,021 p=83475 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:44:02,040 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ************************************************************************
2023-04-23 14:44:02,715 p=83475 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:44:02,748 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ***********************************************************************************************************************
2023-04-23 14:44:02,949 p=83475 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-23 14:44:02,959 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 14:44:02,968 p=83475 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-23 14:44:02,978 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 14:44:12,020 p=83475 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 14:44:12,040 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ****************************************************************************
2023-04-23 14:44:15,499 p=83475 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings 
can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-23 14:44:15,499 p=83475 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 14:44:15,522 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ******************************************************************************************************
2023-04-23 14:44:15,550 p=83475 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 14:44:15,569 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] *****************************************************************
2023-04-23 14:44:18,818 p=83475 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-23 14:44:18,850 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ***********************************************************************************************
2023-04-23 14:44:25,130 p=83475 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:44:25,162 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] *****************************************************************************************************************************
2023-04-23 14:44:26,369 p=83475 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:44:26,403 p=83475 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] *****************************************************************************************************************************************
2023-04-23 14:45:27,862 p=83475 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:45:27,890 p=83475 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] ****************************************************************************************************
2023-04-23 14:45:28,381 p=83475 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:45:28,463 p=83475 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: portainer-swarm-agent

2023-04-23 14:45:28,463 p=83475 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************************************
2023-04-23 14:45:28,463 p=83475 u=craig n=ansible | skipping: no hosts matched
2023-04-23 14:45:28,474 p=83475 u=craig n=ansible | PLAY [Install gui] **************************************************************************************************************************************************************************************************************
2023-04-23 14:45:28,475 p=83475 u=craig n=ansible | skipping: no hosts matched
2023-04-23 14:45:28,475 p=83475 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:45:28,475 p=83475 u=craig n=ansible | 192.168.1.99               : ok=13   changed=6    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-23 14:49:18,237 p=84605 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 14:49:18,244 p=84605 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:49:18,447 p=84605 u=craig n=ansible | fatal: [portainer-swarm-agent]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.9' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.9: Permission denied (publickey,password).", "unreachable": true}
2023-04-23 14:49:18,448 p=84605 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:49:18,448 p=84605 u=craig n=ansible | portainer-swarm-agent      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 14:49:40,306 p=84640 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ***************************************************************************************************************************************************************************************
2023-04-23 14:49:40,317 p=84640 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:49:41,849 p=84640 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:49:41,889 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ************************************************************************************************************************************************************
2023-04-23 14:49:42,745 p=84640 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:49:42,766 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] **************************************************************************************
2023-04-23 14:49:43,101 p=84640 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:49:43,119 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ************************************************************************
2023-04-23 14:49:43,836 p=84640 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:49:43,869 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ***********************************************************************************************************************
2023-04-23 14:49:44,069 p=84640 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-23 14:49:44,079 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 14:49:44,089 p=84640 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-23 14:49:44,099 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 14:49:44,516 p=84640 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:49:44,535 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ****************************************************************************
2023-04-23 14:49:44,902 p=84640 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings 
can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-23 14:49:44,902 p=84640 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 14:49:44,925 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ******************************************************************************************************
2023-04-23 14:49:44,952 p=84640 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 14:49:44,972 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] *****************************************************************
2023-04-23 14:49:45,190 p=84640 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-23 14:49:45,213 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ***********************************************************************************************
2023-04-23 14:49:47,690 p=84640 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:49:47,724 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] *****************************************************************************************************************************
2023-04-23 14:49:49,198 p=84640 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:49:49,223 p=84640 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] *****************************************************************************************************************************************
2023-04-23 14:49:50,267 p=84640 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:49:50,301 p=84640 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] ****************************************************************************************************
2023-04-23 14:49:50,752 p=84640 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.9]
2023-04-23 14:49:50,835 p=84640 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************************************
2023-04-23 14:49:50,844 p=84640 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:49:51,685 p=84640 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:49:51,714 p=84640 u=craig n=ansible | TASK [create_user : Ensure group sudo exists name=sudo, state=present] **********************************************************************************************************************************************************
2023-04-23 14:49:52,041 p=84640 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:49:52,051 p=84640 u=craig n=ansible | TASK [create_user : Allow sudo group to have passwordless sudo path=/etc/sudoers, state=present, regexp=^%sudo, line=%sudo ALL=(ALL) NOPASSWD: ALL, validate=/usr/sbin/visudo -cf %s] *******************************************
2023-04-23 14:49:52,400 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:49:52,411 p=84640 u=craig n=ansible | TASK [create_user : Create a new user name={{machine_user}}, password={{machine_password | string | password_hash('sha512')}}, shell=/bin/bash, groups=sudo, append=True] *******************************************************
2023-04-23 14:49:53,312 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:49:53,328 p=84640 u=craig n=ansible | TASK [create_user : Create the .ssh directory path=/home/{{machine_user}}/.ssh, state=directory, mode=0700, owner={{machine_user}}, group={{machine_user}}] *********************************************************************
2023-04-23 14:49:53,614 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:49:53,626 p=84640 u=craig n=ansible | TASK [create_user : Copy the ssh key to the new user src={{machine_ssh_key}}, dest=/home/{{machine_user}}/.ssh/authorized_keys, mode=0600, owner={{machine_user}}, group={{machine_user}}] **************************************
2023-04-23 14:49:54,257 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:49:54,284 p=84640 u=craig n=ansible | TASK [lockdown : Ensure the /run/sshd directory exists path=/run/sshd, state=directory, mode=493] *******************************************************************************************************************************
2023-04-23 14:49:54,563 p=84640 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:49:54,576 p=84640 u=craig n=ansible | TASK [lockdown : Update SSH configuration to be more secure dest=/etc/ssh/sshd_config, regexp={{ item.regexp }}, line={{ item.line }}, state=present, validate=sshd -T -f %s, mode=420] *****************************************
2023-04-23 14:49:54,880 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent] => (item={'regexp': '^#?PasswordAuthentication', 'line': 'PasswordAuthentication no'})
2023-04-23 14:49:55,173 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent] => (item={'regexp': '^#?PermitRootLogin', 'line': 'PermitRootLogin no'})
2023-04-23 14:49:55,432 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent] => (item={'regexp': '^#?Port', 'line': 'Port 22'})
2023-04-23 14:49:55,697 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent] => (item={'regexp': '^#?PermitEmptyPasswords', 'line': 'PermitEmptyPasswords no'})
2023-04-23 14:49:55,740 p=84640 u=craig n=ansible | RUNNING HANDLER [restart ssh name=sshd, state=restarted] ************************************************************************************************************************************************************************
2023-04-23 14:49:56,271 p=84640 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:49:56,325 p=84640 u=craig n=ansible | PLAY [Install gui] **************************************************************************************************************************************************************************************************************
2023-04-23 14:49:56,336 p=84640 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:49:57,435 p=84640 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:49:57,474 p=84640 u=craig n=ansible | TASK [lxc_gui : Ensure system is up to date update_cache=True, upgrade=True] ****************************************************************************************************************************************************
2023-04-23 14:49:57,485 p=84640 u=craig n=ansible | skipping: [portainer-swarm-agent]
2023-04-23 14:49:57,496 p=84640 u=craig n=ansible | TASK [lxc_gui : Install xrdp and Xfce4 desktop and force if needed and install dependencies and recommends name={{item}}, state=present, force=True, install_recommends=True] ***************************************************
2023-04-23 14:49:57,510 p=84640 u=craig n=ansible | skipping: [portainer-swarm-agent] => (item=xfce4) 
2023-04-23 14:49:57,512 p=84640 u=craig n=ansible | skipping: [portainer-swarm-agent] => (item=xfce4-session) 
2023-04-23 14:49:57,514 p=84640 u=craig n=ansible | skipping: [portainer-swarm-agent] => (item=xrdp) 
2023-04-23 14:49:57,515 p=84640 u=craig n=ansible | skipping: [portainer-swarm-agent]
2023-04-23 14:49:57,525 p=84640 u=craig n=ansible | TASK [lxc_gui : Make sure xrdp is running name=xrdp, state=started, enabled=True] ***********************************************************************************************************************************************
2023-04-23 14:49:57,535 p=84640 u=craig n=ansible | skipping: [portainer-swarm-agent]
2023-04-23 14:49:57,545 p=84640 u=craig n=ansible | TASK [lxc_gui : Install chrome using wget and apt install deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb, state=present, force=True, install_recommends=True] ************************************
2023-04-23 14:49:57,555 p=84640 u=craig n=ansible | skipping: [portainer-swarm-agent]
2023-04-23 14:49:57,598 p=84640 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:49:57,598 p=84640 u=craig n=ansible | 192.168.1.99               : ok=13   changed=3    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-23 14:49:57,598 p=84640 u=craig n=ansible | portainer-swarm-agent      : ok=10   changed=6    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2023-04-23 14:50:05,058 p=84949 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 14:50:05,065 p=84949 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:50:06,038 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:50:06,052 p=84949 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 14:50:07,477 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:50:07,485 p=84949 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 14:50:09,277 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 14:50:10,117 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 14:50:14,226 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent] => (item=curl)
2023-04-23 14:50:20,942 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 14:50:21,729 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 14:50:37,874 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 14:50:37,886 p=84949 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 14:50:38,683 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:50:38,692 p=84949 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 14:50:40,634 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:50:40,642 p=84949 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 14:51:00,981 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:51:00,989 p=84949 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 14:51:01,539 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:51:01,547 p=84949 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 14:51:01,996 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:51:02,004 p=84949 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 14:51:26,218 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:51:26,227 p=84949 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 14:51:31,589 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:51:31,608 p=84949 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 14:51:32,365 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:51:32,371 p=84949 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 14:51:32,964 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:51:32,975 p=84949 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 14:51:33,417 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:51:33,429 p=84949 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 14:51:35,094 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:51:35,105 p=84949 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 14:51:35,515 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:51:35,526 p=84949 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 14:51:36,754 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:51:36,766 p=84949 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 14:51:37,599 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:51:37,607 p=84949 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 14:52:00,351 p=84949 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:52:00,355 p=84949 u=craig n=ansible | TASK [Show deployment result var=deploy_result] *********************************************************************************************************************************************************************************
2023-04-23 14:52:00,369 p=84949 u=craig n=ansible | ok: [portainer-swarm-agent] => {
    "deploy_result": {
        "changed": true,
        "failed": false,
        "services": {
            "agent": {
                "root_agent_1": {
                    "cmd": [],
                    "image": "portainer/agent:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "7c9b0c17a0cb9cc41dd12a68fa5a7cdab1372e8005e65f2bd7aa587c03d37eba",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "agent",
                        "com.docker.compose.version": "1.29.2",
                        "io.portainer.agent": "true"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "10.0.1.4",
                            "IPPrefixLen": 24,
                            "aliases": [
                                "daf172783ad7",
                                "agent"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": "02:42:0a:00:01:04"
                        }
                    },
                    "state": {
                        "running": true,
                        "status": "running"
                    }
                }
            },
            "portainer": {
                "root_portainer_1": {
                    "cmd": [
                        "-H",
                        "tcp://tasks.agent:9001",
                        "--tlsskipverify"
                    ],
                    "image": "portainer/portainer-ce:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "367b3b6ef0314131d70681afc91e9bd3c916ebda2fa44437558462f17fe180fc",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "portainer",
                        "com.docker.compose.version": "1.29.2",
                        "com.docker.desktop.extension.api.version": ">= 0.2.2",
                        "com.docker.desktop.extension.icon": "https://portainer-io-assets.sfo2.cdn.digitaloceanspaces.com/logos/portainer.png",
                        "com.docker.extension.additional-urls": "[{\"title\":\"Website\",\"url\":\"https://www.portainer.io?utm_campaign=DockerCon&utm_source=DockerDesktop\"},{\"title\":\"Documentation\",\"url\":\"https://docs.portainer.io\"},{\"title\":\"Support\",\"url\":\"https://join.slack.com/t/portainer/shared_invite/zt-txh3ljab-52QHTyjCqbe5RibC2lcjKA\"}]",
                        "com.docker.extension.detailed-description": "<p data-renderer-start-pos=\"226\">Portainer&rsquo;s Docker Desktop extension gives you access to all of Portainer&rsquo;s rich management functionality within your docker desktop experience.</p><h2 data-renderer-start-pos=\"374\">With Portainer you can:</h2><ul><li>See all your running containers</li><li>Easily view all of your container logs</li><li>Console into containers</li><li>Easily deploy your code into containers using a simple form</li><li>Turn your YAML into custom templates for easy reuse</li></ul><h2 data-renderer-start-pos=\"660\">About Portainer&nbsp;</h2><p data-renderer-start-pos=\"680\">Portainer is the worlds&rsquo; most popular universal container management platform with more than 650,000 active monthly users. Portainer can be used to manage Docker Standalone, Kubernetes, Docker Swarm and Nomad environments through a single common interface. It includes a simple GitOps automation engine and a Kube API.&nbsp;</p><p data-renderer-start-pos=\"1006\">Portainer Business Edition is our fully supported commercial grade product for business-wide use. It includes all the functionality that businesses need to manage containers at scale. Visit <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/\" title=\"http://Portainer.io\" data-renderer-mark=\"true\">Portainer.io</a> to learn more about Portainer Business and <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" title=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" data-renderer-mark=\"true\">get 5 free nodes.</a></p>",
                        "com.docker.extension.publisher-url": "https://www.portainer.io",
                        "com.docker.extension.screenshots": "[{\"alt\": \"screenshot one\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-1.png\"},{\"alt\": \"screenshot two\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-2.png\"},{\"alt\": \"screenshot three\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-3.png\"},{\"alt\": \"screenshot four\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-4.png\"},{\"alt\": \"screenshot five\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-5.png\"},{\"alt\": \"screenshot six\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-6.png\"},{\"alt\": \"screenshot seven\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-7.png\"},{\"alt\": \"screenshot eight\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-8.png\"},{\"alt\": \"screenshot nine\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-9.png\"}]",
                        "io.portainer.server": "true",
                        "org.opencontainers.image.description": "Docker container management made simple, with the worlds most popular GUI-based container management platform.",
                        "org.opencontainers.image.title": "Portainer",
                        "org.opencontainers.image.vendor": "Portainer.io"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "",
                            "IPPrefixLen": 0,
                            "aliases": [
                                "portainer",
                                "dd236087d74e"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": ""
                        }
                    },
                    "state": {
                        "running": false,
                        "status": "exited"
                    }
                }
            }
        }
    }
}
2023-04-23 14:52:00,382 p=84949 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:52:00,382 p=84949 u=craig n=ansible | portainer-swarm-agent      : ok=19   changed=10   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 14:54:04,648 p=85471 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 14:54:04,654 p=85471 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 14:54:05,948 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:05,962 p=85471 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 14:54:07,479 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:07,483 p=85471 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 14:54:08,251 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 14:54:09,023 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 14:54:09,833 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=curl)
2023-04-23 14:54:10,599 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 14:54:11,432 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 14:54:12,292 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 14:54:12,304 p=85471 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 14:54:12,878 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:12,887 p=85471 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 14:54:13,395 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:13,403 p=85471 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 14:54:14,170 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:14,178 p=85471 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 14:54:14,717 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:14,722 p=85471 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 14:54:15,100 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:15,108 p=85471 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 14:54:15,877 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:15,885 p=85471 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 14:54:16,901 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:16,915 p=85471 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 14:54:17,821 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:17,829 p=85471 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 14:54:18,341 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:18,350 p=85471 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 14:54:18,849 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:18,858 p=85471 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 14:54:20,518 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:20,527 p=85471 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 14:54:20,923 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:20,931 p=85471 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 14:54:21,462 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:21,471 p=85471 u=craig n=ansible | TASK [Display ansible_host value var=ansible_host] ******************************************************************************************************************************************************************************
2023-04-23 14:54:21,489 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => {
    "ansible_host": "192.168.1.9"
}
2023-04-23 14:54:21,495 p=85471 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 14:54:22,174 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 14:54:22,181 p=85471 u=craig n=ansible | TASK [Deploy Portainer stack project_src=/root, files=portainer-agent.yaml, state=present] **************************************************************************************************************************************
2023-04-23 14:54:24,890 p=85471 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 14:54:24,899 p=85471 u=craig n=ansible | TASK [Show deployment result var=deploy_result] *********************************************************************************************************************************************************************************
2023-04-23 14:54:24,919 p=85471 u=craig n=ansible | ok: [portainer-swarm-agent] => {
    "deploy_result": {
        "changed": true,
        "failed": false,
        "services": {
            "agent": {
                "root_agent_1": {
                    "cmd": [],
                    "image": "portainer/agent:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "7c9b0c17a0cb9cc41dd12a68fa5a7cdab1372e8005e65f2bd7aa587c03d37eba",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "agent",
                        "com.docker.compose.version": "1.29.2",
                        "io.portainer.agent": "true"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "10.0.1.5",
                            "IPPrefixLen": 24,
                            "aliases": [
                                "daf172783ad7",
                                "agent"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": "02:42:0a:00:01:05"
                        }
                    },
                    "state": {
                        "running": true,
                        "status": "running"
                    }
                }
            },
            "portainer": {
                "root_portainer_1": {
                    "cmd": [
                        "-H",
                        "tcp://tasks.agent:9001",
                        "--tlsskipverify"
                    ],
                    "image": "portainer/portainer-ce:2.18.1",
                    "labels": {
                        "com.docker.compose.config-hash": "367b3b6ef0314131d70681afc91e9bd3c916ebda2fa44437558462f17fe180fc",
                        "com.docker.compose.container-number": "1",
                        "com.docker.compose.oneoff": "False",
                        "com.docker.compose.project": "root",
                        "com.docker.compose.project.config_files": "/root/portainer-agent.yaml",
                        "com.docker.compose.project.working_dir": "/root",
                        "com.docker.compose.service": "portainer",
                        "com.docker.compose.version": "1.29.2",
                        "com.docker.desktop.extension.api.version": ">= 0.2.2",
                        "com.docker.desktop.extension.icon": "https://portainer-io-assets.sfo2.cdn.digitaloceanspaces.com/logos/portainer.png",
                        "com.docker.extension.additional-urls": "[{\"title\":\"Website\",\"url\":\"https://www.portainer.io?utm_campaign=DockerCon&utm_source=DockerDesktop\"},{\"title\":\"Documentation\",\"url\":\"https://docs.portainer.io\"},{\"title\":\"Support\",\"url\":\"https://join.slack.com/t/portainer/shared_invite/zt-txh3ljab-52QHTyjCqbe5RibC2lcjKA\"}]",
                        "com.docker.extension.detailed-description": "<p data-renderer-start-pos=\"226\">Portainer&rsquo;s Docker Desktop extension gives you access to all of Portainer&rsquo;s rich management functionality within your docker desktop experience.</p><h2 data-renderer-start-pos=\"374\">With Portainer you can:</h2><ul><li>See all your running containers</li><li>Easily view all of your container logs</li><li>Console into containers</li><li>Easily deploy your code into containers using a simple form</li><li>Turn your YAML into custom templates for easy reuse</li></ul><h2 data-renderer-start-pos=\"660\">About Portainer&nbsp;</h2><p data-renderer-start-pos=\"680\">Portainer is the worlds&rsquo; most popular universal container management platform with more than 650,000 active monthly users. Portainer can be used to manage Docker Standalone, Kubernetes, Docker Swarm and Nomad environments through a single common interface. It includes a simple GitOps automation engine and a Kube API.&nbsp;</p><p data-renderer-start-pos=\"1006\">Portainer Business Edition is our fully supported commercial grade product for business-wide use. It includes all the functionality that businesses need to manage containers at scale. Visit <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/\" title=\"http://Portainer.io\" data-renderer-mark=\"true\">Portainer.io</a> to learn more about Portainer Business and <a class=\"sc-jKJlTe dPfAtb\" href=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" title=\"http://portainer.io/take5?utm_campaign=DockerCon&amp;utm_source=Docker%20Desktop\" data-renderer-mark=\"true\">get 5 free nodes.</a></p>",
                        "com.docker.extension.publisher-url": "https://www.portainer.io",
                        "com.docker.extension.screenshots": "[{\"alt\": \"screenshot one\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-1.png\"},{\"alt\": \"screenshot two\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-2.png\"},{\"alt\": \"screenshot three\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-3.png\"},{\"alt\": \"screenshot four\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-4.png\"},{\"alt\": \"screenshot five\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-5.png\"},{\"alt\": \"screenshot six\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-6.png\"},{\"alt\": \"screenshot seven\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-7.png\"},{\"alt\": \"screenshot eight\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-8.png\"},{\"alt\": \"screenshot nine\", \"url\": \"https://portainer-io-assets.sfo2.digitaloceanspaces.com/screenshots/docker-extension-9.png\"}]",
                        "io.portainer.server": "true",
                        "org.opencontainers.image.description": "Docker container management made simple, with the worlds most popular GUI-based container management platform.",
                        "org.opencontainers.image.title": "Portainer",
                        "org.opencontainers.image.vendor": "Portainer.io"
                    },
                    "networks": {
                        "root_agent_network": {
                            "IPAddress": "10.0.1.7",
                            "IPPrefixLen": 24,
                            "aliases": [
                                "portainer",
                                "dd236087d74e"
                            ],
                            "globalIPv6": "",
                            "globalIPv6PrefixLen": 0,
                            "links": null,
                            "macAddress": "02:42:0a:00:01:07"
                        }
                    },
                    "state": {
                        "running": true,
                        "status": "running"
                    }
                }
            }
        }
    }
}
2023-04-23 14:54:24,937 p=85471 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 14:54:24,937 p=85471 u=craig n=ansible | portainer-swarm-agent      : ok=20   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 15:09:57,384 p=90431 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 15:09:57,391 p=90431 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 15:09:58,683 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:09:58,698 p=90431 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 15:10:00,155 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:00,159 p=90431 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 15:10:00,960 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 15:10:01,743 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 15:10:02,659 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=curl)
2023-04-23 15:10:03,469 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 15:10:04,310 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 15:10:05,055 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 15:10:05,064 p=90431 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 15:10:05,634 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:05,643 p=90431 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 15:10:06,163 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:06,172 p=90431 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 15:10:07,061 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:07,066 p=90431 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 15:10:07,588 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:07,595 p=90431 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 15:10:08,020 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:08,028 p=90431 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 15:10:08,903 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:08,912 p=90431 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose'], state=present] **********************************************************************************************************************
2023-04-23 15:10:09,928 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:09,943 p=90431 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 15:10:10,700 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:10,709 p=90431 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 15:10:11,248 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:11,257 p=90431 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 15:10:11,673 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:11,682 p=90431 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 15:10:13,286 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:13,295 p=90431 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 15:10:13,697 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:13,705 p=90431 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 15:10:14,230 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:14,239 p=90431 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 15:10:14,923 p=90431 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:14,930 p=90431 u=craig n=ansible | TASK [Deploy stack from a compose file state=present, name=portainer-agent, compose=['/root/portainer-agent.yaml']] *************************************************************************************************************
2023-04-23 15:10:15,274 p=90431 u=craig n=ansible | fatal: [portainer-swarm-agent]: FAILED! => {"changed": false, "msg": "jsondiff is not installed, try 'pip install jsondiff'"}
2023-04-23 15:10:15,275 p=90431 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 15:10:15,275 p=90431 u=craig n=ansible | portainer-swarm-agent      : ok=17   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-23 15:10:43,186 p=91598 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] *****************************************************************************************************************************************************************************************
2023-04-23 15:10:43,193 p=91598 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************************************
2023-04-23 15:10:44,148 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:44,161 p=91598 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ******************************************************************************************************************************************************************************
2023-04-23 15:10:45,680 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:45,690 p=91598 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ********************************************************************************************************************************************************
2023-04-23 15:10:46,490 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 15:10:47,308 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 15:10:48,160 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=curl)
2023-04-23 15:10:48,929 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 15:10:49,679 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 15:10:50,468 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 15:10:50,479 p=91598 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ******************************************************************************************************************************
2023-04-23 15:10:51,093 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:51,101 p=91598 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *******************************************************************
2023-04-23 15:10:51,595 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:51,603 p=91598 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ********************************************************************************************************************************************************************
2023-04-23 15:10:52,397 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:52,405 p=91598 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 15:10:52,943 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:52,951 p=91598 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ************************************************************************************************************************************
2023-04-23 15:10:53,339 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:53,346 p=91598 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] *************************************************************************************************************************************************************
2023-04-23 15:10:54,162 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:54,169 p=91598 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] **********************************************************************************************************
2023-04-23 15:10:55,496 p=91598 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 15:10:55,509 p=91598 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] *************************************************************************************************
2023-04-23 15:10:56,297 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:56,305 p=91598 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***************************************************************************************************************************************
2023-04-23 15:10:56,928 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:56,936 p=91598 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ****************************************************************************
2023-04-23 15:10:57,440 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:57,448 p=91598 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] **********************************************************************************************************************************************************
2023-04-23 15:10:59,057 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:59,066 p=91598 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] ************************************************************************************************************************************************************
2023-04-23 15:10:59,474 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:10:59,482 p=91598 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ******************************************************************************************************************************************************
2023-04-23 15:11:00,004 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:11:00,013 p=91598 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] ********************************************************************************
2023-04-23 15:11:00,656 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 15:11:00,663 p=91598 u=craig n=ansible | TASK [Deploy stack from a compose file state=present, name=portainer-agent, compose=['/root/portainer-agent.yaml']] *************************************************************************************************************
2023-04-23 15:11:02,346 p=91598 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 15:11:02,355 p=91598 u=craig n=ansible | TASK [Show deployment result var=deploy_result] *********************************************************************************************************************************************************************************
2023-04-23 15:11:02,372 p=91598 u=craig n=ansible | ok: [portainer-swarm-agent] => {
    "deploy_result": "VARIABLE IS NOT DEFINED!"
}
2023-04-23 15:11:02,389 p=91598 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************************************
2023-04-23 15:11:02,389 p=91598 u=craig n=ansible | portainer-swarm-agent      : ok=19   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 18:21:43,453 p=93721 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 18:21:43,464 p=93721 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 18:21:44,891 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:44,906 p=93721 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-04-23 18:21:48,262 p=93721 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:21:48,270 p=93721 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-04-23 18:21:49,175 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 18:21:49,962 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 18:21:50,809 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=curl)
2023-04-23 18:21:51,621 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 18:21:52,395 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 18:21:53,151 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 18:21:53,160 p=93721 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-04-23 18:21:53,863 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:53,873 p=93721 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-04-23 18:21:54,422 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:54,431 p=93721 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-04-23 18:21:55,275 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:55,284 p=93721 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-04-23 18:21:55,917 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:55,925 p=93721 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-04-23 18:21:56,361 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:56,369 p=93721 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-04-23 18:21:57,260 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:57,268 p=93721 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-04-23 18:21:58,387 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:58,401 p=93721 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] ******************************************************************************************
2023-04-23 18:21:59,184 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:59,191 p=93721 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ********************************************************************************************************************************
2023-04-23 18:21:59,730 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:21:59,738 p=93721 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *********************************************************************
2023-04-23 18:22:00,160 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:22:00,168 p=93721 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] ***************************************************************************************************************************************************
2023-04-23 18:22:01,889 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:22:01,898 p=93721 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] *****************************************************************************************************************************************************
2023-04-23 18:22:02,307 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:22:02,315 p=93721 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ***********************************************************************************************************************************************
2023-04-23 18:22:02,863 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:22:02,870 p=93721 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] *************************************************************************
2023-04-23 18:22:03,599 p=93721 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:22:03,605 p=93721 u=craig n=ansible | TASK [Deploy stack from a compose file state=present, name=portainer-agent, compose=['/root/portainer-agent.yaml']] ******************************************************************************************************
2023-04-23 18:22:05,360 p=93721 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:22:05,379 p=93721 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 18:22:05,379 p=93721 u=craig n=ansible | portainer-swarm-agent      : ok=18   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 18:33:40,637 p=94795 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ********************************************************************************************************************************************************************************
2023-04-23 18:33:40,657 p=94795 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 18:33:42,311 p=94795 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:33:42,355 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************
2023-04-23 18:33:43,211 p=94795 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:33:43,232 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************
2023-04-23 18:33:43,580 p=94795 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:33:43,597 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************
2023-04-23 18:33:44,340 p=94795 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:33:44,372 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ****************************************************************************************************************
2023-04-23 18:33:44,694 p=94795 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-23 18:33:44,709 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 18:33:44,722 p=94795 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-23 18:33:44,737 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 18:33:45,234 p=94795 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:33:45,254 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *********************************************************************
2023-04-23 18:33:45,631 p=94795 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation 
warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-23 18:33:45,632 p=94795 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:33:45,654 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ***********************************************************************************************
2023-04-23 18:33:45,686 p=94795 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 18:33:45,711 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] **********************************************************
2023-04-23 18:33:46,047 p=94795 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-23 18:33:46,081 p=94795 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************
2023-04-23 18:33:46,311 p=94795 u=craig n=ansible | fatal: [192.168.1.99 -> 192.168.1.9]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.9' (ED25519) to the list of known hosts.\r\nroot@192.168.1.9: Permission denied (publickey).", "unreachable": true}
2023-04-23 18:33:46,312 p=94795 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 18:33:46,312 p=94795 u=craig n=ansible | 192.168.1.99               : ok=9    changed=2    unreachable=1    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-23 18:33:58,038 p=94951 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ********************************************************************************************************************************************************************************
2023-04-23 18:33:58,057 p=94951 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 18:33:59,324 p=94951 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:33:59,368 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************
2023-04-23 18:34:00,188 p=94951 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:34:00,207 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************
2023-04-23 18:34:00,585 p=94951 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:34:00,603 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************
2023-04-23 18:34:01,350 p=94951 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:34:01,383 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ****************************************************************************************************************
2023-04-23 18:34:01,675 p=94951 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-23 18:34:01,690 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 18:34:01,705 p=94951 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-23 18:34:01,720 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 18:34:02,212 p=94951 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:34:02,233 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *********************************************************************
2023-04-23 18:34:02,630 p=94951 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation 
warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-23 18:34:02,631 p=94951 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 18:34:02,652 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ***********************************************************************************************
2023-04-23 18:34:02,678 p=94951 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 18:34:02,703 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] **********************************************************
2023-04-23 18:34:03,035 p=94951 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-23 18:34:03,069 p=94951 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************
2023-04-23 18:34:03,318 p=94951 u=craig n=ansible | fatal: [192.168.1.99 -> 192.168.1.9]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.9' (ED25519) to the list of known hosts.\r\nroot@192.168.1.9: Permission denied (publickey).", "unreachable": true}
2023-04-23 18:34:03,319 p=94951 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 18:34:03,319 p=94951 u=craig n=ansible | 192.168.1.99               : ok=9    changed=2    unreachable=1    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-23 18:34:10,024 p=95082 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 18:34:10,033 p=95082 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 18:34:11,413 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:11,428 p=95082 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-04-23 18:34:12,996 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:13,002 p=95082 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-04-23 18:34:13,809 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 18:34:14,754 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 18:34:15,573 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=curl)
2023-04-23 18:34:16,378 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 18:34:17,226 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 18:34:18,119 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 18:34:18,127 p=95082 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-04-23 18:34:18,733 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:18,742 p=95082 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-04-23 18:34:19,267 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:19,275 p=95082 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-04-23 18:34:20,057 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:20,065 p=95082 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-04-23 18:34:20,708 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:20,715 p=95082 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-04-23 18:34:21,150 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:21,157 p=95082 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-04-23 18:34:21,946 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:21,955 p=95082 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-04-23 18:34:22,997 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:23,007 p=95082 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] ******************************************************************************************
2023-04-23 18:34:23,775 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:23,784 p=95082 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ********************************************************************************************************************************
2023-04-23 18:34:24,315 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:24,324 p=95082 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *********************************************************************
2023-04-23 18:34:24,809 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:24,817 p=95082 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] ***************************************************************************************************************************************************
2023-04-23 18:34:26,516 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:26,525 p=95082 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] *****************************************************************************************************************************************************
2023-04-23 18:34:26,996 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:27,004 p=95082 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ***********************************************************************************************************************************************
2023-04-23 18:34:27,610 p=95082 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:34:27,619 p=95082 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] *************************************************************************
2023-04-23 18:34:28,436 p=95082 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:34:28,444 p=95082 u=craig n=ansible | TASK [Deploy stack from a compose file state=present, name=portainer-agent, compose=['/root/portainer-agent.yaml']] ******************************************************************************************************
2023-04-23 18:34:30,214 p=95082 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:34:30,239 p=95082 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 18:34:30,239 p=95082 u=craig n=ansible | portainer-swarm-agent      : ok=18   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 18:39:44,023 p=95683 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 18:39:44,033 p=95683 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 18:39:45,406 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:45,423 p=95683 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-04-23 18:39:47,053 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:47,062 p=95683 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-04-23 18:39:47,965 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 18:39:48,885 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 18:39:49,706 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=curl)
2023-04-23 18:39:50,534 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 18:39:51,332 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 18:39:52,180 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 18:39:52,191 p=95683 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-04-23 18:39:52,809 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:52,816 p=95683 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-04-23 18:39:53,340 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:53,348 p=95683 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-04-23 18:39:54,163 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:54,177 p=95683 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-04-23 18:39:54,833 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:54,841 p=95683 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-04-23 18:39:55,284 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:55,291 p=95683 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-04-23 18:39:56,044 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:56,054 p=95683 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-04-23 18:39:57,107 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:57,124 p=95683 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] ******************************************************************************************
2023-04-23 18:39:57,905 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:57,915 p=95683 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ********************************************************************************************************************************
2023-04-23 18:39:58,449 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:58,459 p=95683 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *********************************************************************
2023-04-23 18:39:58,893 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:39:58,904 p=95683 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] ***************************************************************************************************************************************************
2023-04-23 18:40:00,592 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:40:00,604 p=95683 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] *****************************************************************************************************************************************************
2023-04-23 18:40:01,099 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:40:01,109 p=95683 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ***********************************************************************************************************************************************
2023-04-23 18:40:01,705 p=95683 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:40:01,715 p=95683 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] *************************************************************************
2023-04-23 18:40:02,573 p=95683 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:40:02,581 p=95683 u=craig n=ansible | TASK [Deploy stack from a compose file state=present, name=portainer-agent, compose=['/root/portainer-agent.yaml']] ******************************************************************************************************
2023-04-23 18:40:04,283 p=95683 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:40:04,306 p=95683 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 18:40:04,307 p=95683 u=craig n=ansible | portainer-swarm-agent      : ok=18   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 18:50:18,356 p=96648 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 18:50:18,367 p=96648 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 18:50:19,880 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:19,895 p=96648 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-04-23 18:50:21,314 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:21,323 p=96648 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-04-23 18:50:22,222 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=apt-transport-https)
2023-04-23 18:50:23,036 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=ca-certificates)
2023-04-23 18:50:23,801 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=curl)
2023-04-23 18:50:24,569 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=gnupg)
2023-04-23 18:50:25,424 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=lsb-release)
2023-04-23 18:50:26,223 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent] => (item=software-properties-common)
2023-04-23 18:50:26,235 p=96648 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-04-23 18:50:26,883 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:26,892 p=96648 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-04-23 18:50:27,431 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:27,440 p=96648 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-04-23 18:50:28,246 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:28,254 p=96648 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-04-23 18:50:28,889 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:28,898 p=96648 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-04-23 18:50:29,357 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:29,364 p=96648 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-04-23 18:50:30,219 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:30,227 p=96648 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-04-23 18:50:31,344 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:31,358 p=96648 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] ******************************************************************************************
2023-04-23 18:50:32,139 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:32,147 p=96648 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ********************************************************************************************************************************
2023-04-23 18:50:32,674 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:32,682 p=96648 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *********************************************************************
2023-04-23 18:50:33,151 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:33,160 p=96648 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] ***************************************************************************************************************************************************
2023-04-23 18:50:34,872 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:34,882 p=96648 u=craig n=ansible | TASK [Add required kernel modules to /etc/modules-load.d/docker.conf dest=/etc/modules-load.d/docker.conf, content=# required kernel modules for proper docker swarm
# within LXC functionality
overlay
bonding
br_netfilter
iptable_mangle
iptable_nat
ip_vs
ip_vs_dh
ip_vs_ftp
ip_vs_lblc
ip_vs_lblcr
ip_vs_lc
ip_vs_nq
ip_vs_rr
ip_vs_sed
ip_vs_sh
ip_vs_wlc
ip_vs_wrr
nf_nat
xfrm_user
xt_conntrack
xt_MASQUERADE
, owner=root, group=root, mode=0644] ***
2023-04-23 18:50:35,700 p=96648 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:50:35,708 p=96648 u=craig n=ansible | TASK [Update /etc/sysctl.conf to enable IP forwarding path=/etc/sysctl.conf, regexp=^net.ipv4.ip_forward, line=net.ipv4.ip_forward=1, state=present] *********************************************************************
2023-04-23 18:50:36,091 p=96648 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:50:36,098 p=96648 u=craig n=ansible | TASK [Apply sysctl changes _raw_params=sysctl -p] ************************************************************************************************************************************************************************
2023-04-23 18:50:36,495 p=96648 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:50:36,503 p=96648 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] *****************************************************************************************************************************************************
2023-04-23 18:50:36,950 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:36,957 p=96648 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ***********************************************************************************************************************************************
2023-04-23 18:50:37,518 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:37,527 p=96648 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] *************************************************************************
2023-04-23 18:50:38,173 p=96648 u=craig n=ansible | ok: [portainer-swarm-agent]
2023-04-23 18:50:38,180 p=96648 u=craig n=ansible | TASK [Deploy stack from a compose file state=present, name=portainer-agent, compose=['/root/portainer-agent.yaml']] ******************************************************************************************************
2023-04-23 18:50:39,955 p=96648 u=craig n=ansible | changed: [portainer-swarm-agent]
2023-04-23 18:50:39,998 p=96648 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 18:50:39,998 p=96648 u=craig n=ansible | portainer-swarm-agent      : ok=21   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:22:48,989 p=99089 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:22:48,999 p=99089 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:22:49,038 p=99089 u=craig n=ansible | fatal: [testswarm]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Connection refused", "unreachable": true}
2023-04-23 19:22:49,039 p=99089 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:22:49,039 p=99089 u=craig n=ansible | testswarm                  : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:26:29,383 p=99371 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:26:29,394 p=99371 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:26:29,706 p=99371 u=craig n=ansible | fatal: [testswarm]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.13' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.13: Permission denied (publickey,password).", "unreachable": true}
2023-04-23 19:26:29,707 p=99371 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:26:29,707 p=99371 u=craig n=ansible | testswarm                  : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:31:50,855 p=99758 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:31:50,865 p=99758 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:31:51,073 p=99758 u=craig n=ansible | fatal: [testswarm]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.13' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.13: Permission denied (publickey,password).", "unreachable": true}
2023-04-23 19:31:51,074 p=99758 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:31:51,074 p=99758 u=craig n=ansible | testswarm                  : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:33:38,044 p=99902 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:33:38,053 p=99902 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:33:38,276 p=99902 u=craig n=ansible | fatal: [testswarm]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.13' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.13: Permission denied (publickey).", "unreachable": true}
2023-04-23 19:33:38,277 p=99902 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:33:38,277 p=99902 u=craig n=ansible | testswarm                  : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:34:15,229 p=99977 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:34:15,238 p=99977 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:34:25,271 p=99977 u=craig n=ansible | fatal: [testswarm]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-04-23 19:34:25,273 p=99977 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:34:25,273 p=99977 u=craig n=ansible | testswarm                  : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:34:32,480 p=114 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:34:32,490 p=114 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:34:32,808 p=114 u=craig n=ansible | fatal: [testswarm]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.13' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.13: Permission denied (publickey).", "unreachable": true}
2023-04-23 19:34:32,809 p=114 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:34:32,809 p=114 u=craig n=ansible | testswarm                  : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:39:13,157 p=532 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:39:13,167 p=532 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:39:13,372 p=532 u=craig n=ansible | fatal: [testswarm]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.13' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.13: Permission denied (publickey).", "unreachable": true}
2023-04-23 19:39:13,373 p=532 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:39:13,373 p=532 u=craig n=ansible | testswarm                  : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:42:06,047 p=814 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-04-23 19:42:06,047 p=814 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-04-23 19:42:06,047 p=814 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-04-23 19:42:06,052 p=814 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-04-23 19:42:06,352 p=814 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ********************************************************************************************************************************************************************************
2023-04-23 19:42:06,370 p=814 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:42:07,820 p=814 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:42:07,862 p=814 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************
2023-04-23 19:42:08,730 p=814 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:42:08,751 p=814 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************
2023-04-23 19:42:09,138 p=814 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:42:09,154 p=814 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************
2023-04-23 19:42:09,929 p=814 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:42:09,962 p=814 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ****************************************************************************************************************
2023-04-23 19:42:10,266 p=814 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-23 19:42:10,282 p=814 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 19:42:10,294 p=814 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-23 19:42:10,310 p=814 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=0, hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 19:42:46,347 p=814 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'n': 1, 't': '  Logical volume \"vm-113-disk-0\" created.'}]"}
2023-04-23 19:42:46,348 p=814 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:42:46,348 p=814 u=craig n=ansible | 192.168.1.99               : ok=5    changed=1    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2023-04-23 19:43:12,497 p=1556 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ********************************************************************************************************************************************************************************
2023-04-23 19:43:12,516 p=1556 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:43:13,807 p=1556 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:43:13,850 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************
2023-04-23 19:43:14,660 p=1556 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:43:14,681 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************
2023-04-23 19:43:15,026 p=1556 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:43:15,043 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************
2023-04-23 19:43:15,805 p=1556 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:43:15,838 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ****************************************************************************************************************
2023-04-23 19:43:16,131 p=1556 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-23 19:43:16,146 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 19:43:16,159 p=1556 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-23 19:43:16,174 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=0, hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-23 19:43:16,642 p=1556 u=craig n=ansible | ok: [192.168.1.99]
2023-04-23 19:43:16,658 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *********************************************************************
2023-04-23 19:43:37,198 p=1556 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation 
warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-23 19:43:37,199 p=1556 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 19:43:37,220 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ***********************************************************************************************
2023-04-23 19:43:37,251 p=1556 u=craig n=ansible | changed: [192.168.1.99]
2023-04-23 19:43:37,276 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] **********************************************************
2023-04-23 19:43:40,649 p=1556 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-23 19:43:40,684 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************
2023-04-23 19:43:47,546 p=1556 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.13]
2023-04-23 19:43:47,579 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] **********************************************************************************************************************
2023-04-23 19:43:49,081 p=1556 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.13]
2023-04-23 19:43:49,113 p=1556 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] **********************************************************************************************************************************
2023-04-23 19:44:58,503 p=1556 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.13]
2023-04-23 19:44:58,532 p=1556 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] *********************************************************************************************
2023-04-23 19:44:59,075 p=1556 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.13]
2023-04-23 19:44:59,178 p=1556 u=craig n=ansible | PLAY [Create a user and lock down the container] *************************************************************************************************************************************************************************
2023-04-23 19:44:59,191 p=1556 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:45:00,064 p=1556 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:45:00,106 p=1556 u=craig n=ansible | TASK [create_user : Ensure group sudo exists name=sudo, state=present] ***************************************************************************************************************************************************
2023-04-23 19:45:00,510 p=1556 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:45:00,526 p=1556 u=craig n=ansible | TASK [create_user : Allow sudo group to have passwordless sudo path=/etc/sudoers, state=present, regexp=^%sudo, line=%sudo ALL=(ALL) NOPASSWD: ALL, validate=/usr/sbin/visudo -cf %s] ************************************
2023-04-23 19:45:00,911 p=1556 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:45:00,927 p=1556 u=craig n=ansible | TASK [create_user : Create a new user name={{machine_user}}, password={{machine_password | string | password_hash('sha512')}}, shell=/bin/bash, groups=sudo, append=True] ************************************************
2023-04-23 19:45:02,103 p=1556 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:45:02,121 p=1556 u=craig n=ansible | TASK [create_user : Create the .ssh directory path=/home/{{machine_user}}/.ssh, state=directory, mode=0700, owner={{machine_user}}, group={{machine_user}}] **************************************************************
2023-04-23 19:45:02,418 p=1556 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:45:02,436 p=1556 u=craig n=ansible | TASK [create_user : Copy the ssh key to the new user src={{machine_ssh_key}}, dest=/home/{{machine_user}}/.ssh/authorized_keys, mode=0600, owner={{machine_user}}, group={{machine_user}}] *******************************
2023-04-23 19:45:03,150 p=1556 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:45:03,180 p=1556 u=craig n=ansible | TASK [lockdown : Ensure the /run/sshd directory exists path=/run/sshd, state=directory, mode=493] ************************************************************************************************************************
2023-04-23 19:45:03,472 p=1556 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:45:03,488 p=1556 u=craig n=ansible | TASK [lockdown : Update SSH configuration to be more secure dest=/etc/ssh/sshd_config, regexp={{ item.regexp }}, line={{ item.line }}, state=present, validate=sshd -T -f %s, mode=420] **********************************
2023-04-23 19:45:03,808 p=1556 u=craig n=ansible | changed: [portainer-swarm-master] => (item={'regexp': '^#?PasswordAuthentication', 'line': 'PasswordAuthentication no'})
2023-04-23 19:45:04,124 p=1556 u=craig n=ansible | changed: [portainer-swarm-master] => (item={'regexp': '^#?PermitRootLogin', 'line': 'PermitRootLogin no'})
2023-04-23 19:45:04,447 p=1556 u=craig n=ansible | changed: [portainer-swarm-master] => (item={'regexp': '^#?Port', 'line': 'Port 22'})
2023-04-23 19:45:04,733 p=1556 u=craig n=ansible | changed: [portainer-swarm-master] => (item={'regexp': '^#?PermitEmptyPasswords', 'line': 'PermitEmptyPasswords no'})
2023-04-23 19:45:04,791 p=1556 u=craig n=ansible | RUNNING HANDLER [restart ssh name=sshd, state=restarted] *****************************************************************************************************************************************************************
2023-04-23 19:45:05,452 p=1556 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:45:05,512 p=1556 u=craig n=ansible | PLAY [Install gui] *******************************************************************************************************************************************************************************************************
2023-04-23 19:45:05,528 p=1556 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:45:07,253 p=1556 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:45:07,295 p=1556 u=craig n=ansible | TASK [lxc_gui : Ensure system is up to date update_cache=True, upgrade=True] *********************************************************************************************************************************************
2023-04-23 19:45:07,307 p=1556 u=craig n=ansible | skipping: [portainer-swarm-master]
2023-04-23 19:45:07,322 p=1556 u=craig n=ansible | TASK [lxc_gui : Install xrdp and Xfce4 desktop and force if needed and install dependencies and recommends name={{item}}, state=present, force=True, install_recommends=True] ********************************************
2023-04-23 19:45:07,342 p=1556 u=craig n=ansible | skipping: [portainer-swarm-master] => (item=xfce4) 
2023-04-23 19:45:07,344 p=1556 u=craig n=ansible | skipping: [portainer-swarm-master] => (item=xfce4-session) 
2023-04-23 19:45:07,346 p=1556 u=craig n=ansible | skipping: [portainer-swarm-master] => (item=xrdp) 
2023-04-23 19:45:07,348 p=1556 u=craig n=ansible | skipping: [portainer-swarm-master]
2023-04-23 19:45:07,363 p=1556 u=craig n=ansible | TASK [lxc_gui : Make sure xrdp is running name=xrdp, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-23 19:45:07,378 p=1556 u=craig n=ansible | skipping: [portainer-swarm-master]
2023-04-23 19:45:07,396 p=1556 u=craig n=ansible | TASK [lxc_gui : Install chrome using wget and apt install deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb, state=present, force=True, install_recommends=True] *****************************
2023-04-23 19:45:07,413 p=1556 u=craig n=ansible | skipping: [portainer-swarm-master]
2023-04-23 19:45:07,519 p=1556 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:45:07,519 p=1556 u=craig n=ansible | 192.168.1.99               : ok=13   changed=5    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-23 19:45:07,519 p=1556 u=craig n=ansible | portainer-swarm-master     : ok=10   changed=7    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2023-04-23 19:48:25,442 p=2245 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:48:25,453 p=2245 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:48:26,719 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:48:26,734 p=2245 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-04-23 19:48:28,235 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:48:28,243 p=2245 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-04-23 19:48:30,120 p=2245 u=craig n=ansible | changed: [portainer-swarm-master] => (item=apt-transport-https)
2023-04-23 19:48:30,894 p=2245 u=craig n=ansible | ok: [portainer-swarm-master] => (item=ca-certificates)
2023-04-23 19:48:34,932 p=2245 u=craig n=ansible | changed: [portainer-swarm-master] => (item=curl)
2023-04-23 19:48:41,742 p=2245 u=craig n=ansible | changed: [portainer-swarm-master] => (item=gnupg)
2023-04-23 19:48:42,527 p=2245 u=craig n=ansible | ok: [portainer-swarm-master] => (item=lsb-release)
2023-04-23 19:48:59,118 p=2245 u=craig n=ansible | changed: [portainer-swarm-master] => (item=software-properties-common)
2023-04-23 19:48:59,130 p=2245 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-04-23 19:48:59,968 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:48:59,977 p=2245 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-04-23 19:49:02,152 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:49:02,160 p=2245 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-04-23 19:49:25,426 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:49:25,435 p=2245 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-04-23 19:49:26,103 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:49:26,111 p=2245 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-04-23 19:49:26,586 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:49:26,591 p=2245 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-04-23 19:49:56,498 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:49:56,507 p=2245 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-04-23 19:50:02,071 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:50:02,086 p=2245 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] ******************************************************************************************
2023-04-23 19:50:02,870 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:50:02,877 p=2245 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ********************************************************************************************************************************
2023-04-23 19:50:03,491 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:50:03,499 p=2245 u=craig n=ansible | TASK [Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] *********************************************************************
2023-04-23 19:50:03,891 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:50:03,899 p=2245 u=craig n=ansible | TASK [Install Docker name=docker-ce, state=present, update_cache=True] ***************************************************************************************************************************************************
2023-04-23 19:50:05,365 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:50:05,375 p=2245 u=craig n=ansible | TASK [Add required kernel modules to /etc/modules-load.d/docker.conf dest=/etc/modules-load.d/docker.conf, content=# required kernel modules for proper docker swarm
# within LXC functionality
overlay
bonding
br_netfilter
iptable_mangle
iptable_nat
ip_vs
ip_vs_dh
ip_vs_ftp
ip_vs_lblc
ip_vs_lblcr
ip_vs_lc
ip_vs_nq
ip_vs_rr
ip_vs_sed
ip_vs_sh
ip_vs_wlc
ip_vs_wrr
nf_nat
xfrm_user
xt_conntrack
xt_MASQUERADE
, owner=root, group=root, mode=0644] ***
2023-04-23 19:50:06,142 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:50:06,149 p=2245 u=craig n=ansible | TASK [Update /etc/sysctl.conf to enable IP forwarding path=/etc/sysctl.conf, regexp=^net.ipv4.ip_forward, line=net.ipv4.ip_forward=1, state=present] *********************************************************************
2023-04-23 19:50:06,533 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:50:06,541 p=2245 u=craig n=ansible | TASK [Apply sysctl changes _raw_params=sysctl -p] ************************************************************************************************************************************************************************
2023-04-23 19:50:06,938 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:50:06,945 p=2245 u=craig n=ansible | TASK [Start Docker service name=docker, state=started, enabled=True] *****************************************************************************************************************************************************
2023-04-23 19:50:07,418 p=2245 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:50:07,426 p=2245 u=craig n=ansible | TASK [Start docker swarm advertise_addr={{ ansible_host }}, state=present] ***********************************************************************************************************************************************
2023-04-23 19:50:08,730 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:50:08,737 p=2245 u=craig n=ansible | TASK [Create Portainer stack file from template src=portainer-agent.yaml.j2, dest=/root/portainer-agent.yaml, owner=root, group=root, mode=0644] *************************************************************************
2023-04-23 19:50:09,442 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:50:09,451 p=2245 u=craig n=ansible | TASK [Deploy stack from a compose file state=present, name=portainer-agent, compose=['/root/portainer-agent.yaml']] ******************************************************************************************************
2023-04-23 19:50:11,334 p=2245 u=craig n=ansible | changed: [portainer-swarm-master]
2023-04-23 19:50:11,359 p=2245 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:50:11,359 p=2245 u=craig n=ansible | portainer-swarm-master     : ok=21   changed=13   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:51:40,053 p=2779 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:51:40,064 p=2779 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:51:41,895 p=2779 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:51:41,910 p=2779 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-04-23 19:51:44,508 p=2779 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:51:44,517 p=2779 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-04-23 19:51:46,018 p=2779 u=craig n=ansible | ok: [portainer-swarm-master] => (item=apt-transport-https)
2023-04-23 19:51:47,246 p=2779 u=craig n=ansible | ok: [portainer-swarm-master] => (item=ca-certificates)
2023-04-23 19:51:48,350 p=2779 u=craig n=ansible | ok: [portainer-swarm-master] => (item=curl)
2023-04-23 19:51:49,299 p=2779 u=craig n=ansible | ok: [portainer-swarm-master] => (item=gnupg)
2023-04-23 19:51:50,247 p=2779 u=craig n=ansible | ok: [portainer-swarm-master] => (item=lsb-release)
2023-04-23 19:51:51,153 p=2779 u=craig n=ansible | ok: [portainer-swarm-master] => (item=software-properties-common)
2023-04-23 19:51:51,165 p=2779 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-04-23 19:51:52,238 p=2779 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:51:52,247 p=2779 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-04-23 19:51:52,419 p=2779 u=craig n=ansible | fatal: [portainer-swarm-master]: UNREACHABLE! => {"changed": false, "msg": "mkdir: cannot create directory '/home/stantonius/.ansible/tmp/ansible-tmp-1682293912.286089-2871-129215652636812': No space left on device\n", "unreachable": true}
2023-04-23 19:51:52,420 p=2779 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:51:52,421 p=2779 u=craig n=ansible | portainer-swarm-master     : ok=4    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-23 19:52:47,615 p=2957 u=craig n=ansible | PLAY [Set up Docker Swarm Manager node] **********************************************************************************************************************************************************************************
2023-04-23 19:52:47,625 p=2957 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-23 19:52:49,124 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:52:49,141 p=2957 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-04-23 19:52:51,418 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:52:51,426 p=2957 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-04-23 19:52:52,680 p=2957 u=craig n=ansible | ok: [portainer-swarm-master] => (item=apt-transport-https)
2023-04-23 19:52:53,848 p=2957 u=craig n=ansible | ok: [portainer-swarm-master] => (item=ca-certificates)
2023-04-23 19:52:54,709 p=2957 u=craig n=ansible | ok: [portainer-swarm-master] => (item=curl)
2023-04-23 19:52:55,809 p=2957 u=craig n=ansible | ok: [portainer-swarm-master] => (item=gnupg)
2023-04-23 19:52:56,864 p=2957 u=craig n=ansible | ok: [portainer-swarm-master] => (item=lsb-release)
2023-04-23 19:52:57,659 p=2957 u=craig n=ansible | ok: [portainer-swarm-master] => (item=software-properties-common)
2023-04-23 19:52:57,671 p=2957 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-04-23 19:52:58,609 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:52:58,618 p=2957 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-04-23 19:52:59,452 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:52:59,461 p=2957 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-04-23 19:53:00,597 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:53:00,608 p=2957 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-04-23 19:53:01,591 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:53:01,600 p=2957 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-04-23 19:53:02,190 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:53:02,199 p=2957 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-04-23 19:53:03,307 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:53:03,316 p=2957 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-04-23 19:53:05,463 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:53:05,478 p=2957 u=craig n=ansible | TASK [Install required packages name=['apt-transport-https', 'ca-certificates', 'curl', 'gnupg', 'lsb-release'], state=present] ******************************************************************************************
2023-04-23 19:53:06,836 p=2957 u=craig n=ansible | ok: [portainer-swarm-master]
2023-04-23 19:53:06,845 p=2957 u=craig n=ansible | TASK [Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ********************************************************************************************************************************
2023-04-23 19:53:06,914 p=2957 u=craig n=ansible | fatal: [portainer-swarm-master]: UNREACHABLE! => {"changed": false, "msg": "mkdir: cannot create directory '/home/stantonius/.ansible/tmp/ansible-tmp-1682293986.881068-3139-161835157135810': No space left on device\n", "unreachable": true}
2023-04-23 19:53:06,915 p=2957 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-23 19:53:06,915 p=2957 u=craig n=ansible | portainer-swarm-master     : ok=11   changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-26 20:33:52,612 p=36760 u=craig n=ansible | [WARNING]:  * Failed to parse /Users/craig/Projects/homelab/inventory.ini with ini plugin: /Users/craig/Projects/homelab/inventory.ini:21: Expected key=value host variable assignment, got: ansible_host

2023-04-26 20:33:52,612 p=36760 u=craig n=ansible | [WARNING]: Unable to parse /Users/craig/Projects/homelab/inventory.ini as an inventory source

2023-04-26 20:33:52,612 p=36760 u=craig n=ansible | [WARNING]: No inventory was parsed, only implicit localhost is available

2023-04-26 20:33:52,617 p=36760 u=craig n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2023-04-26 20:33:53,018 p=36760 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ********************************************************************************************************************************************************************************
2023-04-26 20:33:53,036 p=36760 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-26 20:33:54,644 p=36760 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:33:54,687 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************
2023-04-26 20:33:55,519 p=36760 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:33:55,539 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************
2023-04-26 20:33:55,889 p=36760 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:33:55,906 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************
2023-04-26 20:33:56,616 p=36760 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:33:56,643 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ****************************************************************************************************************
2023-04-26 20:33:56,939 p=36760 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-26 20:33:56,955 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-26 20:33:56,968 p=36760 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-26 20:33:56,985 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=0, hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-26 20:34:11,494 p=36760 u=craig n=ansible | changed: [192.168.1.99]
2023-04-26 20:34:11,510 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *********************************************************************
2023-04-26 20:34:14,936 p=36760 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation 
warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-26 20:34:14,936 p=36760 u=craig n=ansible | changed: [192.168.1.99]
2023-04-26 20:34:14,952 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ***********************************************************************************************
2023-04-26 20:34:14,986 p=36760 u=craig n=ansible | changed: [192.168.1.99]
2023-04-26 20:34:15,011 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] **********************************************************
2023-04-26 20:34:20,385 p=36760 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-26 20:34:20,420 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************
2023-04-26 20:34:25,093 p=36760 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:34:25,120 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] **********************************************************************************************************************
2023-04-26 20:34:26,444 p=36760 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:34:26,476 p=36760 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] **********************************************************************************************************************************
2023-04-26 20:35:29,608 p=36760 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:35:29,635 p=36760 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] *********************************************************************************************
2023-04-26 20:35:30,199 p=36760 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:35:30,291 p=36760 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: homer

2023-04-26 20:35:30,291 p=36760 u=craig n=ansible | PLAY [Create a user and lock down the container] *************************************************************************************************************************************************************************
2023-04-26 20:35:30,291 p=36760 u=craig n=ansible | skipping: no hosts matched
2023-04-26 20:35:30,308 p=36760 u=craig n=ansible | PLAY [Install gui] *******************************************************************************************************************************************************************************************************
2023-04-26 20:35:30,309 p=36760 u=craig n=ansible | skipping: no hosts matched
2023-04-26 20:35:30,309 p=36760 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-26 20:35:30,309 p=36760 u=craig n=ansible | 192.168.1.99               : ok=13   changed=6    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-26 20:37:14,557 p=37242 u=craig n=ansible | PLAY [Create an LXC container in Proxmox] ********************************************************************************************************************************************************************************
2023-04-26 20:37:14,575 p=37242 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-26 20:37:16,068 p=37242 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:37:16,110 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************
2023-04-26 20:37:17,020 p=37242 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:37:17,037 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************
2023-04-26 20:37:17,378 p=37242 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:37:17,395 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************
2023-04-26 20:37:18,118 p=37242 u=craig n=ansible | ok: [192.168.1.99]
2023-04-26 20:37:18,144 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] ****************************************************************************************************************
2023-04-26 20:37:18,454 p=37242 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-26 20:37:18,469 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Create LXC without hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=1, features=['nesting=1', 'keyctl=1'], netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-26 20:37:18,482 p=37242 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-26 20:37:18,497 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Create LXC with hookscript vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged=0, hookscript=local:snippets/enable_lxc_ssh_hook.sh, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-04-26 20:37:27,269 p=37242 u=craig n=ansible | changed: [192.168.1.99]
2023-04-26 20:37:27,287 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] *********************************************************************
2023-04-26 20:37:33,734 p=37242 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation 
warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-04-26 20:37:33,735 p=37242 u=craig n=ansible | changed: [192.168.1.99]
2023-04-26 20:37:33,756 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{machine_ip | regex_replace('/.*', '')}}, groups=proxmox_nodes] ***********************************************************************************************
2023-04-26 20:37:33,791 p=37242 u=craig n=ansible | changed: [192.168.1.99]
2023-04-26 20:37:33,817 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{machine_ip | regex_replace('/.*', '')}}, port=22, state=started, sleep=5, timeout=300] **********************************************************
2023-04-26 20:37:34,477 p=37242 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-26 20:37:34,512 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************
2023-04-26 20:37:42,027 p=37242 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:37:42,061 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] **********************************************************************************************************************
2023-04-26 20:37:43,613 p=37242 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:37:43,647 p=37242 u=craig n=ansible | TASK [pm_create_lxc : Update all packages to their latest version name=*, state=latest] **********************************************************************************************************************************
2023-04-26 20:38:55,205 p=37242 u=craig n=ansible | changed: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:38:55,237 p=37242 u=craig n=ansible | TASK [pm_create_lxc : add rsa public key to remote host user=root, state=present, key={{ lookup('file', machine_ssh_key) }}] *********************************************************************************************
2023-04-26 20:38:55,799 p=37242 u=craig n=ansible | ok: [192.168.1.99 -> 192.168.1.13]
2023-04-26 20:38:55,900 p=37242 u=craig n=ansible | PLAY [Create a user and lock down the container] *************************************************************************************************************************************************************************
2023-04-26 20:38:55,914 p=37242 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-26 20:38:57,001 p=37242 u=craig n=ansible | ok: [homer]
2023-04-26 20:38:57,060 p=37242 u=craig n=ansible | TASK [create_user : Ensure group sudo exists name=sudo, state=present] ***************************************************************************************************************************************************
2023-04-26 20:38:57,847 p=37242 u=craig n=ansible | ok: [homer]
2023-04-26 20:38:57,870 p=37242 u=craig n=ansible | TASK [create_user : Allow sudo group to have passwordless sudo path=/etc/sudoers, state=present, regexp=^%sudo, line=%sudo ALL=(ALL) NOPASSWD: ALL, validate=/usr/sbin/visudo -cf %s] ************************************
2023-04-26 20:38:58,294 p=37242 u=craig n=ansible | changed: [homer]
2023-04-26 20:38:58,311 p=37242 u=craig n=ansible | TASK [create_user : Create a new user name={{machine_user}}, password={{machine_password | string | password_hash('sha512')}}, shell=/bin/bash, groups=sudo, append=True] ************************************************
2023-04-26 20:38:59,564 p=37242 u=craig n=ansible | changed: [homer]
2023-04-26 20:38:59,584 p=37242 u=craig n=ansible | TASK [create_user : Create the .ssh directory path=/home/{{machine_user}}/.ssh, state=directory, mode=0700, owner={{machine_user}}, group={{machine_user}}] **************************************************************
2023-04-26 20:38:59,920 p=37242 u=craig n=ansible | changed: [homer]
2023-04-26 20:38:59,943 p=37242 u=craig n=ansible | TASK [create_user : Copy the ssh key to the new user src={{machine_ssh_key}}, dest=/home/{{machine_user}}/.ssh/authorized_keys, mode=0600, owner={{machine_user}}, group={{machine_user}}] *******************************
2023-04-26 20:39:00,676 p=37242 u=craig n=ansible | changed: [homer]
2023-04-26 20:39:00,707 p=37242 u=craig n=ansible | TASK [lockdown : Ensure the /run/sshd directory exists path=/run/sshd, state=directory, mode=493] ************************************************************************************************************************
2023-04-26 20:39:00,993 p=37242 u=craig n=ansible | changed: [homer]
2023-04-26 20:39:01,010 p=37242 u=craig n=ansible | TASK [lockdown : Update SSH configuration to be more secure dest=/etc/ssh/sshd_config, regexp={{ item.regexp }}, line={{ item.line }}, state=present, validate=sshd -T -f %s, mode=420] **********************************
2023-04-26 20:39:01,319 p=37242 u=craig n=ansible | changed: [homer] => (item={'regexp': '^#?PasswordAuthentication', 'line': 'PasswordAuthentication no'})
2023-04-26 20:39:01,623 p=37242 u=craig n=ansible | changed: [homer] => (item={'regexp': '^#?PermitRootLogin', 'line': 'PermitRootLogin no'})
2023-04-26 20:39:01,950 p=37242 u=craig n=ansible | changed: [homer] => (item={'regexp': '^#?Port', 'line': 'Port 22'})
2023-04-26 20:39:02,315 p=37242 u=craig n=ansible | changed: [homer] => (item={'regexp': '^#?PermitEmptyPasswords', 'line': 'PermitEmptyPasswords no'})
2023-04-26 20:39:02,383 p=37242 u=craig n=ansible | RUNNING HANDLER [restart ssh name=sshd, state=restarted] *****************************************************************************************************************************************************************
2023-04-26 20:39:03,135 p=37242 u=craig n=ansible | changed: [homer]
2023-04-26 20:39:03,199 p=37242 u=craig n=ansible | PLAY [Install gui] *******************************************************************************************************************************************************************************************************
2023-04-26 20:39:03,215 p=37242 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-04-26 20:39:05,123 p=37242 u=craig n=ansible | ok: [homer]
2023-04-26 20:39:05,168 p=37242 u=craig n=ansible | TASK [lxc_gui : Ensure system is up to date update_cache=True, upgrade=True] *********************************************************************************************************************************************
2023-04-26 20:39:05,181 p=37242 u=craig n=ansible | skipping: [homer]
2023-04-26 20:39:05,195 p=37242 u=craig n=ansible | TASK [lxc_gui : Install xrdp and Xfce4 desktop and force if needed and install dependencies and recommends name={{item}}, state=present, force=True, install_recommends=True] ********************************************
2023-04-26 20:39:05,213 p=37242 u=craig n=ansible | skipping: [homer] => (item=xfce4) 
2023-04-26 20:39:05,216 p=37242 u=craig n=ansible | skipping: [homer] => (item=xfce4-session) 
2023-04-26 20:39:05,218 p=37242 u=craig n=ansible | skipping: [homer] => (item=xrdp) 
2023-04-26 20:39:05,220 p=37242 u=craig n=ansible | skipping: [homer]
2023-04-26 20:39:05,235 p=37242 u=craig n=ansible | TASK [lxc_gui : Make sure xrdp is running name=xrdp, state=started, enabled=True] ****************************************************************************************************************************************
2023-04-26 20:39:05,248 p=37242 u=craig n=ansible | skipping: [homer]
2023-04-26 20:39:05,280 p=37242 u=craig n=ansible | TASK [lxc_gui : Install chrome using wget and apt install deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb, state=present, force=True, install_recommends=True] *****************************
2023-04-26 20:39:05,292 p=37242 u=craig n=ansible | skipping: [homer]
2023-04-26 20:39:05,357 p=37242 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-04-26 20:39:05,357 p=37242 u=craig n=ansible | 192.168.1.99               : ok=13   changed=6    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-04-26 20:39:05,357 p=37242 u=craig n=ansible | homer                      : ok=10   changed=7    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2023-04-27 10:19:43,476 p=42570 u=craig n=ansible | PLAY [Automated VM creation] ********************************************************************************************************************************************************************************************
2023-04-27 10:19:43,483 p=42570 u=craig n=ansible | ERROR! vars file ~/Projects/homelab/vault.yaml was not found
Could not find file on the Ansible Controller.
If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-04-27 10:20:29,533 p=42642 u=craig n=ansible | PLAY [Automated VM creation] ********************************************************************************************************************************************************************************************
2023-04-27 10:20:29,545 p=42642 u=craig n=ansible | TASK [Gathering Facts ] *************************************************************************************************************************************************************************************************
2023-04-27 10:20:31,657 p=42642 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:20:31,694 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***************************************************************************************************************************
2023-04-27 10:20:32,671 p=42642 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:20:32,693 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ********************************************************************************************************************************
2023-04-27 10:20:33,654 p=42642 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:20:33,677 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *****************************************************************************************************
2023-04-27 10:20:33,888 p=42642 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 10:20:33,905 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **************************************************************************
2023-04-27 10:20:34,286 p=42642 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 10:20:34,296 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] ******************************************************************************************
2023-04-27 10:20:35,425 p=42642 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:20:35,435 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] ******************************************************
2023-04-27 10:20:36,031 p=42642 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:20:36,054 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] ***********************************************************************************
2023-04-27 10:20:39,649 p=42642 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:20:39,673 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***********
2023-04-27 10:20:44,048 p=42642 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:20:44,065 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ********************************************************************************
2023-04-27 10:20:50,592 p=42642 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:20:50,615 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 10:20:51,380 p=42642 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:20:51,400 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] **********************************************************************************************************************
2023-04-27 10:20:56,828 p=42642 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:20:56,849 p=42642 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ****************************************
2023-04-27 10:21:09,378 p=42642 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:21:09,459 p=42642 u=craig n=ansible | PLAY [Create a user and lock down the container] ************************************************************************************************************************************************************************
2023-04-27 10:21:09,462 p=42642 u=craig n=ansible | ERROR! vars file ~/Projects/homelab/vault.yaml was not found
Could not find file on the Ansible Controller.
If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-04-27 10:21:55,814 p=43464 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 10:21:55,826 p=43464 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 10:21:56,993 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:21:57,033 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 10:21:57,821 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:21:57,839 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 10:21:58,560 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:21:58,594 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 10:21:58,796 p=43464 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 10:21:58,812 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 10:21:59,193 p=43464 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 10:21:59,204 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 10:21:59,818 p=43464 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:21:59,833 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 10:22:00,150 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:22:00,167 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 10:22:03,175 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:22:03,198 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 10:22:06,974 p=43464 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:22:06,997 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 10:22:13,205 p=43464 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:22:13,227 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 10:22:13,642 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:22:13,662 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 10:22:19,000 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:22:19,022 p=43464 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 10:22:19,377 p=43464 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:22:19,447 p=43464 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 10:22:19,450 p=43464 u=craig n=ansible | ERROR! vars file ~/Projects/homelab/vault.yaml was not found
Could not find file on the Ansible Controller.
If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-04-27 10:24:08,460 p=43778 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 10:24:08,472 p=43778 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 10:24:09,929 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:09,969 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 10:24:10,714 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:10,736 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 10:24:11,435 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:11,469 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 10:24:11,664 p=43778 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 10:24:11,680 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 10:24:12,067 p=43778 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 10:24:12,078 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 10:24:12,727 p=43778 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:24:12,740 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 10:24:13,051 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:13,068 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 10:24:16,075 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:16,099 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 10:24:19,815 p=43778 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:24:19,840 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 10:24:26,056 p=43778 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:24:26,084 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 10:24:26,498 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:26,515 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 10:24:31,877 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:31,904 p=43778 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 10:24:32,271 p=43778 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:24:32,318 p=43778 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 10:24:32,321 p=43778 u=craig n=ansible | ERROR! vars file ~/Projects/homelab/vault.yaml was not found
Could not find file on the Ansible Controller.
If you are using a module and expect the file to exist on the remote, see the remote_src option
2023-04-27 10:25:05,759 p=44005 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 10:25:05,771 p=44005 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 10:25:06,938 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:06,970 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 10:25:07,748 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:07,764 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 10:25:08,482 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:08,516 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 10:25:08,711 p=44005 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 10:25:08,728 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 10:25:09,114 p=44005 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 10:25:09,125 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 10:25:09,747 p=44005 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:25:09,762 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 10:25:10,069 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:10,085 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 10:25:13,104 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:13,126 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 10:25:16,964 p=44005 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:25:16,983 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 10:25:23,267 p=44005 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 10:25:23,292 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 10:25:23,718 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:23,737 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 10:25:29,074 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:29,101 p=44005 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 10:25:29,462 p=44005 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 10:25:29,552 p=44005 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 10:25:29,560 p=44005 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 10:25:39,594 p=44005 u=craig n=ansible | fatal: [arnold]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.67 port 22: Operation timed out", "unreachable": true}
2023-04-27 10:25:39,597 p=44005 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 10:25:39,597 p=44005 u=craig n=ansible | 192.168.1.99               : ok=13   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 10:25:39,597 p=44005 u=craig n=ansible | arnold                     : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 13:43:56,400 p=54524 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 13:43:56,412 p=54524 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 13:43:57,845 p=54524 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:43:57,885 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 13:43:58,679 p=54524 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:43:58,701 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 13:43:59,426 p=54524 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:43:59,462 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 13:43:59,660 p=54524 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 13:43:59,678 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 13:44:00,067 p=54524 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 13:44:00,078 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 13:44:00,714 p=54524 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:44:00,730 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 13:44:01,044 p=54524 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:44:01,057 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 13:44:04,066 p=54524 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:44:04,090 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 13:44:07,865 p=54524 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:44:07,886 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 13:44:14,194 p=54524 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:44:14,216 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 13:44:14,654 p=54524 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:44:14,674 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 13:44:20,034 p=54524 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:44:20,047 p=54524 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 13:44:20,404 p=54524 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "VM with name = arnold does not exist in cluster"}
2023-04-27 13:44:20,405 p=54524 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 13:44:20,405 p=54524 u=craig n=ansible | 192.168.1.99               : ok=12   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-27 13:50:33,381 p=55150 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 13:50:33,393 p=55150 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 13:50:34,860 p=55150 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:50:34,900 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 13:50:35,678 p=55150 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:50:35,699 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 13:50:36,441 p=55150 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:50:36,476 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 13:50:36,671 p=55150 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 13:50:36,688 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 13:50:37,084 p=55150 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 13:50:37,095 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 13:50:37,722 p=55150 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:50:37,738 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 13:50:38,048 p=55150 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:50:38,063 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 13:50:41,055 p=55150 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:50:41,076 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 13:50:44,666 p=55150 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:50:44,692 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 13:50:50,985 p=55150 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:50:51,012 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 13:50:51,471 p=55150 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:50:51,497 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 13:50:56,923 p=55150 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:50:56,950 p=55150 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 13:50:57,308 p=55150 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "VM with name = arnold does not exist in cluster"}
2023-04-27 13:50:57,309 p=55150 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 13:50:57,310 p=55150 u=craig n=ansible | 192.168.1.99               : ok=12   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-27 13:53:53,551 p=55565 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 13:53:53,564 p=55565 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 13:53:54,935 p=55565 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:53:54,973 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 13:53:55,766 p=55565 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:53:55,788 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 13:53:56,530 p=55565 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:53:56,564 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 13:53:56,769 p=55565 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 13:53:56,786 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 13:53:57,211 p=55565 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 13:53:57,223 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 13:53:57,859 p=55565 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:53:57,871 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 13:53:58,178 p=55565 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:53:58,189 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 13:54:01,243 p=55565 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:54:01,271 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 13:54:04,938 p=55565 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:54:04,963 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 13:54:11,117 p=55565 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:54:11,143 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 13:54:16,631 p=55565 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:54:16,658 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 13:54:22,008 p=55565 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:54:22,033 p=55565 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 13:54:28,427 p=55565 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:54:28,516 p=55565 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 13:54:28,526 p=55565 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 13:54:38,558 p=55565 u=craig n=ansible | fatal: [arnold]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.67 port 22: Operation timed out", "unreachable": true}
2023-04-27 13:54:38,559 p=55565 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 13:54:38,560 p=55565 u=craig n=ansible | 192.168.1.99               : ok=13   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 13:54:38,560 p=55565 u=craig n=ansible | arnold                     : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 13:55:44,764 p=55857 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 13:55:44,776 p=55857 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 13:55:46,220 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:55:46,259 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 13:55:47,127 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:55:47,148 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 13:55:47,941 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:55:47,973 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 13:55:48,173 p=55857 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 13:55:48,189 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 13:55:48,574 p=55857 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 13:55:48,585 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 13:55:49,242 p=55857 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:55:49,257 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 13:55:49,575 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:55:49,590 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 13:55:52,597 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:55:52,619 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 13:55:56,188 p=55857 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:55:56,211 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 13:56:02,382 p=55857 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:56:02,404 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 13:56:02,865 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:56:02,887 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 13:56:08,300 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:56:08,323 p=55857 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 13:56:08,662 p=55857 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:56:08,749 p=55857 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 13:56:08,758 p=55857 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 13:56:08,843 p=55857 u=craig n=ansible | fatal: [arnold]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.67' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.67: Permission denied (publickey,password).", "unreachable": true}
2023-04-27 13:56:08,843 p=55857 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 13:56:08,843 p=55857 u=craig n=ansible | 192.168.1.99               : ok=13   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 13:56:08,843 p=55857 u=craig n=ansible | arnold                     : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 13:59:42,209 p=56318 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 13:59:42,221 p=56318 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 13:59:43,655 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:59:43,695 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 13:59:44,474 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:59:44,496 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 13:59:45,219 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:59:45,252 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 13:59:45,448 p=56318 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 13:59:45,464 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 13:59:45,853 p=56318 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 13:59:45,864 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 13:59:46,483 p=56318 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:59:46,498 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 13:59:46,816 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:59:46,832 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 13:59:49,842 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 13:59:49,865 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 13:59:53,602 p=56318 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:59:53,623 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 13:59:59,847 p=56318 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 13:59:59,869 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 14:00:00,296 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:00:00,317 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 14:00:05,685 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:00:05,707 p=56318 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 14:00:06,061 p=56318 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:00:06,148 p=56318 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 14:00:06,157 p=56318 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 14:00:06,239 p=56318 u=craig n=ansible | fatal: [arnold]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.67' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.67: Permission denied (publickey,password).", "unreachable": true}
2023-04-27 14:00:06,240 p=56318 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 14:00:06,240 p=56318 u=craig n=ansible | 192.168.1.99               : ok=13   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 14:00:06,240 p=56318 u=craig n=ansible | arnold                     : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 14:01:43,454 p=56602 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 14:01:43,466 p=56602 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 14:01:44,867 p=56602 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:01:44,907 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 14:01:45,684 p=56602 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:01:45,706 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 14:01:46,432 p=56602 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:01:46,466 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 14:01:46,662 p=56602 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 14:01:46,678 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 14:01:47,065 p=56602 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 14:01:47,076 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 14:01:47,697 p=56602 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 14:01:47,712 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 14:01:48,031 p=56602 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:01:48,048 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 14:01:51,170 p=56602 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:01:51,194 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 14:01:54,946 p=56602 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 14:01:54,968 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 14:02:01,095 p=56602 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 14:02:01,116 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit'}, scsihw=virtio-scsi-pci] ***
2023-04-27 14:02:07,599 p=56602 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 14:02:07,620 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 14:02:12,985 p=56602 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 14:02:13,006 p=56602 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 14:02:19,401 p=56602 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 14:02:19,487 p=56602 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 14:02:19,496 p=56602 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 14:02:29,525 p=56602 u=craig n=ansible | fatal: [arnold]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.67 port 22: Operation timed out", "unreachable": true}
2023-04-27 14:02:29,527 p=56602 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 14:02:29,527 p=56602 u=craig n=ansible | 192.168.1.99               : ok=13   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 14:02:29,527 p=56602 u=craig n=ansible | arnold                     : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 15:05:08,167 p=58980 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 15:05:08,180 p=58980 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 15:05:09,671 p=58980 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:05:09,711 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 15:05:10,490 p=58980 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:05:10,512 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 15:05:11,215 p=58980 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:05:11,249 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 15:05:11,447 p=58980 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 15:05:11,464 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 15:05:11,855 p=58980 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 15:05:11,866 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 15:05:12,518 p=58980 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 15:05:12,534 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 15:05:12,857 p=58980 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:05:12,873 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 15:05:15,876 p=58980 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:05:15,900 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 15:05:19,523 p=58980 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 15:05:19,545 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 15:05:25,666 p=58980 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 15:05:25,687 p=58980 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit', 'scsi2': 'local-lvm:vm-{{machine_id}}-disk-1,size={{machine_disk}},format=qcow2'}, scsihw=virtio-scsi-pci] ***
2023-04-27 15:05:55,310 p=58980 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'t': '  Logical volume \"vm-202-cloudinit\" created.', 'n': 1}]"}
2023-04-27 15:05:55,311 p=58980 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 15:05:55,311 p=58980 u=craig n=ansible | 192.168.1.99               : ok=10   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-27 15:14:07,902 p=63660 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 15:14:07,915 p=63660 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 15:14:09,349 p=63660 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:14:09,379 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 15:14:10,138 p=63660 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:14:10,160 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 15:14:10,874 p=63660 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:14:10,909 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 15:14:11,109 p=63660 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 15:14:11,125 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 15:14:11,514 p=63660 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 15:14:11,524 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 15:14:12,151 p=63660 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 15:14:12,167 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 15:14:12,481 p=63660 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:14:12,496 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 15:14:15,533 p=63660 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 15:14:15,556 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 15:14:19,240 p=63660 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 15:14:19,261 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 15:14:25,476 p=63660 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 15:14:25,497 p=63660 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit', 'scsi2': 'local-lvm:{{machine_disk}},format=qcow2'}, scsihw=virtio-scsi-pci] ***
2023-04-27 15:14:55,187 p=63660 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for creating VM. Last line in task before timeout: [{'n': 1, 't': '  Logical volume \"vm-202-cloudinit\" created.'}]"}
2023-04-27 15:14:55,188 p=63660 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 15:14:55,188 p=63660 u=craig n=ansible | 192.168.1.99               : ok=10   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-27 16:14:13,993 p=67295 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 16:14:14,006 p=67295 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 16:14:15,640 p=67295 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:14:15,678 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 16:14:16,509 p=67295 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:14:16,536 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 16:14:17,293 p=67295 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:14:17,330 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 16:14:17,527 p=67295 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 16:14:17,544 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 16:14:17,943 p=67295 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 16:14:17,957 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 16:14:18,586 p=67295 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:14:18,596 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 16:14:18,909 p=67295 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:14:18,926 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 16:14:21,980 p=67295 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:14:22,008 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 16:14:25,861 p=67295 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:14:25,886 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 16:14:32,119 p=67295 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:14:32,145 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit', 'scsi2': 'local-lvm:{{machine_disk}}'}, scsihw=virtio-scsi-pci] ***
2023-04-27 16:14:36,640 p=67295 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:14:36,662 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Sleep for 5 seconds to wait for cluster to recognize VM timeout=5] ******************************************************************************************************
2023-04-27 16:14:42,015 p=67295 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:14:42,042 p=67295 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 16:14:42,404 p=67295 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "VM with name = arnold does not exist in cluster"}
2023-04-27 16:14:42,406 p=67295 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 16:14:42,406 p=67295 u=craig n=ansible | 192.168.1.99               : ok=12   changed=5    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-27 16:26:21,818 p=68268 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 16:26:21,831 p=68268 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 16:26:23,313 p=68268 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:26:23,353 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 16:26:24,131 p=68268 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:26:24,152 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 16:26:24,867 p=68268 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:26:24,901 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 16:26:25,102 p=68268 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 16:26:25,118 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 16:26:25,510 p=68268 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 16:26:25,520 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 16:26:26,151 p=68268 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:26:26,165 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 16:26:26,478 p=68268 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:26:26,494 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 16:26:29,511 p=68268 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:26:29,534 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 16:26:33,151 p=68268 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:26:33,172 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 16:26:39,361 p=68268 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:26:39,382 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit', 'scsi2': 'local-lvm:{{machine_disk}}'}, scsihw=virtio-scsi-pci] ***
2023-04-27 16:26:46,861 p=68268 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:26:46,882 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Wait for VM to be recognized path=/etc/pve/nodes/{{ node_name }}/qemu-server/{{ machine_id }}.conf, state=present, timeout=30] ******************************************
2023-04-27 16:26:47,217 p=68268 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 16:26:47,233 p=68268 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 16:26:52,603 p=68268 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 16:26:52,691 p=68268 u=craig n=ansible | PLAY [Create a user and lock down the container] ********************************************************************************************************************************************************
2023-04-27 16:26:52,700 p=68268 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 16:27:02,729 p=68268 u=craig n=ansible | fatal: [arnold]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.67 port 22: Operation timed out", "unreachable": true}
2023-04-27 16:27:02,730 p=68268 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 16:27:02,731 p=68268 u=craig n=ansible | 192.168.1.99               : ok=13   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 16:27:02,731 p=68268 u=craig n=ansible | arnold                     : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-04-27 17:07:22,007 p=72193 u=craig n=ansible | Starting galaxy role install process
2023-04-27 17:07:22,175 p=72193 u=craig n=ansible | - downloading role 'pve_nvidia_passthrough', owned by simoncaron
2023-04-27 17:07:22,629 p=72193 u=craig n=ansible | - downloading role from https://github.com/simoncaron/ansible-role-pve_nvidia_passthrough/archive/2.0.1.tar.gz
2023-04-27 17:07:23,237 p=72193 u=craig n=ansible | - extracting simoncaron.pve_nvidia_passthrough to /Users/craig/Projects/homelab/ansible/roles/simoncaron.pve_nvidia_passthrough
2023-04-27 17:07:23,245 p=72193 u=craig n=ansible | - simoncaron.pve_nvidia_passthrough (2.0.1) was installed successfully
2023-04-27 17:49:41,212 p=73416 u=craig n=ansible | PLAY [arnold] *******************************************************************************************************************************************************************************************
2023-04-27 17:49:41,222 p=73416 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 17:49:42,752 p=73416 u=craig n=ansible | ok: [arnold]
2023-04-27 17:49:42,769 p=73416 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Blacklist nouveau driver src=blacklist-nouveau.conf, dest=/etc/modprobe.d/blacklist-nouveau.conf, mode=0644] **************************************************
2023-04-27 17:49:43,424 p=73416 u=craig n=ansible | changed: [arnold]
2023-04-27 17:49:43,430 p=73416 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Force unloading of nouveau driver _raw_params=flush_handlers] *************************************************************************************************
2023-04-27 17:49:43,443 p=73416 u=craig n=ansible | RUNNING HANDLER [simoncaron.pve_nvidia_passthrough : Rebuild initramfs _raw_params=update-initramfs -u {{ pve_nvidia_passthrough_initramfs_update_options }}] *******************************************
2023-04-27 17:49:56,922 p=73416 u=craig n=ansible | ok: [arnold]
2023-04-27 17:49:56,935 p=73416 u=craig n=ansible | RUNNING HANDLER [simoncaron.pve_nvidia_passthrough : Reboot to load drivers ] ***************************************************************************************************************************
2023-04-27 17:50:26,439 p=73416 u=craig n=ansible | changed: [arnold]
2023-04-27 17:50:26,449 p=73416 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install kernel headers name=pve-headers, state=present] *******************************************************************************************************
2023-04-27 17:50:27,278 p=73416 u=craig n=ansible | fatal: [arnold]: FAILED! => {"changed": false, "msg": "No package matching 'pve-headers' is available"}
2023-04-27 17:50:27,279 p=73416 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 17:50:27,279 p=73416 u=craig n=ansible | arnold                     : ok=4    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-27 17:54:59,537 p=73910 u=craig n=ansible | PLAY [bigprox] ******************************************************************************************************************************************************************************************
2023-04-27 17:54:59,549 p=73910 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 17:55:01,128 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:55:01,147 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Blacklist nouveau driver src=blacklist-nouveau.conf, dest=/etc/modprobe.d/blacklist-nouveau.conf, mode=0644] **************************************************
2023-04-27 17:55:01,771 p=73910 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 17:55:01,780 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Force unloading of nouveau driver _raw_params=flush_handlers] *************************************************************************************************
2023-04-27 17:55:01,793 p=73910 u=craig n=ansible | RUNNING HANDLER [simoncaron.pve_nvidia_passthrough : Rebuild initramfs _raw_params=update-initramfs -u {{ pve_nvidia_passthrough_initramfs_update_options }}] *******************************************
2023-04-27 17:55:50,858 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:55:50,868 p=73910 u=craig n=ansible | RUNNING HANDLER [simoncaron.pve_nvidia_passthrough : Reboot to load drivers ] ***************************************************************************************************************************
2023-04-27 17:56:54,439 p=73910 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 17:56:54,450 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install kernel headers name=pve-headers, state=present] *******************************************************************************************************
2023-04-27 17:56:55,193 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:56:55,203 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Create temporary download directory for nvidia drivers state=directory, suffix=nvidia_drivers] ****************************************************************
2023-04-27 17:56:55,525 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:56:55,531 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Download drivers NVIDIA-Linux-x86_64-525.116.03 url=https://us.download.nvidia.com/XFree86/Linux-x86_64/{{ pve_nvidia_passthrough_driver_version }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, dest={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, mode=0775] ***
2023-04-27 17:57:01,346 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:57:01,357 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia drivers 525.116.03 creates=/usr/lib/firmware/nvidia/{{ pve_nvidia_passthrough_driver_version }}, _raw_params={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run {{ pve_nvidia_passthrough_driver_host_install_opts }}] ***
2023-04-27 17:57:42,211 p=73910 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 17:57:42,221 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add nvidia modules to modules.conf path=/etc/modules-load.d/modules.conf, block=# Nvidia modules
nvidia-drm
nvidia-uvm
] *****************************************
2023-04-27 17:57:42,647 p=73910 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 17:57:42,657 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Copy udev rule file src=70-nvidia.rules, dest=/etc/udev/rules.d/70-nvidia.rules, mode=0644] *******************************************************************
2023-04-27 17:57:43,160 p=73910 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 17:57:43,168 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Populate service facts ] **************************************************************************************************************************************
2023-04-27 17:57:45,301 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:57:45,310 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Copy nvidia-persistenced installer package src=/usr/share/doc/NVIDIA_GLX-1.0/samples/nvidia-persistenced-init.tar.bz2, dest={{ tempfile.path }}/nvidia-persistenced-init.tar.bz2, mode=0444, remote_src=True] ***
2023-04-27 17:57:45,578 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:57:45,585 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Copy and prepare install script chdir={{ tempfile.path }}, _raw_params={{ item }}] ****************************************************************************
2023-04-27 17:57:45,912 p=73910 u=craig n=ansible | ok: [192.168.1.99] => (item=bunzip2 nvidia-persistenced-init.tar.bz2)
2023-04-27 17:57:46,233 p=73910 u=craig n=ansible | ok: [192.168.1.99] => (item=tar -xf nvidia-persistenced-init.tar)
2023-04-27 17:57:46,553 p=73910 u=craig n=ansible | ok: [192.168.1.99] => (item=chmod +x nvidia-persistenced-init/install.sh)
2023-04-27 17:57:46,570 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Run nvidia-persistenced-init/install.sh creates=/lib/systemd/system/nvidia-persistenced.service, _raw_params={{ tempfile.path }}/nvidia-persistenced-init/install.sh] ***
2023-04-27 17:57:48,113 p=73910 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 17:57:48,125 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Create temporary download directory for nvidia drivers state=directory, suffix=nvidia_drivers] ****************************************************************
2023-04-27 17:57:48,139 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,150 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Download drivers NVIDIA-Linux-x86_64-525.116.03 url=https://us.download.nvidia.com/XFree86/Linux-x86_64/{{ pve_nvidia_passthrough_driver_version }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, dest={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, mode=0775] ***
2023-04-27 17:57:48,162 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,170 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia drivers 525.116.03 creates=/usr/lib/firmware/nvidia/{{ pve_nvidia_passthrough_driver_version }}, _raw_params={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run {{ pve_nvidia_passthrough_driver_guest_install_opts }}] ***
2023-04-27 17:57:48,180 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,188 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add libnvidia-container apt key url={{ pve_nvidia_passthrough_libnvidia_apt_gpg_key }}, dest=/etc/apt/trusted.gpg.d/nvidia-docker.asc, mode=0644, force=True] ***
2023-04-27 17:57:48,199 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,205 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add libnvidia-container repository repo={{ pve_nvidia_passthrough_libnvidia_apt_repository }}, state=present, filename=nvidia-container-toolkit, update_cache=True] ***
2023-04-27 17:57:48,217 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,226 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia-container-toolkit package name=nvidia-container-toolkit, state=present] ************************************************************************
2023-04-27 17:57:48,238 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,264 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add the no-cgroups option for unprivileged containers path=/etc/nvidia-container-runtime/config.toml, regexp=^#no-cgroups = false, line=no-cgroups = true] ****
2023-04-27 17:57:48,275 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,281 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Check if /etc/docker/daemon.json exists path=/etc/docker/daemon.json] *****************************************************************************************
2023-04-27 17:57:48,292 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,298 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Check /etc/docker/daemon.json runtime config _raw_params=cat /etc/docker/daemon.json] *************************************************************************
2023-04-27 17:57:48,309 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,316 p=73910 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia drivers 525.116.03 _raw_params=nvidia-ctk runtime configure --runtime=docker] ******************************************************************
2023-04-27 17:57:48,327 p=73910 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 17:57:48,351 p=73910 u=craig n=ansible | RUNNING HANDLER [simoncaron.pve_nvidia_passthrough : Rebuild initramfs _raw_params=update-initramfs -u {{ pve_nvidia_passthrough_initramfs_update_options }}] *******************************************
2023-04-27 17:58:33,200 p=73910 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 17:58:33,213 p=73910 u=craig n=ansible | RUNNING HANDLER [simoncaron.pve_nvidia_passthrough : Reboot to load drivers ] ***************************************************************************************************************************
2023-04-27 17:59:18,549 p=73910 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 17:59:18,572 p=73910 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 17:59:18,572 p=73910 u=craig n=ansible | 192.168.1.99               : ok=16   changed=7    unreachable=0    failed=0    skipped=10   rescued=0    ignored=0   
2023-04-27 20:12:31,450 p=78630 u=craig n=ansible | ERROR! the playbook: ansible/playbooks/gpu_passthrough/main.yaml could not be found
2023-04-27 20:12:45,616 p=78684 u=craig n=ansible | PLAY [bigprox] ******************************************************************************************************************************************************************************************
2023-04-27 20:12:45,634 p=78684 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 20:12:47,184 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:47,204 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Blacklist nouveau driver src=blacklist-nouveau.conf, dest=/etc/modprobe.d/blacklist-nouveau.conf, mode=0644] **************************************************
2023-04-27 20:12:47,870 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:47,877 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Force unloading of nouveau driver _raw_params=flush_handlers] *************************************************************************************************
2023-04-27 20:12:47,891 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install kernel headers name=pve-headers, state=present] *******************************************************************************************************
2023-04-27 20:12:48,705 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:48,712 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Create temporary download directory for nvidia drivers state=directory, suffix=nvidia_drivers] ****************************************************************
2023-04-27 20:12:49,194 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:49,202 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Download drivers NVIDIA-Linux-x86_64-525.116.03 url=https://us.download.nvidia.com/XFree86/Linux-x86_64/{{ pve_nvidia_passthrough_driver_version }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, dest={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, mode=0775] ***
2023-04-27 20:12:55,156 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:55,168 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia drivers 525.116.03 creates=/usr/lib/firmware/nvidia/{{ pve_nvidia_passthrough_driver_version }}, _raw_params={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run {{ pve_nvidia_passthrough_driver_host_install_opts }}] ***
2023-04-27 20:12:55,529 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:55,536 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add nvidia modules to modules.conf path=/etc/modules-load.d/modules.conf, block=# Nvidia modules
nvidia-drm
nvidia-uvm
] *****************************************
2023-04-27 20:12:55,891 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:55,898 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Copy udev rule file src=70-nvidia.rules, dest=/etc/udev/rules.d/70-nvidia.rules, mode=0644] *******************************************************************
2023-04-27 20:12:56,374 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:56,383 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Populate service facts ] **************************************************************************************************************************************
2023-04-27 20:12:58,617 p=78684 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:12:58,628 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Copy nvidia-persistenced installer package src=/usr/share/doc/NVIDIA_GLX-1.0/samples/nvidia-persistenced-init.tar.bz2, dest={{ tempfile.path }}/nvidia-persistenced-init.tar.bz2, mode=0444, remote_src=True] ***
2023-04-27 20:12:58,643 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,653 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Copy and prepare install script chdir={{ tempfile.path }}, _raw_params={{ item }}] ****************************************************************************
2023-04-27 20:12:58,678 p=78684 u=craig n=ansible | skipping: [192.168.1.99] => (item=bunzip2 nvidia-persistenced-init.tar.bz2) 
2023-04-27 20:12:58,682 p=78684 u=craig n=ansible | skipping: [192.168.1.99] => (item=tar -xf nvidia-persistenced-init.tar) 
2023-04-27 20:12:58,684 p=78684 u=craig n=ansible | skipping: [192.168.1.99] => (item=chmod +x nvidia-persistenced-init/install.sh) 
2023-04-27 20:12:58,686 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,696 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Run nvidia-persistenced-init/install.sh creates=/lib/systemd/system/nvidia-persistenced.service, _raw_params={{ tempfile.path }}/nvidia-persistenced-init/install.sh] ***
2023-04-27 20:12:58,713 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,724 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Create temporary download directory for nvidia drivers state=directory, suffix=nvidia_drivers] ****************************************************************
2023-04-27 20:12:58,740 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,752 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Download drivers NVIDIA-Linux-x86_64-525.116.03 url=https://us.download.nvidia.com/XFree86/Linux-x86_64/{{ pve_nvidia_passthrough_driver_version }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, dest={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run, mode=0775] ***
2023-04-27 20:12:58,767 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,779 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia drivers 525.116.03 creates=/usr/lib/firmware/nvidia/{{ pve_nvidia_passthrough_driver_version }}, _raw_params={{ tempfile.path }}/NVIDIA-Linux-x86_64-{{ pve_nvidia_passthrough_driver_version }}.run {{ pve_nvidia_passthrough_driver_guest_install_opts }}] ***
2023-04-27 20:12:58,794 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,805 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add libnvidia-container apt key url={{ pve_nvidia_passthrough_libnvidia_apt_gpg_key }}, dest=/etc/apt/trusted.gpg.d/nvidia-docker.asc, mode=0644, force=True] ***
2023-04-27 20:12:58,819 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,830 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add libnvidia-container repository repo={{ pve_nvidia_passthrough_libnvidia_apt_repository }}, state=present, filename=nvidia-container-toolkit, update_cache=True] ***
2023-04-27 20:12:58,844 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,874 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia-container-toolkit package name=nvidia-container-toolkit, state=present] ************************************************************************
2023-04-27 20:12:58,887 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,897 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Add the no-cgroups option for unprivileged containers path=/etc/nvidia-container-runtime/config.toml, regexp=^#no-cgroups = false, line=no-cgroups = true] ****
2023-04-27 20:12:58,910 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,920 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Check if /etc/docker/daemon.json exists path=/etc/docker/daemon.json] *****************************************************************************************
2023-04-27 20:12:58,935 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,945 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Check /etc/docker/daemon.json runtime config _raw_params=cat /etc/docker/daemon.json] *************************************************************************
2023-04-27 20:12:58,959 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:58,969 p=78684 u=craig n=ansible | TASK [simoncaron.pve_nvidia_passthrough : Install nvidia drivers 525.116.03 _raw_params=nvidia-ctk runtime configure --runtime=docker] ******************************************************************
2023-04-27 20:12:58,984 p=78684 u=craig n=ansible | skipping: [192.168.1.99]
2023-04-27 20:12:59,024 p=78684 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 20:12:59,024 p=78684 u=craig n=ansible | 192.168.1.99               : ok=9    changed=0    unreachable=0    failed=0    skipped=13   rescued=0    ignored=0   
2023-04-27 20:13:15,400 p=78858 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-27 20:13:15,419 p=78858 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-27 20:13:16,676 p=78858 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:13:16,720 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-27 20:13:17,744 p=78858 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:13:17,766 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-27 20:13:18,511 p=78858 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:13:18,543 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-27 20:13:18,838 p=78858 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-27 20:13:18,864 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-27 20:13:19,491 p=78858 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-27 20:13:19,507 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-27 20:13:20,222 p=78858 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 20:13:20,237 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-27 20:13:20,596 p=78858 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:13:20,611 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-27 20:13:27,430 p=78858 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 20:13:27,454 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-27 20:13:28,493 p=78858 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 20:13:28,514 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-27 20:13:33,564 p=78858 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 20:13:33,586 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, machine=q35, bios=ovmf, boot=cdn, efidisk0={'efitype': '2m', 'storage': 'local-lvm', 'format': 'raw', 'pre_enrolled_keys': False}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit', 'scsi2': 'local-lvm:{{machine_disk}}'}, scsihw=virtio-scsi-pci, hostpci={"hostpci0": "01:00.0,x-vga=on"}] ***
2023-04-27 20:14:04,405 p=78858 u=craig n=ansible | changed: [192.168.1.99]
2023-04-27 20:14:04,430 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Wait for VM to be recognized path=/etc/pve/nodes/{{ node_name }}/qemu-server/{{ machine_id }}.conf, state=present, timeout=30] ******************************************
2023-04-27 20:14:05,299 p=78858 u=craig n=ansible | ok: [192.168.1.99]
2023-04-27 20:14:05,321 p=78858 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-27 20:14:06,341 p=78858 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "VM with name = arnold does not exist in cluster"}
2023-04-27 20:14:06,342 p=78858 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-27 20:14:06,342 p=78858 u=craig n=ansible | 192.168.1.99               : ok=12   changed=6    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-28 16:16:14,878 p=91532 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-28 16:16:14,891 p=91532 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-28 16:16:16,569 p=91532 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:16:16,620 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-28 16:16:17,442 p=91532 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:16:17,463 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-28 16:16:18,189 p=91532 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:16:18,213 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-28 16:16:18,408 p=91532 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-28 16:16:18,425 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-28 16:16:18,812 p=91532 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-28 16:16:18,823 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-28 16:16:19,504 p=91532 u=craig n=ansible | changed: [192.168.1.99]
2023-04-28 16:16:19,516 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-28 16:16:19,827 p=91532 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:16:19,842 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-28 16:16:25,118 p=91532 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:16:25,140 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-28 16:16:28,595 p=91532 u=craig n=ansible | changed: [192.168.1.99]
2023-04-28 16:16:28,605 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-28 16:16:37,665 p=91532 u=craig n=ansible | changed: [192.168.1.99]
2023-04-28 16:16:37,687 p=91532 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, machine=q35, bios=ovmf, boot=cdn, efidisk0={'efitype': '2m', 'storage': 'local-lvm', 'format': 'raw', 'pre_enrolled_keys': False}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit', 'scsi2': 'local-lvm:{{machine_disk}}'}, scsihw=virtio-scsi-pci, hostpci={"hostpci0": "01:00.0,x-vga=on"}, vga=qxl, serial=socket] ***
2023-04-28 16:16:38,032 p=91532 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "argument 'serial' is of type <class 'str'> and we were unable to convert to dict: dictionary requested, could not parse JSON or key=value"}
2023-04-28 16:16:38,033 p=91532 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-28 16:16:38,033 p=91532 u=craig n=ansible | 192.168.1.99               : ok=10   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-04-28 16:18:17,124 p=91847 u=craig n=ansible | PLAY [Automated VM creation] ****************************************************************************************************************************************************************************
2023-04-28 16:18:17,137 p=91847 u=craig n=ansible | TASK [Gathering Facts ] *********************************************************************************************************************************************************************************
2023-04-28 16:18:18,681 p=91847 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:18:18,721 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Install proxmoxer on main host name=proxmoxer, state=present] ***********************************************************************************************************
2023-04-28 16:18:19,467 p=91847 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:18:19,489 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Ensure pycdlib is installed name=pycdlib, state=present] ****************************************************************************************************************
2023-04-28 16:18:20,216 p=91847 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:18:20,250 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Print the ssh key and store it to a variable _raw_params=cat {{ machine_ssh_key }}] *************************************************************************************
2023-04-28 16:18:20,445 p=91847 u=craig n=ansible | changed: [192.168.1.99 -> localhost]
2023-04-28 16:18:20,461 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Register the user password hash machine_password_hash={{machine_password | string | password_hash('sha512')}}] **********************************************************
2023-04-28 16:18:20,855 p=91847 u=craig n=ansible | ok: [192.168.1.99 -> localhost]
2023-04-28 16:18:20,866 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Generate and install the user-data file src=user-data.j2, dest=/var/lib/vz/snippets/user-data] **************************************************************************
2023-04-28 16:18:21,509 p=91847 u=craig n=ansible | changed: [192.168.1.99]
2023-04-28 16:18:21,525 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create an empty meta-data file path=/var/lib/vz/snippets/meta-data, state=touch, modification_time=preserve, access_time=preserve] **************************************
2023-04-28 16:18:21,837 p=91847 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:18:21,852 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Copy the image to /tmp src=/var/lib/vz/template/iso/{{ machine_image }}, remote_src=True, dest=/tmp/] *******************************************************************
2023-04-28 16:18:24,895 p=91847 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:18:24,917 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Run the ubuntu_autoinstall.py python script executable=/usr/bin/python3, _raw_params=~/Projects/homelab/scripts/ubuntu_autoinstall.py /tmp/{{ machine_image }} /tmp/test.iso] ***
2023-04-28 16:18:28,296 p=91847 u=craig n=ansible | changed: [192.168.1.99]
2023-04-28 16:18:28,318 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Move the ISO to the correct location src=/tmp/test.iso, dest=/var/lib/vz/template/iso/, remote_src=True] ****************************************************************
2023-04-28 16:18:34,120 p=91847 u=craig n=ansible | changed: [192.168.1.99]
2023-04-28 16:18:34,142 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Create VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, vcpus={{machine_cpus}}, cores={{machine_cores}}, memory={{machine_ram}}, name={{machine_name}}, state=present, onboot=False, vmid={{machine_id}}, sshkeys={{ssh_key.stdout}}, machine=q35, bios=ovmf, boot=cdn, efidisk0={'efitype': '2m', 'storage': 'local-lvm', 'format': 'raw', 'pre_enrolled_keys': False}, net={'net0': 'model=virtio,bridge=vmbr0,firewall=1'}, scsi={'scsi0': 'local:iso/test.iso,media=cdrom', 'scsi1': 'local-lvm:cloudinit', 'scsi2': 'local-lvm:{{machine_disk}}'}, scsihw=virtio-scsi-pci, hostpci={"hostpci0": "01:00.0,x-vga=on"}, vga=std] ***
2023-04-28 16:18:43,666 p=91847 u=craig n=ansible | changed: [192.168.1.99]
2023-04-28 16:18:43,687 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Wait for VM to be recognized path=/etc/pve/nodes/{{ node_name }}/qemu-server/{{ machine_id }}.conf, state=present, timeout=30] ******************************************
2023-04-28 16:18:44,025 p=91847 u=craig n=ansible | ok: [192.168.1.99]
2023-04-28 16:18:44,041 p=91847 u=craig n=ansible | TASK [pm_create_vm_cloud_init : Start VM node={{node_name}}, api_host={{host_ip}}, api_user={{root_user}}, api_password={{root_password}}, name={{machine_name}}, state=started] ************************
2023-04-28 16:18:44,410 p=91847 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "VM with name = arnold does not exist in cluster"}
2023-04-28 16:18:44,412 p=91847 u=craig n=ansible | PLAY RECAP **********************************************************************************************************************************************************************************************
2023-04-28 16:18:44,412 p=91847 u=craig n=ansible | 192.168.1.99               : ok=12   changed=5    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-21 19:43:48,105 p=70274 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************
2023-06-21 19:43:48,112 p=70274 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 19:43:49,556 p=70274 u=craig n=ansible | ok: [caddy]
2023-06-21 19:43:49,566 p=70274 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************
2023-06-21 19:43:49,590 p=70274 u=craig n=ansible | ok: [caddy]
2023-06-21 19:43:49,601 p=70274 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************
2023-06-21 19:43:50,794 p=70274 u=craig n=ansible | changed: [caddy]
2023-06-21 19:43:50,803 p=70274 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************
2023-06-21 19:43:51,131 p=70274 u=craig n=ansible | ok: [caddy]
2023-06-21 19:43:51,139 p=70274 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************
2023-06-21 19:43:51,823 p=70274 u=craig n=ansible | changed: [caddy]
2023-06-21 19:43:51,829 p=70274 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************
2023-06-21 19:43:52,302 p=70274 u=craig n=ansible | ok: [caddy]
2023-06-21 19:43:52,312 p=70274 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************
2023-06-21 19:43:52,854 p=70274 u=craig n=ansible | ok: [caddy]
2023-06-21 19:43:52,863 p=70274 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] *****************************************************************************************************************
2023-06-21 19:48:26,004 p=70274 u=craig n=ansible | changed: [caddy]
2023-06-21 19:48:26,020 p=70274 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 19:48:26,020 p=70274 u=craig n=ansible | caddy                      : ok=8    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-21 20:00:40,449 p=72764 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************
2023-06-21 20:00:40,457 p=72764 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 20:00:41,709 p=72764 u=craig n=ansible | ok: [caddy]
2023-06-21 20:00:41,717 p=72764 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************
2023-06-21 20:00:41,742 p=72764 u=craig n=ansible | ok: [caddy]
2023-06-21 20:00:41,754 p=72764 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************
2023-06-21 20:00:42,373 p=72764 u=craig n=ansible | changed: [caddy]
2023-06-21 20:00:42,382 p=72764 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************
2023-06-21 20:00:42,748 p=72764 u=craig n=ansible | ok: [caddy]
2023-06-21 20:00:42,755 p=72764 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************
2023-06-21 20:00:43,422 p=72764 u=craig n=ansible | changed: [caddy]
2023-06-21 20:00:43,428 p=72764 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************
2023-06-21 20:00:43,949 p=72764 u=craig n=ansible | ok: [caddy]
2023-06-21 20:00:43,957 p=72764 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************
2023-06-21 20:00:44,408 p=72764 u=craig n=ansible | ok: [caddy]
2023-06-21 20:00:44,413 p=72764 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] *****************************************************************************************************************
2023-06-21 20:00:47,092 p=72764 u=craig n=ansible | changed: [caddy]
2023-06-21 20:00:47,122 p=72764 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 20:00:47,122 p=72764 u=craig n=ansible | caddy                      : ok=8    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-21 21:28:13,049 p=78120 u=craig n=ansible | PLAY [Deploy Homer container] ********************************************************************************************************************************************************************************************
2023-06-21 21:28:13,057 p=78120 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 21:28:14,447 p=78120 u=craig n=ansible | ok: [homer]
2023-06-21 21:28:14,464 p=78120 u=craig n=ansible | TASK [homer : Copy config.yml to the host src=../files/config.yml, dest=/tmp/config.yml] *********************************************************************************************************************************
2023-06-21 21:28:15,118 p=78120 u=craig n=ansible | changed: [homer]
2023-06-21 21:28:15,124 p=78120 u=craig n=ansible | TASK [homer : Run Homer container name=homer, image=b4bz/homer:latest, state=started, restart_policy=always, ports=['8080:8080'], volumes=['/tmp/config.yml:/www/assets/config.yml']] ************************************
2023-06-21 21:28:15,607 p=78120 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ModuleNotFoundError: No module named 'requests'
2023-06-21 21:28:15,607 p=78120 u=craig n=ansible | fatal: [homer]: FAILED! => {"changed": false, "msg": "Failed to import the required Python library (requests) on homer's Python /usr/bin/python3. Please read the module documentation and install it in the appropriate location. If the required library is installed, but Ansible is using the wrong Python interpreter, please consult the documentation on ansible_python_interpreter"}
2023-06-21 21:28:15,608 p=78120 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 21:28:15,608 p=78120 u=craig n=ansible | homer                      : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-21 21:29:06,512 p=78335 u=craig n=ansible | PLAY [Deploy Homer container] ********************************************************************************************************************************************************************************************
2023-06-21 21:29:06,520 p=78335 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 21:29:07,420 p=78335 u=craig n=ansible | ok: [homer]
2023-06-21 21:29:07,430 p=78335 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-06-21 21:29:12,481 p=78335 u=craig n=ansible | changed: [homer]
2023-06-21 21:29:12,490 p=78335 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-06-21 21:29:13,822 p=78335 u=craig n=ansible | changed: [homer] => (item=apt-transport-https)
2023-06-21 21:29:14,369 p=78335 u=craig n=ansible | ok: [homer] => (item=ca-certificates)
2023-06-21 21:29:16,964 p=78335 u=craig n=ansible | changed: [homer] => (item=curl)
2023-06-21 21:29:21,294 p=78335 u=craig n=ansible | changed: [homer] => (item=gnupg)
2023-06-21 21:29:21,845 p=78335 u=craig n=ansible | ok: [homer] => (item=lsb-release)
2023-06-21 21:29:32,150 p=78335 u=craig n=ansible | changed: [homer] => (item=software-properties-common)
2023-06-21 21:29:32,167 p=78335 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-06-21 21:29:32,899 p=78335 u=craig n=ansible | changed: [homer]
2023-06-21 21:29:32,908 p=78335 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-06-21 21:29:34,521 p=78335 u=craig n=ansible | changed: [homer]
2023-06-21 21:29:34,533 p=78335 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-06-21 21:29:52,143 p=78335 u=craig n=ansible | changed: [homer]
2023-06-21 21:29:52,153 p=78335 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-06-21 21:29:52,671 p=78335 u=craig n=ansible | ok: [homer]
2023-06-21 21:29:52,679 p=78335 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-06-21 21:29:53,062 p=78335 u=craig n=ansible | changed: [homer]
2023-06-21 21:29:53,069 p=78335 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-06-21 21:30:08,961 p=78335 u=craig n=ansible | changed: [homer]
2023-06-21 21:30:08,970 p=78335 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-06-21 21:30:13,926 p=78335 u=craig n=ansible | changed: [homer]
2023-06-21 21:30:13,944 p=78335 u=craig n=ansible | TASK [homer : Copy config.yml to the host src=../files/config.yml, dest=/tmp/config.yml] *********************************************************************************************************************************
2023-06-21 21:30:14,596 p=78335 u=craig n=ansible | ok: [homer]
2023-06-21 21:30:14,603 p=78335 u=craig n=ansible | TASK [homer : Run Homer container name=homer, image=b4bz/homer:latest, state=started, restart_policy=always, ports=['8080:8080'], volumes=['/tmp/config.yml:/www/assets/config.yml']] ************************************
2023-06-21 21:30:15,175 p=78335 u=craig n=ansible | fatal: [homer]: FAILED! => {"changed": false, "msg": "Error connecting: Error while fetching server API version: HTTPConnection.request() got an unexpected keyword argument 'chunked'"}
2023-06-21 21:30:15,176 p=78335 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 21:30:15,176 p=78335 u=craig n=ansible | homer                      : ok=11   changed=8    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-21 21:33:04,455 p=79043 u=craig n=ansible | PLAY [Deploy Homer container] ********************************************************************************************************************************************************************************************
2023-06-21 21:33:04,462 p=79043 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 21:33:05,775 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:05,791 p=79043 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-06-21 21:33:06,976 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:06,984 p=79043 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-06-21 21:33:07,601 p=79043 u=craig n=ansible | ok: [homer] => (item=apt-transport-https)
2023-06-21 21:33:08,172 p=79043 u=craig n=ansible | ok: [homer] => (item=ca-certificates)
2023-06-21 21:33:08,765 p=79043 u=craig n=ansible | ok: [homer] => (item=curl)
2023-06-21 21:33:09,350 p=79043 u=craig n=ansible | ok: [homer] => (item=gnupg)
2023-06-21 21:33:09,914 p=79043 u=craig n=ansible | ok: [homer] => (item=lsb-release)
2023-06-21 21:33:10,582 p=79043 u=craig n=ansible | ok: [homer] => (item=software-properties-common)
2023-06-21 21:33:10,594 p=79043 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-06-21 21:33:11,282 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:11,290 p=79043 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-06-21 21:33:11,754 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:11,762 p=79043 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-06-21 21:33:12,325 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:12,334 p=79043 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-06-21 21:33:12,886 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:12,893 p=79043 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-06-21 21:33:13,261 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:13,267 p=79043 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-06-21 21:33:13,841 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:13,850 p=79043 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-06-21 21:33:14,764 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:14,780 p=79043 u=craig n=ansible | TASK [homer : Copy config.yml to the host src=../files/config.yml, dest=/tmp/config.yml] *********************************************************************************************************************************
2023-06-21 21:33:15,374 p=79043 u=craig n=ansible | ok: [homer]
2023-06-21 21:33:15,380 p=79043 u=craig n=ansible | TASK [homer : Run Homer container name=homer, image=b4bz/homer:latest, state=started, restart_policy=always, ports=['8080:8080'], volumes=['/tmp/config.yml:/www/assets/config.yml']] ************************************
2023-06-21 21:33:15,921 p=79043 u=craig n=ansible | fatal: [homer]: FAILED! => {"changed": false, "msg": "Error connecting: Error while fetching server API version: HTTPConnection.request() got an unexpected keyword argument 'chunked'"}
2023-06-21 21:33:15,922 p=79043 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 21:33:15,923 p=79043 u=craig n=ansible | homer                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-21 21:36:48,404 p=79744 u=craig n=ansible | Starting galaxy collection install process
2023-06-21 21:36:48,405 p=79744 u=craig n=ansible | Process install dependency map
2023-06-21 21:36:48,405 p=79744 u=craig n=ansible | |
2023-06-21 21:36:48,510 p=79744 u=craig n=ansible | /
2023-06-21 21:36:48,615 p=79744 u=craig n=ansible | -
2023-06-21 21:36:48,720 p=79744 u=craig n=ansible | \
2023-06-21 21:36:48,822 p=79744 u=craig n=ansible | |
2023-06-21 21:36:48,927 p=79744 u=craig n=ansible | /
2023-06-21 21:36:49,028 p=79744 u=craig n=ansible | -
2023-06-21 21:36:49,130 p=79744 u=craig n=ansible | \
2023-06-21 21:36:49,231 p=79744 u=craig n=ansible | |
2023-06-21 21:36:49,337 p=79744 u=craig n=ansible | /
2023-06-21 21:36:49,441 p=79744 u=craig n=ansible | -
2023-06-21 21:36:49,546 p=79744 u=craig n=ansible | \
2023-06-21 21:36:49,651 p=79744 u=craig n=ansible | |
2023-06-21 21:36:49,752 p=79744 u=craig n=ansible | /
2023-06-21 21:36:49,856 p=79744 u=craig n=ansible | -
2023-06-21 21:36:49,960 p=79744 u=craig n=ansible | \
2023-06-21 21:36:50,083 p=79744 u=craig n=ansible | |
2023-06-21 21:36:50,188 p=79744 u=craig n=ansible | /
2023-06-21 21:36:50,292 p=79744 u=craig n=ansible | -
2023-06-21 21:36:50,397 p=79744 u=craig n=ansible | \
2023-06-21 21:36:50,501 p=79744 u=craig n=ansible | |
2023-06-21 21:36:50,604 p=79744 u=craig n=ansible | /
2023-06-21 21:36:50,706 p=79744 u=craig n=ansible | -
2023-06-21 21:36:50,809 p=79744 u=craig n=ansible | \
2023-06-21 21:36:50,911 p=79744 u=craig n=ansible | |
2023-06-21 21:36:51,014 p=79744 u=craig n=ansible | /
2023-06-21 21:36:51,116 p=79744 u=craig n=ansible | -
2023-06-21 21:36:51,217 p=79744 u=craig n=ansible | \
2023-06-21 21:36:51,319 p=79744 u=craig n=ansible | |
2023-06-21 21:36:51,423 p=79744 u=craig n=ansible | /
2023-06-21 21:36:51,526 p=79744 u=craig n=ansible | -
2023-06-21 21:36:51,631 p=79744 u=craig n=ansible | \
2023-06-21 21:36:51,736 p=79744 u=craig n=ansible | |
2023-06-21 21:36:51,857 p=79744 u=craig n=ansible | /
2023-06-21 21:36:51,962 p=79744 u=craig n=ansible | -
2023-06-21 21:36:52,063 p=79744 u=craig n=ansible | \
2023-06-21 21:36:52,168 p=79744 u=craig n=ansible | |
2023-06-21 21:36:52,274 p=79744 u=craig n=ansible | /
2023-06-21 21:36:52,374 p=79744 u=craig n=ansible | -
2023-06-21 21:36:52,479 p=79744 u=craig n=ansible | \
2023-06-21 21:36:52,585 p=79744 u=craig n=ansible | |
2023-06-21 21:36:52,689 p=79744 u=craig n=ansible | /
2023-06-21 21:36:52,795 p=79744 u=craig n=ansible | -
2023-06-21 21:36:52,895 p=79744 u=craig n=ansible | \
2023-06-21 21:36:52,997 p=79744 u=craig n=ansible | |
2023-06-21 21:36:53,103 p=79744 u=craig n=ansible | /
2023-06-21 21:36:53,205 p=79744 u=craig n=ansible | -
2023-06-21 21:36:53,310 p=79744 u=craig n=ansible | \
2023-06-21 21:36:53,411 p=79744 u=craig n=ansible | |
2023-06-21 21:36:53,516 p=79744 u=craig n=ansible | /
2023-06-21 21:36:53,621 p=79744 u=craig n=ansible | -
2023-06-21 21:36:53,723 p=79744 u=craig n=ansible | \
2023-06-21 21:36:53,828 p=79744 u=craig n=ansible | |
2023-06-21 21:36:53,929 p=79744 u=craig n=ansible | /
2023-06-21 21:36:54,030 p=79744 u=craig n=ansible | -
2023-06-21 21:36:54,136 p=79744 u=craig n=ansible | \
2023-06-21 21:36:54,240 p=79744 u=craig n=ansible | |
2023-06-21 21:36:54,345 p=79744 u=craig n=ansible | /
2023-06-21 21:36:54,451 p=79744 u=craig n=ansible | -
2023-06-21 21:36:54,555 p=79744 u=craig n=ansible | \
2023-06-21 21:36:54,656 p=79744 u=craig n=ansible | |
2023-06-21 21:36:54,760 p=79744 u=craig n=ansible | /
2023-06-21 21:36:54,865 p=79744 u=craig n=ansible | -
2023-06-21 21:36:54,967 p=79744 u=craig n=ansible | \
2023-06-21 21:36:55,073 p=79744 u=craig n=ansible | |
2023-06-21 21:36:55,178 p=79744 u=craig n=ansible | /
2023-06-21 21:36:55,281 p=79744 u=craig n=ansible | -
2023-06-21 21:36:55,382 p=79744 u=craig n=ansible | \
2023-06-21 21:36:55,482 p=79744 u=craig n=ansible | |
2023-06-21 21:36:55,588 p=79744 u=craig n=ansible | /
2023-06-21 21:36:55,690 p=79744 u=craig n=ansible | -
2023-06-21 21:36:55,791 p=79744 u=craig n=ansible | \
2023-06-21 21:36:55,896 p=79744 u=craig n=ansible | |
2023-06-21 21:36:56,001 p=79744 u=craig n=ansible | /
2023-06-21 21:36:56,106 p=79744 u=craig n=ansible | -
2023-06-21 21:36:56,212 p=79744 u=craig n=ansible | \
2023-06-21 21:36:56,315 p=79744 u=craig n=ansible | |
2023-06-21 21:36:56,421 p=79744 u=craig n=ansible | /
2023-06-21 21:36:56,523 p=79744 u=craig n=ansible | -
2023-06-21 21:36:56,626 p=79744 u=craig n=ansible | \
2023-06-21 21:36:56,730 p=79744 u=craig n=ansible | |
2023-06-21 21:36:56,832 p=79744 u=craig n=ansible | /
2023-06-21 21:36:56,937 p=79744 u=craig n=ansible | -
2023-06-21 21:36:57,039 p=79744 u=craig n=ansible | \
2023-06-21 21:36:57,144 p=79744 u=craig n=ansible | |
2023-06-21 21:36:57,247 p=79744 u=craig n=ansible | /
2023-06-21 21:36:57,352 p=79744 u=craig n=ansible | -
2023-06-21 21:36:57,454 p=79744 u=craig n=ansible | \
2023-06-21 21:36:57,558 p=79744 u=craig n=ansible | |
2023-06-21 21:36:57,664 p=79744 u=craig n=ansible | /
2023-06-21 21:36:57,768 p=79744 u=craig n=ansible | -
2023-06-21 21:36:57,874 p=79744 u=craig n=ansible | \
2023-06-21 21:36:57,976 p=79744 u=craig n=ansible | |
2023-06-21 21:36:58,082 p=79744 u=craig n=ansible | /
2023-06-21 21:36:58,185 p=79744 u=craig n=ansible | -
2023-06-21 21:36:58,290 p=79744 u=craig n=ansible | \
2023-06-21 21:36:58,395 p=79744 u=craig n=ansible | |
2023-06-21 21:36:58,501 p=79744 u=craig n=ansible | /
2023-06-21 21:36:58,603 p=79744 u=craig n=ansible | -
2023-06-21 21:36:58,704 p=79744 u=craig n=ansible | \
2023-06-21 21:36:58,809 p=79744 u=craig n=ansible | |
2023-06-21 21:36:58,914 p=79744 u=craig n=ansible | /
2023-06-21 21:36:59,018 p=79744 u=craig n=ansible | -
2023-06-21 21:36:59,119 p=79744 u=craig n=ansible | \
2023-06-21 21:36:59,224 p=79744 u=craig n=ansible | |
2023-06-21 21:36:59,330 p=79744 u=craig n=ansible | /
2023-06-21 21:36:59,435 p=79744 u=craig n=ansible | -
2023-06-21 21:36:59,539 p=79744 u=craig n=ansible | \
2023-06-21 21:36:59,645 p=79744 u=craig n=ansible | |
2023-06-21 21:36:59,749 p=79744 u=craig n=ansible | /
2023-06-21 21:36:59,853 p=79744 u=craig n=ansible | -
2023-06-21 21:36:59,956 p=79744 u=craig n=ansible | \
2023-06-21 21:37:00,061 p=79744 u=craig n=ansible | |
2023-06-21 21:37:00,166 p=79744 u=craig n=ansible | /
2023-06-21 21:37:00,268 p=79744 u=craig n=ansible | -
2023-06-21 21:37:00,373 p=79744 u=craig n=ansible | \
2023-06-21 21:37:00,478 p=79744 u=craig n=ansible | |
2023-06-21 21:37:00,580 p=79744 u=craig n=ansible | /
2023-06-21 21:37:00,685 p=79744 u=craig n=ansible | -
2023-06-21 21:37:00,790 p=79744 u=craig n=ansible | \
2023-06-21 21:37:00,892 p=79744 u=craig n=ansible | |
2023-06-21 21:37:00,997 p=79744 u=craig n=ansible | /
2023-06-21 21:37:01,116 p=79744 u=craig n=ansible | -
2023-06-21 21:37:01,221 p=79744 u=craig n=ansible | Starting collection install process
2023-06-21 21:37:01,222 p=79744 u=craig n=ansible | |
2023-06-21 21:37:01,223 p=79744 u=craig n=ansible | Downloading https://galaxy.ansible.com/download/community-docker-3.4.7.tar.gz to /Users/craig/.ansible/tmp/ansible-local-79744ilbg1mvc/tmpnv43ld1d/community-docker-3.4.7-8jmvvvyx
2023-06-21 21:37:01,326 p=79744 u=craig n=ansible | /
2023-06-21 21:37:01,432 p=79744 u=craig n=ansible | -
2023-06-21 21:37:01,532 p=79744 u=craig n=ansible | \
2023-06-21 21:37:01,635 p=79744 u=craig n=ansible | |
2023-06-21 21:37:01,738 p=79744 u=craig n=ansible | /
2023-06-21 21:37:01,840 p=79744 u=craig n=ansible | Installing 'community.docker:3.4.7' to '/Users/craig/.ansible/collections/ansible_collections/community/docker'
2023-06-21 21:37:01,840 p=79744 u=craig n=ansible | -
2023-06-21 21:37:01,945 p=79744 u=craig n=ansible | \
2023-06-21 21:37:02,050 p=79744 u=craig n=ansible | community.docker:3.4.7 was installed successfully
2023-06-21 21:37:16,858 p=79835 u=craig n=ansible | PLAY [Deploy Homer container] ********************************************************************************************************************************************************************************************
2023-06-21 21:37:16,865 p=79835 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 21:37:18,091 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:18,107 p=79835 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-06-21 21:37:19,250 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:19,259 p=79835 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-06-21 21:37:19,916 p=79835 u=craig n=ansible | ok: [homer] => (item=apt-transport-https)
2023-06-21 21:37:20,522 p=79835 u=craig n=ansible | ok: [homer] => (item=ca-certificates)
2023-06-21 21:37:21,143 p=79835 u=craig n=ansible | ok: [homer] => (item=curl)
2023-06-21 21:37:21,759 p=79835 u=craig n=ansible | ok: [homer] => (item=gnupg)
2023-06-21 21:37:22,374 p=79835 u=craig n=ansible | ok: [homer] => (item=lsb-release)
2023-06-21 21:37:22,943 p=79835 u=craig n=ansible | ok: [homer] => (item=software-properties-common)
2023-06-21 21:37:22,955 p=79835 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-06-21 21:37:23,599 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:23,608 p=79835 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-06-21 21:37:24,062 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:24,070 p=79835 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-06-21 21:37:24,643 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:24,652 p=79835 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-06-21 21:37:25,168 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:25,176 p=79835 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-06-21 21:37:25,544 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:25,550 p=79835 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-06-21 21:37:26,103 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:26,112 p=79835 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-06-21 21:37:26,948 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:26,963 p=79835 u=craig n=ansible | TASK [homer : Copy config.yml to the host src=../files/config.yml, dest=/tmp/config.yml] *********************************************************************************************************************************
2023-06-21 21:37:27,568 p=79835 u=craig n=ansible | ok: [homer]
2023-06-21 21:37:27,573 p=79835 u=craig n=ansible | TASK [homer : Run Homer container name=homer, image=b4bz/homer:latest, state=started, restart_policy=always, ports=['8080:8080'], volumes=['/tmp/config.yml:/www/assets/config.yml']] ************************************
2023-06-21 21:37:35,462 p=79835 u=craig n=ansible | fatal: [homer]: FAILED! => {"changed": false, "msg": "Error starting container f480f8690241be3e7e16d9a758b3123ec2428007c300b77bf86291f25d3c69b8: 500 Server Error for http+docker://localhost/v1.43/containers/f480f8690241be3e7e16d9a758b3123ec2428007c300b77bf86291f25d3c69b8/start: Internal Server Error (\"AppArmor enabled on system but the docker-default profile could not be loaded: running `/usr/sbin/apparmor_parser apparmor_parser -Kr /var/lib/docker/tmp/docker-default3462216367` failed with output: apparmor_parser: Unable to replace \"docker-default\".  Permission denied; attempted to load a profile while confined?\n\nerror: exit status 243\")"}
2023-06-21 21:37:35,463 p=79835 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 21:37:35,463 p=79835 u=craig n=ansible | homer                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-21 21:40:56,541 p=80610 u=craig n=ansible | PLAY [Deploy Homer container] ********************************************************************************************************************************************************************************************
2023-06-21 21:40:56,550 p=80610 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 21:40:57,938 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:40:57,954 p=80610 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-06-21 21:40:59,184 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:40:59,192 p=80610 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-06-21 21:40:59,778 p=80610 u=craig n=ansible | ok: [homer] => (item=apt-transport-https)
2023-06-21 21:41:00,394 p=80610 u=craig n=ansible | ok: [homer] => (item=ca-certificates)
2023-06-21 21:41:01,007 p=80610 u=craig n=ansible | ok: [homer] => (item=curl)
2023-06-21 21:41:01,573 p=80610 u=craig n=ansible | ok: [homer] => (item=gnupg)
2023-06-21 21:41:02,235 p=80610 u=craig n=ansible | ok: [homer] => (item=lsb-release)
2023-06-21 21:41:02,844 p=80610 u=craig n=ansible | ok: [homer] => (item=software-properties-common)
2023-06-21 21:41:02,855 p=80610 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-06-21 21:41:03,456 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:41:03,465 p=80610 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-06-21 21:41:03,911 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:41:03,920 p=80610 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-06-21 21:41:04,477 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:41:04,486 p=80610 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-06-21 21:41:05,023 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:41:05,031 p=80610 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-06-21 21:41:05,413 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:41:05,419 p=80610 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-06-21 21:41:05,995 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:41:06,003 p=80610 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-06-21 21:41:06,931 p=80610 u=craig n=ansible | ok: [homer]
2023-06-21 21:41:06,947 p=80610 u=craig n=ansible | TASK [homer : Copy config.yml to the host src=../files/config.yml, dest=/tmp/config.yml] *********************************************************************************************************************************
2023-06-21 21:41:07,611 p=80610 u=craig n=ansible | changed: [homer]
2023-06-21 21:41:07,617 p=80610 u=craig n=ansible | TASK [homer : Run Homer container name=homer, image=b4bz/homer:latest, state=started, restart_policy=always, ports=['8080:8080'], volumes=['/tmp/config.yml:/www/assets/config.yml']] ************************************
2023-06-21 21:41:08,481 p=80610 u=craig n=ansible | fatal: [homer]: FAILED! => {"changed": false, "msg": "Error starting container f480f8690241be3e7e16d9a758b3123ec2428007c300b77bf86291f25d3c69b8: 500 Server Error for http+docker://localhost/v1.43/containers/f480f8690241be3e7e16d9a758b3123ec2428007c300b77bf86291f25d3c69b8/start: Internal Server Error (\"AppArmor enabled on system but the docker-default profile could not be loaded: running `/usr/sbin/apparmor_parser apparmor_parser -Kr /var/lib/docker/tmp/docker-default2746886975` failed with output: apparmor_parser: Unable to replace \"docker-default\".  Permission denied; attempted to load a profile while confined?\n\nerror: exit status 243\")"}
2023-06-21 21:41:08,482 p=80610 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 21:41:08,483 p=80610 u=craig n=ansible | homer                      : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-21 21:42:51,585 p=81065 u=craig n=ansible | PLAY [Deploy Homer container] ********************************************************************************************************************************************************************************************
2023-06-21 21:42:51,592 p=81065 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************
2023-06-21 21:42:52,845 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:42:52,861 p=81065 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] ***********************************************************************************************************************************************************************
2023-06-21 21:42:54,058 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:42:54,066 p=81065 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] *************************************************************************************************************************************************
2023-06-21 21:42:54,634 p=81065 u=craig n=ansible | ok: [homer] => (item=apt-transport-https)
2023-06-21 21:42:55,201 p=81065 u=craig n=ansible | ok: [homer] => (item=ca-certificates)
2023-06-21 21:42:55,786 p=81065 u=craig n=ansible | ok: [homer] => (item=curl)
2023-06-21 21:42:56,315 p=81065 u=craig n=ansible | ok: [homer] => (item=gnupg)
2023-06-21 21:42:56,864 p=81065 u=craig n=ansible | ok: [homer] => (item=lsb-release)
2023-06-21 21:42:57,418 p=81065 u=craig n=ansible | ok: [homer] => (item=software-properties-common)
2023-06-21 21:42:57,429 p=81065 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] ***********************************************************************************************************************
2023-06-21 21:42:58,048 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:42:58,056 p=81065 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] ************************************************************
2023-06-21 21:42:58,504 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:42:58,512 p=81065 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] *************************************************************************************************************************************************************
2023-06-21 21:42:59,172 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:42:59,180 p=81065 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *********************************************************************************************************************************
2023-06-21 21:42:59,699 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:42:59,706 p=81065 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] *****************************************************************************************************************************
2023-06-21 21:43:00,072 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:43:00,078 p=81065 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ******************************************************************************************************************************************************
2023-06-21 21:43:00,710 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:43:00,719 p=81065 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] ***************************************************************************************************
2023-06-21 21:43:01,606 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:43:01,621 p=81065 u=craig n=ansible | TASK [homer : Copy config.yml to the host src=../files/config.yml, dest=/tmp/config.yml] *********************************************************************************************************************************
2023-06-21 21:43:02,262 p=81065 u=craig n=ansible | ok: [homer]
2023-06-21 21:43:02,268 p=81065 u=craig n=ansible | TASK [homer : Run Homer container name=homer, image=b4bz/homer:latest, state=started, restart_policy=always, ports=['8080:8080'], volumes=['/tmp/config.yml:/www/assets/config.yml'], security_opts=['apparmor:unconfined']] ***
2023-06-21 21:43:03,375 p=81065 u=craig n=ansible | fatal: [homer]: FAILED! => {"changed": false, "msg": "Error starting container d276f1b8576f11adc4a7d7255717171a46d08bf3a4009fc35c633d651cc3e9ab: 400 Client Error for http+docker://localhost/v1.43/containers/d276f1b8576f11adc4a7d7255717171a46d08bf3a4009fc35c633d651cc3e9ab/start: Bad Request (\"failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting \"proc\" to rootfs at \"/proc\": mount proc:/proc (via /proc/self/fd/6), flags: 0xe: permission denied: unknown\")"}
2023-06-21 21:43:03,376 p=81065 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************
2023-06-21 21:43:03,377 p=81065 u=craig n=ansible | homer                      : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-23 21:20:48,682 p=17195 u=craig n=ansible | PLAY [Deploy Homer container] **************************************************************************************************************************************************************************************
2023-06-23 21:20:48,695 p=17195 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-06-23 21:20:58,728 p=17195 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-06-23 21:20:58,729 p=17195 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-06-23 21:20:58,729 p=17195 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-25 20:21:31,575 p=83871 u=craig n=ansible | PLAY [Deploy Homer container] *********************************************************************************************************************************************************************************************
2023-06-25 20:21:31,584 p=83871 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-25 20:21:41,614 p=83871 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-06-25 20:21:41,616 p=83871 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************************
2023-06-25 20:21:41,616 p=83871 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-26 21:26:19,925 p=75783 u=craig n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  found unacceptable key (unhashable type: 'AnsibleMapping')

The error appears to be in '/Users/craig/Projects/homelab/ansible/playbooks/homer/main.yaml': line 15, column 15, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

  vars:
    host_ip: {{ proxmox_host_ip }}
              ^ here
We could be wrong, but this one looks like it might be an issue with
missing quotes. Always quote template expression brackets when they
start a value. For instance:

    with_items:
      - {{ foo }}

Should be written as:

    with_items:
      - "{{ foo }}"

2023-06-26 21:26:48,719 p=75915 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-26 21:26:48,725 p=75915 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-26 21:26:50,042 p=75915 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:26:50,059 p=75915 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}] *************************************************************************************************************************************************************
2023-06-26 21:26:50,074 p=75915 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:26:50,090 p=75915 u=craig n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: proxmox

2023-06-26 21:26:50,090 p=75915 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ************************************************************************************************************************************************************************************
2023-06-26 21:26:50,090 p=75915 u=craig n=ansible | skipping: no hosts matched
2023-06-26 21:26:50,091 p=75915 u=craig n=ansible | PLAY [Install Docker in the container] ************************************************************************************************************************************************************************************
2023-06-26 21:26:50,094 p=75915 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-26 21:26:57,110 p=75915 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-06-26 21:30:12,713 p=76418 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-26 21:30:12,719 p=76418 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-26 21:30:14,003 p=76418 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:30:14,021 p=76418 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, host_name={{ ansible_hostname }}] ***************************************************************************************************************************
2023-06-26 21:30:14,036 p=76418 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:30:14,053 p=76418 u=craig n=ansible | ERROR! The field 'hosts' has an invalid value, which includes an undefined variable. The error was: 'host_name' is undefined. 'host_name' is undefined

The error appears to be in '/Users/craig/Projects/homelab/ansible/playbooks/homer/main.yaml': line 11, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Deploy LXC container in Proxmox
  ^ here

2023-06-26 21:31:28,845 p=76616 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-26 21:31:28,852 p=76616 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-26 21:31:30,154 p=76616 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:31:30,172 p=76616 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}] *************************************************************************************************************************************************************
2023-06-26 21:31:30,187 p=76616 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:31:30,191 p=76616 u=craig n=ansible | TASK [Set Hostname host_name={{ ansible_hostname }}] **********************************************************************************************************************************************************************
2023-06-26 21:31:30,204 p=76616 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:31:30,219 p=76616 u=craig n=ansible | ERROR! The field 'hosts' has an invalid value, which includes an undefined variable. The error was: 'host_name' is undefined. 'host_name' is undefined

The error appears to be in '/Users/craig/Projects/homelab/ansible/playbooks/homer/main.yaml': line 13, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Deploy LXC container in Proxmox
  ^ here

2023-06-26 21:37:02,028 p=77446 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-26 21:37:02,033 p=77446 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-26 21:37:03,299 p=77446 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:37:03,314 p=77446 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] *********************************************************************************************************************************************
2023-06-26 21:37:03,327 p=77446 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:37:03,343 p=77446 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ************************************************************************************************************************************************************************************
2023-06-26 21:37:03,355 p=77446 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************************
2023-06-26 21:37:04,179 p=77446 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:37:04,188 p=77446 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-26 21:37:04,227 p=77446 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:37:04,232 p=77446 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************************
2023-06-26 21:37:04,531 p=77446 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:37:04,539 p=77446 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************************
2023-06-26 21:37:05,176 p=77446 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:37:05,185 p=77446 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-26 21:37:05,201 p=77446 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'root_user' is undefined. 'root_user' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/pm_create_lxc/tasks/main.yaml': line 31, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Create LXC\n  ^ here\n"}
2023-06-26 21:37:05,202 p=77446 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************************
2023-06-26 21:37:05,202 p=77446 u=craig n=ansible | 192.168.1.99               : ok=6    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-26 21:38:46,827 p=77751 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-26 21:38:46,833 p=77751 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-26 21:38:48,236 p=77751 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:38:48,254 p=77751 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] *********************************************************************************************************************************************
2023-06-26 21:38:48,268 p=77751 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:38:48,284 p=77751 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ************************************************************************************************************************************************************************************
2023-06-26 21:38:48,310 p=77751 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************************
2023-06-26 21:38:48,951 p=77751 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:38:48,958 p=77751 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-26 21:38:48,989 p=77751 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:38:48,994 p=77751 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************************
2023-06-26 21:38:49,288 p=77751 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:38:49,296 p=77751 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************************
2023-06-26 21:38:49,949 p=77751 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:38:49,958 p=77751 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-26 21:38:49,975 p=77751 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'root_user' is undefined. 'root_user' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/pm_create_lxc/tasks/main.yaml': line 31, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Create LXC\n  ^ here\n"}
2023-06-26 21:38:49,975 p=77751 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************************
2023-06-26 21:38:49,975 p=77751 u=craig n=ansible | 192.168.1.99               : ok=6    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-26 21:39:44,903 p=77967 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-26 21:39:44,908 p=77967 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-26 21:39:45,906 p=77967 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:39:45,924 p=77967 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] *********************************************************************************************************************************************
2023-06-26 21:39:45,937 p=77967 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:39:45,971 p=77967 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ************************************************************************************************************************************************************************************
2023-06-26 21:39:46,000 p=77967 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************************
2023-06-26 21:39:46,661 p=77967 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:39:46,683 p=77967 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-26 21:39:46,710 p=77967 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:39:46,721 p=77967 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************************
2023-06-26 21:39:46,999 p=77967 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:39:47,015 p=77967 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************************
2023-06-26 21:39:47,641 p=77967 u=craig n=ansible | ok: [192.168.1.99]
2023-06-26 21:39:47,661 p=77967 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ssh_key.stdout}}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-26 21:39:47,678 p=77967 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'ssh_key' is undefined. 'ssh_key' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/pm_create_lxc/tasks/main.yaml': line 31, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Create LXC\n  ^ here\n"}
2023-06-26 21:39:47,679 p=77967 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************************
2023-06-26 21:39:47,679 p=77967 u=craig n=ansible | 192.168.1.99               : ok=6    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-27 09:46:22,671 p=1979 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-27 09:46:22,677 p=1979 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-27 09:46:24,030 p=1979 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:46:24,047 p=1979 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] *********************************************************************************************************************************************
2023-06-27 09:46:24,061 p=1979 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:46:24,095 p=1979 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ************************************************************************************************************************************************************************************
2023-06-27 09:46:24,123 p=1979 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************************
2023-06-27 09:46:24,820 p=1979 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:46:24,840 p=1979 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-27 09:46:24,873 p=1979 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'machine_ssh_key' is undefined. 'machine_ssh_key' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/pm_create_lxc/tasks/main.yaml': line 7, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Set LXC options\n  ^ here\n"}
2023-06-27 09:46:24,874 p=1979 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************************
2023-06-27 09:46:24,874 p=1979 u=craig n=ansible | 192.168.1.99               : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-27 09:47:53,109 p=2248 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-27 09:47:53,115 p=2248 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-27 09:47:54,433 p=2248 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:47:54,450 p=2248 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] *********************************************************************************************************************************************
2023-06-27 09:47:54,465 p=2248 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:47:54,499 p=2248 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ************************************************************************************************************************************************************************************
2023-06-27 09:47:54,527 p=2248 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************************
2023-06-27 09:47:55,194 p=2248 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:47:55,216 p=2248 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-27 09:47:55,249 p=2248 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:47:55,261 p=2248 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************************
2023-06-27 09:47:55,542 p=2248 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:47:55,557 p=2248 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************************
2023-06-27 09:47:56,185 p=2248 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:47:56,205 p=2248 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-27 09:47:59,845 p=2248 u=craig n=ansible | changed: [192.168.1.99]
2023-06-27 09:47:59,861 p=2248 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] ************************************************************************************************************
2023-06-27 09:47:59,885 p=2248 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 09:47:59,896 p=2248 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] *****************************************************************
2023-06-27 09:48:09,920 p=2248 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-06-27 09:48:09,922 p=2248 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************************
2023-06-27 09:48:09,922 p=2248 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-27 10:48:50,348 p=10660 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] *******************************************************************************************************************************************************************************************
2023-06-27 10:48:50,353 p=10660 u=craig n=ansible | TASK [Gathering Facts ] ***************************************************************************************************************************************************************************************************
2023-06-27 10:48:51,892 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:51,910 p=10660 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] *********************************************************************************************************************************************
2023-06-27 10:48:51,924 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:51,958 p=10660 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ************************************************************************************************************************************************************************************
2023-06-27 10:48:51,999 p=10660 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************************
2023-06-27 10:48:52,646 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:52,667 p=10660 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-27 10:48:52,700 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:52,711 p=10660 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************************
2023-06-27 10:48:52,989 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:53,005 p=10660 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************************
2023-06-27 10:48:53,644 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:53,661 p=10660 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-27 10:48:54,051 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:54,069 p=10660 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] ************************************************************************************************************
2023-06-27 10:48:54,093 p=10660 u=craig n=ansible | ok: [192.168.1.99]
2023-06-27 10:48:54,105 p=10660 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] *****************************************************************
2023-06-27 10:49:04,138 p=10660 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-06-27 10:49:04,139 p=10660 u=craig n=ansible | PLAY RECAP ****************************************************************************************************************************************************************************************************************
2023-06-27 10:49:04,139 p=10660 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-27 12:15:07,011 p=16279 u=craig n=ansible | ERROR! the playbook: ansible/playbooks/homer/main.yaml could not be found
2023-06-30 21:54:02,569 p=65440 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-06-30 21:54:02,578 p=65440 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-06-30 21:54:04,168 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:04,185 p=65440 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-06-30 21:54:04,205 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:04,272 p=65440 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-06-30 21:54:04,318 p=65440 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-06-30 21:54:05,008 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:05,023 p=65440 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-30 21:54:05,061 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:05,076 p=65440 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-06-30 21:54:05,411 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:05,427 p=65440 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-06-30 21:54:06,156 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:06,172 p=65440 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-30 21:54:06,693 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:06,708 p=65440 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-06-30 21:54:06,736 p=65440 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 21:54:06,751 p=65440 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-06-30 21:54:16,789 p=65440 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-06-30 21:54:16,791 p=65440 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-06-30 21:54:16,791 p=65440 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-30 22:27:10,990 p=74922 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-06-30 22:27:10,999 p=74922 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-06-30 22:27:12,527 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:12,546 p=74922 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-06-30 22:27:12,563 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:12,611 p=74922 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-06-30 22:27:12,671 p=74922 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-06-30 22:27:13,401 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:13,422 p=74922 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-30 22:27:13,461 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:13,476 p=74922 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-06-30 22:27:13,801 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:13,818 p=74922 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-06-30 22:27:14,519 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:14,540 p=74922 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-30 22:27:14,973 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:14,991 p=74922 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-06-30 22:27:15,018 p=74922 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:27:15,033 p=74922 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user=root@pam, api_password={{root_password}}, api_host={{host_ip}}, state=started] ***************************************************************
2023-06-30 22:27:25,069 p=74922 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-06-30 22:27:25,071 p=74922 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-06-30 22:27:25,071 p=74922 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-30 22:41:02,704 p=76773 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-06-30 22:41:02,711 p=76773 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-06-30 22:41:04,278 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:04,297 p=76773 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-06-30 22:41:04,313 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:04,376 p=76773 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-06-30 22:41:04,421 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-06-30 22:41:05,124 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:05,144 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-30 22:41:05,180 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:05,195 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-06-30 22:41:05,564 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:05,582 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-06-30 22:41:06,369 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:06,387 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-30 22:41:06,825 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:06,842 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-06-30 22:41:06,868 p=76773 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:41:06,894 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-06-30 22:41:07,045 p=76773 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-06-30 22:41:07,062 p=76773 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] ********************************************************************************************
2023-06-30 22:41:07,078 p=76773 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-06-30 22:41:07,078 p=76773 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-06-30 22:41:07,079 p=76773 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-06-30 22:41:07,079 p=76773 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-06-30 22:45:00,900 p=77378 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-06-30 22:45:00,909 p=77378 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-06-30 22:45:02,482 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:02,501 p=77378 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-06-30 22:45:02,518 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:02,581 p=77378 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-06-30 22:45:02,625 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-06-30 22:45:03,332 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:03,353 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-30 22:45:03,393 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:03,408 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-06-30 22:45:03,734 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:03,751 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-06-30 22:45:04,427 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:04,447 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-30 22:45:04,880 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:04,898 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-06-30 22:45:04,923 p=77378 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:45:04,949 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-06-30 22:45:05,054 p=77378 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-06-30 22:45:05,070 p=77378 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] ********************************************************************************************
2023-06-30 22:45:05,086 p=77378 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-06-30 22:45:05,087 p=77378 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-06-30 22:45:05,087 p=77378 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-06-30 22:45:05,087 p=77378 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-06-30 22:49:13,346 p=78038 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-06-30 22:49:13,354 p=78038 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-06-30 22:49:15,030 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:15,049 p=78038 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-06-30 22:49:15,064 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:15,128 p=78038 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-06-30 22:49:15,173 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-06-30 22:49:15,950 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:15,970 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-30 22:49:16,006 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:16,021 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-06-30 22:49:16,366 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:16,383 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-06-30 22:49:17,068 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:17,087 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-30 22:49:17,551 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:17,571 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-06-30 22:49:17,598 p=78038 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:49:17,613 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-06-30 22:49:18,409 p=78038 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ModuleNotFoundError: No module named 'proxmoxer'
2023-06-30 22:49:18,410 p=78038 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Failed to import the required Python library (proxmoxer) on homer's Python /usr/bin/python3. Please read the module documentation and install it in the appropriate location. If the required library is installed, but Ansible is using the wrong Python interpreter, please consult the documentation on ansible_python_interpreter"}
2023-06-30 22:49:18,433 p=78038 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] ********************************************************************************************
2023-06-30 22:49:18,451 p=78038 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-06-30 22:49:18,452 p=78038 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-06-30 22:49:18,452 p=78038 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-06-30 22:49:18,452 p=78038 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-06-30 22:51:14,988 p=78442 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-06-30 22:51:14,997 p=78442 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-06-30 22:51:16,510 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:16,528 p=78442 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-06-30 22:51:16,543 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:16,592 p=78442 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-06-30 22:51:16,654 p=78442 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-06-30 22:51:17,400 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:17,419 p=78442 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-06-30 22:51:17,456 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:17,470 p=78442 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-06-30 22:51:17,841 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:17,857 p=78442 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-06-30 22:51:18,751 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:18,773 p=78442 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-06-30 22:51:19,222 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:19,242 p=78442 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-06-30 22:51:19,269 p=78442 u=craig n=ansible | ok: [192.168.1.99]
2023-06-30 22:51:19,284 p=78442 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-06-30 22:51:29,324 p=78442 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-06-30 22:51:29,325 p=78442 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-06-30 22:51:29,326 p=78442 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 12:07:04,239 p=4382 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-07-01 12:07:04,245 p=4382 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-07-01 12:07:05,653 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:05,670 p=4382 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-07-01 12:07:05,684 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:05,718 p=4382 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-07-01 12:07:05,758 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-07-01 12:07:06,411 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:06,433 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-01 12:07:06,467 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:06,479 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-07-01 12:07:06,769 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:06,785 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-07-01 12:07:07,431 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:07,452 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-07-01 12:07:07,852 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:07,871 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-07-01 12:07:07,895 p=4382 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:07:07,914 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-07-01 12:07:08,003 p=4382 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-01 12:07:08,014 p=4382 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] ********************************************************************************************
2023-07-01 12:07:08,026 p=4382 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-01 12:07:08,026 p=4382 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-07-01 12:07:08,027 p=4382 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-07-01 12:07:08,027 p=4382 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-07-01 12:09:02,719 p=4738 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-07-01 12:09:02,724 p=4738 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-07-01 12:09:04,232 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:04,250 p=4738 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-07-01 12:09:04,264 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:04,299 p=4738 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-07-01 12:09:04,339 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-07-01 12:09:05,015 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:05,037 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-01 12:09:05,069 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:05,081 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-07-01 12:09:05,369 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:05,384 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-07-01 12:09:06,033 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:06,054 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-07-01 12:09:06,450 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:06,469 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-07-01 12:09:06,494 p=4738 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:09:06,513 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started] **********************************************************
2023-07-01 12:09:06,582 p=4738 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-01 12:09:06,592 p=4738 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] ********************************************************************************************
2023-07-01 12:09:06,604 p=4738 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-01 12:09:06,604 p=4738 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-07-01 12:09:06,605 p=4738 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-07-01 12:09:06,605 p=4738 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-07-01 12:10:15,726 p=5029 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-07-01 12:10:15,731 p=5029 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-07-01 12:10:17,050 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:17,070 p=5029 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-07-01 12:10:17,084 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:17,118 p=5029 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-07-01 12:10:17,147 p=5029 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-07-01 12:10:17,837 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:17,858 p=5029 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-01 12:10:17,891 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:17,903 p=5029 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-07-01 12:10:18,182 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:18,197 p=5029 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-07-01 12:10:18,856 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:18,876 p=5029 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-07-01 12:10:19,265 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:19,284 p=5029 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-07-01 12:10:19,309 p=5029 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:10:19,321 p=5029 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host=192.168.1.99, state=started] *********************************************************
2023-07-01 12:10:29,353 p=5029 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-01 12:10:29,355 p=5029 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-07-01 12:10:29,355 p=5029 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 12:11:39,958 p=5287 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-07-01 12:11:39,963 p=5287 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-07-01 12:11:41,443 p=5287 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:11:41,462 p=5287 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-07-01 12:11:41,477 p=5287 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:11:41,511 p=5287 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-07-01 12:11:41,551 p=5287 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-07-01 12:11:42,216 p=5287 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:11:42,238 p=5287 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-01 12:11:42,271 p=5287 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:11:42,283 p=5287 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-07-01 12:11:42,570 p=5287 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:11:42,585 p=5287 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-07-01 12:11:43,193 p=5287 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:11:43,211 p=5287 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-07-01 12:11:46,754 p=5287 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 12:11:46,776 p=5287 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-07-01 12:11:46,801 p=5287 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:11:46,814 p=5287 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host=192.168.1.99, state=started] *********************************************************
2023-07-01 12:11:56,846 p=5287 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-01 12:11:56,848 p=5287 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-07-01 12:11:56,848 p=5287 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 12:24:49,487 p=8503 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-07-01 12:24:49,492 p=8503 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-07-01 12:24:51,051 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:51,069 p=8503 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-07-01 12:24:51,082 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:51,125 p=8503 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-07-01 12:24:51,154 p=8503 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-07-01 12:24:51,807 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:51,828 p=8503 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-01 12:24:51,864 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:51,875 p=8503 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-07-01 12:24:52,170 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:52,187 p=8503 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-07-01 12:24:52,877 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:52,898 p=8503 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-07-01 12:24:53,311 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:53,331 p=8503 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-07-01 12:24:53,356 p=8503 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:24:53,368 p=8503 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host=192.168.1.99, state=started] *********************************************************
2023-07-01 12:25:03,400 p=8503 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-01 12:25:03,402 p=8503 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-07-01 12:25:03,402 p=8503 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 12:26:29,262 p=8803 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-07-01 12:26:29,267 p=8803 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-07-01 12:26:30,687 p=8803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:26:30,705 p=8803 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-07-01 12:26:30,720 p=8803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:26:30,754 p=8803 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-07-01 12:26:30,793 p=8803 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-07-01 12:26:31,462 p=8803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:26:31,484 p=8803 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-01 12:26:31,516 p=8803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:26:31,528 p=8803 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-07-01 12:26:31,811 p=8803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:26:31,827 p=8803 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-07-01 12:26:32,497 p=8803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:26:32,517 p=8803 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=started] ***
2023-07-01 12:26:34,982 p=8803 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 12:26:35,003 p=8803 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] *****************************************************************************************************
2023-07-01 12:26:35,028 p=8803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:26:35,041 p=8803 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host=192.168.1.99, state=started] *********************************************************
2023-07-01 12:26:35,071 p=8803 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Connection refused", "unreachable": true}
2023-07-01 12:26:35,072 p=8803 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-07-01 12:26:35,072 p=8803 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 12:27:47,057 p=9068 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ************************************************************************************************************************************************************************************
2023-07-01 12:27:47,062 p=9068 u=craig n=ansible | TASK [Gathering Facts ] ********************************************************************************************************************************************************************************************
2023-07-01 12:27:48,437 p=9068 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:27:48,457 p=9068 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] **************************************************************************************************************************************
2023-07-01 12:27:48,472 p=9068 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:27:48,507 p=9068 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *****************************************************************************************************************************************************************************
2023-07-01 12:27:48,536 p=9068 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***********************************************************************************************************************************************
2023-07-01 12:27:49,198 p=9068 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:27:49,219 p=9068 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-01 12:27:49,250 p=9068 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:27:49,262 p=9068 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *************************************************************************
2023-07-01 12:27:49,543 p=9068 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:27:49,557 p=9068 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***********************************************************
2023-07-01 12:27:50,209 p=9068 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 12:27:50,231 p=9068 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=started] ***
2023-07-01 12:27:50,633 p=9068 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "VM with vmid 113 does not exist in cluster"}
2023-07-01 12:27:50,634 p=9068 u=craig n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************************
2023-07-01 12:27:50,634 p=9068 u=craig n=ansible | 192.168.1.99               : ok=6    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-01 19:36:56,364 p=28632 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:36:56,370 p=28632 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:36:57,620 p=28632 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:36:57,638 p=28632 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:36:57,652 p=28632 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:36:57,685 p=28632 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:36:57,713 p=28632 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:36:58,364 p=28632 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:36:58,385 p=28632 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-01 19:36:58,419 p=28632 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:36:58,431 p=28632 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:36:58,712 p=28632 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:36:58,729 p=28632 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:36:59,353 p=28632 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:36:59,373 p=28632 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}] ***
2023-07-01 19:37:02,899 p=28632 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 19:37:02,921 p=28632 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:37:02,948 p=28632 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:37:02,961 p=28632 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:37:12,995 p=28632 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-01 19:37:12,997 p=28632 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:37:12,997 p=28632 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 19:43:19,774 p=29559 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:19,779 p=29559 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:21,120 p=29559 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:43:21,138 p=29559 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:21,153 p=29559 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:43:21,187 p=29559 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:21,216 p=29559 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:21,877 p=29559 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:43:21,897 p=29559 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-01 19:43:21,931 p=29559 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:43:21,944 p=29559 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:22,228 p=29559 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:43:22,243 p=29559 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:23,001 p=29559 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:43:23,022 p=29559 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-01 19:43:26,577 p=29559 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 19:43:26,599 p=29559 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip | regex_replace('/.*', '')}}] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:26,625 p=29559 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:43:26,639 p=29559 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:36,668 p=29559 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-01 19:43:36,670 p=29559 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:43:36,670 p=29559 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 19:44:49,025 p=29850 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:49,030 p=29850 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:50,466 p=29850 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:44:50,484 p=29850 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:50,499 p=29850 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:44:50,533 p=29850 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:50,574 p=29850 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:51,271 p=29850 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:44:51,292 p=29850 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-01 19:44:51,325 p=29850 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:44:51,336 p=29850 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:51,856 p=29850 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:44:51,879 p=29850 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:52,539 p=29850 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:44:52,559 p=29850 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-01 19:44:52,945 p=29850 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:44:52,964 p=29850 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:55,309 p=29850 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-01 19:44:55,310 p=29850 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 19:44:55,376 p=29850 u=craig n=ansible | PLAY [Install Docker in the container] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:55,379 p=29850 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:55,408 p=29850 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Connection refused", "unreachable": true}
2023-07-01 19:44:55,409 p=29850 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:44:55,409 p=29850 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 19:44:55,409 p=29850 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 19:55:25,205 p=31341 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:25,211 p=31341 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:26,759 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:26,776 p=31341 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:26,790 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:26,824 p=31341 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:26,865 p=31341 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:27,568 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:27,586 p=31341 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-01 19:55:27,621 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:27,634 p=31341 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:27,917 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:27,933 p=31341 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:28,576 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:28,596 p=31341 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-01 19:55:28,981 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:28,999 p=31341 u=craig n=ansible | TASK [pm_create_lxc : Define variables for convenience ansible_host={{machine_ip}}] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:29,015 p=31341 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 19:55:29,028 p=31341 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:29,089 p=31341 u=craig n=ansible | fatal: [192.168.1.99]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: Could not resolve hostname 192.168.1.13/24: nodename nor servname provided, or not known", "unreachable": true}
2023-07-01 19:55:29,090 p=31341 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 19:55:29,090 p=31341 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-01 21:30:58,093 p=37058 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:30:58,098 p=37058 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:30:59,388 p=37058 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:30:59,405 p=37058 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:30:59,421 p=37058 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:30:59,455 p=37058 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:30:59,484 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:00,237 p=37058 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:00,259 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-01 21:31:00,294 p=37058 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:00,305 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:00,593 p=37058 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:00,608 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:01,233 p=37058 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:01,253 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-01 21:31:04,828 p=37058 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 21:31:04,849 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:07,196 p=37058 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-01 21:31:07,196 p=37058 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 21:31:07,213 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_ip }}, groups=proxmox_nodes] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:07,230 p=37058 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 21:31:07,248 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip }}, port=22, state=started, sleep=5, timeout=300] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:07,425 p=37058 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-01 21:31:07,435 p=37058 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:07,448 p=37058 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-01 21:31:07,448 p=37058 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-07-01 21:31:07,449 p=37058 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:07,449 p=37058 u=craig n=ansible | 192.168.1.99               : ok=9    changed=3    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-07-01 21:31:33,659 p=37285 u=craig n=ansible | PLAY [Retrieve Proxmox Host IP] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:33,664 p=37285 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:34,849 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:34,867 p=37285 u=craig n=ansible | TASK [Set Proxmox Host IP proxmox_host_ip={{ ansible_host }}, cacheable=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:34,882 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:34,916 p=37285 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:34,945 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:35,667 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:35,684 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-01 21:31:35,708 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:35,718 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:36,016 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:36,033 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:36,668 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:36,688 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-01 21:31:37,078 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:37,096 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:37,418 p=37285 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-01 21:31:37,418 p=37285 u=craig n=ansible | ok: [192.168.1.99]
2023-07-01 21:31:37,439 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_ip }}, groups=proxmox_nodes] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:31:37,457 p=37285 u=craig n=ansible | changed: [192.168.1.99]
2023-07-01 21:31:37,470 p=37285 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip }}, port=22, state=started, sleep=5, timeout=300] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 21:36:30,792 p=37285 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-07-01 22:01:54,937 p=42269 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:54,945 p=42269 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:56,300 p=42269 u=craig n=ansible | ok: [caddy]
2023-07-01 22:01:56,308 p=42269 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:56,333 p=42269 u=craig n=ansible | ok: [caddy]
2023-07-01 22:01:56,344 p=42269 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:57,882 p=42269 u=craig n=ansible | changed: [caddy]
2023-07-01 22:01:57,890 p=42269 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:58,233 p=42269 u=craig n=ansible | ok: [caddy]
2023-07-01 22:01:58,241 p=42269 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:58,789 p=42269 u=craig n=ansible | ok: [caddy]
2023-07-01 22:01:58,797 p=42269 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:59,421 p=42269 u=craig n=ansible | changed: [caddy]
2023-07-01 22:01:59,429 p=42269 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:01:59,979 p=42269 u=craig n=ansible | changed: [caddy]
2023-07-01 22:01:59,988 p=42269 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:02:04,820 p=42269 u=craig n=ansible | changed: [caddy]
2023-07-01 22:02:04,849 p=42269 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-01 22:02:04,849 p=42269 u=craig n=ansible | caddy                      : ok=8    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-03 21:06:54,400 p=7651 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:54,408 p=7651 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:55,918 p=7651 u=craig n=ansible | ok: [caddy]
2023-07-03 21:06:55,925 p=7651 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:55,951 p=7651 u=craig n=ansible | ok: [caddy]
2023-07-03 21:06:55,963 p=7651 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:57,449 p=7651 u=craig n=ansible | changed: [caddy]
2023-07-03 21:06:57,458 p=7651 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:57,789 p=7651 u=craig n=ansible | ok: [caddy]
2023-07-03 21:06:57,796 p=7651 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:58,330 p=7651 u=craig n=ansible | ok: [caddy]
2023-07-03 21:06:58,338 p=7651 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:58,826 p=7651 u=craig n=ansible | ok: [caddy]
2023-07-03 21:06:58,836 p=7651 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:06:59,323 p=7651 u=craig n=ansible | ok: [caddy]
2023-07-03 21:06:59,333 p=7651 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:07:02,584 p=7651 u=craig n=ansible | changed: [caddy]
2023-07-03 21:07:02,614 p=7651 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:07:02,614 p=7651 u=craig n=ansible | caddy                      : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-03 21:40:03,302 p=12065 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:03,309 p=12065 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:04,719 p=12065 u=craig n=ansible | ok: [caddy]
2023-07-03 21:40:04,726 p=12065 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:04,753 p=12065 u=craig n=ansible | ok: [caddy]
2023-07-03 21:40:04,764 p=12065 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:06,345 p=12065 u=craig n=ansible | changed: [caddy]
2023-07-03 21:40:06,354 p=12065 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:06,714 p=12065 u=craig n=ansible | ok: [caddy]
2023-07-03 21:40:06,737 p=12065 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:07,454 p=12065 u=craig n=ansible | changed: [caddy]
2023-07-03 21:40:07,458 p=12065 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:08,088 p=12065 u=craig n=ansible | changed: [caddy]
2023-07-03 21:40:08,098 p=12065 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:08,665 p=12065 u=craig n=ansible | ok: [caddy]
2023-07-03 21:40:08,674 p=12065 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:11,710 p=12065 u=craig n=ansible | changed: [caddy]
2023-07-03 21:40:11,728 p=12065 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:40:11,729 p=12065 u=craig n=ansible | caddy                      : ok=8    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-03 21:54:38,612 p=14172 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:38,619 p=14172 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:39,993 p=14172 u=craig n=ansible | ok: [caddy]
2023-07-03 21:54:40,000 p=14172 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:40,022 p=14172 u=craig n=ansible | ok: [caddy]
2023-07-03 21:54:40,033 p=14172 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:41,545 p=14172 u=craig n=ansible | changed: [caddy]
2023-07-03 21:54:41,552 p=14172 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:41,923 p=14172 u=craig n=ansible | ok: [caddy]
2023-07-03 21:54:41,932 p=14172 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:42,519 p=14172 u=craig n=ansible | ok: [caddy]
2023-07-03 21:54:42,527 p=14172 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:43,036 p=14172 u=craig n=ansible | ok: [caddy]
2023-07-03 21:54:43,044 p=14172 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:43,691 p=14172 u=craig n=ansible | changed: [caddy]
2023-07-03 21:54:43,698 p=14172 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:46,502 p=14172 u=craig n=ansible | changed: [caddy]
2023-07-03 21:54:46,533 p=14172 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:54:46,533 p=14172 u=craig n=ansible | caddy                      : ok=8    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-03 21:59:34,499 p=14958 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:34,507 p=14958 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:35,836 p=14958 u=craig n=ansible | ok: [caddy]
2023-07-03 21:59:35,843 p=14958 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:35,870 p=14958 u=craig n=ansible | ok: [caddy]
2023-07-03 21:59:35,881 p=14958 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:37,401 p=14958 u=craig n=ansible | changed: [caddy]
2023-07-03 21:59:37,410 p=14958 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:37,771 p=14958 u=craig n=ansible | ok: [caddy]
2023-07-03 21:59:37,780 p=14958 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:38,409 p=14958 u=craig n=ansible | ok: [caddy]
2023-07-03 21:59:38,418 p=14958 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:38,966 p=14958 u=craig n=ansible | ok: [caddy]
2023-07-03 21:59:38,977 p=14958 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:39,506 p=14958 u=craig n=ansible | ok: [caddy]
2023-07-03 21:59:39,516 p=14958 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, force_recreate=True] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:40,110 p=14958 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (ansible.builtin.docker_compose) module: force_recreate. Supported parameters include: api_version, build, ca_cert, client_cert, client_key, debug, definition, dependencies, docker_host, env_file, files, hostname_check, nocache, profiles, project_name, project_src, pull, recreate, remove_images, remove_orphans, remove_volumes, restarted, scale, services, ssl_version, state, stopped, timeout, tls, tls_hostname, use_ssh_client, validate_certs (cacert_path, cert_path, docker_api_version, docker_url, key_path, tls_ca_cert, tls_client_cert, tls_client_key, tls_verify)."}
2023-07-03 21:59:40,112 p=14958 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 21:59:40,112 p=14958 u=craig n=ansible | caddy                      : ok=7    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-03 22:00:06,264 p=15131 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:06,272 p=15131 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:07,278 p=15131 u=craig n=ansible | ok: [caddy]
2023-07-03 22:00:07,286 p=15131 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:07,313 p=15131 u=craig n=ansible | ok: [caddy]
2023-07-03 22:00:07,325 p=15131 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:07,983 p=15131 u=craig n=ansible | ok: [caddy]
2023-07-03 22:00:07,992 p=15131 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:08,360 p=15131 u=craig n=ansible | ok: [caddy]
2023-07-03 22:00:08,369 p=15131 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:08,979 p=15131 u=craig n=ansible | ok: [caddy]
2023-07-03 22:00:08,988 p=15131 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:09,530 p=15131 u=craig n=ansible | ok: [caddy]
2023-07-03 22:00:09,540 p=15131 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:00:10,089 p=15131 u=craig n=ansible | ok: [caddy]
2023-07-03 22:00:10,097 p=15131 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:06:18,695 p=15131 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:847d8eca25e08fb9b0c6c7288ab67be29674205faffaca66488728d4205bd3b0\nStatus: Image is up to date for caddy:2-builder\n ---> 8df230ad40b5\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in ee64130f10e5\np/buildenv_2023-07-04-0200.1110538002\n2023/07/04 02:00:14 [INFO] Writing main module: /tmp/buildenv_2023-07-04-0200.1110538002/main.go\npackage main\n\nimport (\n\tcaddycmd \"github.com/caddyserver/caddy/v2/cmd\"\n\n\t// plug in Caddy modules here\n\t_ \"github.com/caddyserver/caddy/v2/modules/standard\"\n\t_ \"github.com/caddy-dns/cloudflare\"\n)\n\nfunc main() {\n\tcaddycmd.Main()\n}\n2023/07/04 02:00:14 [INFO] Initializing Go module\n2023/07/04 02:00:14 [INFO] exec (timeout=-2562047h47m16.854775808s): /usr/local/go/bin/go mod init caddy \nodule caddy\ns:\n\tgo mod tidy\n2023/07/04 02:00:14 [INFO] Pinning versions\n/caddyserver/caddy/v2@v2.6.4 \n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/google/uuid v1.3.0\netheus/client_golang v1.14.0\n/quic-go/quic-go v0.32.0\ngo: downloading go.uber.org/zap v1.24.0\ngo: downloading golang.org/x/sys v0.5.0\n v0.5.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\nez v1.1.0\niekg/dns v1.1.50\ngo: downloading golang.org/x/crypto v0.5.0\ngo: downloading golang.org/x/net v0.7.0\n/beorn7/perks v1.0.1\n/cespare/xxhash/v2 v2.1.2\n/cespare/xxhash v1.1.0\n/golang/protobuf v1.5.2\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\ngo: downloading google.golang.org/protobuf v1.28.1\nock v1.6.0\n/onsi/ginkgo/v2 v2.2.0\n/quic-go/qpack v0.4.0\nic v1.9.0\nultierr v1.6.0\ngo: downloading golang.org/x/tools v0.2.0\ngo: downloading golang.org/x/text v0.7.0\natttproud/golang_protobuf_extensions v1.0.1\nod v0.6.0\ngo: downloading golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n-sprig v0.0.0-20210107165309-348f09dbbbc0\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/beorn7/perks v1.0.1\n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/cespare/xxhash/v2 v2.1.2\n-sprig v0.0.0-20210107165309-348f09dbbbc0\nock v1.6.0\n/golang/protobuf v1.5.2\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/google/uuid v1.3.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\natttproud/golang_protobuf_extensions v1.0.1\nez v1.1.0\niekg/dns v1.1.50\n/onsi/ginkgo/v2 v2.2.0\netheus/client_golang v1.14.0\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\n/quic-go/qpack v0.4.0\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n/quic-go/quic-go v0.32.0\nic v1.9.0\nultierr v1.6.0\ngo: added go.uber.org/zap v1.24.0\ngo: added golang.org/x/crypto v0.5.0\ngo: added golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\nod v0.6.0\ngo: added golang.org/x/net v0.7.0\ngo: added golang.org/x/sys v0.5.0\n v0.5.0\ngo: added golang.org/x/text v0.7.0\ngo: added golang.org/x/tools v0.2.0\ngo: added google.golang.org/protobuf v1.28.1\n/caddyserver/caddy/v2@v2.6.4 \n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n16.854775808s): /usr/local/go/bin/go get -d -v  \n/aryann/difflib v0.0.0-20210328193216-ff5ff6dc229b\n/spf13/cobra v1.6.1\n/spf13/pflag v1.0.5\nousetrap v1.0.1\nan/v2 v2.0.2\nl.v3 v3.0.1\nallstep/certificates v0.23.2\nallstep/truststore v0.12.1\n/crypto v0.23.2\npatible\nallstep/nosql v0.5.0\n/tailscale/tscert v0.0.0-20230124224810-c6dc1f4049b2\nanize v1.0.1\nberjack.v2 v2.2.1\n/russross/blackfriday/v2 v2.1.0\n/google/cel-go v0.13.0\ngo: downloading google.golang.org/genproto v0.0.0-20230202175211-008b39050e57\ngo: downloading golang.org/x/sync v0.1.0\npress v1.15.15\nl v1.2.1\ninds/sprig/v3 v3.2.3\na/v2 v2.5.0\nark v1.5.4\nark-highlighting/v2 v2.0.0-20220924101305-151362477c87\nentation/net/http/otelhttp v0.39.0\netry.io/otel/exporters/otlp/otlptrace/otlptracegrpc v1.4.0\netry.io/otel/exporters/otlp/otlptrace v1.4.0\netry.io/otel v1.13.0\netry.io/otel/sdk v1.13.0\n/pkg/errors v0.9.1\n/cli-utils v0.7.5\n/linkedca v0.19.0\ngo: downloading google.golang.org/grpc v1.52.3\ngo: downloading gopkg.in/square/go-jose.v2 v2.6.0\ngo: downloading howett.net/plist v1.0.0\nacker/cbor/v2 v2.4.0\n/slackhq/nebula v1.6.1\n/stoewer/go-strcase v1.2.0\ne/Go/antlr v1.4.10\ninds/goutils v1.1.1\nver/v3 v3.2.0\n/huandu/xstrings v1.3.3\nergo v0.3.12\nitchellh/copystructure v1.2.0\nal v1.2.0\n/spf13/cast v1.4.1\n/felixge/httpsnoop v1.0.3\netric v0.36.0\netry.io/otel/trace v1.13.0\netry.io/otel/exporters/otlp/internal/retry v1.4.0\netry.io/proto/otlp v0.12.0\n/scep/v2 v2.1.0\nozilla.org/pkcs7 v0.0.0-20210826202110-33d05740a352\n/urfave/cli v1.22.12\n/chzyer/readline v0.0.0-20180603132655-2972be24d48e\nptui v0.9.0\ngo: downloading filippo.io/edwards25519 v1.0.0\n/x448/float16 v0.8.4\n/rs/xid v1.4.0\n/sirupsen/logrus v1.9.0\n/dgraph-io/badger v1.6.2\n/dgraph-io/badger/v2 v2.2007.4\ngo: downloading go.etcd.io/bbolt v1.3.6\nysql v1.6.0\n/jackc/pgx/v4 v4.17.2\n/Microsoft/go-winio v0.6.0\nitchellh/go-ps v1.0.0\nitchellh/reflectwalk v1.0.2\n/dlclark/regexp2 v1.7.0\n/go-logr/logr v1.2.3\n/cenkalti/backoff/v4 v4.1.2\n/grpc-gateway v1.16.0\n/go-logr/stdr v1.2.2\n/go-kit/kit v0.10.0\n/dgraph-io/ristretto v0.1.0\n v0.0.0-20200201041132-a6ae2369ad13\n/jackc/pgconn v1.13.0\n/jackc/pgio v1.0.0\n/jackc/pgproto3/v2 v2.3.1\n/jackc/pgtype v1.12.0\nt v0.5.1\n v0.0.0-20190825152654-46b345b51c96\n/golang/glog v1.0.0\n/golang/snappy v0.0.4\n/jackc/chunkreader/v2 v2.0.1\n/jackc/pgpassfile v1.0.0\n/jackc/pgservicefile v0.0.0-20200714003250-2b9c44734f2b\ngutz/ansi v0.0.0-20200706080929-d51e80ef957d\nattn/go-colorable v0.1.8\ne v1.0.0\nattn/go-isatty v0.0.13\nent ready\n2023/07/04 02:04:03 [INFO] Building Caddy\nod tidy -e \n/stretchr/testify v1.8.1\ngo: downloading go.uber.org/goleak v1.1.12\nega v1.20.1\ngo: downloading gopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c\n/davecgh/go-spew v1.1.1\nezard/go-difflib v1.0.0\n/benbjohnson/clock v1.1.0\nallstep/assert v0.0.0-20200723003110-82e2b9b3b262\np v0.5.9\n/kr/pretty v0.3.1\nas/assert/v2 v2.2.1\n/kr/text v0.1.0\n/rogpeppe/go-internal v1.9.0\nl.v2 v2.4.0\nas/repr v0.2.0\n/hexops/gotextdiff v1.0.3\n/chzyer/test v0.0.0-20180213035817-a1ea475d72b1\n/aws/aws-sdk-go v1.44.185\ns v1.8.0\n/go v0.107.0\n/googleapis/gax-go/v2 v2.7.0\ngo: downloading google.golang.org/api v0.108.0\n/cockroachdb/apd v1.1.0\npatible\n/go-stack/stack v1.8.0\n/chzyer/logex v1.1.10\n v0.8.0\ngo: downloading golang.org/x/oauth2 v0.0.0-20221014153046-6fdb5e3db783\nock v0.0.0-20210724152146-4ad1a8207f65\n/lib/pq v1.10.2\nespath v0.4.0\netadata v0.2.3\npute v1.14.0\ngo: downloading go.opencensus.io v0.24.0\ngo: downloading google.golang.org/appengine v1.6.7\n/OneOfOne/xxhash v1.2.2\nur3 v1.1.0\n/googleapis/enterprise-certificate-proxy v0.2.1\n/golang/groupcache v0.0.0-20210331224755-41bb18bfe9da\npath \nplete: ./caddy\n2023/07/04 02:06:00 [INFO] Skipping cleanup as requested; leaving folder intact: /tmp/buildenv_2023-07-04-0200.1110538002\nin privileges): [setcap cap_net_bind_service=+ep ./caddy]\n", "msg": "Error: build failed with (<Service: caddy>, 'ApplyLayer exit status 1 stdout:  stderr: write /go/pkg/mod/google.golang.org/api@v0.108.0/artifactregistry/v1beta2/artifactregistry-gen.go: no space left on device')"}
2023-07-03 22:06:18,697 p=15131 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:06:18,697 p=15131 u=craig n=ansible | caddy                      : ok=7    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-03 22:06:40,595 p=16120 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:06:40,603 p=16120 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:06:41,719 p=16120 u=craig n=ansible | ok: [caddy]
2023-07-03 22:06:41,728 p=16120 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:06:41,754 p=16120 u=craig n=ansible | ok: [caddy]
2023-07-03 22:06:41,765 p=16120 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent, remove_images=all, remove_orphans=True] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:06:42,418 p=16120 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (ansible.builtin.docker_container) module: remove_images, remove_orphans. Supported parameters include: api_version, auto_remove, blkio_weight, ca_cert, cap_drop, capabilities, cgroup_parent, cgroupns_mode, cleanup, client_cert, client_key, command, command_handling, comparisons, container_default_behavior, cpu_period, cpu_quota, cpu_shares, cpus, cpuset_cpus, cpuset_mems, debug, default_host_ip, detach, device_read_bps, device_read_iops, device_requests, device_write_bps, device_write_iops, devices, dns_opts, dns_search_domains, dns_servers, docker_host, domainname, entrypoint, env, env_file, etc_hosts, exposed_ports, force_kill, groups, healthcheck, hostname, ignore_image, image, image_comparison, image_label_mismatch, image_name_mismatch, init, interactive, ipc_mode, keep_volumes, kernel_memory, kill_signal, labels, links, log_driver, log_options, mac_address, memory, memory_reservation, memory_swap, memory_swappiness, mounts, name, network_mode, networks, networks_cli_compatible, oom_killer, oom_score_adj, output_logs, paused, pid_mode, pids_limit, platform, privileged, publish_all_ports, published_ports, pull, purge_networks, read_only, recreate, removal_wait_timeout, restart, restart_policy, restart_retries, runtime, security_opts, shm_size, ssl_version, state, stop_signal, stop_timeout, storage_opts, sysctls, timeout, tls, tls_hostname, tmpfs, tty, ulimits, use_ssh_client, user, userns_mode, uts, validate_certs, volume_driver, volumes, volumes_from, working_dir (cacert_path, cert_path, docker_api_version, docker_url, expose, exposed, forcekill, key_path, log_opt, ports, tls_ca_cert, tls_client_cert, tls_client_key, tls_verify)."}
2023-07-03 22:06:42,419 p=16120 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:06:42,420 p=16120 u=craig n=ansible | caddy                      : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-03 22:07:15,904 p=16263 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:07:15,911 p=16263 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:07:16,946 p=16263 u=craig n=ansible | ok: [caddy]
2023-07-03 22:07:16,953 p=16263 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:07:16,980 p=16263 u=craig n=ansible | ok: [caddy]
2023-07-03 22:07:16,992 p=16263 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists name=caddy, state=absent, remove_images=all, remove_orphans=True] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:07:17,584 p=16263 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (ansible.builtin.docker_compose) module: name. Supported parameters include: api_version, build, ca_cert, client_cert, client_key, debug, definition, dependencies, docker_host, env_file, files, hostname_check, nocache, profiles, project_name, project_src, pull, recreate, remove_images, remove_orphans, remove_volumes, restarted, scale, services, ssl_version, state, stopped, timeout, tls, tls_hostname, use_ssh_client, validate_certs (cacert_path, cert_path, docker_api_version, docker_url, key_path, tls_ca_cert, tls_client_cert, tls_client_key, tls_verify)."}
2023-07-03 22:07:17,585 p=16263 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:07:17,585 p=16263 u=craig n=ansible | caddy                      : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-03 22:08:26,846 p=16447 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:26,854 p=16447 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:28,125 p=16447 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:28,132 p=16447 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:28,160 p=16447 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:28,172 p=16447 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists state=absent, remove_images=all, remove_orphans=True] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:28,739 p=16447 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Parameter error - project_src required."}
2023-07-03 22:08:28,741 p=16447 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:28,741 p=16447 u=craig n=ansible | caddy                      : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-03 22:08:46,237 p=16566 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:46,244 p=16566 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:47,226 p=16566 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:47,233 p=16566 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:47,259 p=16566 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:47,271 p=16566 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:47,888 p=16566 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:47,897 p=16566 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:48,303 p=16566 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:48,312 p=16566 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:48,884 p=16566 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:48,893 p=16566 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:49,425 p=16566 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:49,435 p=16566 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:08:49,975 p=16566 u=craig n=ansible | ok: [caddy]
2023-07-03 22:08:49,985 p=16566 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:11:27,394 p=16566 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:847d8eca25e08fb9b0c6c7288ab67be29674205faffaca66488728d4205bd3b0\nStatus: Image is up to date for caddy:2-builder\n ---> 8df230ad40b5\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in 360eeda92791\np/buildenv_2023-07-04-0208.2371429455\n2023/07/04 02:08:52 [INFO] Writing main module: /tmp/buildenv_2023-07-04-0208.2371429455/main.go\npackage main\n\nimport (\n\tcaddycmd \"github.com/caddyserver/caddy/v2/cmd\"\n\n\t// plug in Caddy modules here\n\t_ \"github.com/caddyserver/caddy/v2/modules/standard\"\n\t_ \"github.com/caddy-dns/cloudflare\"\n)\n\nfunc main() {\n\tcaddycmd.Main()\n}\n2023/07/04 02:08:52 [INFO] Initializing Go module\n2023/07/04 02:08:52 [INFO] exec (timeout=-2562047h47m16.854775808s): /usr/local/go/bin/go mod init caddy \nodule caddy\ns:\n\tgo mod tidy\n2023/07/04 02:08:52 [INFO] Pinning versions\n/caddyserver/caddy/v2@v2.6.4 \n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/google/uuid v1.3.0\netheus/client_golang v1.14.0\n/quic-go/quic-go v0.32.0\ngo: downloading go.uber.org/zap v1.24.0\ngo: downloading golang.org/x/sys v0.5.0\n v0.5.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\nez v1.1.0\niekg/dns v1.1.50\ngo: downloading golang.org/x/crypto v0.5.0\ngo: downloading golang.org/x/net v0.7.0\n/beorn7/perks v1.0.1\n/cespare/xxhash/v2 v2.1.2\n/cespare/xxhash v1.1.0\n/golang/protobuf v1.5.2\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\ngo: downloading google.golang.org/protobuf v1.28.1\nock v1.6.0\n/onsi/ginkgo/v2 v2.2.0\n/quic-go/qpack v0.4.0\nic v1.9.0\nultierr v1.6.0\ngo: downloading golang.org/x/tools v0.2.0\ngo: downloading golang.org/x/text v0.7.0\natttproud/golang_protobuf_extensions v1.0.1\nod v0.6.0\ngo: downloading golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n-sprig v0.0.0-20210107165309-348f09dbbbc0\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/beorn7/perks v1.0.1\n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/cespare/xxhash/v2 v2.1.2\n-sprig v0.0.0-20210107165309-348f09dbbbc0\nock v1.6.0\n/golang/protobuf v1.5.2\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/google/uuid v1.3.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\natttproud/golang_protobuf_extensions v1.0.1\nez v1.1.0\niekg/dns v1.1.50\n/onsi/ginkgo/v2 v2.2.0\netheus/client_golang v1.14.0\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\n/quic-go/qpack v0.4.0\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n/quic-go/quic-go v0.32.0\nic v1.9.0\nultierr v1.6.0\ngo: added go.uber.org/zap v1.24.0\ngo: added golang.org/x/crypto v0.5.0\ngo: added golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\nod v0.6.0\ngo: added golang.org/x/net v0.7.0\ngo: added golang.org/x/sys v0.5.0\n v0.5.0\ngo: added golang.org/x/text v0.7.0\ngo: added golang.org/x/tools v0.2.0\ngo: added google.golang.org/protobuf v1.28.1\n/caddyserver/caddy/v2@v2.6.4 \n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n16.854775808s): /usr/local/go/bin/go get -d -v  \n/aryann/difflib v0.0.0-20210328193216-ff5ff6dc229b\n/spf13/cobra v1.6.1\n/spf13/pflag v1.0.5\nousetrap v1.0.1\nan/v2 v2.0.2\nl.v3 v3.0.1\nallstep/certificates v0.23.2\nallstep/truststore v0.12.1\n/crypto v0.23.2\npatible\nallstep/nosql v0.5.0\n/tailscale/tscert v0.0.0-20230124224810-c6dc1f4049b2\nanize v1.0.1\nberjack.v2 v2.2.1\n/russross/blackfriday/v2 v2.1.0\n/google/cel-go v0.13.0\ngo: downloading google.golang.org/genproto v0.0.0-20230202175211-008b39050e57\ngo: downloading golang.org/x/sync v0.1.0\npress v1.15.15\nl v1.2.1\ninds/sprig/v3 v3.2.3\na/v2 v2.5.0\nark v1.5.4\nark-highlighting/v2 v2.0.0-20220924101305-151362477c87\nentation/net/http/otelhttp v0.39.0\netry.io/otel/exporters/otlp/otlptrace/otlptracegrpc v1.4.0\netry.io/otel/exporters/otlp/otlptrace v1.4.0\netry.io/otel v1.13.0\netry.io/otel/sdk v1.13.0\n/pkg/errors v0.9.1\n/cli-utils v0.7.5\n/linkedca v0.19.0\ngo: downloading google.golang.org/grpc v1.52.3\ngo: downloading gopkg.in/square/go-jose.v2 v2.6.0\ngo: downloading howett.net/plist v1.0.0\nacker/cbor/v2 v2.4.0\n/slackhq/nebula v1.6.1\n/stoewer/go-strcase v1.2.0\ne/Go/antlr v1.4.10\ninds/goutils v1.1.1\nver/v3 v3.2.0\n/huandu/xstrings v1.3.3\nergo v0.3.12\nitchellh/copystructure v1.2.0\nal v1.2.0\n/spf13/cast v1.4.1\n/felixge/httpsnoop v1.0.3\netric v0.36.0\netry.io/otel/trace v1.13.0\netry.io/otel/exporters/otlp/internal/retry v1.4.0\netry.io/proto/otlp v0.12.0\n/scep/v2 v2.1.0\nozilla.org/pkcs7 v0.0.0-20210826202110-33d05740a352\n/urfave/cli v1.22.12\n/chzyer/readline v0.0.0-20180603132655-2972be24d48e\nptui v0.9.0\ngo: downloading filippo.io/edwards25519 v1.0.0\n/x448/float16 v0.8.4\n/rs/xid v1.4.0\n/sirupsen/logrus v1.9.0\n/dgraph-io/badger v1.6.2\n/dgraph-io/badger/v2 v2.2007.4\ngo: downloading go.etcd.io/bbolt v1.3.6\nysql v1.6.0\n/jackc/pgx/v4 v4.17.2\n/Microsoft/go-winio v0.6.0\nitchellh/go-ps v1.0.0\nitchellh/reflectwalk v1.0.2\n/dlclark/regexp2 v1.7.0\n/go-logr/logr v1.2.3\n/cenkalti/backoff/v4 v4.1.2\n/grpc-gateway v1.16.0\n/go-logr/stdr v1.2.2\n/go-kit/kit v0.10.0\n/dgraph-io/ristretto v0.1.0\n v0.0.0-20200201041132-a6ae2369ad13\n/jackc/pgconn v1.13.0\n/jackc/pgio v1.0.0\n/jackc/pgproto3/v2 v2.3.1\n/jackc/pgtype v1.12.0\nt v0.5.1\n v0.0.0-20190825152654-46b345b51c96\n/golang/glog v1.0.0\n/golang/snappy v0.0.4\n/jackc/chunkreader/v2 v2.0.1\n/jackc/pgpassfile v1.0.0\n/jackc/pgservicefile v0.0.0-20200714003250-2b9c44734f2b\ngutz/ansi v0.0.0-20200706080929-d51e80ef957d\nattn/go-colorable v0.1.8\ne v1.0.0\nattn/go-isatty v0.0.13\nent ready\n2023/07/04 02:11:18 [INFO] Building Caddy\nod tidy -e \n/stretchr/testify v1.8.1\ngo: downloading go.uber.org/goleak v1.1.12\nega v1.20.1\ngo: downloading gopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c\n/davecgh/go-spew v1.1.1\nezard/go-difflib v1.0.0\n/benbjohnson/clock v1.1.0\nallstep/assert v0.0.0-20200723003110-82e2b9b3b262\np v0.5.9\n/kr/pretty v0.3.1\nas/assert/v2 v2.2.1\n/kr/text v0.1.0\n/rogpeppe/go-internal v1.9.0\nl.v2 v2.4.0\nas/repr v0.2.0\n/hexops/gotextdiff v1.0.3\n/chzyer/test v0.0.0-20180213035817-a1ea475d72b1\n/aws/aws-sdk-go v1.44.185\ns v1.8.0\n/go v0.107.0\nd/go-cloud-debug-agent/internal/debug/dwarf/testdata/typedef.c: no space left on device\n/googleapis/gax-go/v2 v2.7.0\ngo: downloading google.golang.org/api v0.108.0\n/cockroachdb/apd v1.1.0\npatible\npatible/testdata/corpus/seed_invalid_23: no space left on device\n/go-stack/stack v1.8.0\n/chzyer/logex v1.1.10\nock v0.0.0-20210724152146-4ad1a8207f65\nock.go: no space left on device\n/lib/pq v1.10.2\nespath v0.4.0\n/OneOfOne/xxhash v1.2.2\n/!one!of!one/xxhash@v1.2.2/.gitignore: no space left on device\nur3 v1.1.0\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tcloud.google.com/go/kms/apiv1: unzip /go/pkg/mod/cache/download/cloud.google.com/go/@v/v0.107.0.zip: write /go/pkg/mod/cloud.google.com/go@v0.107.0/cmd/go-cloud-debug-agent/internal/debug/dwarf/testdata/typedef.c: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tcloud.google.com/go/kms/apiv1/kmspb: unzip /go/pkg/mod/cache/download/cloud.google.com/go/@v/v0.107.0.zip: write /go/pkg/mod/cloud.google.com/go@v0.107.0/cmd/go-cloud-debug-agent/internal/debug/dwarf/testdata/typedef.c: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tgoogle.golang.org/api/option: google.golang.org/api@v0.108.0: read \"https:/proxy.golang.org/@v/v0.108.0.zip\": write /go/pkg/mod/cache/download/google.golang.org/api/@v/v0.108.0.zip225511528.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/postgresql imports\n\tgithub.com/jackc/pgx/v4 tested by\n\tgithub.com/jackc/pgx/v4.test imports\n\tgithub.com/cockroachdb/apd: github.com/cockroachdb/apd@v1.1.0: read \"https:/proxy.golang.org/@v/v1.1.0.zip\": write /go/pkg/mod/cache/download/github.com/cockroachdb/apd/@v/v1.1.0.zip852186258.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/postgresql imports\n\tgithub.com/jackc/pgx/v4 tested by\n\tgithub.com/jackc/pgx/v4.test imports\n\tgithub.com/gofrs/uuid: unzip /go/pkg/mod/cache/download/github.com/gofrs/uuid/@v/v4.0.0+incompatible.zip: write /go/pkg/mod/github.com/gofrs/uuid@v4.0.0+incompatible/testdata/corpus/seed_invalid_23: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tgithub.com/googleapis/gax-go/v2 imports\n\tgoogle.golang.org/api/googleapi: google.golang.org/api@v0.108.0: read \"https:/proxy.golang.org/@v/v0.108.0.zip\": write /go/pkg/mod/cache/download/google.golang.org/api/@v/v0.108.0.zip225511528.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/postgresql imports\n\tgithub.com/jackc/pgx/v4 imports\n\tgithub.com/jackc/pgconn tested by\n\tgithub.com/jackc/pgconn.test imports\n\tgithub.com/jackc/pgmock: unzip /go/pkg/mod/cache/download/github.com/jackc/pgmock/@v/v0.0.0-20210724152146-4ad1a8207f65.zip: write /go/pkg/mod/github.com/jackc/pgmock@v0.0.0-20210724152146-4ad1a8207f65/pgmock.go: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/postgresql imports\n\tgithub.com/jackc/pgx/v4 imports\n\tgithub.com/jackc/pgtype tested by\n\tgithub.com/jackc/pgtype.test imports\n\tgithub.com/lib/pq: github.com/lib/pq@v1.10.2: read \"https:/proxy.golang.org/@v/v1.10.2.zip\": write /go/pkg/mod/cache/download/github.com/lib/pq/@v/v1.10.2.zip858292790.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/awskms imports\n\tgithub.com/aws/aws-sdk-go/aws/request imports\n\tgithub.com/aws/aws-sdk-go/aws/awsutil imports\n\tgithub.com/jmespath/go-jmespath: github.com/jmespath/go-jmespath@v0.4.0: read \"https:/proxy.golang.org/@v/v0.4.0.zip\": write /go/pkg/mod/cache/download/github.com/jmespath/go-jmespath/@v/v0.4.0.zip496193015.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/badger/v2 imports\n\tgithub.com/dgraph-io/badger/v2 imports\n\tgithub.com/dgraph-io/badger/v2/y imports\n\tgithub.com/cespare/xxhash tested by\n\tgithub.com/cespare/xxhash.test imports\n\tgithub.com/OneOfOne/xxhash: unzip /go/pkg/mod/cache/download/github.com/!one!of!one/xxhash/@v/v1.2.2.zip: write /go/pkg/mod/github.com/!one!of!one/xxhash@v1.2.2/.gitignore: no space left on device\ncaddy imports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/cadd", "msg": "Error: build failed with [Errno 28] No space left on device"}
2023-07-03 22:11:27,397 p=16566 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-03 22:11:27,397 p=16566 u=craig n=ansible | caddy                      : ok=7    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-04 21:10:38,567 p=94090 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:10:38,573 p=94090 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:10:40,137 p=94090 u=craig n=ansible | ok: [caddy]
2023-07-04 21:10:40,146 p=94090 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:10:40,170 p=94090 u=craig n=ansible | ok: [caddy]
2023-07-04 21:10:40,181 p=94090 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:10:41,007 p=94090 u=craig n=ansible | ok: [caddy]
2023-07-04 21:10:41,017 p=94090 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300, reboot_timeout_unit=seconds] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:10:41,033 p=94090 u=craig n=ansible | fatal: [caddy]: FAILED! => {"msg": "The conditional check 'ansible_reboot_pending' failed. The error was: error while evaluating conditional (ansible_reboot_pending): 'ansible_reboot_pending' is undefined. 'ansible_reboot_pending' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/caddy_docker/tasks/main.yaml': line 10, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Restart system\n  ^ here\n"}
2023-07-04 21:10:41,034 p=94090 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:10:41,034 p=94090 u=craig n=ansible | caddy                      : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-04 21:11:00,102 p=94191 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:11:00,108 p=94191 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:11:01,199 p=94191 u=craig n=ansible | ok: [caddy]
2023-07-04 21:11:01,206 p=94191 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:11:01,232 p=94191 u=craig n=ansible | ok: [caddy]
2023-07-04 21:11:01,247 p=94191 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:11:01,827 p=94191 u=craig n=ansible | ok: [caddy]
2023-07-04 21:11:01,836 p=94191 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300, reboot_timeout_unit=seconds] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:11:01,855 p=94191 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-04 21:11:01,856 p=94191 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.reboot: reboot_timeout_unit"}
2023-07-04 21:11:01,857 p=94191 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:11:01,857 p=94191 u=craig n=ansible | caddy                      : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-04 21:12:03,267 p=94356 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:03,274 p=94356 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:04,543 p=94356 u=craig n=ansible | ok: [caddy]
2023-07-04 21:12:04,550 p=94356 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:04,575 p=94356 u=craig n=ansible | ok: [caddy]
2023-07-04 21:12:04,587 p=94356 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:05,158 p=94356 u=craig n=ansible | ok: [caddy]
2023-07-04 21:12:05,167 p=94356 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:21,191 p=94356 u=craig n=ansible | changed: [caddy]
2023-07-04 21:12:21,199 p=94356 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:21,650 p=94356 u=craig n=ansible | ok: [caddy]
2023-07-04 21:12:21,661 p=94356 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:22,334 p=94356 u=craig n=ansible | ok: [caddy]
2023-07-04 21:12:22,341 p=94356 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:23,008 p=94356 u=craig n=ansible | ok: [caddy]
2023-07-04 21:12:23,018 p=94356 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:12:23,639 p=94356 u=craig n=ansible | ok: [caddy]
2023-07-04 21:12:23,648 p=94356 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:14:58,471 p=94356 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:847d8eca25e08fb9b0c6c7288ab67be29674205faffaca66488728d4205bd3b0\nStatus: Image is up to date for caddy:2-builder\n ---> 8df230ad40b5\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in 153979af6fa5\np/buildenv_2023-07-05-0112.1105729009\n2023/07/05 01:12:25 [INFO] Writing main module: /tmp/buildenv_2023-07-05-0112.1105729009/main.go\npackage main\n\nimport (\n\tcaddycmd \"github.com/caddyserver/caddy/v2/cmd\"\n\n\t// plug in Caddy modules here\n\t_ \"github.com/caddyserver/caddy/v2/modules/standard\"\n\t_ \"github.com/caddy-dns/cloudflare\"\n)\n\nfunc main() {\n\tcaddycmd.Main()\n}\n2023/07/05 01:12:25 [INFO] Initializing Go module\n2023/07/05 01:12:25 [INFO] exec (timeout=-2562047h47m16.854775808s): /usr/local/go/bin/go mod init caddy \nodule caddy\ns:\n\tgo mod tidy\n2023/07/05 01:12:25 [INFO] Pinning versions\n/caddyserver/caddy/v2@v2.6.4 \n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/google/uuid v1.3.0\netheus/client_golang v1.14.0\n/quic-go/quic-go v0.32.0\ngo: downloading go.uber.org/zap v1.24.0\ngo: downloading golang.org/x/sys v0.5.0\n v0.5.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\nez v1.1.0\niekg/dns v1.1.50\ngo: downloading golang.org/x/crypto v0.5.0\ngo: downloading golang.org/x/net v0.7.0\n/beorn7/perks v1.0.1\n/cespare/xxhash/v2 v2.1.2\n/cespare/xxhash v1.1.0\n/golang/protobuf v1.5.2\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\ngo: downloading google.golang.org/protobuf v1.28.1\nock v1.6.0\n/onsi/ginkgo/v2 v2.2.0\n/quic-go/qpack v0.4.0\nic v1.9.0\nultierr v1.6.0\ngo: downloading golang.org/x/tools v0.2.0\ngo: downloading golang.org/x/text v0.7.0\natttproud/golang_protobuf_extensions v1.0.1\nod v0.6.0\ngo: downloading golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n-sprig v0.0.0-20210107165309-348f09dbbbc0\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/beorn7/perks v1.0.1\n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/cespare/xxhash/v2 v2.1.2\n-sprig v0.0.0-20210107165309-348f09dbbbc0\nock v1.6.0\n/golang/protobuf v1.5.2\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/google/uuid v1.3.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\natttproud/golang_protobuf_extensions v1.0.1\nez v1.1.0\niekg/dns v1.1.50\n/onsi/ginkgo/v2 v2.2.0\netheus/client_golang v1.14.0\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\n/quic-go/qpack v0.4.0\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n/quic-go/quic-go v0.32.0\nic v1.9.0\nultierr v1.6.0\ngo: added go.uber.org/zap v1.24.0\ngo: added golang.org/x/crypto v0.5.0\ngo: added golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\nod v0.6.0\ngo: added golang.org/x/net v0.7.0\ngo: added golang.org/x/sys v0.5.0\n v0.5.0\ngo: added golang.org/x/text v0.7.0\ngo: added golang.org/x/tools v0.2.0\ngo: added google.golang.org/protobuf v1.28.1\n/caddyserver/caddy/v2@v2.6.4 \n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n16.854775808s): /usr/local/go/bin/go get -d -v  \n/aryann/difflib v0.0.0-20210328193216-ff5ff6dc229b\n/spf13/cobra v1.6.1\n/spf13/pflag v1.0.5\nousetrap v1.0.1\nan/v2 v2.0.2\nl.v3 v3.0.1\nallstep/certificates v0.23.2\nallstep/truststore v0.12.1\n/crypto v0.23.2\npatible\nallstep/nosql v0.5.0\n/tailscale/tscert v0.0.0-20230124224810-c6dc1f4049b2\nanize v1.0.1\nberjack.v2 v2.2.1\n/russross/blackfriday/v2 v2.1.0\n/google/cel-go v0.13.0\ngo: downloading google.golang.org/genproto v0.0.0-20230202175211-008b39050e57\ngo: downloading golang.org/x/sync v0.1.0\npress v1.15.15\nl v1.2.1\ninds/sprig/v3 v3.2.3\na/v2 v2.5.0\nark v1.5.4\nark-highlighting/v2 v2.0.0-20220924101305-151362477c87\nentation/net/http/otelhttp v0.39.0\netry.io/otel/exporters/otlp/otlptrace/otlptracegrpc v1.4.0\netry.io/otel/exporters/otlp/otlptrace v1.4.0\netry.io/otel v1.13.0\netry.io/otel/sdk v1.13.0\n/pkg/errors v0.9.1\n/cli-utils v0.7.5\n/linkedca v0.19.0\ngo: downloading google.golang.org/grpc v1.52.3\ngo: downloading gopkg.in/square/go-jose.v2 v2.6.0\ngo: downloading howett.net/plist v1.0.0\nacker/cbor/v2 v2.4.0\n/slackhq/nebula v1.6.1\n/stoewer/go-strcase v1.2.0\ne/Go/antlr v1.4.10\ninds/goutils v1.1.1\nver/v3 v3.2.0\n/huandu/xstrings v1.3.3\nergo v0.3.12\nitchellh/copystructure v1.2.0\nal v1.2.0\n/spf13/cast v1.4.1\n/felixge/httpsnoop v1.0.3\netric v0.36.0\netry.io/otel/trace v1.13.0\netry.io/otel/exporters/otlp/internal/retry v1.4.0\netry.io/proto/otlp v0.12.0\n/scep/v2 v2.1.0\nozilla.org/pkcs7 v0.0.0-20210826202110-33d05740a352\n/urfave/cli v1.22.12\n/chzyer/readline v0.0.0-20180603132655-2972be24d48e\nptui v0.9.0\ngo: downloading filippo.io/edwards25519 v1.0.0\n/x448/float16 v0.8.4\n/rs/xid v1.4.0\n/sirupsen/logrus v1.9.0\n/dgraph-io/badger v1.6.2\n/dgraph-io/badger/v2 v2.2007.4\ngo: downloading go.etcd.io/bbolt v1.3.6\nysql v1.6.0\n/jackc/pgx/v4 v4.17.2\n/Microsoft/go-winio v0.6.0\nitchellh/go-ps v1.0.0\nitchellh/reflectwalk v1.0.2\n/dlclark/regexp2 v1.7.0\n/go-logr/logr v1.2.3\n/cenkalti/backoff/v4 v4.1.2\n/grpc-gateway v1.16.0\n/go-logr/stdr v1.2.2\n/go-kit/kit v0.10.0\n/dgraph-io/ristretto v0.1.0\n v0.0.0-20200201041132-a6ae2369ad13\n/jackc/pgconn v1.13.0\n/jackc/pgio v1.0.0\n/jackc/pgproto3/v2 v2.3.1\n/jackc/pgtype v1.12.0\nt v0.5.1\n v0.0.0-20190825152654-46b345b51c96\n/golang/glog v1.0.0\n/golang/snappy v0.0.4\n/jackc/chunkreader/v2 v2.0.1\n/jackc/pgpassfile v1.0.0\n/jackc/pgservicefile v0.0.0-20200714003250-2b9c44734f2b\ngutz/ansi v0.0.0-20200706080929-d51e80ef957d\nattn/go-colorable v0.1.8\ne v1.0.0\nattn/go-isatty v0.0.13\nent ready\n2023/07/05 01:14:48 [INFO] Building Caddy\nod tidy -e \n/stretchr/testify v1.8.1\ngo: downloading go.uber.org/goleak v1.1.12\nega v1.20.1\ngo: downloading gopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c\n/davecgh/go-spew v1.1.1\nezard/go-difflib v1.0.0\n/benbjohnson/clock v1.1.0\nallstep/assert v0.0.0-20200723003110-82e2b9b3b262\np v0.5.9\n/kr/pretty v0.3.1\nas/assert/v2 v2.2.1\n/kr/text v0.1.0\n/rogpeppe/go-internal v1.9.0\nl.v2 v2.4.0\nas/repr v0.2.0\n/hexops/gotextdiff v1.0.3\n/chzyer/test v0.0.0-20180213035817-a1ea475d72b1\n/aws/aws-sdk-go v1.44.185\ns v1.8.0\n/go v0.107.0\nd/go-cloud-debug-agent/internal/debug/server/server.go: no space left on device\n/googleapis/gax-go/v2 v2.7.0\ngo: downloading google.golang.org/api v0.108.0\n/cockroachdb/apd v1.1.0\n/cockroachdb/apd@v1.1.0/testdata/ln.decTest: no space left on device\npatible\n/go-stack/stack v1.8.0\n/chzyer/logex v1.1.10\nock v0.0.0-20210724152146-4ad1a8207f65\n/lib/pq v1.10.2\nespath v0.4.0\n/OneOfOne/xxhash v1.2.2\n/!one!of!one/xxhash@v1.2.2/bugs_test.go: no space left on device\nur3 v1.1.0\nd: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tcloud.google.com/go/kms/apiv1: unzip /go/pkg/mod/cache/download/cloud.google.com/go/@v/v0.107.0.zip: write /go/pkg/mod/cloud.google.com/go@v0.107.0/cmd/go-cloud-debug-agent/internal/debug/server/server.go: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tcloud.google.com/go/kms/apiv1/kmspb: unzip /go/pkg/mod/cache/download/cloud.google.com/go/@v/v0.107.0.zip: write /go/pkg/mod/cloud.google.com/go@v0.107.0/cmd/go-cloud-debug-agent/internal/debug/server/server.go: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tgoogle.golang.org/api/option: google.golang.org/api@v0.108.0: read \"https:/proxy.golang.org/@v/v0.108.0.zip\": write /go/pkg/mod/cache/download/google.golang.org/api/@v/v0.108.0.zip225511528.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/postgresql imports\n\tgithub.com/jackc/pgx/v4 tested by\n\tgithub.com/jackc/pgx/v4.test imports\n\tgithub.com/cockroachdb/apd: unzip /go/pkg/mod/cache/download/github.com/cockroachdb/apd/@v/v1.1.0.zip: write /go/pkg/mod/github.com/cockroachdb/apd@v1.1.0/testdata/ln.decTest: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tgithub.com/googleapis/gax-go/v2 imports\n\tgoogle.golang.org/api/googleapi: google.golang.org/api@v0.108.0: read \"https:/proxy.golang.org/@v/v0.108.0.zip\": write /go/pkg/mod/cache/download/google.golang.org/api/@v/v0.108.0.zip225511528.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/postgresql imports\n\tgithub.com/jackc/pgx/v4 imports\n\tgithub.com/jackc/pgtype tested by\n\tgithub.com/jackc/pgtype.test imports\n\tgithub.com/lib/pq: github.com/lib/pq@v1.10.2: read \"https:/proxy.golang.org/@v/v1.10.2.zip\": write /go/pkg/mod/cache/download/github.com/lib/pq/@v/v1.10.2.zip858292790.tmp: no space left on device\ncaddy imports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/awskms imports\n\tgithub.com/aws/aws-sdk-go/aws/request imports\n\tgithub.com/aws/aws-sdk-go/aws/awsutil imports\n\tgithub.com/jmespath/go-jmespath: github.com/jmespath/go-jmespath@v0.4.0: read \"https:/proxy.golang.org/@v/v0.4.0.zip\": write /go/pkg/mod/cache/download/github.com/jmespath/go-jmespath/@v/v0.4.0.zip496193015.tmp: no space left on device\ncaddy imports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/badger/v2 imports\n\tgithub.com/dgraph-io/badger/v2 imports\n\tgithub.com/dgraph-io/badger/v2/y imports\n\tgithub.com/cespare/xxhash tested by\n\tgithub.com/cespare/xxhash.test imports\n\tgithub.com/OneOfOne/xxhash: unzip /go/pkg/mod/cache/download/github.com/!one!of!one/xxhash/@v/v1.2.2.zip: write /go/pkg/mod/github.com/!one!of!one/xxhash@v1.2.2/bugs_test.go: no space left on device\ncaddy imports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/badger/v2 imports\n\tgithub.com/dgraph-io/badger/v2 imports\n\tgithub.com/dgraph-io/badger/v2/y imports\n\tgithub.com/cespare/xxhash tested by\n\tgithub.com/cespare/xxhash.test imports\n\tgithub.com/spaolacci/murmur3: unzip /go/pkg/mod/cache/download/github.com/spaolacci/murmur3/@v/v1.1.0.zip: write /go/pkg/mod/github.com/spaolacci/murmur3@v1.1.0/README.md: no space left on device\npath \np: no space left on device\np: no space left on device\np: no space left on device\np: no space left on device\ngo: writing", "msg": "Error: build failed with [Errno 28] No space left on device"}
2023-07-04 21:14:58,473 p=94356 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:14:58,474 p=94356 u=craig n=ansible | caddy                      : ok=8    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-04 21:19:52,119 p=95505 u=craig n=ansible | PLAY [Update Caddyfile in Docker container] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:19:52,125 p=95505 u=craig n=ansible | TASK [Gathering Facts ] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:19:53,505 p=95505 u=craig n=ansible | ok: [caddy]
2023-07-04 21:19:53,513 p=95505 u=craig n=ansible | TASK [Include secrets] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:19:53,540 p=95505 u=craig n=ansible | ok: [caddy]
2023-07-04 21:19:53,552 p=95505 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True, remove_volumes=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:19:54,237 p=95505 u=craig n=ansible | ok: [caddy]
2023-07-04 21:19:54,248 p=95505 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:20:00,787 p=95505 u=craig n=ansible | changed: [caddy]
2023-07-04 21:20:00,795 p=95505 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:20:01,160 p=95505 u=craig n=ansible | ok: [caddy]
2023-07-04 21:20:01,169 p=95505 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:20:01,968 p=95505 u=craig n=ansible | ok: [caddy]
2023-07-04 21:20:01,973 p=95505 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:20:02,524 p=95505 u=craig n=ansible | ok: [caddy]
2023-07-04 21:20:02,535 p=95505 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:20:03,191 p=95505 u=craig n=ansible | ok: [caddy]
2023-07-04 21:20:03,200 p=95505 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:22:04,186 p=95505 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:847d8eca25e08fb9b0c6c7288ab67be29674205faffaca66488728d4205bd3b0\nStatus: Image is up to date for caddy:2-builder\n ---> 8df230ad40b5\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in 839a4f26457c\np/buildenv_2023-07-05-0120.2121022176\n2023/07/05 01:20:06 [INFO] Writing main module: /tmp/buildenv_2023-07-05-0120.2121022176/main.go\npackage main\n\nimport (\n\tcaddycmd \"github.com/caddyserver/caddy/v2/cmd\"\n\n\t// plug in Caddy modules here\n\t_ \"github.com/caddyserver/caddy/v2/modules/standard\"\n\t_ \"github.com/caddy-dns/cloudflare\"\n)\n\nfunc main() {\n\tcaddycmd.Main()\n}\n2023/07/05 01:20:06 [INFO] Initializing Go module\n2023/07/05 01:20:06 [INFO] exec (timeout=-2562047h47m16.854775808s): /usr/local/go/bin/go mod init caddy \nodule caddy\ns:\n\tgo mod tidy\n2023/07/05 01:20:06 [INFO] Pinning versions\n/caddyserver/caddy/v2@v2.6.4 \n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/google/uuid v1.3.0\netheus/client_golang v1.14.0\n/quic-go/quic-go v0.32.0\ngo: downloading go.uber.org/zap v1.24.0\ngo: downloading golang.org/x/sys v0.5.0\n v0.5.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\nez v1.1.0\niekg/dns v1.1.50\ngo: downloading golang.org/x/crypto v0.5.0\ngo: downloading golang.org/x/net v0.7.0\n/beorn7/perks v1.0.1\n/cespare/xxhash/v2 v2.1.2\n/cespare/xxhash v1.1.0\n/golang/protobuf v1.5.2\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\ngo: downloading google.golang.org/protobuf v1.28.1\nock v1.6.0\n/onsi/ginkgo/v2 v2.2.0\n/quic-go/qpack v0.4.0\nic v1.9.0\nultierr v1.6.0\ngo: downloading golang.org/x/tools v0.2.0\ngo: downloading golang.org/x/text v0.7.0\natttproud/golang_protobuf_extensions v1.0.1\nod v0.6.0\ngo: downloading golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n-sprig v0.0.0-20210107165309-348f09dbbbc0\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/beorn7/perks v1.0.1\n/caddyserver/caddy/v2 v2.6.4\nagic v0.17.2\n/cespare/xxhash/v2 v2.1.2\n-sprig v0.0.0-20210107165309-348f09dbbbc0\nock v1.6.0\n/golang/protobuf v1.5.2\n/google/pprof v0.0.0-20210407192527-94a9f03dee38\n/google/uuid v1.3.0\n/klauspost/cpuid/v2 v2.2.3\n/libdns/libdns v0.2.1\natttproud/golang_protobuf_extensions v1.0.1\nez v1.1.0\niekg/dns v1.1.50\n/onsi/ginkgo/v2 v2.2.0\netheus/client_golang v1.14.0\nodel v0.3.0\non v0.37.0\netheus/procfs v0.8.0\n/quic-go/qpack v0.4.0\n/quic-go/qtls-go1-18 v0.2.0\n/quic-go/qtls-go1-19 v0.2.0\n/quic-go/qtls-go1-20 v0.1.0\n/quic-go/quic-go v0.32.0\nic v1.9.0\nultierr v1.6.0\ngo: added go.uber.org/zap v1.24.0\ngo: added golang.org/x/crypto v0.5.0\ngo: added golang.org/x/exp v0.0.0-20221205204356-47842c84f3db\nod v0.6.0\ngo: added golang.org/x/net v0.7.0\ngo: added golang.org/x/sys v0.5.0\n v0.5.0\ngo: added golang.org/x/text v0.7.0\ngo: added golang.org/x/tools v0.2.0\ngo: added google.golang.org/protobuf v1.28.1\n/caddyserver/caddy/v2@v2.6.4 \n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n/caddy-dns/cloudflare v0.0.0-20230224210553-a9d3ae2690a1\n/libdns/cloudflare v0.1.0\n16.854775808s): /usr/local/go/bin/go get -d -v  \n/aryann/difflib v0.0.0-20210328193216-ff5ff6dc229b\n/spf13/cobra v1.6.1\n/spf13/pflag v1.0.5\nousetrap v1.0.1\nan/v2 v2.0.2\nl.v3 v3.0.1\nallstep/certificates v0.23.2\nallstep/truststore v0.12.1\n/crypto v0.23.2\npatible\nallstep/nosql v0.5.0\n/tailscale/tscert v0.0.0-20230124224810-c6dc1f4049b2\nanize v1.0.1\nberjack.v2 v2.2.1\n/russross/blackfriday/v2 v2.1.0\n/google/cel-go v0.13.0\ngo: downloading google.golang.org/genproto v0.0.0-20230202175211-008b39050e57\ngo: downloading golang.org/x/sync v0.1.0\npress v1.15.15\nl v1.2.1\ninds/sprig/v3 v3.2.3\na/v2 v2.5.0\nark v1.5.4\nark-highlighting/v2 v2.0.0-20220924101305-151362477c87\nentation/net/http/otelhttp v0.39.0\netry.io/otel/exporters/otlp/otlptrace/otlptracegrpc v1.4.0\netry.io/otel/exporters/otlp/otlptrace v1.4.0\netry.io/otel v1.13.0\netry.io/otel/sdk v1.13.0\n/pkg/errors v0.9.1\n/cli-utils v0.7.5\n/linkedca v0.19.0\ngo: downloading google.golang.org/grpc v1.52.3\ngo: downloading gopkg.in/square/go-jose.v2 v2.6.0\ngo: downloading howett.net/plist v1.0.0\nacker/cbor/v2 v2.4.0\n/slackhq/nebula v1.6.1\n/stoewer/go-strcase v1.2.0\ne/Go/antlr v1.4.10\ninds/goutils v1.1.1\nver/v3 v3.2.0\n/huandu/xstrings v1.3.3\nergo v0.3.12\nitchellh/copystructure v1.2.0\nal v1.2.0\n/spf13/cast v1.4.1\n/felixge/httpsnoop v1.0.3\netric v0.36.0\netry.io/otel/trace v1.13.0\netry.io/otel/exporters/otlp/internal/retry v1.4.0\netry.io/proto/otlp v0.12.0\n/scep/v2 v2.1.0\nozilla.org/pkcs7 v0.0.0-20210826202110-33d05740a352\n/urfave/cli v1.22.12\n/chzyer/readline v0.0.0-20180603132655-2972be24d48e\nptui v0.9.0\ngo: downloading filippo.io/edwards25519 v1.0.0\n/x448/float16 v0.8.4\n/rs/xid v1.4.0\n/sirupsen/logrus v1.9.0\n/dgraph-io/badger v1.6.2\n/dgraph-io/badger/v2 v2.2007.4\ngo: downloading go.etcd.io/bbolt v1.3.6\nysql v1.6.0\n/jackc/pgx/v4 v4.17.2\n/Microsoft/go-winio v0.6.0\nitchellh/go-ps v1.0.0\nitchellh/reflectwalk v1.0.2\n/dlclark/regexp2 v1.7.0\n/go-logr/logr v1.2.3\n/cenkalti/backoff/v4 v4.1.2\n/grpc-gateway v1.16.0\n/go-logr/stdr v1.2.2\n/go-kit/kit v0.10.0\n/dgraph-io/ristretto v0.1.0\n v0.0.0-20200201041132-a6ae2369ad13\n/jackc/pgconn v1.13.0\n/jackc/pgio v1.0.0\n/jackc/pgproto3/v2 v2.3.1\n/jackc/pgtype v1.12.0\nt v0.5.1\n v0.0.0-20190825152654-46b345b51c96\n/golang/glog v1.0.0\n/golang/snappy v0.0.4\n/jackc/chunkreader/v2 v2.0.1\n/jackc/pgpassfile v1.0.0\n/jackc/pgservicefile v0.0.0-20200714003250-2b9c44734f2b\ngutz/ansi v0.0.0-20200706080929-d51e80ef957d\nattn/go-colorable v0.1.8\ne v1.0.0\nattn/go-isatty v0.0.13\nent ready\n2023/07/05 01:21:55 [INFO] Building Caddy\nod tidy -e \n/stretchr/testify v1.8.1\ngo: downloading go.uber.org/goleak v1.1.12\nega v1.20.1\ngo: downloading gopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c\n/davecgh/go-spew v1.1.1\nezard/go-difflib v1.0.0\n/benbjohnson/clock v1.1.0\nallstep/assert v0.0.0-20200723003110-82e2b9b3b262\np v0.5.9\n/kr/pretty v0.3.1\nas/assert/v2 v2.2.1\n/kr/text v0.1.0\n/rogpeppe/go-internal v1.9.0\nl.v2 v2.4.0\nas/repr v0.2.0\n/hexops/gotextdiff v1.0.3\n/chzyer/test v0.0.0-20180213035817-a1ea475d72b1\n/aws/aws-sdk-go v1.44.185\ns v1.8.0\n/go v0.107.0\n.go: no space left on device\n/googleapis/gax-go/v2 v2.7.0\ngo: downloading google.golang.org/api v0.108.0\n/cockroachdb/apd v1.1.0\npare.decTest: no space left on device\npatible\n/go-stack/stack v1.8.0\n/chzyer/logex v1.1.10\n/chzyer/logex@v1.1.10: no space left on device\nock v0.0.0-20210724152146-4ad1a8207f65\n/lib/pq v1.10.2\nespath v0.4.0\n/OneOfOne/xxhash v1.2.2\nur3 v1.1.0\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tcloud.google.com/go/kms/apiv1: unzip /go/pkg/mod/cache/download/cloud.google.com/go/@v/v0.107.0.zip: write /go/pkg/mod/cloud.google.com/go@v0.107.0/cmd/go-cloud-debug-agent/internal/debug/program.go: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tcloud.google.com/go/kms/apiv1/kmspb: unzip /go/pkg/mod/cache/download/cloud.google.com/go/@v/v0.107.0.zip: write /go/pkg/mod/cloud.google.com/go@v0.107.0/cmd/go-cloud-debug-agent/internal/debug/program.go: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki imports\n\tgithub.com/smallstep/certificates/authority imports\n\tgo.step.sm/crypto/kms tested by\n\tgo.step.sm/crypto/kms.test imports\n\tgo.step.sm/crypto/kms/cloudkms imports\n\tgoogle.golang.org/api/option: google.golang.org/api@v0.108.0: read \"https:/proxy.golang.org/@v/v0.108.0.zip\": write /go/pkg/mod/cache/download/google.golang.org/api/@v/v0.108.0.zip225511528.tmp: no space left on device\nports\n\tgithub.com/caddyserver/caddy/v2/modules/standard imports\n\tgithub.com/caddyserver/caddy/v2/modules/caddypki/acmeserver imports\n\tgithub.com/smallstep/nosql imports\n\tgithub.com/smallstep/nosql/postgresql imports\n\tgithub.com/jackc/pgx/v4 ", "msg": "Error: build failed with [Errno 28] No space left on device"}
2023-07-04 21:22:04,188 p=95505 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:22:04,189 p=95505 u=craig n=ansible | caddy                      : ok=8    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-04 21:34:13,236 p=97583 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:34:13,261 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:34:14,851 p=97583 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:34:14,869 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 21:34:14,906 p=97583 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:34:14,915 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:34:15,220 p=97583 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:34:15,234 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:34:15,976 p=97583 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:34:15,994 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 21:34:28,044 p=97583 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:34:28,062 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:34:30,537 p=97583 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 21:34:30,537 p=97583 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:34:30,556 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_ip }}, groups=proxmox_nodes] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:34:30,580 p=97583 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:34:30,593 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip }}, port=22, state=started, sleep=5, timeout=300] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:39:31,167 p=97583 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "elapsed": 300, "msg": "Timeout when waiting for 192.168.1.4/24:22"}
2023-07-04 21:39:31,187 p=97583 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:39:31,207 p=97583 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-04 21:39:31,207 p=97583 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-07-04 21:39:31,208 p=97583 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:39:31,208 p=97583 u=craig n=ansible | 192.168.1.99               : ok=7    changed=3    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-07-04 21:40:00,559 p=98455 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:00,584 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:01,507 p=98455 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:40:01,522 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 21:40:01,548 p=98455 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:40:01,556 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:01,872 p=98455 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:40:01,885 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:02,623 p=98455 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:40:02,636 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 21:40:19,869 p=98455 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:40:19,886 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:22,260 p=98455 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 21:40:22,260 p=98455 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:40:22,279 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_ip }}, groups=proxmox_nodes] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:22,299 p=98455 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:40:22,321 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Ensure SSH is enabled and started inside the container _raw_params=pct exec {{ machine_id }} -- systemctl enable ssh && pct exec {{ machine_id }} -- systemctl start ssh] **************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:24,128 p=98455 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": true, "cmd": "pct exec 110 -- systemctl enable ssh && pct exec 110 -- systemctl start ssh", "delta": "0:00:01.471829", "end": "2023-07-04 21:40:24.092497", "msg": "non-zero return code", "rc": 1, "start": "2023-07-04 21:40:22.620668", "stderr": "Synchronizing state of ssh.service with SysV service script with /lib/systemd/systemd-sysv-install.\nExecuting: /lib/systemd/systemd-sysv-install enable ssh\nperl: warning: Setting locale failed.\nperl: warning: Please check that your locale settings:\n\tLANGUAGE = (unset),\n\tLC_ALL = (unset),\n\tLANG = \"en_US.UTF-8\"\n    are supported and installed on your system.\nperl: warning: Falling back to the standard locale (\"C\").\nperl: warning: Setting locale failed.\nperl: warning: Please check that your locale settings:\n\tLANGUAGE = (unset),\n\tLC_ALL = (unset),\n\tLANG = \"en_US.UTF-8\"\n    are supported and installed on your system.\nperl: warning: Falling back to the standard locale (\"C\").\nJob for ssh.service failed because the control process exited with error code.\nSee \"systemctl status ssh.service\" and \"journalctl -xeu ssh.service\" for details.", "stderr_lines": ["Synchronizing state of ssh.service with SysV service script with /lib/systemd/systemd-sysv-install.", "Executing: /lib/systemd/systemd-sysv-install enable ssh", "perl: warning: Setting locale failed.", "perl: warning: Please check that your locale settings:", "\tLANGUAGE = (unset),", "\tLC_ALL = (unset),", "\tLANG = \"en_US.UTF-8\"", "    are supported and installed on your system.", "perl: warning: Falling back to the standard locale (\"C\").", "perl: warning: Setting locale failed.", "perl: warning: Please check that your locale settings:", "\tLANGUAGE = (unset),", "\tLC_ALL = (unset),", "\tLANG = \"en_US.UTF-8\"", "    are supported and installed on your system.", "perl: warning: Falling back to the standard locale (\"C\").", "Job for ssh.service failed because the control process exited with error code.", "See \"systemctl status ssh.service\" and \"journalctl -xeu ssh.service\" for details."], "stdout": "", "stdout_lines": []}
2023-07-04 21:40:24,147 p=98455 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:24,171 p=98455 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-04 21:40:24,172 p=98455 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-07-04 21:40:24,172 p=98455 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:40:24,173 p=98455 u=craig n=ansible | 192.168.1.99               : ok=7    changed=3    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-07-04 21:50:35,271 p=795 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:50:35,297 p=795 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:50:36,505 p=795 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:50:36,523 p=795 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 21:50:36,558 p=795 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:50:36,567 p=795 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:50:36,873 p=795 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:50:36,885 p=795 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:50:37,715 p=795 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:50:37,727 p=795 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 21:50:38,113 p=795 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:50:38,129 p=795 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:10,172 p=795 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 21:52:10,173 p=795 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Reached timeout while waiting for starting VM. Last line in task before timeout: [{'t': \"TASK ERROR: Configuration file 'nodes/bigprox/lxc/110.conf' does not exist\", 'n': 1}]"}
2023-07-04 21:52:10,190 p=795 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:10,210 p=795 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-04 21:52:10,210 p=795 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-07-04 21:52:10,211 p=795 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:10,211 p=795 u=craig n=ansible | 192.168.1.99               : ok=5    changed=1    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-07-04 21:52:41,554 p=1170 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:41,579 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:42,508 p=1170 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:52:42,526 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 21:52:42,560 p=1170 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:52:42,569 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:42,889 p=1170 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:52:42,903 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:43,613 p=1170 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:52:43,626 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 21:52:56,757 p=1170 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:52:56,775 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:59,194 p=1170 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 21:52:59,194 p=1170 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:52:59,212 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_ip }}, groups=proxmox_nodes] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:52:59,233 p=1170 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:52:59,254 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Ensure SSH is enabled and started inside the container _raw_params=pct exec {{ machine_id }} -- systemctl enable ssh && pct exec {{ machine_id }} -- systemctl start ssh] **************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:53:01,041 p=1170 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:53:01,058 p=1170 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip }}, port=22, state=started, sleep=5, timeout=300] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:53:56,043 p=1170 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-07-04 21:58:03,738 p=2012 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:03,765 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:04,866 p=2012 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:58:04,884 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 21:58:04,916 p=2012 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:58:04,926 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:05,236 p=2012 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:58:05,249 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:05,942 p=2012 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 21:58:05,959 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 21:58:17,761 p=2012 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:58:17,778 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:20,139 p=2012 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 21:58:20,140 p=2012 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:58:20,158 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:20,177 p=2012 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 21:58:20,196 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_name }}, port=22, state=started, sleep=5, timeout=300] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:20,364 p=2012 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-04 21:58:20,373 p=2012 u=craig n=ansible | TASK [pm_create_lxc : Remove the container from inventory upon failure key=failed_containers, hosts={{ ansible_host }}] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:20,385 p=2012 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
2023-07-04 21:58:20,385 p=2012 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Invalid options for ansible.builtin.group_by: hosts"}
2023-07-04 21:58:20,386 p=2012 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 21:58:20,386 p=2012 u=craig n=ansible | 192.168.1.99               : ok=7    changed=3    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0   
2023-07-04 22:03:35,078 p=2861 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:03:35,103 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:03:36,229 p=2861 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:03:36,246 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 22:03:36,280 p=2861 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:03:36,289 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:03:36,602 p=2861 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:03:36,616 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:03:37,312 p=2861 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:03:37,328 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 22:03:55,272 p=2861 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:03:55,285 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:03:58,757 p=2861 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 22:03:58,757 p=2861 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:03:58,776 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:03:58,806 p=2861 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:03:58,816 p=2861 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_name }}, port=22, state=started, sleep=5, timeout=300] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:07:53,516 p=2861 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-07-04 22:07:58,200 p=3550 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:07:58,227 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:07:59,091 p=3550 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:07:59,108 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 22:07:59,140 p=3550 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:07:59,150 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:07:59,462 p=3550 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:07:59,476 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:00,218 p=3550 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:00,234 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 22:08:00,675 p=3550 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:00,693 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:01,056 p=3550 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 22:08:01,056 p=3550 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:01,074 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:01,103 p=3550 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:08:01,113 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip | regex_replace('/.*', '') }}, port=22, state=started, sleep=5, timeout=300] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:01,421 p=3550 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:01,446 p=3550 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:01,528 p=3550 u=craig n=ansible | fatal: [192.168.1.99 -> 192.168.1.4/24]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: Could not resolve hostname 192.168.1.4/24: nodename nor servname provided, or not known", "unreachable": true}
2023-07-04 22:08:01,528 p=3550 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:01,529 p=3550 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-04 22:08:57,253 p=3743 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:57,278 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:58,138 p=3743 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:58,155 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 22:08:58,188 p=3743 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:58,197 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:58,509 p=3743 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:58,523 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:08:59,245 p=3743 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:08:59,262 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 22:09:13,525 p=3743 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:09:13,542 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:09:17,943 p=3743 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 22:09:17,944 p=3743 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:09:17,963 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:09:17,991 p=3743 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:09:18,001 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip | regex_replace('/.*', '') }}, port=22, state=started, sleep=5, timeout=300] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:09:28,377 p=3743 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:09:28,409 p=3743 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:09:28,434 p=3743 u=craig n=ansible | fatal: [192.168.1.99 -> 192.168.1.4/24]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: Could not resolve hostname 192.168.1.4/24: nodename nor servname provided, or not known", "unreachable": true}
2023-07-04 22:09:28,435 p=3743 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:09:28,435 p=3743 u=craig n=ansible | 192.168.1.99               : ok=8    changed=3    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-04 22:25:44,097 p=6102 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:25:44,123 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:25:45,231 p=6102 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:25:45,248 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 22:25:45,281 p=6102 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:25:45,291 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:25:45,598 p=6102 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:25:45,611 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:25:46,321 p=6102 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:25:46,337 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 22:25:55,802 p=6102 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:25:55,819 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:00,212 p=6102 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 22:26:00,212 p=6102 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:26:00,230 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:00,258 p=6102 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:26:00,268 p=6102 u=craig n=ansible | TASK [Update inventory name=add_host] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:00,321 p=6102 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *********************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:00,633 p=6102 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {"changed": false, "msg": "Destination /root/Projects/homelab/ansible/inventory.yaml does not exist !", "rc": 257}
2023-07-04 22:26:00,646 p=6102 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:00,660 p=6102 u=craig n=ansible | ok: [192.168.1.99] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-04 22:26:00,676 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip | regex_replace('/.*', '') }}, port=22, state=started, sleep=5, timeout=300] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:11,065 p=6102 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:26:11,096 p=6102 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:11,361 p=6102 u=craig n=ansible | fatal: [192.168.1.99 -> caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\ncraig@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-04 22:26:11,362 p=6102 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:26:11,362 p=6102 u=craig n=ansible | 192.168.1.99               : ok=9    changed=3    unreachable=1    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-04 22:33:37,389 p=7288 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:37,416 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:38,517 p=7288 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:33:38,529 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] **************************************************************************************************************************************************************************************
2023-07-04 22:33:38,565 p=7288 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:33:38,575 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:38,922 p=7288 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:33:38,936 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:39,627 p=7288 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:33:39,642 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-04 22:33:53,196 p=7288 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:33:53,213 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:57,700 p=7288 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-04 22:33:57,700 p=7288 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:33:57,718 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:57,745 p=7288 u=craig n=ansible | changed: [192.168.1.99]
2023-07-04 22:33:57,757 p=7288 u=craig n=ansible | TASK [Update inventory name=add_host] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:57,815 p=7288 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *********************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:57,957 p=7288 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-04 22:33:57,972 p=7288 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:33:57,983 p=7288 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-04 22:33:57,997 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_ip | regex_replace('/.*', '') }}, port=22, state=started, sleep=5, timeout=300] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:34:08,450 p=7288 u=craig n=ansible | ok: [192.168.1.99]
2023-07-04 22:34:08,480 p=7288 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:34:09,009 p=7288 u=craig n=ansible | fatal: [192.168.1.99 -> caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-04 22:34:09,010 p=7288 u=craig n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
2023-07-04 22:34:09,010 p=7288 u=craig n=ansible | 192.168.1.99               : ok=9    changed=3    unreachable=1    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-07 22:19:08,096 p=50661 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-07 22:19:08,134 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-07-07 22:19:09,300 p=50661 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:19:09,318 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-07 22:19:09,355 p=50661 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:19:09,367 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-07-07 22:19:09,716 p=50661 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:19:09,729 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-07-07 22:19:10,457 p=50661 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:19:10,473 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-07 22:19:18,841 p=50661 u=craig n=ansible | changed: [192.168.1.99]
2023-07-07 22:19:18,857 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] **************************************
2023-07-07 22:19:24,301 p=50661 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-07 22:19:24,301 p=50661 u=craig n=ansible | changed: [192.168.1.99]
2023-07-07 22:19:24,319 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ********************************************************
2023-07-07 22:19:24,349 p=50661 u=craig n=ansible | changed: [192.168.1.99]
2023-07-07 22:19:24,360 p=50661 u=craig n=ansible | TASK [Update inventory name=add_host] **********************************************************************************************************************************************************************
2023-07-07 22:19:24,449 p=50661 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-07 22:19:24,693 p=50661 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-07 22:19:24,714 p=50661 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-07 22:19:24,728 p=50661 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-07 22:19:24,750 p=50661 u=craig n=ansible | TASK [pm_create_lxc : Wait for port 22 to become open on the host host={{ machine_name }}, port=22, state=started, sleep=5, timeout=300] *******************************************************************
2023-07-07 22:22:13,881 p=50661 u=craig n=ansible |  [ERROR]: User interrupted execution

2023-07-07 22:22:17,139 p=51192 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-07 22:22:17,176 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-07-07 22:22:18,117 p=51192 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:22:18,134 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-07 22:22:18,166 p=51192 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:22:18,177 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-07-07 22:22:18,542 p=51192 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:22:18,556 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-07-07 22:22:19,299 p=51192 u=craig n=ansible | ok: [192.168.1.99]
2023-07-07 22:22:19,312 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-07 22:22:35,641 p=51192 u=craig n=ansible | changed: [192.168.1.99]
2023-07-07 22:22:35,658 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] **************************************
2023-07-07 22:22:40,143 p=51192 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-07 22:22:40,143 p=51192 u=craig n=ansible | changed: [192.168.1.99]
2023-07-07 22:22:40,157 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ********************************************************
2023-07-07 22:22:40,186 p=51192 u=craig n=ansible | changed: [192.168.1.99]
2023-07-07 22:22:40,199 p=51192 u=craig n=ansible | TASK [Update inventory name=add_host] **********************************************************************************************************************************************************************
2023-07-07 22:22:40,296 p=51192 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-07 22:22:40,520 p=51192 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-07 22:22:40,541 p=51192 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-07 22:22:40,556 p=51192 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-07 22:22:40,588 p=51192 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-07 22:22:40,818 p=51192 u=craig n=ansible | fatal: [192.168.1.99 -> caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-07 22:22:40,819 p=51192 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-07 22:22:40,819 p=51192 u=craig n=ansible | 192.168.1.99               : ok=8    changed=3    unreachable=1    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-12 21:10:53,923 p=34554 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-12 21:10:53,961 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-07-12 21:10:55,461 p=34554 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:10:55,479 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-12 21:10:55,516 p=34554 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:10:55,527 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-07-12 21:10:55,881 p=34554 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:10:55,894 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-07-12 21:10:56,688 p=34554 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:10:56,705 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-12 21:10:57,160 p=34554 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:10:57,177 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] **************************************
2023-07-12 21:10:57,562 p=34554 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-12 21:10:57,562 p=34554 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:10:57,580 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ********************************************************
2023-07-12 21:10:57,607 p=34554 u=craig n=ansible | changed: [192.168.1.99]
2023-07-12 21:10:57,618 p=34554 u=craig n=ansible | TASK [Update inventory name=add_host] **********************************************************************************************************************************************************************
2023-07-12 21:10:57,702 p=34554 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-12 21:10:57,930 p=34554 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-12 21:10:57,952 p=34554 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-12 21:10:57,965 p=34554 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-12 21:10:57,998 p=34554 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-12 21:10:58,209 p=34554 u=craig n=ansible | fatal: [192.168.1.99 -> caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-12 21:10:58,209 p=34554 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-12 21:10:58,210 p=34554 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-12 21:32:56,070 p=36796 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-12 21:32:56,108 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-07-12 21:32:57,459 p=36796 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:32:57,477 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-12 21:32:57,512 p=36796 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:32:57,523 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-07-12 21:32:57,878 p=36796 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:32:57,892 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-07-12 21:32:58,634 p=36796 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:32:58,646 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-12 21:32:59,105 p=36796 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:32:59,121 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] **************************************
2023-07-12 21:32:59,496 p=36796 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-12 21:32:59,496 p=36796 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:32:59,509 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ********************************************************
2023-07-12 21:32:59,535 p=36796 u=craig n=ansible | changed: [192.168.1.99]
2023-07-12 21:32:59,546 p=36796 u=craig n=ansible | TASK [Update inventory name=add_host] **********************************************************************************************************************************************************************
2023-07-12 21:32:59,628 p=36796 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-12 21:32:59,819 p=36796 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-12 21:32:59,841 p=36796 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-12 21:32:59,855 p=36796 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-12 21:32:59,887 p=36796 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-12 21:33:00,107 p=36796 u=craig n=ansible | fatal: [192.168.1.99 -> caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-12 21:33:00,108 p=36796 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-12 21:33:00,108 p=36796 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-12 21:34:42,260 p=37182 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-12 21:34:42,298 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Install proxmoxer on main host name=proxmoxer] ***************************************************************************************************************************************
2023-07-12 21:34:43,649 p=37182 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:34:43,666 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-12 21:34:43,698 p=37182 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:34:43,710 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] *****************************************************************
2023-07-12 21:34:44,061 p=37182 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:34:44,074 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ***************************************************
2023-07-12 21:34:44,815 p=37182 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:34:44,832 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-12 21:34:45,274 p=37182 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:34:45,290 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] **************************************
2023-07-12 21:34:45,656 p=37182 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-12 21:34:45,656 p=37182 u=craig n=ansible | ok: [192.168.1.99]
2023-07-12 21:34:45,673 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ********************************************************
2023-07-12 21:34:45,701 p=37182 u=craig n=ansible | changed: [192.168.1.99]
2023-07-12 21:34:45,713 p=37182 u=craig n=ansible | TASK [Update inventory name=add_host] **********************************************************************************************************************************************************************
2023-07-12 21:34:45,795 p=37182 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-12 21:34:45,976 p=37182 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-12 21:34:45,998 p=37182 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-12 21:34:46,012 p=37182 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-12 21:34:46,045 p=37182 u=craig n=ansible | TASK [pm_create_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-12 21:34:46,258 p=37182 u=craig n=ansible | fatal: [192.168.1.99 -> caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-12 21:34:46,259 p=37182 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-12 21:34:46,259 p=37182 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=1    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-23 13:53:13,717 p=55283 u=craig n=ansible | {
    "_meta": {
        "hostvars": {
            "192.158.1.97": {
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "root"
            },
            "192.168.1.99": {
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "root"
            },
            "arnold": {
                "ansible_become": "yes",
                "ansible_host": "192.168.1.67",
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "stantonius"
            },
            "homer": {
                "ansible_become": "yes",
                "ansible_host": "192.168.1.13",
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "stantonius"
            },
            "portainer-swarm-agent": {
                "ansible_become": "yes",
                "ansible_host": "192.168.1.9",
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "stantonius"
            },
            "portainer-swarm-master": {
                "ansible_become": "yes",
                "ansible_host": "192.168.1.13",
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "stantonius"
            },
            "tailscale-homelab": {
                "ansible_become": "yes",
                "ansible_host": "192.168.1.88",
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "stantonius"
            },
            "unbound-dns": {
                "ansible_become": "yes",
                "ansible_host": "192.168.1.8",
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "stantonius"
            },
            "vscode": {
                "ansible_become": "yes",
                "ansible_host": "192.168.1.112",
                "ansible_ssh_private_key_file": "~/.ssh/proxmox_rsa",
                "ansible_user": "stantonius"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "proxmox_nodes",
            "lxc",
            "vm"
        ]
    },
    "bigprox": {
        "hosts": [
            "192.168.1.99"
        ]
    },
    "lxc": {
        "hosts": [
            "tailscale-homelab",
            "unbound-dns",
            "vscode",
            "portainer-swarm-agent",
            "portainer-swarm-master",
            "homer"
        ]
    },
    "miniprox": {
        "hosts": [
            "192.158.1.97"
        ]
    },
    "proxmox_nodes": {
        "children": [
            "bigprox",
            "miniprox"
        ]
    },
    "vm": {
        "hosts": [
            "arnold"
        ]
    }
}
2023-07-23 14:14:44,480 p=57753 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:14:44,511 p=57753 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:14:45,751 p=57753 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:14:45,768 p=57753 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:14:45,805 p=57753 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:14:45,816 p=57753 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:14:46,134 p=57753 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:14:46,144 p=57753 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:14:46,838 p=57753 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:14:46,848 p=57753 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:14:47,264 p=57753 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:14:47,280 p=57753 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:14:47,647 p=57753 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:14:47,647 p=57753 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:14:47,665 p=57753 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:14:47,694 p=57753 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:14:47,704 p=57753 u=craig n=ansible | TASK [Update inventory name=add_host] **********************************************************************************************************************************************************************
2023-07-23 14:14:47,763 p=57753 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:14:47,913 p=57753 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-23 14:14:47,928 p=57753 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-23 14:14:47,940 p=57753 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-23 14:14:47,997 p=57753 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:14:48,006 p=57753 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:14:58,036 p=57753 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:14:58,037 p=57753 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:14:58,037 p=57753 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-23 14:14:58,038 p=57753 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:18:17,766 p=58791 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:18:17,792 p=58791 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:18:18,956 p=58791 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:18:18,973 p=58791 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:18:19,010 p=58791 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:18:19,019 p=58791 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:18:19,343 p=58791 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:18:19,357 p=58791 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:18:20,059 p=58791 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:18:20,074 p=58791 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:18:20,495 p=58791 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:18:20,512 p=58791 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:18:20,870 p=58791 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:18:20,870 p=58791 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:18:20,887 p=58791 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:18:20,915 p=58791 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:18:20,925 p=58791 u=craig n=ansible | TASK [Update inventory name=add_host] **********************************************************************************************************************************************************************
2023-07-23 14:18:20,984 p=58791 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:18:21,116 p=58791 u=craig n=ansible | fatal: [192.168.1.99 -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-23 14:18:21,130 p=58791 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-23 14:18:21,142 p=58791 u=craig n=ansible | ok: [192.168.1.99 -> localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-23 14:18:21,199 p=58791 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:18:21,208 p=58791 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:18:31,240 p=58791 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:18:31,243 p=58791 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:18:31,243 p=58791 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-23 14:18:31,243 p=58791 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:19:52,428 p=59077 u=craig n=ansible | ERROR! the role 'update_inventory' was not found in /Users/craig/Projects/homelab/ansible/playbooks/caddy_build/roles:/Users/craig/Projects/homelab/ansible/roles:/Users/craig/Projects/homelab/ansible/playbooks/caddy_build

The error appears to be in '/Users/craig/Projects/homelab/ansible/playbooks/caddy_build/caddy.yaml': line 33, column 7, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

  roles:
    - update_inventory
      ^ here

2023-07-23 14:20:35,538 p=59196 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:20:35,565 p=59196 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:20:36,655 p=59196 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:20:36,673 p=59196 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:20:36,706 p=59196 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:20:36,715 p=59196 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:20:37,032 p=59196 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:20:37,045 p=59196 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:20:37,769 p=59196 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:20:37,785 p=59196 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:20:38,184 p=59196 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:20:38,201 p=59196 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:20:38,560 p=59196 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:20:38,561 p=59196 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:20:38,578 p=59196 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:20:38,606 p=59196 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:20:38,645 p=59196 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:20:38,648 p=59196 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:20:40,096 p=59196 u=craig n=ansible | ok: [localhost]
2023-07-23 14:20:40,106 p=59196 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:20:40,127 p=59196 u=craig n=ansible | fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: {{ machine_name }}: 'machine_name' is undefined. 'machine_name' is undefined. {{ machine_name }}: 'machine_name' is undefined. 'machine_name' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/add_host/tasks/main.yaml': line 3, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n- block:\n    - name: Add new host to the specified group in inventory file\n      ^ here\n"}
2023-07-23 14:20:40,132 p=59196 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-23 14:20:40,144 p=59196 u=craig n=ansible | ok: [localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-23 14:20:40,173 p=59196 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:20:40,182 p=59196 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:20:50,212 p=59196 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:20:50,214 p=59196 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:20:50,214 p=59196 u=craig n=ansible | 192.168.1.99               : ok=7    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:20:50,214 p=59196 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:20:50,214 p=59196 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-23 14:23:20,222 p=59572 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:23:20,248 p=59572 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:23:21,347 p=59572 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:23:21,365 p=59572 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:23:21,408 p=59572 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:23:21,418 p=59572 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:23:21,751 p=59572 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:23:21,765 p=59572 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:23:22,481 p=59572 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:23:22,496 p=59572 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:23:22,890 p=59572 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:23:22,906 p=59572 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:23:23,257 p=59572 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:23:23,257 p=59572 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:23:23,275 p=59572 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:23:23,304 p=59572 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:23:23,321 p=59572 u=craig n=ansible | TASK [Set facts for inventory host_name_fact={{ machine_name }}, host_ip_fact={{ machine_ip | regex_replace('/.*', '') }}] *********************************************************************************
2023-07-23 14:23:23,342 p=59572 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:23:23,371 p=59572 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:23:23,374 p=59572 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:23:24,818 p=59572 u=craig n=ansible | ok: [localhost]
2023-07-23 14:23:24,828 p=59572 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:23:24,842 p=59572 u=craig n=ansible | fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: {{ host_name_fact }}: 'host_name_fact' is undefined. 'host_name_fact' is undefined. {{ host_name_fact }}: 'host_name_fact' is undefined. 'host_name_fact' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/add_host/tasks/main.yaml': line 3, column 7, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n- block:\n    - name: Add new host to the specified group in inventory file\n      ^ here\n"}
2023-07-23 14:23:24,848 p=59572 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-23 14:23:24,865 p=59572 u=craig n=ansible | ok: [localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-23 14:23:24,894 p=59572 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:23:24,903 p=59572 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:23:34,931 p=59572 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:23:34,933 p=59572 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:23:34,933 p=59572 u=craig n=ansible | 192.168.1.99               : ok=8    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:23:34,933 p=59572 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:23:34,933 p=59572 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-23 14:26:09,358 p=59954 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:26:09,385 p=59954 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:26:10,611 p=59954 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:26:10,629 p=59954 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:26:10,666 p=59954 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:26:10,675 p=59954 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:26:10,994 p=59954 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:26:11,009 p=59954 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:26:11,693 p=59954 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:26:11,709 p=59954 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:26:12,109 p=59954 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:26:12,124 p=59954 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:26:12,502 p=59954 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:26:12,502 p=59954 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:26:12,521 p=59954 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:26:12,551 p=59954 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:26:12,591 p=59954 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:26:12,593 p=59954 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:26:13,006 p=59954 u=craig n=ansible | ok: [localhost]
2023-07-23 14:26:13,016 p=59954 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:26:13,214 p=59954 u=craig n=ansible | fatal: [localhost]: FAILED! => {"changed": false, "msg": "Destination /Users/craig/Projects/homelab/ansible/inventory.ini does not exist !", "rc": 257}
2023-07-23 14:26:13,220 p=59954 u=craig n=ansible | TASK [add_host : Log error message msg=Failed to add the new host to the inventory file.] ******************************************************************************************************************
2023-07-23 14:26:13,232 p=59954 u=craig n=ansible | ok: [localhost] => {
    "msg": "Failed to add the new host to the inventory file."
}
2023-07-23 14:26:13,260 p=59954 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:26:13,268 p=59954 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:26:23,295 p=59954 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:26:23,297 p=59954 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:26:23,297 p=59954 u=craig n=ansible | 192.168.1.99               : ok=7    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:26:23,297 p=59954 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:26:23,297 p=59954 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   
2023-07-23 14:27:13,879 p=60200 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:27:13,906 p=60200 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:27:15,063 p=60200 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:27:15,081 p=60200 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:27:15,121 p=60200 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:27:15,130 p=60200 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:27:15,441 p=60200 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:27:15,454 p=60200 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:27:16,149 p=60200 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:27:16,164 p=60200 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:27:16,561 p=60200 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:27:16,577 p=60200 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:27:16,948 p=60200 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:27:16,948 p=60200 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:27:16,965 p=60200 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:27:16,994 p=60200 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:27:17,034 p=60200 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:27:17,037 p=60200 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:27:17,449 p=60200 u=craig n=ansible | ok: [localhost]
2023-07-23 14:27:17,459 p=60200 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:27:17,664 p=60200 u=craig n=ansible | changed: [localhost]
2023-07-23 14:27:17,693 p=60200 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:27:17,701 p=60200 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:27:27,731 p=60200 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:27:27,733 p=60200 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:27:27,733 p=60200 u=craig n=ansible | 192.168.1.99               : ok=7    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:27:27,733 p=60200 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:27:27,733 p=60200 u=craig n=ansible | localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:29:54,696 p=60605 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:29:54,723 p=60605 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:29:55,888 p=60605 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:29:55,907 p=60605 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:29:55,944 p=60605 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:29:55,953 p=60605 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:29:56,293 p=60605 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:29:56,307 p=60605 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:29:57,008 p=60605 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:29:57,024 p=60605 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:29:57,418 p=60605 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:29:57,434 p=60605 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:29:57,787 p=60605 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:29:57,788 p=60605 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:29:57,804 p=60605 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:29:57,833 p=60605 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:29:57,872 p=60605 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:29:57,875 p=60605 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:29:58,300 p=60605 u=craig n=ansible | ok: [localhost]
2023-07-23 14:29:58,309 p=60605 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:29:58,509 p=60605 u=craig n=ansible | changed: [localhost]
2023-07-23 14:29:58,539 p=60605 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:29:58,547 p=60605 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:30:08,575 p=60605 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:30:08,576 p=60605 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:30:08,577 p=60605 u=craig n=ansible | 192.168.1.99               : ok=7    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:30:08,577 p=60605 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:30:08,577 p=60605 u=craig n=ansible | localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:35:05,432 p=61803 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:35:05,458 p=61803 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:35:06,540 p=61803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:35:06,558 p=61803 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:35:06,594 p=61803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:35:06,603 p=61803 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:35:06,921 p=61803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:35:06,934 p=61803 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:35:07,647 p=61803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:35:07,664 p=61803 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:35:19,276 p=61803 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:35:19,295 p=61803 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:35:21,685 p=61803 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:35:21,685 p=61803 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 14:35:21,694 p=61803 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:35:21,734 p=61803 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:35:21,777 p=61803 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:35:21,782 p=61803 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:35:22,233 p=61803 u=craig n=ansible | ok: [localhost]
2023-07-23 14:35:22,242 p=61803 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:35:22,460 p=61803 u=craig n=ansible | ok: [localhost]
2023-07-23 14:35:22,490 p=61803 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:35:22,498 p=61803 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:35:32,527 p=61803 u=craig n=ansible | fatal: [homer]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.1.13 port 22: Operation timed out", "unreachable": true}
2023-07-23 14:35:32,528 p=61803 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:35:32,528 p=61803 u=craig n=ansible | 192.168.1.99               : ok=7    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:35:32,529 p=61803 u=craig n=ansible | homer                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:35:32,529 p=61803 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:36:03,384 p=62079 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:36:03,410 p=62079 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:36:04,295 p=62079 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:36:04,314 p=62079 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:36:04,352 p=62079 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:36:04,360 p=62079 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:36:04,684 p=62079 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:36:04,696 p=62079 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:36:05,412 p=62079 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:36:05,430 p=62079 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:36:05,860 p=62079 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:36:05,878 p=62079 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:36:06,240 p=62079 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:36:06,240 p=62079 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:36:06,258 p=62079 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:36:06,287 p=62079 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:36:06,326 p=62079 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:36:06,330 p=62079 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:36:07,776 p=62079 u=craig n=ansible | ok: [localhost]
2023-07-23 14:36:07,786 p=62079 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:36:08,006 p=62079 u=craig n=ansible | ok: [localhost]
2023-07-23 14:36:08,035 p=62079 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:36:08,044 p=62079 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:36:11,264 p=62079 u=craig n=ansible | fatal: [caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-23 14:36:11,264 p=62079 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:36:11,264 p=62079 u=craig n=ansible | 192.168.1.99               : ok=7    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:36:11,264 p=62079 u=craig n=ansible | caddy                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:36:11,264 p=62079 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:43:30,833 p=62860 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:43:30,864 p=62860 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:43:31,960 p=62860 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:43:31,978 p=62860 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:43:32,013 p=62860 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:43:32,023 p=62860 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 14:43:32,040 p=62860 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 14:43:32,049 p=62860 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 14:43:32,061 p=62860 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 14:43:32,070 p=62860 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:43:32,398 p=62860 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:43:32,411 p=62860 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:43:33,111 p=62860 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:43:33,127 p=62860 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:43:33,524 p=62860 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:43:33,540 p=62860 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:43:33,899 p=62860 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:43:33,899 p=62860 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:43:33,910 p=62860 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:43:33,932 p=62860 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 14:43:33,968 p=62860 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:43:33,971 p=62860 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:43:34,390 p=62860 u=craig n=ansible | ok: [localhost]
2023-07-23 14:43:34,400 p=62860 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:43:34,612 p=62860 u=craig n=ansible | ok: [localhost]
2023-07-23 14:43:34,643 p=62860 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:43:34,651 p=62860 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:43:34,847 p=62860 u=craig n=ansible | fatal: [caddy]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).", "unreachable": true}
2023-07-23 14:43:34,848 p=62860 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:43:34,848 p=62860 u=craig n=ansible | 192.168.1.99               : ok=9    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:43:34,848 p=62860 u=craig n=ansible | caddy                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:43:34,848 p=62860 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:46:49,368 p=63286 u=craig n=ansible | ansible-playbook [core 2.14.4]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11)
  jinja version = 3.1.2
  libyaml = True
2023-07-23 14:46:49,368 p=63286 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-07-23 14:46:49,375 p=63286 u=craig n=ansible | host_list declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 14:46:49,375 p=63286 u=craig n=ansible | script declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 14:46:49,375 p=63286 u=craig n=ansible | auto declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 14:46:49,375 p=63286 u=craig n=ansible | yaml declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 14:46:49,376 p=63286 u=craig n=ansible | Parsed /Users/craig/Projects/homelab/inventory.ini inventory source with ini plugin
2023-07-23 14:46:49,492 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,548 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,561 p=63286 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 14:46:49,564 p=63286 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 14:46:49,572 p=63286 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-07-23 14:46:49,572 p=63286 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-07-23 14:46:49,572 p=63286 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-07-23 14:46:49,572 p=63286 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-07-23 14:46:49,572 p=63286 u=craig n=ansible | 5 plays in ansible/playbooks/caddy_build/caddy.yaml
2023-07-23 14:46:49,577 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,583 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,589 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,589 p=63286 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 14:46:49,602 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,609 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,616 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:49,616 p=63286 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 14:46:49,625 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:49,625 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 14:46:49,883 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b"Warning: Permanently added '192.168.1.99' (ED25519) to the list of known hosts.\r\n")
2023-07-23 14:46:49,883 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:49,885 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514 `" && echo ansible-tmp-1690138009.882216-63289-35968579243514="` echo /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514 `" ) && sleep 0'"'"''
2023-07-23 14:46:49,904 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690138009.882216-63289-35968579243514=/root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514\n', b'')
2023-07-23 14:46:49,991 p=63286 u=craig n=ansible | <192.168.1.99> Attempting python interpreter discovery
2023-07-23 14:46:49,992 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:49,992 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo PLATFORM; uname; echo FOUND; command -v '"'"'"'"'"'"'"'"'python3.11'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.10'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.9'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.8'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.6'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.5'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python3'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/libexec/platform-python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python2.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python'"'"'"'"'"'"'"'"'; echo ENDFOUND && sleep 0'"'"''
2023-07-23 14:46:50,009 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'PLATFORM\nLinux\nFOUND\n/usr/bin/python3.9\n/usr/bin/python3\nENDFOUND\n', b'')
2023-07-23 14:46:50,011 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:50,011 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3.9 && sleep 0'"'"''
2023-07-23 14:46:50,043 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'{"platform_dist_result": [], "osrelease_content": "PRETTY_NAME=\\"Debian GNU/Linux 11 (bullseye)\\"\\nNAME=\\"Debian GNU/Linux\\"\\nVERSION_ID=\\"11\\"\\nVERSION=\\"11 (bullseye)\\"\\nVERSION_CODENAME=bullseye\\nID=debian\\nHOME_URL=\\"https://www.debian.org/\\"\\nSUPPORT_URL=\\"https://www.debian.org/support\\"\\nBUG_REPORT_URL=\\"https://bugs.debian.org/\\"\\n"}\n', b'')
2023-07-23 14:46:50,044 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/pip.py
2023-07-23 14:46:50,044 p=63286 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmp222c0ipy TO /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514/AnsiballZ_pip.py
2023-07-23 14:46:50,044 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 14:46:50,114 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmp222c0ipy /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514/AnsiballZ_pip.py\n', b'')
2023-07-23 14:46:50,115 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:50,115 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514/ /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 14:46:50,132 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:50,132 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:50,133 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 14:46:50,688 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "proxmoxer"], "name": ["proxmoxer"], "version": null, "state": "present", "requirements": null, "virtualenv": null, "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\\n", "stderr": "WARNING: Running pip as the \'root\' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\\n\\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\\n[notice] To update, run: python3 -m pip install --upgrade pip\\n", "invocation": {"module_args": {"name": ["proxmoxer"], "state": "present", "virtualenv_site_packages": false, "virtualenv_command": "virtualenv", "editable": false, "version": null, "requirements": null, "virtualenv": null, "virtualenv_python": null, "extra_args": null, "chdir": null, "executable": null, "umask": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 14:46:50,689 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:50,690 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690138009.882216-63289-35968579243514/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 14:46:50,718 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:50,725 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "cmd": [
        "/usr/bin/python3",
        "-m",
        "pip.__main__",
        "install",
        "proxmoxer"
    ],
    "invocation": {
        "module_args": {
            "chdir": null,
            "editable": false,
            "executable": null,
            "extra_args": null,
            "name": [
                "proxmoxer"
            ],
            "requirements": null,
            "state": "present",
            "umask": null,
            "version": null,
            "virtualenv": null,
            "virtualenv_command": "virtualenv",
            "virtualenv_python": null,
            "virtualenv_site_packages": false
        }
    },
    "name": [
        "proxmoxer"
    ],
    "requirements": null,
    "state": "present",
    "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\n[notice] To update, run: python3 -m pip install --upgrade pip\n",
    "stderr_lines": [
        "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv",
        "",
        "[notice] A new release of pip available: 22.3.1 -> 23.2.1",
        "[notice] To update, run: python3 -m pip install --upgrade pip"
    ],
    "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\n",
    "stdout_lines": [
        "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)"
    ],
    "version": null,
    "virtualenv": null
}
2023-07-23 14:46:50,737 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:50,740 p=63286 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 14:46:50,772 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "lxc_features": [
            "fuse=1"
        ],
        "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
        "lxc_unprivileged": "0",
        "ssh_key_content": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan"
    },
    "changed": false
}
2023-07-23 14:46:50,780 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:50,781 p=63286 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 14:46:50,793 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 14:46:50,802 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:50,803 p=63286 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 14:46:50,816 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 14:46:50,823 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:50,824 p=63286 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 14:46:50,833 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:50,835 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 14:46:50,850 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 14:46:50,850 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:50,852 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698 `" && echo ansible-tmp-1690138010.8500109-63306-199077541692698="` echo /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698 `" ) && sleep 0'"'"''
2023-07-23 14:46:50,871 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690138010.8500109-63306-199077541692698=/root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698\n', b'')
2023-07-23 14:46:50,945 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 14:46:50,945 p=63286 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmp9dvo001a TO /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698/AnsiballZ_file.py
2023-07-23 14:46:50,945 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 14:46:51,008 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmp9dvo001a /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698/AnsiballZ_file.py\n', b'')
2023-07-23 14:46:51,009 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,011 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698/ /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 14:46:51,028 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:51,028 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,030 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 14:46:51,135 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/"}, "after": {"path": "/var/lib/vz/snippets/"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "directory", "size": 4096, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/", "state": "directory", "mode": 448, "recurse": false, "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_original_basename": null, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 14:46:51,135 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,136 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690138010.8500109-63306-199077541692698/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 14:46:51,177 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:51,183 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/"
        },
        "before": {
            "path": "/var/lib/vz/snippets/"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": null,
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "directory",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/",
    "size": 4096,
    "state": "directory",
    "uid": 0
}
2023-07-23 14:46:51,191 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:51,193 p=63286 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 14:46:51,204 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,204 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 14:46:51,221 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 14:46:51,221 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,223 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070 `" && echo ansible-tmp-1690138011.221243-63316-1361235782070="` echo /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070 `" ) && sleep 0'"'"''
2023-07-23 14:46:51,240 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690138011.221243-63316-1361235782070=/root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070\n', b'')
2023-07-23 14:46:51,312 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 14:46:51,312 p=63286 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpqivy81aa TO /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py
2023-07-23 14:46:51,312 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 14:46:51,379 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpqivy81aa /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py\n', b'')
2023-07-23 14:46:51,379 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,381 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/ /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 14:46:51,397 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:51,397 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,399 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 14:46:51,491 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets", "mode": "0700", "isdir": true, "ischr": false, "isblk": false, "isreg": false, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 4096, "inode": 4067824, "dev": 64769, "nlink": 2, "atime": 1669770774.825888, "mtime": 1688521837.7000277, "ctime": 1688521837.7000277, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "mimetype": "inode/directory", "charset": "binary", "version": "3961388135", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 14:46:51,491 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 14:46:51,491 p=63286 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpga732f4m TO /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py
2023-07-23 14:46:51,492 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 14:46:51,549 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpga732f4m /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py\n', b'')
2023-07-23 14:46:51,549 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,552 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/ /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 14:46:51,567 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:51,567 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,569 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 14:46:51,681 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "mode": "0700", "isdir": false, "ischr": false, "isblk": false, "isreg": true, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 902, "inode": 5636589, "dev": 64769, "nlink": 1, "atime": 1690135771.4091015, "mtime": 1688521837.420026, "ctime": 1688521837.7000277, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583", "mimetype": "text/x-shellscript", "charset": "us-ascii", "version": "3326393875", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 14:46:51,681 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 14:46:51,681 p=63286 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpp_qtejrz TO /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_file.py
2023-07-23 14:46:51,681 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 14:46:51,741 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpp_qtejrz /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_file.py\n', b'')
2023-07-23 14:46:51,741 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,742 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/ /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 14:46:51,758 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:51,758 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,758 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 14:46:51,855 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}, "after": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "file", "size": 902, "invocation": {"module_args": {"mode": 448, "dest": "/var/lib/vz/snippets", "_original_basename": "enable_lxc_ssh_hook.sh", "recurse": false, "state": "file", "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 14:46:51,855 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,856 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690138011.221243-63316-1361235782070/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 14:46:51,871 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:51,873 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583",
    "dest": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        },
        "before": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": "enable_lxc_ssh_hook.sh",
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "dest": "/var/lib/vz/snippets",
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "file",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "size": 902,
    "state": "file",
    "uid": 0
}
2023-07-23 14:46:51,881 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:51,882 p=63286 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 14:46:51,897 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,898 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 14:46:51,914 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 14:46:51,914 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:51,914 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787 `" && echo ansible-tmp-1690138011.9137359-63332-143369188357787="` echo /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787 `" ) && sleep 0'"'"''
2023-07-23 14:46:51,931 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690138011.9137359-63332-143369188357787=/root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787\n', b'')
2023-07-23 14:46:51,990 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible_collections/community/general/plugins/modules/proxmox.py
2023-07-23 14:46:51,990 p=63286 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpjaa28e7f TO /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787/AnsiballZ_proxmox.py
2023-07-23 14:46:51,991 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 14:46:52,050 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpjaa28e7f /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787/AnsiballZ_proxmox.py\n', b'')
2023-07-23 14:46:52,051 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,051 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787/ /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 14:46:52,081 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:52,081 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,081 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 14:46:52,270 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "msg": "VM with vmid = 110 is already exists", "invocation": {"module_args": {"vmid": 110, "node": "bigprox", "api_user": "root@pam", "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "api_host": "192.168.1.99", "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst", "storage": "local-lvm", "unprivileged": false, "hookscript": "local:snippets/enable_lxc_ssh_hook.sh", "netif": {"net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"}, "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan", "features": ["fuse=1"], "cores": 1, "cpus": 1, "memory": 512, "disk": "20", "onboot": true, "state": "present", "validate_certs": false, "timeout": 30, "force": false, "purge": false, "proxmox_default_behavior": "no_defaults", "clone_type": "opportunistic", "api_token_id": null, "api_token_secret": null, "pool": null, "swap": null, "mounts": null, "ip_address": null, "cpuunits": null, "nameserver": null, "searchdomain": null, "description": null, "clone": null, "tags": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 14:46:52,271 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,271 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690138011.9137359-63332-143369188357787/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 14:46:52,294 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:52,299 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "invocation": {
        "module_args": {
            "api_host": "192.168.1.99",
            "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "api_token_id": null,
            "api_token_secret": null,
            "api_user": "root@pam",
            "clone": null,
            "clone_type": "opportunistic",
            "cores": 1,
            "cpus": 1,
            "cpuunits": null,
            "description": null,
            "disk": "20",
            "features": [
                "fuse=1"
            ],
            "force": false,
            "hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
            "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "ip_address": null,
            "memory": 512,
            "mounts": null,
            "nameserver": null,
            "netif": {
                "net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"
            },
            "node": "bigprox",
            "onboot": true,
            "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst",
            "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "pool": null,
            "proxmox_default_behavior": "no_defaults",
            "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan",
            "purge": false,
            "searchdomain": null,
            "state": "present",
            "storage": "local-lvm",
            "swap": null,
            "tags": null,
            "timeout": 30,
            "unprivileged": false,
            "validate_certs": false,
            "vmid": 110
        }
    },
    "msg": "VM with vmid = 110 is already exists"
}
2023-07-23 14:46:52,310 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:52,310 p=63286 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 14:46:52,323 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,323 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 14:46:52,341 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 14:46:52,341 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,343 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699 `" && echo ansible-tmp-1690138012.340993-63341-227679710886699="` echo /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699 `" ) && sleep 0'"'"''
2023-07-23 14:46:52,360 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690138012.340993-63341-227679710886699=/root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699\n', b'')
2023-07-23 14:46:52,362 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible_collections/community/general/plugins/modules/proxmox.py
2023-07-23 14:46:52,362 p=63286 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmp8tro8ppn TO /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699/AnsiballZ_proxmox.py
2023-07-23 14:46:52,363 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 14:46:52,427 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmp8tro8ppn /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699/AnsiballZ_proxmox.py\n', b'')
2023-07-23 14:46:52,427 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,429 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699/ /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 14:46:52,447 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:52,447 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,448 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 14:46:52,648 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "msg": "VM 110 is already running", "invocation": {"module_args": {"vmid": 110, "api_user": "root@pam", "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "api_host": "192.168.1.99", "state": "started", "timeout": 90, "validate_certs": false, "storage": "local", "force": false, "purge": false, "proxmox_default_behavior": "no_defaults", "clone_type": "opportunistic", "api_token_id": null, "api_token_secret": null, "node": null, "pool": null, "password": null, "hostname": null, "ostemplate": null, "disk": null, "cores": null, "cpus": null, "memory": null, "swap": null, "netif": null, "mounts": null, "ip_address": null, "onboot": null, "features": null, "cpuunits": null, "nameserver": null, "searchdomain": null, "pubkey": null, "unprivileged": false, "description": null, "hookscript": null, "clone": null, "tags": null}}, "deprecations": [{"msg": "The default value `false` for the parameter \\"unprivileged\\" is deprecated and it will be replaced with `true`", "version": "7.0.0", "collection_name": "community.general"}]}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 14:46:52,648 p=63286 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 14:46:52,649 p=63286 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690138012.340993-63341-227679710886699/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 14:46:52,670 p=63286 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 14:46:52,674 p=63286 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 14:46:52,674 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "invocation": {
        "module_args": {
            "api_host": "192.168.1.99",
            "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "api_token_id": null,
            "api_token_secret": null,
            "api_user": "root@pam",
            "clone": null,
            "clone_type": "opportunistic",
            "cores": null,
            "cpus": null,
            "cpuunits": null,
            "description": null,
            "disk": null,
            "features": null,
            "force": false,
            "hookscript": null,
            "hostname": null,
            "ip_address": null,
            "memory": null,
            "mounts": null,
            "nameserver": null,
            "netif": null,
            "node": null,
            "onboot": null,
            "ostemplate": null,
            "password": null,
            "pool": null,
            "proxmox_default_behavior": "no_defaults",
            "pubkey": null,
            "purge": false,
            "searchdomain": null,
            "state": "started",
            "storage": "local",
            "swap": null,
            "tags": null,
            "timeout": 90,
            "unprivileged": false,
            "validate_certs": false,
            "vmid": 110
        }
    },
    "msg": "VM 110 is already running"
}
2023-07-23 14:46:52,685 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:52,687 p=63286 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 14:46:52,708 p=63286 u=craig n=ansible | creating host via 'add_host': hostname=caddy
2023-07-23 14:46:52,711 p=63286 u=craig n=ansible | ok: [192.168.1.99] => {
    "add_host": {
        "groups": [
            "lxc"
        ],
        "host_name": "caddy",
        "host_vars": {
            "ansible_host": "192.168.1.4"
        }
    },
    "changed": false
}
2023-07-23 14:46:52,719 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:52,726 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:52,733 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:52,739 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:52,746 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:52,748 p=63286 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 14:46:52,752 p=63286 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:46:52,760 p=63286 u=craig n=ansible | <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: craig
2023-07-23 14:46:52,761 p=63286 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'echo ~craig && sleep 0'
2023-07-23 14:46:52,769 p=63286 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /Users/craig/.ansible/tmp `"&& mkdir "` echo /Users/craig/.ansible/tmp/ansible-tmp-1690138012.769482-63350-152042396739303 `" && echo ansible-tmp-1690138012.769482-63350-152042396739303="` echo /Users/craig/.ansible/tmp/ansible-tmp-1690138012.769482-63350-152042396739303 `" ) && sleep 0'
2023-07-23 14:46:52,908 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/setup.py
2023-07-23 14:46:52,909 p=63286 u=craig n=ansible | <127.0.0.1> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmpfhx1g03p TO /Users/craig/.ansible/tmp/ansible-tmp-1690138012.769482-63350-152042396739303/AnsiballZ_setup.py
2023-07-23 14:46:52,909 p=63286 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'chmod u+x /Users/craig/.ansible/tmp/ansible-tmp-1690138012.769482-63350-152042396739303/ /Users/craig/.ansible/tmp/ansible-tmp-1690138012.769482-63350-152042396739303/AnsiballZ_setup.py && sleep 0'
2023-07-23 14:46:52,922 p=63286 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c '/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11 /Users/craig/.ansible/tmp/ansible-tmp-1690138012.769482-63350-152042396739303/AnsiballZ_setup.py && sleep 0'
2023-07-23 14:46:53,157 p=63286 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /Users/craig/.ansible/tmp/ansible-tmp-1690138012.769482-63350-152042396739303/ > /dev/null 2>&1 && sleep 0'
2023-07-23 14:46:53,177 p=63286 u=craig n=ansible | ok: [localhost]
2023-07-23 14:46:53,186 p=63286 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 14:46:53,196 p=63286 u=craig n=ansible | <localhost> ESTABLISH LOCAL CONNECTION FOR USER: craig
2023-07-23 14:46:53,198 p=63286 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'echo ~craig && sleep 0'
2023-07-23 14:46:53,209 p=63286 u=craig n=ansible | <localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /Users/craig/.ansible/tmp `"&& mkdir "` echo /Users/craig/.ansible/tmp/ansible-tmp-1690138013.207805-63383-177939213329776 `" && echo ansible-tmp-1690138013.207805-63383-177939213329776="` echo /Users/craig/.ansible/tmp/ansible-tmp-1690138013.207805-63383-177939213329776 `" ) && sleep 0'
2023-07-23 14:46:53,275 p=63286 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/lineinfile.py
2023-07-23 14:46:53,275 p=63286 u=craig n=ansible | <localhost> PUT /Users/craig/.ansible/tmp/ansible-local-63286q5lh0yep/tmp89qt279r TO /Users/craig/.ansible/tmp/ansible-tmp-1690138013.207805-63383-177939213329776/AnsiballZ_lineinfile.py
2023-07-23 14:46:53,276 p=63286 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'chmod u+x /Users/craig/.ansible/tmp/ansible-tmp-1690138013.207805-63383-177939213329776/ /Users/craig/.ansible/tmp/ansible-tmp-1690138013.207805-63383-177939213329776/AnsiballZ_lineinfile.py && sleep 0'
2023-07-23 14:46:53,288 p=63286 u=craig n=ansible | <localhost> EXEC /bin/sh -c '/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11 /Users/craig/.ansible/tmp/ansible-tmp-1690138013.207805-63383-177939213329776/AnsiballZ_lineinfile.py && sleep 0'
2023-07-23 14:46:53,392 p=63286 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'rm -f -r /Users/craig/.ansible/tmp/ansible-tmp-1690138013.207805-63383-177939213329776/ > /dev/null 2>&1 && sleep 0'
2023-07-23 14:46:53,409 p=63286 u=craig n=ansible | ok: [localhost] => {
    "backup": "",
    "changed": false,
    "diff": [
        {
            "after": "",
            "after_header": "/Users/craig/Projects/homelab/inventory.ini (content)",
            "before": "",
            "before_header": "/Users/craig/Projects/homelab/inventory.ini (content)"
        },
        {
            "after_header": "/Users/craig/Projects/homelab/inventory.ini (file attributes)",
            "before_header": "/Users/craig/Projects/homelab/inventory.ini (file attributes)"
        }
    ],
    "invocation": {
        "module_args": {
            "attributes": null,
            "backrefs": false,
            "backup": false,
            "create": false,
            "firstmatch": false,
            "group": null,
            "insertafter": "^\\[lxc\\]",
            "insertbefore": null,
            "line": "caddy ansible_host=192.168.1.4",
            "mode": null,
            "owner": null,
            "path": "/Users/craig/Projects/homelab/inventory.ini",
            "regexp": null,
            "search_string": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "state": "present",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": ""
}
2023-07-23 14:46:53,425 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:53,430 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:53,436 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:53,437 p=63286 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 14:46:53,445 p=63286 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 14:46:53,446 p=63286 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 14:46:53,455 p=63286 u=craig n=ansible | <192.168.1.4> ESTABLISH SSH CONNECTION FOR USER: stantonius
2023-07-23 14:46:53,457 p=63286 u=craig n=ansible | <192.168.1.4> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="stantonius"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/35ea447758"' 192.168.1.4 '/bin/sh -c '"'"'echo ~stantonius && sleep 0'"'"''
2023-07-23 14:46:53,640 p=63286 u=craig n=ansible | <192.168.1.4> (255, b'', b"Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).\r\n")
2023-07-23 14:46:53,643 p=63286 u=craig n=ansible | fatal: [caddy]: UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).",
    "unreachable": true
}
2023-07-23 14:46:53,644 p=63286 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 14:46:53,644 p=63286 u=craig n=ansible | 192.168.1.99               : ok=9    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:46:53,644 p=63286 u=craig n=ansible | caddy                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 14:46:53,644 p=63286 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 15:04:00,349 p=64840 u=craig n=ansible | ansible-playbook [core 2.14.4]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11)
  jinja version = 3.1.2
  libyaml = True
2023-07-23 15:04:00,349 p=64840 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-07-23 15:04:00,356 p=64840 u=craig n=ansible | host_list declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:04:00,356 p=64840 u=craig n=ansible | script declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:04:00,356 p=64840 u=craig n=ansible | auto declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:04:00,356 p=64840 u=craig n=ansible | yaml declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:04:00,357 p=64840 u=craig n=ansible | Parsed /Users/craig/Projects/homelab/inventory.ini inventory source with ini plugin
2023-07-23 15:04:00,474 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,531 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,545 p=64840 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 15:04:00,548 p=64840 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 15:04:00,556 p=64840 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-07-23 15:04:00,556 p=64840 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-07-23 15:04:00,556 p=64840 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-07-23 15:04:00,556 p=64840 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-07-23 15:04:00,556 p=64840 u=craig n=ansible | 5 plays in ansible/playbooks/caddy_build/caddy.yaml
2023-07-23 15:04:00,562 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,567 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,573 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,573 p=64840 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 15:04:00,586 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,594 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,600 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:00,600 p=64840 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 15:04:00,612 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:00,614 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:04:00,867 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b"Warning: Permanently added '192.168.1.99' (ED25519) to the list of known hosts.\r\n")
2023-07-23 15:04:00,867 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:00,867 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393 `" && echo ansible-tmp-1690139040.866477-64843-176522550695393="` echo /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393 `" ) && sleep 0'"'"''
2023-07-23 15:04:00,888 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139040.866477-64843-176522550695393=/root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393\n', b'')
2023-07-23 15:04:00,972 p=64840 u=craig n=ansible | <192.168.1.99> Attempting python interpreter discovery
2023-07-23 15:04:00,972 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:00,972 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo PLATFORM; uname; echo FOUND; command -v '"'"'"'"'"'"'"'"'python3.11'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.10'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.9'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.8'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.6'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.5'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python3'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/libexec/platform-python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python2.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python'"'"'"'"'"'"'"'"'; echo ENDFOUND && sleep 0'"'"''
2023-07-23 15:04:00,990 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'PLATFORM\nLinux\nFOUND\n/usr/bin/python3.9\n/usr/bin/python3\nENDFOUND\n', b'')
2023-07-23 15:04:00,991 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:00,991 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3.9 && sleep 0'"'"''
2023-07-23 15:04:01,023 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'{"platform_dist_result": [], "osrelease_content": "PRETTY_NAME=\\"Debian GNU/Linux 11 (bullseye)\\"\\nNAME=\\"Debian GNU/Linux\\"\\nVERSION_ID=\\"11\\"\\nVERSION=\\"11 (bullseye)\\"\\nVERSION_CODENAME=bullseye\\nID=debian\\nHOME_URL=\\"https://www.debian.org/\\"\\nSUPPORT_URL=\\"https://www.debian.org/support\\"\\nBUG_REPORT_URL=\\"https://bugs.debian.org/\\"\\n"}\n', b'')
2023-07-23 15:04:01,024 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/pip.py
2023-07-23 15:04:01,025 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmp550epqoc TO /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393/AnsiballZ_pip.py
2023-07-23 15:04:01,025 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:01,095 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmp550epqoc /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393/AnsiballZ_pip.py\n', b'')
2023-07-23 15:04:01,095 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:01,097 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393/ /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 15:04:01,115 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:01,115 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:01,115 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 15:04:01,707 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "proxmoxer"], "name": ["proxmoxer"], "version": null, "state": "present", "requirements": null, "virtualenv": null, "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\\n", "stderr": "WARNING: Running pip as the \'root\' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\\n\\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\\n[notice] To update, run: python3 -m pip install --upgrade pip\\n", "invocation": {"module_args": {"name": ["proxmoxer"], "state": "present", "virtualenv_site_packages": false, "virtualenv_command": "virtualenv", "editable": false, "version": null, "requirements": null, "virtualenv": null, "virtualenv_python": null, "extra_args": null, "chdir": null, "executable": null, "umask": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:01,707 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:01,707 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139040.866477-64843-176522550695393/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:04:01,735 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:01,743 p=64840 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "cmd": [
        "/usr/bin/python3",
        "-m",
        "pip.__main__",
        "install",
        "proxmoxer"
    ],
    "invocation": {
        "module_args": {
            "chdir": null,
            "editable": false,
            "executable": null,
            "extra_args": null,
            "name": [
                "proxmoxer"
            ],
            "requirements": null,
            "state": "present",
            "umask": null,
            "version": null,
            "virtualenv": null,
            "virtualenv_command": "virtualenv",
            "virtualenv_python": null,
            "virtualenv_site_packages": false
        }
    },
    "name": [
        "proxmoxer"
    ],
    "requirements": null,
    "state": "present",
    "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\n[notice] To update, run: python3 -m pip install --upgrade pip\n",
    "stderr_lines": [
        "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv",
        "",
        "[notice] A new release of pip available: 22.3.1 -> 23.2.1",
        "[notice] To update, run: python3 -m pip install --upgrade pip"
    ],
    "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\n",
    "stdout_lines": [
        "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)"
    ],
    "version": null,
    "virtualenv": null
}
2023-07-23 15:04:01,756 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:01,758 p=64840 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 15:04:01,793 p=64840 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "lxc_features": [
            "fuse=1"
        ],
        "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
        "lxc_unprivileged": "0",
        "ssh_key_content": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan"
    },
    "changed": false
}
2023-07-23 15:04:01,801 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:01,802 p=64840 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 15:04:01,814 p=64840 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 15:04:01,821 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:01,822 p=64840 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 15:04:01,837 p=64840 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 15:04:01,845 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:01,845 p=64840 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 15:04:01,855 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:01,856 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:04:01,872 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:04:01,873 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:01,873 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115 `" && echo ansible-tmp-1690139041.872192-64862-216719739026115="` echo /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115 `" ) && sleep 0'"'"''
2023-07-23 15:04:01,889 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139041.872192-64862-216719739026115=/root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115\n', b'')
2023-07-23 15:04:01,964 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 15:04:01,964 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpp3c3o2z5 TO /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115/AnsiballZ_file.py
2023-07-23 15:04:01,964 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:02,032 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpp3c3o2z5 /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115/AnsiballZ_file.py\n', b'')
2023-07-23 15:04:02,032 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,034 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115/ /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:04:02,049 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:02,049 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,052 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:04:02,145 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/"}, "after": {"path": "/var/lib/vz/snippets/"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "directory", "size": 4096, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/", "state": "directory", "mode": 448, "recurse": false, "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_original_basename": null, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:02,145 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,145 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139041.872192-64862-216719739026115/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:04:02,163 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:02,166 p=64840 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/"
        },
        "before": {
            "path": "/var/lib/vz/snippets/"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": null,
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "directory",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/",
    "size": 4096,
    "state": "directory",
    "uid": 0
}
2023-07-23 15:04:02,175 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:02,176 p=64840 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 15:04:02,187 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,189 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:04:02,205 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:04:02,205 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,207 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175 `" && echo ansible-tmp-1690139042.204898-64870-71819437558175="` echo /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175 `" ) && sleep 0'"'"''
2023-07-23 15:04:02,222 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139042.204898-64870-71819437558175=/root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175\n', b'')
2023-07-23 15:04:02,299 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:04:02,299 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmph4fbfm6n TO /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py
2023-07-23 15:04:02,301 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:02,361 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmph4fbfm6n /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py\n', b'')
2023-07-23 15:04:02,362 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,362 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/ /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:02,379 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:02,379 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,379 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:02,477 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets", "mode": "0700", "isdir": true, "ischr": false, "isblk": false, "isreg": false, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 4096, "inode": 4067824, "dev": 64769, "nlink": 2, "atime": 1669770774.825888, "mtime": 1688521837.7000277, "ctime": 1688521837.7000277, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "mimetype": "inode/directory", "charset": "binary", "version": "3961388135", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:02,477 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:04:02,478 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpob1gqylx TO /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py
2023-07-23 15:04:02,478 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:02,549 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpob1gqylx /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py\n', b'')
2023-07-23 15:04:02,550 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,550 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/ /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:02,568 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:02,568 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,570 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:02,664 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "mode": "0700", "isdir": false, "ischr": false, "isblk": false, "isreg": true, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 902, "inode": 5636589, "dev": 64769, "nlink": 1, "atime": 1690135771.4091015, "mtime": 1688521837.420026, "ctime": 1688521837.7000277, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583", "mimetype": "text/x-shellscript", "charset": "us-ascii", "version": "3326393875", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:02,666 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 15:04:02,666 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpgk2pts_w TO /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_file.py
2023-07-23 15:04:02,666 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:02,736 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpgk2pts_w /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_file.py\n', b'')
2023-07-23 15:04:02,737 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,739 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/ /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:04:02,756 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:02,756 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,756 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:04:02,853 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}, "after": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "file", "size": 902, "invocation": {"module_args": {"mode": 448, "dest": "/var/lib/vz/snippets", "_original_basename": "enable_lxc_ssh_hook.sh", "recurse": false, "state": "file", "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:02,853 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,854 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139042.204898-64870-71819437558175/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:04:02,871 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:02,875 p=64840 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583",
    "dest": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        },
        "before": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": "enable_lxc_ssh_hook.sh",
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "dest": "/var/lib/vz/snippets",
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "file",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "size": 902,
    "state": "file",
    "uid": 0
}
2023-07-23 15:04:02,883 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:02,884 p=64840 u=craig n=ansible | TASK [create_lxc : Copy the cloud-init configuration file to snippets directory src=enable_ssh.yaml, dest=/var/lib/vz/snippets, mode=420] ******************************************************************
2023-07-23 15:04:02,894 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,895 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:04:02,909 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:04:02,909 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,911 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533 `" && echo ansible-tmp-1690139042.9092438-64887-161203942558533="` echo /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533 `" ) && sleep 0'"'"''
2023-07-23 15:04:02,927 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139042.9092438-64887-161203942558533=/root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533\n', b'')
2023-07-23 15:04:02,930 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:04:02,930 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpk2t32f79 TO /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py
2023-07-23 15:04:02,930 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:02,988 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpk2t32f79 /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py\n', b'')
2023-07-23 15:04:02,988 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:02,988 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/ /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:03,007 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:03,007 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,007 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:03,096 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets", "mode": "0700", "isdir": true, "ischr": false, "isblk": false, "isreg": false, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 4096, "inode": 4067824, "dev": 64769, "nlink": 2, "atime": 1669770774.825888, "mtime": 1688521837.7000277, "ctime": 1688521837.7000277, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "mimetype": "inode/directory", "charset": "binary", "version": "3961388135", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:03,097 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:04:03,097 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmp8za1euxp TO /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py
2023-07-23 15:04:03,099 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:03,157 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmp8za1euxp /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py\n', b'')
2023-07-23 15:04:03,158 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,160 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/ /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:03,175 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:03,175 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,177 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:04:03,265 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": false}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/enable_ssh.yaml", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:03,266 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/Projects/homelab/ansible/roles/create_lxc/files/enable_ssh.yaml TO /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/source
2023-07-23 15:04:03,266 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:03,331 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/Projects/homelab/ansible/roles/create_lxc/files/enable_ssh.yaml /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/source\n', b'')
2023-07-23 15:04:03,331 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,332 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/ /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/source && sleep 0'"'"''
2023-07-23 15:04:03,348 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:03,435 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/copy.py
2023-07-23 15:04:03,435 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmp2u4o6ifp TO /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_copy.py
2023-07-23 15:04:03,435 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:03,498 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmp2u4o6ifp /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_copy.py\n', b'')
2023-07-23 15:04:03,498 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,499 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/ /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_copy.py && sleep 0'"'"''
2023-07-23 15:04:03,517 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:03,517 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,517 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/AnsiballZ_copy.py && sleep 0'"'"''
2023-07-23 15:04:03,609 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"dest": "/var/lib/vz/snippets/enable_ssh.yaml", "src": "/root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/source", "md5sum": "ceaf86df2ba2e72250e59c66b3066105", "checksum": "60b15faf37ae6aeccb1107ba86d755c3d8fa5c8c", "changed": true, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0644", "state": "file", "size": 272, "invocation": {"module_args": {"src": "/root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/source", "dest": "/var/lib/vz/snippets", "mode": 420, "_original_basename": "enable_ssh.yaml", "follow": false, "checksum": "60b15faf37ae6aeccb1107ba86d755c3d8fa5c8c", "backup": false, "force": true, "unsafe_writes": false, "content": null, "validate": null, "directory_mode": null, "remote_src": null, "local_follow": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:03,610 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,610 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:04:03,629 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:03,632 p=64840 u=craig n=ansible | changed: [192.168.1.99] => {
    "changed": true,
    "checksum": "60b15faf37ae6aeccb1107ba86d755c3d8fa5c8c",
    "dest": "/var/lib/vz/snippets/enable_ssh.yaml",
    "diff": [],
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_original_basename": "enable_ssh.yaml",
            "attributes": null,
            "backup": false,
            "checksum": "60b15faf37ae6aeccb1107ba86d755c3d8fa5c8c",
            "content": null,
            "dest": "/var/lib/vz/snippets",
            "directory_mode": null,
            "follow": false,
            "force": true,
            "group": null,
            "local_follow": null,
            "mode": 420,
            "owner": null,
            "remote_src": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/source",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "md5sum": "ceaf86df2ba2e72250e59c66b3066105",
    "mode": "0644",
    "owner": "root",
    "size": 272,
    "src": "/root/.ansible/tmp/ansible-tmp-1690139042.9092438-64887-161203942558533/source",
    "state": "file",
    "uid": 0
}
2023-07-23 15:04:03,640 p=64840 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:04:03,641 p=64840 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present, cicustom=user=local:snippets/enable_ssh.yaml] ***
2023-07-23 15:04:03,654 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,656 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:04:03,670 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:04:03,670 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,672 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329 `" && echo ansible-tmp-1690139043.6701398-64906-8671246210329="` echo /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329 `" ) && sleep 0'"'"''
2023-07-23 15:04:03,688 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139043.6701398-64906-8671246210329=/root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329\n', b'')
2023-07-23 15:04:03,750 p=64840 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible_collections/community/general/plugins/modules/proxmox.py
2023-07-23 15:04:03,751 p=64840 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpnlw7eb6a TO /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329/AnsiballZ_proxmox.py
2023-07-23 15:04:03,753 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:04:03,814 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-648407ji6fl77/tmpnlw7eb6a /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329/AnsiballZ_proxmox.py\n', b'')
2023-07-23 15:04:03,814 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,814 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329/ /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:04:03,834 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:03,834 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,837 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:04:03,941 p=64840 u=craig n=ansible | <192.168.1.99> (1, b'\r\n{"failed": true, "msg": "Unsupported parameters for (community.general.proxmox) module: cicustom. Supported parameters include: api_host, api_password, api_token_id, api_token_secret, api_user, clone, clone_type, cores, cpus, cpuunits, description, disk, features, force, hookscript, hostname, ip_address, memory, mounts, nameserver, netif, node, onboot, ostemplate, password, pool, proxmox_default_behavior, pubkey, purge, searchdomain, state, storage, swap, tags, timeout, unprivileged, validate_certs, vmid.", "invocation": {"module_args": {"vmid": 110, "node": "bigprox", "api_user": "root@pam", "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "api_host": "192.168.1.99", "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst", "storage": "local-lvm", "unprivileged": false, "hookscript": "local:snippets/enable_lxc_ssh_hook.sh", "netif": {"net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"}, "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan", "features": ["fuse=1"], "cores": 1, "cpus": 1, "memory": 512, "disk": "20", "onboot": true, "state": "present", "cicustom": "user=local:snippets/enable_ssh.yaml", "validate_certs": false, "timeout": 30, "force": false, "purge": false, "proxmox_default_behavior": "no_defaults", "clone_type": "opportunistic", "api_token_id": null, "api_token_secret": null, "pool": null, "swap": null, "mounts": null, "ip_address": null, "cpuunits": null, "nameserver": null, "searchdomain": null, "description": null, "clone": null, "tags": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:04:03,941 p=64840 u=craig n=ansible | <192.168.1.99> Failed to connect to the host via ssh: Shared connection to 192.168.1.99 closed.
2023-07-23 15:04:03,941 p=64840 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:04:03,943 p=64840 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139043.6701398-64906-8671246210329/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:04:03,969 p=64840 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:04:03,973 p=64840 u=craig n=ansible | fatal: [192.168.1.99]: FAILED! => {
    "changed": false,
    "invocation": {
        "module_args": {
            "api_host": "192.168.1.99",
            "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "api_token_id": null,
            "api_token_secret": null,
            "api_user": "root@pam",
            "cicustom": "user=local:snippets/enable_ssh.yaml",
            "clone": null,
            "clone_type": "opportunistic",
            "cores": 1,
            "cpus": 1,
            "cpuunits": null,
            "description": null,
            "disk": "20",
            "features": [
                "fuse=1"
            ],
            "force": false,
            "hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
            "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "ip_address": null,
            "memory": 512,
            "mounts": null,
            "nameserver": null,
            "netif": {
                "net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"
            },
            "node": "bigprox",
            "onboot": true,
            "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst",
            "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "pool": null,
            "proxmox_default_behavior": "no_defaults",
            "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan",
            "purge": false,
            "searchdomain": null,
            "state": "present",
            "storage": "local-lvm",
            "swap": null,
            "tags": null,
            "timeout": 30,
            "unprivileged": false,
            "validate_certs": false,
            "vmid": 110
        }
    },
    "msg": "Unsupported parameters for (community.general.proxmox) module: cicustom. Supported parameters include: api_host, api_password, api_token_id, api_token_secret, api_user, clone, clone_type, cores, cpus, cpuunits, description, disk, features, force, hookscript, hostname, ip_address, memory, mounts, nameserver, netif, node, onboot, ostemplate, password, pool, proxmox_default_behavior, pubkey, purge, searchdomain, state, storage, swap, tags, timeout, unprivileged, validate_certs, vmid."
}
2023-07-23 15:04:03,974 p=64840 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 15:04:03,974 p=64840 u=craig n=ansible | 192.168.1.99               : ok=7    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 15:16:25,292 p=66255 u=craig n=ansible | ansible-playbook [core 2.14.4]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11)
  jinja version = 3.1.2
  libyaml = True
2023-07-23 15:16:25,292 p=66255 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-07-23 15:16:25,298 p=66255 u=craig n=ansible | host_list declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:16:25,298 p=66255 u=craig n=ansible | script declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:16:25,298 p=66255 u=craig n=ansible | auto declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:16:25,298 p=66255 u=craig n=ansible | yaml declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:16:25,299 p=66255 u=craig n=ansible | Parsed /Users/craig/Projects/homelab/inventory.ini inventory source with ini plugin
2023-07-23 15:16:25,419 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,475 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,488 p=66255 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 15:16:25,491 p=66255 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 15:16:25,499 p=66255 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-07-23 15:16:25,499 p=66255 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-07-23 15:16:25,499 p=66255 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-07-23 15:16:25,499 p=66255 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-07-23 15:16:25,499 p=66255 u=craig n=ansible | 5 plays in ansible/playbooks/caddy_build/caddy.yaml
2023-07-23 15:16:25,504 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,510 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,515 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,516 p=66255 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 15:16:25,529 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,536 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,543 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:25,543 p=66255 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 15:16:25,552 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:25,552 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:16:25,802 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b"Warning: Permanently added '192.168.1.99' (ED25519) to the list of known hosts.\r\n")
2023-07-23 15:16:25,802 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:25,802 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524 `" && echo ansible-tmp-1690139785.8014379-66258-43807174341524="` echo /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524 `" ) && sleep 0'"'"''
2023-07-23 15:16:25,821 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139785.8014379-66258-43807174341524=/root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524\n', b'')
2023-07-23 15:16:25,906 p=66255 u=craig n=ansible | <192.168.1.99> Attempting python interpreter discovery
2023-07-23 15:16:25,907 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:25,908 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo PLATFORM; uname; echo FOUND; command -v '"'"'"'"'"'"'"'"'python3.11'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.10'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.9'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.8'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.6'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.5'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python3'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/libexec/platform-python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python2.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python'"'"'"'"'"'"'"'"'; echo ENDFOUND && sleep 0'"'"''
2023-07-23 15:16:25,925 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'PLATFORM\nLinux\nFOUND\n/usr/bin/python3.9\n/usr/bin/python3\nENDFOUND\n', b'')
2023-07-23 15:16:25,926 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:25,926 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3.9 && sleep 0'"'"''
2023-07-23 15:16:25,957 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'{"platform_dist_result": [], "osrelease_content": "PRETTY_NAME=\\"Debian GNU/Linux 11 (bullseye)\\"\\nNAME=\\"Debian GNU/Linux\\"\\nVERSION_ID=\\"11\\"\\nVERSION=\\"11 (bullseye)\\"\\nVERSION_CODENAME=bullseye\\nID=debian\\nHOME_URL=\\"https://www.debian.org/\\"\\nSUPPORT_URL=\\"https://www.debian.org/support\\"\\nBUG_REPORT_URL=\\"https://bugs.debian.org/\\"\\n"}\n', b'')
2023-07-23 15:16:25,958 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/pip.py
2023-07-23 15:16:25,958 p=66255 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpoxx332h4 TO /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524/AnsiballZ_pip.py
2023-07-23 15:16:25,958 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:16:26,033 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpoxx332h4 /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524/AnsiballZ_pip.py\n', b'')
2023-07-23 15:16:26,034 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:26,036 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524/ /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 15:16:26,052 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:26,052 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:26,054 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 15:16:26,668 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "proxmoxer"], "name": ["proxmoxer"], "version": null, "state": "present", "requirements": null, "virtualenv": null, "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\\n", "stderr": "WARNING: Running pip as the \'root\' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\\n\\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\\n[notice] To update, run: python3 -m pip install --upgrade pip\\n", "invocation": {"module_args": {"name": ["proxmoxer"], "state": "present", "virtualenv_site_packages": false, "virtualenv_command": "virtualenv", "editable": false, "version": null, "requirements": null, "virtualenv": null, "virtualenv_python": null, "extra_args": null, "chdir": null, "executable": null, "umask": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:16:26,668 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:26,669 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139785.8014379-66258-43807174341524/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:16:26,694 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:26,701 p=66255 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "cmd": [
        "/usr/bin/python3",
        "-m",
        "pip.__main__",
        "install",
        "proxmoxer"
    ],
    "invocation": {
        "module_args": {
            "chdir": null,
            "editable": false,
            "executable": null,
            "extra_args": null,
            "name": [
                "proxmoxer"
            ],
            "requirements": null,
            "state": "present",
            "umask": null,
            "version": null,
            "virtualenv": null,
            "virtualenv_command": "virtualenv",
            "virtualenv_python": null,
            "virtualenv_site_packages": false
        }
    },
    "name": [
        "proxmoxer"
    ],
    "requirements": null,
    "state": "present",
    "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\n[notice] To update, run: python3 -m pip install --upgrade pip\n",
    "stderr_lines": [
        "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv",
        "",
        "[notice] A new release of pip available: 22.3.1 -> 23.2.1",
        "[notice] To update, run: python3 -m pip install --upgrade pip"
    ],
    "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\n",
    "stdout_lines": [
        "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)"
    ],
    "version": null,
    "virtualenv": null
}
2023-07-23 15:16:26,715 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:26,717 p=66255 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 15:16:26,766 p=66255 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "lxc_features": [
            "fuse=1"
        ],
        "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
        "lxc_unprivileged": "0",
        "ssh_key_content": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan"
    },
    "changed": false
}
2023-07-23 15:16:26,774 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:26,775 p=66255 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 15:16:26,790 p=66255 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 15:16:26,798 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:26,799 p=66255 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 15:16:26,808 p=66255 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 15:16:26,815 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:26,815 p=66255 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 15:16:26,828 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:26,830 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:16:26,844 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:16:26,844 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:26,844 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933 `" && echo ansible-tmp-1690139786.8441222-66276-258354639046933="` echo /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933 `" ) && sleep 0'"'"''
2023-07-23 15:16:26,865 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139786.8441222-66276-258354639046933=/root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933\n', b'')
2023-07-23 15:16:26,937 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 15:16:26,937 p=66255 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpg28usfdd TO /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933/AnsiballZ_file.py
2023-07-23 15:16:26,937 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:16:26,994 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpg28usfdd /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933/AnsiballZ_file.py\n', b'')
2023-07-23 15:16:26,995 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:26,996 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933/ /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:16:27,011 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:27,011 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,012 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:16:27,103 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/"}, "after": {"path": "/var/lib/vz/snippets/"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "directory", "size": 4096, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/", "state": "directory", "mode": 448, "recurse": false, "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_original_basename": null, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:16:27,103 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,104 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139786.8441222-66276-258354639046933/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:16:27,121 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:27,123 p=66255 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/"
        },
        "before": {
            "path": "/var/lib/vz/snippets/"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": null,
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "directory",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/",
    "size": 4096,
    "state": "directory",
    "uid": 0
}
2023-07-23 15:16:27,131 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:27,132 p=66255 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 15:16:27,143 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,143 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:16:27,160 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:16:27,161 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,162 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248 `" && echo ansible-tmp-1690139787.1604931-66285-208714628773248="` echo /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248 `" ) && sleep 0'"'"''
2023-07-23 15:16:27,176 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139787.1604931-66285-208714628773248=/root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248\n', b'')
2023-07-23 15:16:27,246 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:16:27,247 p=66255 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpopgf16xg TO /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py
2023-07-23 15:16:27,248 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:16:27,311 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpopgf16xg /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py\n', b'')
2023-07-23 15:16:27,312 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,312 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/ /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:16:27,330 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:27,331 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,332 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:16:27,425 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets", "mode": "0700", "isdir": true, "ischr": false, "isblk": false, "isreg": false, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 4096, "inode": 4067824, "dev": 64769, "nlink": 2, "atime": 1669770774.825888, "mtime": 1690139043.6633346, "ctime": 1690139043.6633346, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "mimetype": "inode/directory", "charset": "binary", "version": "3961388135", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:16:27,425 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:16:27,426 p=66255 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpq_ltmukj TO /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py
2023-07-23 15:16:27,426 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:16:27,505 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpq_ltmukj /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py\n', b'')
2023-07-23 15:16:27,505 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,506 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/ /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:16:27,523 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:27,523 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,525 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:16:27,617 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "mode": "0700", "isdir": false, "ischr": false, "isblk": false, "isreg": true, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 902, "inode": 5636589, "dev": 64769, "nlink": 1, "atime": 1690135771.4091015, "mtime": 1688521837.420026, "ctime": 1688521837.7000277, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583", "mimetype": "text/x-shellscript", "charset": "us-ascii", "version": "3326393875", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:16:27,618 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 15:16:27,619 p=66255 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpaa1vl_wf TO /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_file.py
2023-07-23 15:16:27,619 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:16:27,686 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpaa1vl_wf /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_file.py\n', b'')
2023-07-23 15:16:27,686 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,688 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/ /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:16:27,703 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:27,703 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,705 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:16:27,800 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}, "after": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "file", "size": 902, "invocation": {"module_args": {"mode": 448, "dest": "/var/lib/vz/snippets", "_original_basename": "enable_lxc_ssh_hook.sh", "recurse": false, "state": "file", "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:16:27,800 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,800 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139787.1604931-66285-208714628773248/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:16:27,817 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:27,819 p=66255 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583",
    "dest": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        },
        "before": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": "enable_lxc_ssh_hook.sh",
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "dest": "/var/lib/vz/snippets",
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "file",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "size": 902,
    "state": "file",
    "uid": 0
}
2023-07-23 15:16:27,827 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:27,828 p=66255 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 15:16:27,840 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,842 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:16:27,857 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:16:27,857 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,859 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167 `" && echo ansible-tmp-1690139787.857058-66301-103910589216167="` echo /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167 `" ) && sleep 0'"'"''
2023-07-23 15:16:27,874 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139787.857058-66301-103910589216167=/root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167\n', b'')
2023-07-23 15:16:27,934 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible_collections/community/general/plugins/modules/proxmox.py
2023-07-23 15:16:27,935 p=66255 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmp1wmqcca6 TO /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167/AnsiballZ_proxmox.py
2023-07-23 15:16:27,935 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:16:27,995 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmp1wmqcca6 /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167/AnsiballZ_proxmox.py\n', b'')
2023-07-23 15:16:27,996 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:27,996 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167/ /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:16:28,015 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:28,015 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:28,017 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:16:40,101 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": true, "msg": "Deployed VM 110 from template local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst", "invocation": {"module_args": {"vmid": 110, "node": "bigprox", "api_user": "root@pam", "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "api_host": "192.168.1.99", "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst", "storage": "local-lvm", "unprivileged": false, "hookscript": "local:snippets/enable_lxc_ssh_hook.sh", "netif": {"net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"}, "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan", "features": ["fuse=1"], "cores": 1, "cpus": 1, "memory": 512, "disk": "20", "onboot": true, "state": "present", "validate_certs": false, "timeout": 30, "force": false, "purge": false, "proxmox_default_behavior": "no_defaults", "clone_type": "opportunistic", "api_token_id": null, "api_token_secret": null, "pool": null, "swap": null, "mounts": null, "ip_address": null, "cpuunits": null, "nameserver": null, "searchdomain": null, "description": null, "clone": null, "tags": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:16:40,102 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:40,102 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139787.857058-66301-103910589216167/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:16:40,130 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:40,135 p=66255 u=craig n=ansible | changed: [192.168.1.99] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "api_host": "192.168.1.99",
            "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "api_token_id": null,
            "api_token_secret": null,
            "api_user": "root@pam",
            "clone": null,
            "clone_type": "opportunistic",
            "cores": 1,
            "cpus": 1,
            "cpuunits": null,
            "description": null,
            "disk": "20",
            "features": [
                "fuse=1"
            ],
            "force": false,
            "hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
            "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "ip_address": null,
            "memory": 512,
            "mounts": null,
            "nameserver": null,
            "netif": {
                "net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"
            },
            "node": "bigprox",
            "onboot": true,
            "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst",
            "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "pool": null,
            "proxmox_default_behavior": "no_defaults",
            "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan",
            "purge": false,
            "searchdomain": null,
            "state": "present",
            "storage": "local-lvm",
            "swap": null,
            "tags": null,
            "timeout": 30,
            "unprivileged": false,
            "validate_certs": false,
            "vmid": 110
        }
    },
    "msg": "Deployed VM 110 from template local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst"
}
2023-07-23 15:16:40,148 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:40,149 p=66255 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 15:16:40,165 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:40,168 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:16:40,185 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:16:40,190 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:40,190 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620 `" && echo ansible-tmp-1690139800.1849742-66323-199737565659620="` echo /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620 `" ) && sleep 0'"'"''
2023-07-23 15:16:40,203 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690139800.1849742-66323-199737565659620=/root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620\n', b'')
2023-07-23 15:16:40,205 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible_collections/community/general/plugins/modules/proxmox.py
2023-07-23 15:16:40,205 p=66255 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmp49rqsl9u TO /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620/AnsiballZ_proxmox.py
2023-07-23 15:16:40,205 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:16:40,270 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmp49rqsl9u /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620/AnsiballZ_proxmox.py\n', b'')
2023-07-23 15:16:40,270 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:40,271 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620/ /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:16:40,288 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:40,288 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:40,290 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:16:44,586 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": true, "msg": "VM 110 started", "invocation": {"module_args": {"vmid": 110, "api_user": "root@pam", "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "api_host": "192.168.1.99", "state": "started", "timeout": 90, "validate_certs": false, "storage": "local", "force": false, "purge": false, "proxmox_default_behavior": "no_defaults", "clone_type": "opportunistic", "api_token_id": null, "api_token_secret": null, "node": null, "pool": null, "password": null, "hostname": null, "ostemplate": null, "disk": null, "cores": null, "cpus": null, "memory": null, "swap": null, "netif": null, "mounts": null, "ip_address": null, "onboot": null, "features": null, "cpuunits": null, "nameserver": null, "searchdomain": null, "pubkey": null, "unprivileged": false, "description": null, "hookscript": null, "clone": null, "tags": null}}, "deprecations": [{"msg": "The default value `false` for the parameter \\"unprivileged\\" is deprecated and it will be replaced with `true`", "version": "7.0.0", "collection_name": "community.general"}]}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:16:44,586 p=66255 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:16:44,587 p=66255 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690139800.1849742-66323-199737565659620/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:16:44,618 p=66255 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:16:44,622 p=66255 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 15:16:44,623 p=66255 u=craig n=ansible | changed: [192.168.1.99] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "api_host": "192.168.1.99",
            "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "api_token_id": null,
            "api_token_secret": null,
            "api_user": "root@pam",
            "clone": null,
            "clone_type": "opportunistic",
            "cores": null,
            "cpus": null,
            "cpuunits": null,
            "description": null,
            "disk": null,
            "features": null,
            "force": false,
            "hookscript": null,
            "hostname": null,
            "ip_address": null,
            "memory": null,
            "mounts": null,
            "nameserver": null,
            "netif": null,
            "node": null,
            "onboot": null,
            "ostemplate": null,
            "password": null,
            "pool": null,
            "proxmox_default_behavior": "no_defaults",
            "pubkey": null,
            "purge": false,
            "searchdomain": null,
            "state": "started",
            "storage": "local",
            "swap": null,
            "tags": null,
            "timeout": 90,
            "unprivileged": false,
            "validate_certs": false,
            "vmid": 110
        }
    },
    "msg": "VM 110 started"
}
2023-07-23 15:16:44,634 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:44,636 p=66255 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 15:16:44,664 p=66255 u=craig n=ansible | creating host via 'add_host': hostname=caddy
2023-07-23 15:16:44,667 p=66255 u=craig n=ansible | ok: [192.168.1.99] => {
    "add_host": {
        "groups": [
            "lxc"
        ],
        "host_name": "caddy",
        "host_vars": {
            "ansible_host": "192.168.1.4"
        }
    },
    "changed": false
}
2023-07-23 15:16:44,675 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:44,683 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:44,689 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:44,696 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:44,703 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:44,705 p=66255 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 15:16:44,708 p=66255 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 15:16:44,717 p=66255 u=craig n=ansible | <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: craig
2023-07-23 15:16:44,718 p=66255 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'echo ~craig && sleep 0'
2023-07-23 15:16:44,731 p=66255 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /Users/craig/.ansible/tmp `"&& mkdir "` echo /Users/craig/.ansible/tmp/ansible-tmp-1690139804.7312598-66337-279317779457676 `" && echo ansible-tmp-1690139804.7312598-66337-279317779457676="` echo /Users/craig/.ansible/tmp/ansible-tmp-1690139804.7312598-66337-279317779457676 `" ) && sleep 0'
2023-07-23 15:16:44,896 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/setup.py
2023-07-23 15:16:44,896 p=66255 u=craig n=ansible | <127.0.0.1> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpqkim1e6c TO /Users/craig/.ansible/tmp/ansible-tmp-1690139804.7312598-66337-279317779457676/AnsiballZ_setup.py
2023-07-23 15:16:44,897 p=66255 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'chmod u+x /Users/craig/.ansible/tmp/ansible-tmp-1690139804.7312598-66337-279317779457676/ /Users/craig/.ansible/tmp/ansible-tmp-1690139804.7312598-66337-279317779457676/AnsiballZ_setup.py && sleep 0'
2023-07-23 15:16:44,911 p=66255 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c '/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11 /Users/craig/.ansible/tmp/ansible-tmp-1690139804.7312598-66337-279317779457676/AnsiballZ_setup.py && sleep 0'
2023-07-23 15:16:45,176 p=66255 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /Users/craig/.ansible/tmp/ansible-tmp-1690139804.7312598-66337-279317779457676/ > /dev/null 2>&1 && sleep 0'
2023-07-23 15:16:45,197 p=66255 u=craig n=ansible | ok: [localhost]
2023-07-23 15:16:45,205 p=66255 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 15:16:45,214 p=66255 u=craig n=ansible | <localhost> ESTABLISH LOCAL CONNECTION FOR USER: craig
2023-07-23 15:16:45,215 p=66255 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'echo ~craig && sleep 0'
2023-07-23 15:16:45,226 p=66255 u=craig n=ansible | <localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /Users/craig/.ansible/tmp `"&& mkdir "` echo /Users/craig/.ansible/tmp/ansible-tmp-1690139805.225745-66371-36567266647171 `" && echo ansible-tmp-1690139805.225745-66371-36567266647171="` echo /Users/craig/.ansible/tmp/ansible-tmp-1690139805.225745-66371-36567266647171 `" ) && sleep 0'
2023-07-23 15:16:45,313 p=66255 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/lineinfile.py
2023-07-23 15:16:45,313 p=66255 u=craig n=ansible | <localhost> PUT /Users/craig/.ansible/tmp/ansible-local-6625553n94zw6/tmpscljtajn TO /Users/craig/.ansible/tmp/ansible-tmp-1690139805.225745-66371-36567266647171/AnsiballZ_lineinfile.py
2023-07-23 15:16:45,314 p=66255 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'chmod u+x /Users/craig/.ansible/tmp/ansible-tmp-1690139805.225745-66371-36567266647171/ /Users/craig/.ansible/tmp/ansible-tmp-1690139805.225745-66371-36567266647171/AnsiballZ_lineinfile.py && sleep 0'
2023-07-23 15:16:45,325 p=66255 u=craig n=ansible | <localhost> EXEC /bin/sh -c '/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11 /Users/craig/.ansible/tmp/ansible-tmp-1690139805.225745-66371-36567266647171/AnsiballZ_lineinfile.py && sleep 0'
2023-07-23 15:16:45,428 p=66255 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'rm -f -r /Users/craig/.ansible/tmp/ansible-tmp-1690139805.225745-66371-36567266647171/ > /dev/null 2>&1 && sleep 0'
2023-07-23 15:16:45,443 p=66255 u=craig n=ansible | ok: [localhost] => {
    "backup": "",
    "changed": false,
    "diff": [
        {
            "after": "",
            "after_header": "/Users/craig/Projects/homelab/inventory.ini (content)",
            "before": "",
            "before_header": "/Users/craig/Projects/homelab/inventory.ini (content)"
        },
        {
            "after_header": "/Users/craig/Projects/homelab/inventory.ini (file attributes)",
            "before_header": "/Users/craig/Projects/homelab/inventory.ini (file attributes)"
        }
    ],
    "invocation": {
        "module_args": {
            "attributes": null,
            "backrefs": false,
            "backup": false,
            "create": false,
            "firstmatch": false,
            "group": null,
            "insertafter": "^\\[lxc\\]",
            "insertbefore": null,
            "line": "caddy ansible_host=192.168.1.4",
            "mode": null,
            "owner": null,
            "path": "/Users/craig/Projects/homelab/inventory.ini",
            "regexp": null,
            "search_string": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "state": "present",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": ""
}
2023-07-23 15:16:45,460 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:45,465 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:45,471 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:45,472 p=66255 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 15:16:45,480 p=66255 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:16:45,483 p=66255 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 15:16:45,491 p=66255 u=craig n=ansible | <192.168.1.4> ESTABLISH SSH CONNECTION FOR USER: stantonius
2023-07-23 15:16:45,491 p=66255 u=craig n=ansible | <192.168.1.4> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="stantonius"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/35ea447758"' 192.168.1.4 '/bin/sh -c '"'"'echo ~stantonius && sleep 0'"'"''
2023-07-23 15:16:45,696 p=66255 u=craig n=ansible | <192.168.1.4> (255, b'', b"Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).\r\n")
2023-07-23 15:16:45,699 p=66255 u=craig n=ansible | fatal: [caddy]: UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).",
    "unreachable": true
}
2023-07-23 15:16:45,700 p=66255 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 15:16:45,700 p=66255 u=craig n=ansible | 192.168.1.99               : ok=9    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 15:16:45,700 p=66255 u=craig n=ansible | caddy                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 15:16:45,700 p=66255 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 15:23:13,798 p=67016 u=craig n=ansible | ansible-playbook [core 2.14.4]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11)
  jinja version = 3.1.2
  libyaml = True
2023-07-23 15:23:13,798 p=67016 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-07-23 15:23:13,804 p=67016 u=craig n=ansible | host_list declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:23:13,805 p=67016 u=craig n=ansible | script declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:23:13,805 p=67016 u=craig n=ansible | auto declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:23:13,805 p=67016 u=craig n=ansible | yaml declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:23:13,806 p=67016 u=craig n=ansible | Parsed /Users/craig/Projects/homelab/inventory.ini inventory source with ini plugin
2023-07-23 15:23:13,920 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:13,979 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:13,992 p=67016 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 15:23:13,994 p=67016 u=craig n=ansible | redirecting (type: modules) ansible.builtin.docker_compose to community.docker.docker_compose
2023-07-23 15:23:14,002 p=67016 u=craig n=ansible | Skipping callback 'default', as we already have a stdout callback.
2023-07-23 15:23:14,002 p=67016 u=craig n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2023-07-23 15:23:14,002 p=67016 u=craig n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2023-07-23 15:23:14,002 p=67016 u=craig n=ansible | PLAYBOOK: caddy.yaml ***************************************************************************************************************************************************************************************
2023-07-23 15:23:14,003 p=67016 u=craig n=ansible | 5 plays in ansible/playbooks/caddy_build/caddy.yaml
2023-07-23 15:23:14,008 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:14,013 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:14,019 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:14,019 p=67016 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 15:23:14,032 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:14,039 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:14,046 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:14,046 p=67016 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 15:23:14,055 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:14,055 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:23:14,319 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b"Warning: Permanently added '192.168.1.99' (ED25519) to the list of known hosts.\r\n")
2023-07-23 15:23:14,319 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:14,320 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746 `" && echo ansible-tmp-1690140194.3187578-67020-242690097051746="` echo /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746 `" ) && sleep 0'"'"''
2023-07-23 15:23:14,341 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690140194.3187578-67020-242690097051746=/root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746\n', b'')
2023-07-23 15:23:14,426 p=67016 u=craig n=ansible | <192.168.1.99> Attempting python interpreter discovery
2023-07-23 15:23:14,426 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:14,428 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo PLATFORM; uname; echo FOUND; command -v '"'"'"'"'"'"'"'"'python3.11'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.10'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.9'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.8'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.6'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.5'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python3'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/libexec/platform-python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python2.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python'"'"'"'"'"'"'"'"'; echo ENDFOUND && sleep 0'"'"''
2023-07-23 15:23:14,446 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'PLATFORM\nLinux\nFOUND\n/usr/bin/python3.9\n/usr/bin/python3\nENDFOUND\n', b'')
2023-07-23 15:23:14,447 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:14,447 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3.9 && sleep 0'"'"''
2023-07-23 15:23:14,480 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'{"platform_dist_result": [], "osrelease_content": "PRETTY_NAME=\\"Debian GNU/Linux 11 (bullseye)\\"\\nNAME=\\"Debian GNU/Linux\\"\\nVERSION_ID=\\"11\\"\\nVERSION=\\"11 (bullseye)\\"\\nVERSION_CODENAME=bullseye\\nID=debian\\nHOME_URL=\\"https://www.debian.org/\\"\\nSUPPORT_URL=\\"https://www.debian.org/support\\"\\nBUG_REPORT_URL=\\"https://bugs.debian.org/\\"\\n"}\n', b'')
2023-07-23 15:23:14,480 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/pip.py
2023-07-23 15:23:14,481 p=67016 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmp37kfketl TO /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746/AnsiballZ_pip.py
2023-07-23 15:23:14,481 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:23:14,550 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmp37kfketl /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746/AnsiballZ_pip.py\n', b'')
2023-07-23 15:23:14,550 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:14,551 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746/ /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 15:23:14,568 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:14,568 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:14,570 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746/AnsiballZ_pip.py && sleep 0'"'"''
2023-07-23 15:23:15,141 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "cmd": ["/usr/bin/python3", "-m", "pip.__main__", "install", "proxmoxer"], "name": ["proxmoxer"], "version": null, "state": "present", "requirements": null, "virtualenv": null, "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\\n", "stderr": "WARNING: Running pip as the \'root\' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\\n\\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\\n[notice] To update, run: python3 -m pip install --upgrade pip\\n", "invocation": {"module_args": {"name": ["proxmoxer"], "state": "present", "virtualenv_site_packages": false, "virtualenv_command": "virtualenv", "editable": false, "version": null, "requirements": null, "virtualenv": null, "virtualenv_python": null, "extra_args": null, "chdir": null, "executable": null, "umask": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:23:15,142 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,142 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690140194.3187578-67020-242690097051746/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:23:15,168 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:15,175 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "cmd": [
        "/usr/bin/python3",
        "-m",
        "pip.__main__",
        "install",
        "proxmoxer"
    ],
    "invocation": {
        "module_args": {
            "chdir": null,
            "editable": false,
            "executable": null,
            "extra_args": null,
            "name": [
                "proxmoxer"
            ],
            "requirements": null,
            "state": "present",
            "umask": null,
            "version": null,
            "virtualenv": null,
            "virtualenv_command": "virtualenv",
            "virtualenv_python": null,
            "virtualenv_site_packages": false
        }
    },
    "name": [
        "proxmoxer"
    ],
    "requirements": null,
    "state": "present",
    "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\n[notice] A new release of pip available: 22.3.1 -> 23.2.1\n[notice] To update, run: python3 -m pip install --upgrade pip\n",
    "stderr_lines": [
        "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv",
        "",
        "[notice] A new release of pip available: 22.3.1 -> 23.2.1",
        "[notice] To update, run: python3 -m pip install --upgrade pip"
    ],
    "stdout": "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)\n",
    "stdout_lines": [
        "Requirement already satisfied: proxmoxer in /usr/local/lib/python3.9/dist-packages (1.3.1)"
    ],
    "version": null,
    "virtualenv": null
}
2023-07-23 15:23:15,188 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:15,190 p=67016 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 15:23:15,223 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "ansible_facts": {
        "lxc_features": [
            "fuse=1"
        ],
        "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
        "lxc_unprivileged": "0",
        "ssh_key_content": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan"
    },
    "changed": false
}
2023-07-23 15:23:15,231 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:15,232 p=67016 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 15:23:15,245 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 15:23:15,253 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:15,253 p=67016 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 15:23:15,265 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 15:23:15,272 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:15,273 p=67016 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 15:23:15,282 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,283 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:23:15,302 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:23:15,302 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,304 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985 `" && echo ansible-tmp-1690140195.3019478-67037-8510145801985="` echo /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985 `" ) && sleep 0'"'"''
2023-07-23 15:23:15,318 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690140195.3019478-67037-8510145801985=/root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985\n', b'')
2023-07-23 15:23:15,393 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 15:23:15,393 p=67016 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpz9_pqzc9 TO /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985/AnsiballZ_file.py
2023-07-23 15:23:15,393 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:23:15,457 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpz9_pqzc9 /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985/AnsiballZ_file.py\n', b'')
2023-07-23 15:23:15,457 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,459 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985/ /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:23:15,476 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:15,476 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,478 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:23:15,573 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/"}, "after": {"path": "/var/lib/vz/snippets/"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "directory", "size": 4096, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/", "state": "directory", "mode": 448, "recurse": false, "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_original_basename": null, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:23:15,573 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,574 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690140195.3019478-67037-8510145801985/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:23:15,591 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:15,594 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/"
        },
        "before": {
            "path": "/var/lib/vz/snippets/"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": null,
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "directory",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/",
    "size": 4096,
    "state": "directory",
    "uid": 0
}
2023-07-23 15:23:15,602 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:15,603 p=67016 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 15:23:15,613 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,615 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:23:15,631 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:23:15,631 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,633 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268 `" && echo ansible-tmp-1690140195.6311638-67045-254760531979268="` echo /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268 `" ) && sleep 0'"'"''
2023-07-23 15:23:15,648 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690140195.6311638-67045-254760531979268=/root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268\n', b'')
2023-07-23 15:23:15,719 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:23:15,719 p=67016 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpm74jrlao TO /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py
2023-07-23 15:23:15,719 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:23:15,782 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpm74jrlao /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py\n', b'')
2023-07-23 15:23:15,782 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,784 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/ /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:23:15,802 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:15,802 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,804 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:23:15,911 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets", "mode": "0700", "isdir": true, "ischr": false, "isblk": false, "isreg": false, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 4096, "inode": 4067824, "dev": 64769, "nlink": 2, "atime": 1669770774.825888, "mtime": 1690139043.6633346, "ctime": 1690139043.6633346, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "mimetype": "inode/directory", "charset": "binary", "version": "3961388135", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:23:15,912 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/stat.py
2023-07-23 15:23:15,912 p=67016 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpbj9xivpv TO /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py
2023-07-23 15:23:15,912 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:23:15,975 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpbj9xivpv /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py\n', b'')
2023-07-23 15:23:15,975 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,975 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/ /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:23:15,992 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:15,993 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:15,995 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_stat.py && sleep 0'"'"''
2023-07-23 15:23:16,088 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "mode": "0700", "isdir": false, "ischr": false, "isblk": false, "isreg": true, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 902, "inode": 5636589, "dev": 64769, "nlink": 1, "atime": 1690135771.4091015, "mtime": 1688521837.420026, "ctime": 1688521837.7000277, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": false, "xgrp": false, "woth": false, "roth": false, "xoth": false, "isuid": false, "isgid": false, "blocks": 8, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583", "mimetype": "text/x-shellscript", "charset": "us-ascii", "version": "3326393875", "attributes": ["extents"], "attr_flags": "e"}, "invocation": {"module_args": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:23:16,089 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/file.py
2023-07-23 15:23:16,089 p=67016 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpzb_kl4ut TO /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_file.py
2023-07-23 15:23:16,091 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:23:16,154 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpzb_kl4ut /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_file.py\n', b'')
2023-07-23 15:23:16,154 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,155 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/ /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:23:16,172 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:16,172 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,174 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/AnsiballZ_file.py && sleep 0'"'"''
2023-07-23 15:23:16,270 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "changed": false, "diff": {"before": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}, "after": {"path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0700", "state": "file", "size": 902, "invocation": {"module_args": {"mode": 448, "dest": "/var/lib/vz/snippets", "_original_basename": "enable_lxc_ssh_hook.sh", "recurse": false, "state": "file", "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh", "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:23:16,271 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,271 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690140195.6311638-67045-254760531979268/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:23:16,289 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:16,292 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "checksum": "fb7924e0f225315d3d8fd3af8b57da9f187a5583",
    "dest": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "diff": {
        "after": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        },
        "before": {
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": "enable_lxc_ssh_hook.sh",
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "dest": "/var/lib/vz/snippets",
            "follow": true,
            "force": false,
            "group": null,
            "mode": 448,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "file",
            "unsafe_writes": false
        }
    },
    "mode": "0700",
    "owner": "root",
    "path": "/var/lib/vz/snippets/enable_lxc_ssh_hook.sh",
    "size": 902,
    "state": "file",
    "uid": 0
}
2023-07-23 15:23:16,299 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:16,300 p=67016 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 15:23:16,312 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,314 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:23:16,329 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:23:16,329 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,332 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285 `" && echo ansible-tmp-1690140196.329203-67063-50953057874285="` echo /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285 `" ) && sleep 0'"'"''
2023-07-23 15:23:16,347 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690140196.329203-67063-50953057874285=/root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285\n', b'')
2023-07-23 15:23:16,408 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible_collections/community/general/plugins/modules/proxmox.py
2023-07-23 15:23:16,408 p=67016 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpa5j1gab_ TO /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285/AnsiballZ_proxmox.py
2023-07-23 15:23:16,410 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:23:16,470 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpa5j1gab_ /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285/AnsiballZ_proxmox.py\n', b'')
2023-07-23 15:23:16,470 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,471 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285/ /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:23:16,489 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:16,489 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,491 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:23:16,670 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "msg": "VM with vmid = 110 is already exists", "invocation": {"module_args": {"vmid": 110, "node": "bigprox", "api_user": "root@pam", "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "api_host": "192.168.1.99", "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst", "storage": "local-lvm", "unprivileged": false, "hookscript": "local:snippets/enable_lxc_ssh_hook.sh", "netif": {"net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"}, "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan", "features": ["fuse=1"], "cores": 1, "cpus": 1, "memory": 512, "disk": "20", "onboot": true, "state": "present", "validate_certs": false, "timeout": 30, "force": false, "purge": false, "proxmox_default_behavior": "no_defaults", "clone_type": "opportunistic", "api_token_id": null, "api_token_secret": null, "pool": null, "swap": null, "mounts": null, "ip_address": null, "cpuunits": null, "nameserver": null, "searchdomain": null, "description": null, "clone": null, "tags": null}}}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:23:16,670 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,671 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690140196.329203-67063-50953057874285/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:23:16,691 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:16,695 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "invocation": {
        "module_args": {
            "api_host": "192.168.1.99",
            "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "api_token_id": null,
            "api_token_secret": null,
            "api_user": "root@pam",
            "clone": null,
            "clone_type": "opportunistic",
            "cores": 1,
            "cpus": 1,
            "cpuunits": null,
            "description": null,
            "disk": "20",
            "features": [
                "fuse=1"
            ],
            "force": false,
            "hookscript": "local:snippets/enable_lxc_ssh_hook.sh",
            "hostname": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "ip_address": null,
            "memory": 512,
            "mounts": null,
            "nameserver": null,
            "netif": {
                "net0": "name=enp6s0,gw=192.168.1.1,ip=192.168.1.4/24,bridge=vmbr0"
            },
            "node": "bigprox",
            "onboot": true,
            "ostemplate": "local:vztmpl/ubuntu-22.04-standard_22.04-1_amd64.tar.zst",
            "password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "pool": null,
            "proxmox_default_behavior": "no_defaults",
            "pubkey": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCTmHa4Db44PQ1CmCwJP9kvaDbzLt1mACaSlT46d1wwHq9OHaEp4uQO7biDeMjN2adeKkc0eoaNapFM+l7NdDZIFBys2ce42kcAhi3UvYBa4sjWORwL1MOXfeBlOne0JbV6hNvSQRuu9GDOiSe5UXH10NAAaVIm/FcEonCaYpBZwcwQDWvq3E6kU8fwfBFyGCUoJz00cQqznJU6UZumdERNu4x6Q0SfTJEmiU50lmo9nggbllKr+FF95fkdd9tmDt+AmYYi27ZXwAawh7yrtULrVdV+ER4hjeB0vdmflhVxLMs1kD2kuxWVKPPWZUKIi6tKrBnqXDAP/YHLyr46Z3vthLk0bC3IrTqOm2u/Pmdp90f/4EXEZljmON2PNH600B9jSME7DisL9jAQPAZpuhkMxEuUOa1KkUF/Vv70c5ePRITT37U9J+W3KZFHCajDHqo4qFMAL8xCRaCeVm7hfHMO3xxzzs8B+4ql12gs0bQtyANk+nq/cpk0IGC7r17yTlq7FYmwMlsyOD2gV7XIjISyu9dYKdxWJ7t++dFC9YWDY13VMDuBUJfxlIXKbZlJwShFr0g+1H+kDag2Oxk235eBAAxZKdPL5UVoG4K7D2yyRVh1tufx0w23QGf9TkMyfgzxn9SywnP7zIcfepIFhRS93BZiAJQV1e7LO3uWx/l8Tw== craig@MBP.lan",
            "purge": false,
            "searchdomain": null,
            "state": "present",
            "storage": "local-lvm",
            "swap": null,
            "tags": null,
            "timeout": 30,
            "unprivileged": false,
            "validate_certs": false,
            "vmid": 110
        }
    },
    "msg": "VM with vmid = 110 is already exists"
}
2023-07-23 15:23:16,705 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:16,706 p=67016 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 15:23:16,718 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,718 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'echo ~root && sleep 0'"'"''
2023-07-23 15:23:16,736 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'/root\n', b'')
2023-07-23 15:23:16,736 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,738 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /root/.ansible/tmp `"&& mkdir "` echo /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769 `" && echo ansible-tmp-1690140196.735979-67071-160713597794769="` echo /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769 `" ) && sleep 0'"'"''
2023-07-23 15:23:16,753 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'ansible-tmp-1690140196.735979-67071-160713597794769=/root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769\n', b'')
2023-07-23 15:23:16,755 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible_collections/community/general/plugins/modules/proxmox.py
2023-07-23 15:23:16,755 p=67016 u=craig n=ansible | <192.168.1.99> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmp5aejj1vx TO /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769/AnsiballZ_proxmox.py
2023-07-23 15:23:16,757 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' '[192.168.1.99]'
2023-07-23 15:23:16,816 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'sftp> put /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmp5aejj1vx /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769/AnsiballZ_proxmox.py\n', b'')
2023-07-23 15:23:16,816 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,816 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'chmod u+x /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769/ /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:23:16,832 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:16,832 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:16,834 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' -tt 192.168.1.99 '/bin/sh -c '"'"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769/AnsiballZ_proxmox.py && sleep 0'"'"''
2023-07-23 15:23:17,023 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'\r\n{"changed": false, "msg": "VM 110 is already running", "invocation": {"module_args": {"vmid": 110, "api_user": "root@pam", "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER", "api_host": "192.168.1.99", "state": "started", "timeout": 90, "validate_certs": false, "storage": "local", "force": false, "purge": false, "proxmox_default_behavior": "no_defaults", "clone_type": "opportunistic", "api_token_id": null, "api_token_secret": null, "node": null, "pool": null, "password": null, "hostname": null, "ostemplate": null, "disk": null, "cores": null, "cpus": null, "memory": null, "swap": null, "netif": null, "mounts": null, "ip_address": null, "onboot": null, "features": null, "cpuunits": null, "nameserver": null, "searchdomain": null, "pubkey": null, "unprivileged": false, "description": null, "hookscript": null, "clone": null, "tags": null}}, "deprecations": [{"msg": "The default value `false` for the parameter \\"unprivileged\\" is deprecated and it will be replaced with `true`", "version": "7.0.0", "collection_name": "community.general"}]}\r\n', b'Shared connection to 192.168.1.99 closed.\r\n')
2023-07-23 15:23:17,023 p=67016 u=craig n=ansible | <192.168.1.99> ESTABLISH SSH CONNECTION FOR USER: root
2023-07-23 15:23:17,023 p=67016 u=craig n=ansible | <192.168.1.99> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="root"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/98e9aa4d1c"' 192.168.1.99 '/bin/sh -c '"'"'rm -f -r /root/.ansible/tmp/ansible-tmp-1690140196.735979-67071-160713597794769/ > /dev/null 2>&1 && sleep 0'"'"''
2023-07-23 15:23:17,045 p=67016 u=craig n=ansible | <192.168.1.99> (0, b'', b'')
2023-07-23 15:23:17,049 p=67016 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 15:23:17,049 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "changed": false,
    "invocation": {
        "module_args": {
            "api_host": "192.168.1.99",
            "api_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "api_token_id": null,
            "api_token_secret": null,
            "api_user": "root@pam",
            "clone": null,
            "clone_type": "opportunistic",
            "cores": null,
            "cpus": null,
            "cpuunits": null,
            "description": null,
            "disk": null,
            "features": null,
            "force": false,
            "hookscript": null,
            "hostname": null,
            "ip_address": null,
            "memory": null,
            "mounts": null,
            "nameserver": null,
            "netif": null,
            "node": null,
            "onboot": null,
            "ostemplate": null,
            "password": null,
            "pool": null,
            "proxmox_default_behavior": "no_defaults",
            "pubkey": null,
            "purge": false,
            "searchdomain": null,
            "state": "started",
            "storage": "local",
            "swap": null,
            "tags": null,
            "timeout": 90,
            "unprivileged": false,
            "validate_certs": false,
            "vmid": 110
        }
    },
    "msg": "VM 110 is already running"
}
2023-07-23 15:23:17,059 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,060 p=67016 u=craig n=ansible | TASK [create_lxc : Add new container to inventory name={{ machine_name }}, groups=lxc, ansible_host={{ machine_ip | regex_replace('/.*', '') }}] ***********************************************************
2023-07-23 15:23:17,079 p=67016 u=craig n=ansible | creating host via 'add_host': hostname=caddy
2023-07-23 15:23:17,082 p=67016 u=craig n=ansible | ok: [192.168.1.99] => {
    "add_host": {
        "groups": [
            "lxc"
        ],
        "host_name": "caddy",
        "host_vars": {
            "ansible_host": "192.168.1.4"
        }
    },
    "changed": false
}
2023-07-23 15:23:17,090 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,097 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,103 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,109 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,116 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,118 p=67016 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 15:23:17,122 p=67016 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 15:23:17,131 p=67016 u=craig n=ansible | <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: craig
2023-07-23 15:23:17,132 p=67016 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'echo ~craig && sleep 0'
2023-07-23 15:23:17,140 p=67016 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /Users/craig/.ansible/tmp `"&& mkdir "` echo /Users/craig/.ansible/tmp/ansible-tmp-1690140197.140349-67081-195474238091253 `" && echo ansible-tmp-1690140197.140349-67081-195474238091253="` echo /Users/craig/.ansible/tmp/ansible-tmp-1690140197.140349-67081-195474238091253 `" ) && sleep 0'
2023-07-23 15:23:17,287 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/setup.py
2023-07-23 15:23:17,287 p=67016 u=craig n=ansible | <127.0.0.1> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpnl7j09b4 TO /Users/craig/.ansible/tmp/ansible-tmp-1690140197.140349-67081-195474238091253/AnsiballZ_setup.py
2023-07-23 15:23:17,287 p=67016 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'chmod u+x /Users/craig/.ansible/tmp/ansible-tmp-1690140197.140349-67081-195474238091253/ /Users/craig/.ansible/tmp/ansible-tmp-1690140197.140349-67081-195474238091253/AnsiballZ_setup.py && sleep 0'
2023-07-23 15:23:17,300 p=67016 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c '/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11 /Users/craig/.ansible/tmp/ansible-tmp-1690140197.140349-67081-195474238091253/AnsiballZ_setup.py && sleep 0'
2023-07-23 15:23:17,535 p=67016 u=craig n=ansible | <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /Users/craig/.ansible/tmp/ansible-tmp-1690140197.140349-67081-195474238091253/ > /dev/null 2>&1 && sleep 0'
2023-07-23 15:23:17,554 p=67016 u=craig n=ansible | ok: [localhost]
2023-07-23 15:23:17,563 p=67016 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], line={{ host_name }} ansible_host={{ host_ip }}, state=present] *******
2023-07-23 15:23:17,572 p=67016 u=craig n=ansible | <localhost> ESTABLISH LOCAL CONNECTION FOR USER: craig
2023-07-23 15:23:17,573 p=67016 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'echo ~craig && sleep 0'
2023-07-23 15:23:17,583 p=67016 u=craig n=ansible | <localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /Users/craig/.ansible/tmp `"&& mkdir "` echo /Users/craig/.ansible/tmp/ansible-tmp-1690140197.583099-67114-210971371146110 `" && echo ansible-tmp-1690140197.583099-67114-210971371146110="` echo /Users/craig/.ansible/tmp/ansible-tmp-1690140197.583099-67114-210971371146110 `" ) && sleep 0'
2023-07-23 15:23:17,652 p=67016 u=craig n=ansible | Using module file /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible/modules/lineinfile.py
2023-07-23 15:23:17,652 p=67016 u=craig n=ansible | <localhost> PUT /Users/craig/.ansible/tmp/ansible-local-67016mqc0mu_u/tmpdph4tu2g TO /Users/craig/.ansible/tmp/ansible-tmp-1690140197.583099-67114-210971371146110/AnsiballZ_lineinfile.py
2023-07-23 15:23:17,652 p=67016 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'chmod u+x /Users/craig/.ansible/tmp/ansible-tmp-1690140197.583099-67114-210971371146110/ /Users/craig/.ansible/tmp/ansible-tmp-1690140197.583099-67114-210971371146110/AnsiballZ_lineinfile.py && sleep 0'
2023-07-23 15:23:17,666 p=67016 u=craig n=ansible | <localhost> EXEC /bin/sh -c '/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11 /Users/craig/.ansible/tmp/ansible-tmp-1690140197.583099-67114-210971371146110/AnsiballZ_lineinfile.py && sleep 0'
2023-07-23 15:23:17,780 p=67016 u=craig n=ansible | <localhost> EXEC /bin/sh -c 'rm -f -r /Users/craig/.ansible/tmp/ansible-tmp-1690140197.583099-67114-210971371146110/ > /dev/null 2>&1 && sleep 0'
2023-07-23 15:23:17,795 p=67016 u=craig n=ansible | ok: [localhost] => {
    "backup": "",
    "changed": false,
    "diff": [
        {
            "after": "",
            "after_header": "/Users/craig/Projects/homelab/inventory.ini (content)",
            "before": "",
            "before_header": "/Users/craig/Projects/homelab/inventory.ini (content)"
        },
        {
            "after_header": "/Users/craig/Projects/homelab/inventory.ini (file attributes)",
            "before_header": "/Users/craig/Projects/homelab/inventory.ini (file attributes)"
        }
    ],
    "invocation": {
        "module_args": {
            "attributes": null,
            "backrefs": false,
            "backup": false,
            "create": false,
            "firstmatch": false,
            "group": null,
            "insertafter": "^\\[lxc\\]",
            "insertbefore": null,
            "line": "caddy ansible_host=192.168.1.4",
            "mode": null,
            "owner": null,
            "path": "/Users/craig/Projects/homelab/inventory.ini",
            "regexp": null,
            "search_string": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "state": "present",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": ""
}
2023-07-23 15:23:17,813 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,818 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,824 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,824 p=67016 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 15:23:17,833 p=67016 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:23:17,833 p=67016 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 15:23:17,842 p=67016 u=craig n=ansible | <192.168.1.4> ESTABLISH SSH CONNECTION FOR USER: stantonius
2023-07-23 15:23:17,844 p=67016 u=craig n=ansible | <192.168.1.4> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'IdentityFile="/Users/craig/.ssh/proxmox_rsa"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="stantonius"' -o ConnectTimeout=10 -o 'ControlPath="/Users/craig/.ansible/cp/35ea447758"' 192.168.1.4 '/bin/sh -c '"'"'echo ~stantonius && sleep 0'"'"''
2023-07-23 15:23:18,027 p=67016 u=craig n=ansible | <192.168.1.4> (255, b'', b"Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).\r\n")
2023-07-23 15:23:18,030 p=67016 u=craig n=ansible | fatal: [caddy]: UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Warning: Permanently added '192.168.1.4' (ED25519) to the list of known hosts.\r\nstantonius@192.168.1.4: Permission denied (publickey,password).",
    "unreachable": true
}
2023-07-23 15:23:18,031 p=67016 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 15:23:18,031 p=67016 u=craig n=ansible | 192.168.1.99               : ok=9    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 15:23:18,031 p=67016 u=craig n=ansible | caddy                      : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 15:23:18,031 p=67016 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 15:25:15,222 p=67341 u=craig n=ansible | ansible-playbook [core 2.14.4]
  config file = /Users/craig/Projects/homelab/ansible.cfg
  configured module search path = ['/Users/craig/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/homebrew/Cellar/ansible/7.4.0/libexec/lib/python3.11/site-packages/ansible
  ansible collection location = /Users/craig/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/homebrew/bin/ansible-playbook
  python version = 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/Cellar/ansible/7.4.0/libexec/bin/python3.11)
  jinja version = 3.1.2
  libyaml = True
2023-07-23 15:25:15,222 p=67341 u=craig n=ansible | Using /Users/craig/Projects/homelab/ansible.cfg as config file
2023-07-23 15:25:15,228 p=67341 u=craig n=ansible | host_list declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:25:15,229 p=67341 u=craig n=ansible | script declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:25:15,229 p=67341 u=craig n=ansible | auto declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:25:15,229 p=67341 u=craig n=ansible | yaml declined parsing /Users/craig/Projects/homelab/inventory.ini as it did not pass its verify_file() method
2023-07-23 15:25:15,230 p=67341 u=craig n=ansible | Parsed /Users/craig/Projects/homelab/inventory.ini inventory source with ini plugin
2023-07-23 15:25:15,345 p=67341 u=craig n=ansible | Read vars_file '~/Projects/homelab/secrets.yaml'
2023-07-23 15:25:15,395 p=67341 u=craig n=ansible | ERROR! 'ansible_user' is not a valid attribute for a Play

The error appears to be in '/Users/craig/Projects/homelab/ansible/playbooks/caddy_build/caddy.yaml': line 40, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Configure LXC
  ^ here

2023-07-23 22:00:21,721 p=74054 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:00:21,753 p=74054 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:00:22,847 p=74054 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:00:22,864 p=74054 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:00:22,902 p=74054 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:00:22,912 p=74054 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:00:22,926 p=74054 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:00:22,934 p=74054 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:00:22,948 p=74054 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:00:22,956 p=74054 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:00:23,264 p=74054 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:00:23,277 p=74054 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:00:23,990 p=74054 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:00:24,004 p=74054 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:00:38,001 p=74054 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 22:00:38,018 p=74054 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:00:41,486 p=74054 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:00:41,487 p=74054 u=craig n=ansible | changed: [192.168.1.99]
2023-07-23 22:00:41,547 p=74054 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:00:41,551 p=74054 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:00:42,036 p=74054 u=craig n=ansible | ok: [localhost]
2023-07-23 22:00:42,044 p=74054 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:00:42,287 p=74054 u=craig n=ansible | changed: [localhost]
2023-07-23 22:00:42,299 p=74054 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:00:42,299 p=74054 u=craig n=ansible | 192.168.1.99               : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:00:42,299 p=74054 u=craig n=ansible | localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:01:57,044 p=74338 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:01:57,070 p=74338 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:01:58,175 p=74338 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:01:58,193 p=74338 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:01:58,232 p=74338 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:01:58,242 p=74338 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:01:58,258 p=74338 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:01:58,267 p=74338 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:01:58,285 p=74338 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:01:58,296 p=74338 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:01:58,627 p=74338 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:01:58,641 p=74338 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:01:59,365 p=74338 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:01:59,380 p=74338 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:01:59,803 p=74338 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:01:59,819 p=74338 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:02:00,189 p=74338 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:02:00,190 p=74338 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:02:00,247 p=74338 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:02:00,251 p=74338 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:02:01,710 p=74338 u=craig n=ansible | ok: [localhost]
2023-07-23 22:02:01,718 p=74338 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:02:01,955 p=74338 u=craig n=ansible | ok: [localhost]
2023-07-23 22:02:01,967 p=74338 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:02:01,967 p=74338 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:02:01,967 p=74338 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:02:13,185 p=74527 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:02:13,211 p=74527 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:02:14,055 p=74527 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:02:14,073 p=74527 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:02:14,116 p=74527 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:02:14,127 p=74527 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:02:14,141 p=74527 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:02:14,148 p=74527 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:02:14,160 p=74527 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:02:14,168 p=74527 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:02:14,481 p=74527 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:02:14,495 p=74527 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:02:15,211 p=74527 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:02:15,227 p=74527 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:02:15,639 p=74527 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:02:15,656 p=74527 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:02:16,026 p=74527 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:02:16,026 p=74527 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:02:16,083 p=74527 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:02:16,087 p=74527 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:02:16,476 p=74527 u=craig n=ansible | ok: [localhost]
2023-07-23 22:02:16,483 p=74527 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:02:16,696 p=74527 u=craig n=ansible | ok: [localhost]
2023-07-23 22:02:16,724 p=74527 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:02:16,733 p=74527 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:02:18,624 p=74527 u=craig n=ansible | ok: [caddy]
2023-07-23 22:02:18,675 p=74527 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:02:18,839 p=74527 u=craig n=ansible | fatal: [caddy -> localhost]: FAILED! => {"changed": false, "module_stderr": "sudo: a password is required\n", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}
2023-07-23 22:02:18,840 p=74527 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:02:18,841 p=74527 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:02:18,841 p=74527 u=craig n=ansible | caddy                      : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 22:02:18,841 p=74527 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:03:57,623 p=74888 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:03:57,651 p=74888 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:03:58,807 p=74888 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:03:58,824 p=74888 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:03:58,860 p=74888 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:03:58,869 p=74888 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:03:58,885 p=74888 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:03:58,892 p=74888 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:03:58,903 p=74888 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:03:58,911 p=74888 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:03:59,225 p=74888 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:03:59,239 p=74888 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:03:59,957 p=74888 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:03:59,973 p=74888 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:04:00,384 p=74888 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:00,400 p=74888 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:04:00,813 p=74888 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:04:00,814 p=74888 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:00,875 p=74888 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:04:00,879 p=74888 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:04:01,300 p=74888 u=craig n=ansible | ok: [localhost]
2023-07-23 22:04:01,307 p=74888 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:04:01,517 p=74888 u=craig n=ansible | ok: [localhost]
2023-07-23 22:04:01,546 p=74888 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:04:01,554 p=74888 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:04:02,682 p=74888 u=craig n=ansible | ok: [caddy]
2023-07-23 22:04:02,731 p=74888 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:04:02,967 p=74888 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:04:02,977 p=74888 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:04:06,621 p=74888 u=craig n=ansible | changed: [caddy]
2023-07-23 22:04:06,654 p=74888 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:04:06,674 p=74888 u=craig n=ansible | fatal: [caddy -> {{ machine_name }}]: FAILED! => {"msg": "The field 'delegate_to' has an invalid value, which includes an undefined variable. The error was: 'machine_name' is undefined. 'machine_name' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/configure_lxc/tasks/main.yaml': line 14, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Run the equivalent of \"apt-get update\"\n  ^ here\n"}
2023-07-23 22:04:06,675 p=74888 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:04:06,675 p=74888 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:04:06,675 p=74888 u=craig n=ansible | caddy                      : ok=3    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 22:04:06,675 p=74888 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:04:44,097 p=75146 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:04:44,124 p=75146 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:04:44,958 p=75146 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:44,976 p=75146 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:04:45,017 p=75146 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:45,027 p=75146 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:04:45,041 p=75146 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:04:45,048 p=75146 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:04:45,060 p=75146 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:04:45,068 p=75146 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:04:45,382 p=75146 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:45,396 p=75146 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:04:46,203 p=75146 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:46,221 p=75146 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:04:46,666 p=75146 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:46,682 p=75146 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:04:47,061 p=75146 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:04:47,061 p=75146 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:04:47,115 p=75146 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:04:47,120 p=75146 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:04:47,564 p=75146 u=craig n=ansible | ok: [localhost]
2023-07-23 22:04:47,572 p=75146 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:04:47,782 p=75146 u=craig n=ansible | ok: [localhost]
2023-07-23 22:04:47,811 p=75146 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:04:47,819 p=75146 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:04:48,679 p=75146 u=craig n=ansible | ok: [caddy]
2023-07-23 22:04:48,729 p=75146 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:04:48,952 p=75146 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:04:48,962 p=75146 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:04:50,929 p=75146 u=craig n=ansible | changed: [caddy]
2023-07-23 22:04:50,950 p=75146 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:04:52,360 p=75146 u=craig n=ansible | ok: [caddy]
2023-07-23 22:04:52,381 p=75146 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-23 22:06:09,020 p=75146 u=craig n=ansible | changed: [caddy]
2023-07-23 22:06:09,043 p=75146 u=craig n=ansible | TASK [configure_lxc : Add rsa public key to remote host user=root, state=present, key={{ ssh_key_content }}] ***********************************************************************************************
2023-07-23 22:06:09,105 p=75146 u=craig n=ansible | fatal: [caddy]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'ssh_key_content' is undefined. 'ssh_key_content' is undefined\n\nThe error appears to be in '/Users/craig/Projects/homelab/ansible/roles/configure_lxc/tasks/main.yaml': line 24, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Add rsa public key to remote host\n  ^ here\n"}
2023-07-23 22:06:09,107 p=75146 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:06:09,107 p=75146 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:06:09,107 p=75146 u=craig n=ansible | caddy                      : ok=5    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 22:06:09,107 p=75146 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:12:36,914 p=76066 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:12:36,940 p=76066 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:12:38,106 p=76066 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:12:38,125 p=76066 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:12:38,165 p=76066 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:12:38,175 p=76066 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:12:38,191 p=76066 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:12:38,199 p=76066 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:12:38,209 p=76066 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:12:38,217 p=76066 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:12:38,886 p=76066 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:12:38,905 p=76066 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:12:39,633 p=76066 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:12:39,651 p=76066 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:12:40,061 p=76066 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:12:40,077 p=76066 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:12:40,421 p=76066 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:12:40,422 p=76066 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:12:40,477 p=76066 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:12:40,482 p=76066 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:12:40,900 p=76066 u=craig n=ansible | ok: [localhost]
2023-07-23 22:12:40,907 p=76066 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:12:41,135 p=76066 u=craig n=ansible | ok: [localhost]
2023-07-23 22:12:41,164 p=76066 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:12:41,172 p=76066 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:12:43,142 p=76066 u=craig n=ansible | ok: [caddy]
2023-07-23 22:12:43,191 p=76066 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:12:43,426 p=76066 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:12:43,436 p=76066 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:12:45,121 p=76066 u=craig n=ansible | changed: [caddy]
2023-07-23 22:12:45,142 p=76066 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:12:46,583 p=76066 u=craig n=ansible | ok: [caddy]
2023-07-23 22:12:46,604 p=76066 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-23 22:12:47,446 p=76066 u=craig n=ansible | ok: [caddy]
2023-07-23 22:12:47,515 p=76066 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-23 22:12:47,520 p=76066 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:12:48,306 p=76066 u=craig n=ansible | ok: [caddy]
2023-07-23 22:12:48,323 p=76066 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-23 22:12:49,632 p=76066 u=craig n=ansible | ok: [caddy]
2023-07-23 22:12:49,638 p=76066 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-23 22:12:51,526 p=76066 u=craig n=ansible | changed: [caddy] => (item=apt-transport-https)
2023-07-23 22:12:52,342 p=76066 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-23 22:12:56,466 p=76066 u=craig n=ansible | changed: [caddy] => (item=curl)
2023-07-23 22:13:03,258 p=76066 u=craig n=ansible | changed: [caddy] => (item=gnupg)
2023-07-23 22:13:03,962 p=76066 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-23 22:13:20,162 p=76066 u=craig n=ansible | changed: [caddy] => (item=software-properties-common)
2023-07-23 22:13:20,177 p=76066 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-23 22:13:20,962 p=76066 u=craig n=ansible | changed: [caddy]
2023-07-23 22:13:20,972 p=76066 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-23 22:13:23,071 p=76066 u=craig n=ansible | changed: [caddy]
2023-07-23 22:13:23,079 p=76066 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-23 22:13:42,954 p=76066 u=craig n=ansible | changed: [caddy]
2023-07-23 22:13:42,964 p=76066 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-23 22:13:43,602 p=76066 u=craig n=ansible | ok: [caddy]
2023-07-23 22:13:43,613 p=76066 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-23 22:13:44,088 p=76066 u=craig n=ansible | changed: [caddy]
2023-07-23 22:13:44,099 p=76066 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-23 22:14:12,969 p=76066 u=craig n=ansible | changed: [caddy]
2023-07-23 22:14:12,981 p=76066 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-23 22:14:18,461 p=76066 u=craig n=ansible | changed: [caddy]
2023-07-23 22:14:18,504 p=76066 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-23 22:14:18,513 p=76066 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:14:19,433 p=76066 u=craig n=ansible | ok: [caddy]
2023-07-23 22:14:19,452 p=76066 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True, remove_volumes=True] ***************************************
2023-07-23 22:14:20,107 p=76066 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Configuration error - \n        Can't find a suitable configuration file in this directory or any\n        parent. Are you in the right directory?\n\n        Supported filenames: docker-compose.yml, docker-compose.yaml, compose.yml, compose.yaml\n        "}
2023-07-23 22:14:20,107 p=76066 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:14:20,108 p=76066 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:14:20,108 p=76066 u=craig n=ansible | caddy                      : ok=16   changed=8    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 22:14:20,108 p=76066 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:18:19,492 p=76931 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:18:19,519 p=76931 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:18:20,696 p=76931 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:18:20,714 p=76931 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:18:20,750 p=76931 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:18:20,760 p=76931 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:18:20,774 p=76931 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:18:20,782 p=76931 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:18:20,792 p=76931 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:18:20,800 p=76931 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:18:21,122 p=76931 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:18:21,135 p=76931 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:18:21,826 p=76931 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:18:21,842 p=76931 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:18:22,234 p=76931 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:18:22,249 p=76931 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:18:22,614 p=76931 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:18:22,614 p=76931 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:18:22,671 p=76931 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:18:22,675 p=76931 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:18:23,096 p=76931 u=craig n=ansible | ok: [localhost]
2023-07-23 22:18:23,103 p=76931 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:18:23,314 p=76931 u=craig n=ansible | ok: [localhost]
2023-07-23 22:18:23,343 p=76931 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:18:23,351 p=76931 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:18:24,590 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:24,639 p=76931 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:18:24,870 p=76931 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:18:24,881 p=76931 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:18:26,763 p=76931 u=craig n=ansible | changed: [caddy]
2023-07-23 22:18:26,783 p=76931 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:18:28,358 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:28,380 p=76931 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-23 22:18:29,248 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:29,316 p=76931 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-23 22:18:29,322 p=76931 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:18:30,108 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:30,125 p=76931 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-23 22:18:31,698 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:31,706 p=76931 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-23 22:18:32,489 p=76931 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-07-23 22:18:33,234 p=76931 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-23 22:18:34,037 p=76931 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-07-23 22:18:34,871 p=76931 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-07-23 22:18:35,634 p=76931 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-23 22:18:36,401 p=76931 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-07-23 22:18:36,414 p=76931 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-23 22:18:37,007 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:37,016 p=76931 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-23 22:18:37,527 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:37,536 p=76931 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-23 22:18:38,363 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:38,372 p=76931 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-23 22:18:38,936 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:38,944 p=76931 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-23 22:18:39,334 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:39,342 p=76931 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-23 22:18:40,191 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:40,200 p=76931 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-23 22:18:41,219 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:41,250 p=76931 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-23 22:18:41,258 p=76931 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:18:42,058 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:42,074 p=76931 u=craig n=ansible | TASK [caddy_docker : Check if /opt/caddy directory exists path=/opt/caddy] *********************************************************************************************************************************
2023-07-23 22:18:42,356 p=76931 u=craig n=ansible | ok: [caddy]
2023-07-23 22:18:42,362 p=76931 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True, remove_volumes=True] ***************************************
2023-07-23 22:18:42,377 p=76931 u=craig n=ansible | skipping: [caddy]
2023-07-23 22:18:42,384 p=76931 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300] ****************************************************************************************************************************************************
2023-07-23 22:18:42,395 p=76931 u=craig n=ansible | skipping: [caddy]
2023-07-23 22:18:42,399 p=76931 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-07-23 22:18:42,680 p=76931 u=craig n=ansible | changed: [caddy]
2023-07-23 22:18:42,687 p=76931 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-07-23 22:18:43,353 p=76931 u=craig n=ansible | changed: [caddy]
2023-07-23 22:18:43,360 p=76931 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-07-23 22:18:43,943 p=76931 u=craig n=ansible | changed: [caddy]
2023-07-23 22:18:43,952 p=76931 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-07-23 22:18:44,038 p=76931 u=craig n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'cloudflare_api_key' is undefined. 'cloudflare_api_key' is undefined
2023-07-23 22:18:44,038 p=76931 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'cloudflare_api_key' is undefined. 'cloudflare_api_key' is undefined"}
2023-07-23 22:18:44,038 p=76931 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:18:44,038 p=76931 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:18:44,038 p=76931 u=craig n=ansible | caddy                      : ok=20   changed=4    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2023-07-23 22:18:44,038 p=76931 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:21:14,018 p=77628 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:21:14,045 p=77628 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:21:15,110 p=77628 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:21:15,127 p=77628 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:21:15,167 p=77628 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:21:15,177 p=77628 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:21:15,193 p=77628 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:21:15,201 p=77628 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:21:15,213 p=77628 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:21:15,221 p=77628 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:21:15,533 p=77628 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:21:15,547 p=77628 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:21:16,249 p=77628 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:21:16,264 p=77628 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:21:16,665 p=77628 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:21:16,681 p=77628 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:21:17,049 p=77628 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:21:17,049 p=77628 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:21:17,109 p=77628 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:21:17,114 p=77628 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:21:17,525 p=77628 u=craig n=ansible | ok: [localhost]
2023-07-23 22:21:17,532 p=77628 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:21:17,742 p=77628 u=craig n=ansible | ok: [localhost]
2023-07-23 22:21:17,771 p=77628 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:21:17,779 p=77628 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:21:19,033 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:19,082 p=77628 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:21:19,315 p=77628 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:21:19,325 p=77628 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:21:21,209 p=77628 u=craig n=ansible | changed: [caddy]
2023-07-23 22:21:21,229 p=77628 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:21:22,925 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:22,947 p=77628 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-23 22:21:23,830 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:23,899 p=77628 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-23 22:21:23,904 p=77628 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:21:24,678 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:24,696 p=77628 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-23 22:21:26,151 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:26,160 p=77628 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-23 22:21:26,896 p=77628 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-07-23 22:21:27,613 p=77628 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-23 22:21:28,391 p=77628 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-07-23 22:21:29,114 p=77628 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-07-23 22:21:29,874 p=77628 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-23 22:21:30,686 p=77628 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-07-23 22:21:30,699 p=77628 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-23 22:21:31,304 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:31,312 p=77628 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-23 22:21:31,790 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:31,799 p=77628 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-23 22:21:32,635 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:32,643 p=77628 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-23 22:21:33,205 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:33,212 p=77628 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-23 22:21:33,631 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:33,639 p=77628 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-23 22:21:34,370 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:34,378 p=77628 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-23 22:21:35,398 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:35,454 p=77628 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-23 22:21:35,468 p=77628 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:21:36,295 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:36,334 p=77628 u=craig n=ansible | TASK [caddy_docker : Check if /opt/caddy directory exists path=/opt/caddy] *********************************************************************************************************************************
2023-07-23 22:21:36,607 p=77628 u=craig n=ansible | ok: [caddy]
2023-07-23 22:21:36,625 p=77628 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True, remove_volumes=True] ***************************************
2023-07-23 22:21:37,252 p=77628 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Configuration error - \n        Can't find a suitable configuration file in this directory or any\n        parent. Are you in the right directory?\n\n        Supported filenames: docker-compose.yml, docker-compose.yaml, compose.yml, compose.yaml\n        "}
2023-07-23 22:21:37,253 p=77628 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:21:37,253 p=77628 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:21:37,253 p=77628 u=craig n=ansible | caddy                      : ok=17   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 22:21:37,253 p=77628 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:24:17,286 p=78280 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:24:17,312 p=78280 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:24:18,464 p=78280 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:24:18,483 p=78280 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:24:18,520 p=78280 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:24:18,531 p=78280 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:24:18,546 p=78280 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:24:18,554 p=78280 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:24:18,564 p=78280 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:24:18,572 p=78280 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:24:18,924 p=78280 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:24:18,939 p=78280 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:24:19,627 p=78280 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:24:19,642 p=78280 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:24:20,037 p=78280 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:24:20,053 p=78280 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:24:20,416 p=78280 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:24:20,416 p=78280 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:24:20,473 p=78280 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:24:20,477 p=78280 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:24:20,885 p=78280 u=craig n=ansible | ok: [localhost]
2023-07-23 22:24:20,893 p=78280 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:24:21,104 p=78280 u=craig n=ansible | ok: [localhost]
2023-07-23 22:24:21,133 p=78280 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:24:21,141 p=78280 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:24:22,377 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:22,426 p=78280 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:24:22,653 p=78280 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:24:22,663 p=78280 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:24:24,557 p=78280 u=craig n=ansible | changed: [caddy]
2023-07-23 22:24:24,579 p=78280 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:24:26,100 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:26,121 p=78280 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-23 22:24:27,126 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:27,194 p=78280 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-23 22:24:27,199 p=78280 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:24:27,982 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:27,999 p=78280 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-23 22:24:29,409 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:29,418 p=78280 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-23 22:24:30,203 p=78280 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-07-23 22:24:30,925 p=78280 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-23 22:24:31,737 p=78280 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-07-23 22:24:32,514 p=78280 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-07-23 22:24:33,378 p=78280 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-23 22:24:34,140 p=78280 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-07-23 22:24:34,151 p=78280 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-23 22:24:34,806 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:34,815 p=78280 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-23 22:24:35,420 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:35,429 p=78280 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-23 22:24:36,186 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:36,195 p=78280 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-23 22:24:36,739 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:36,748 p=78280 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-23 22:24:37,126 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:37,135 p=78280 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-23 22:24:37,979 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:37,988 p=78280 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-23 22:24:38,989 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:39,046 p=78280 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-23 22:24:39,059 p=78280 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:24:39,835 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:39,874 p=78280 u=craig n=ansible | TASK [caddy_docker : Check if /opt/caddy directory exists path=/opt/caddy] *********************************************************************************************************************************
2023-07-23 22:24:40,140 p=78280 u=craig n=ansible | ok: [caddy]
2023-07-23 22:24:40,156 p=78280 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_orphans=True, remove_volumes=True] ***************************************
2023-07-23 22:24:40,763 p=78280 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Configuration error - \n        Can't find a suitable configuration file in this directory or any\n        parent. Are you in the right directory?\n\n        Supported filenames: docker-compose.yml, docker-compose.yaml, compose.yml, compose.yaml\n        "}
2023-07-23 22:24:40,764 p=78280 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:24:40,764 p=78280 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:24:40,764 p=78280 u=craig n=ansible | caddy                      : ok=17   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 22:24:40,764 p=78280 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:30:15,965 p=79157 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:30:15,992 p=79157 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:30:17,152 p=79157 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:30:17,170 p=79157 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:30:17,213 p=79157 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:30:17,224 p=79157 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:30:17,239 p=79157 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:30:17,246 p=79157 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:30:17,259 p=79157 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:30:17,267 p=79157 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:30:17,588 p=79157 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:30:17,601 p=79157 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:30:18,278 p=79157 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:30:18,293 p=79157 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:30:18,709 p=79157 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:30:18,725 p=79157 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:30:19,107 p=79157 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:30:19,108 p=79157 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:30:19,165 p=79157 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:30:19,170 p=79157 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:30:19,615 p=79157 u=craig n=ansible | ok: [localhost]
2023-07-23 22:30:19,622 p=79157 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:30:19,849 p=79157 u=craig n=ansible | ok: [localhost]
2023-07-23 22:30:19,878 p=79157 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:30:19,886 p=79157 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:30:21,085 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:21,137 p=79157 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:30:21,368 p=79157 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:30:21,378 p=79157 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:30:23,175 p=79157 u=craig n=ansible | changed: [caddy]
2023-07-23 22:30:23,197 p=79157 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:30:24,717 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:24,727 p=79157 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-23 22:30:25,706 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:25,775 p=79157 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-23 22:30:25,780 p=79157 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:30:26,598 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:26,615 p=79157 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-23 22:30:28,086 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:28,095 p=79157 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-23 22:30:28,911 p=79157 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-07-23 22:30:29,640 p=79157 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-23 22:30:30,446 p=79157 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-07-23 22:30:31,263 p=79157 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-07-23 22:30:32,012 p=79157 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-23 22:30:32,795 p=79157 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-07-23 22:30:32,808 p=79157 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-23 22:30:33,621 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:33,632 p=79157 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-23 22:30:34,107 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:34,116 p=79157 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-23 22:30:34,836 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:34,841 p=79157 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-23 22:30:35,382 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:35,391 p=79157 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-23 22:30:35,801 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:35,808 p=79157 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-23 22:30:36,538 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:36,547 p=79157 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-23 22:30:37,466 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:37,521 p=79157 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-23 22:30:37,534 p=79157 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:30:38,325 p=79157 u=craig n=ansible | ok: [caddy]
2023-07-23 22:30:38,366 p=79157 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_volumes=True] ************************************************************
2023-07-23 22:30:39,045 p=79157 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Configuration error - \n        Can't find a suitable configuration file in this directory or any\n        parent. Are you in the right directory?\n\n        Supported filenames: docker-compose.yml, docker-compose.yaml, compose.yml, compose.yaml\n        "}
2023-07-23 22:30:39,046 p=79157 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:30:39,046 p=79157 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:30:39,046 p=79157 u=craig n=ansible | caddy                      : ok=16   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-23 22:30:39,046 p=79157 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:33:15,388 p=79806 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-23 22:33:15,416 p=79806 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-23 22:33:16,508 p=79806 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:33:16,526 p=79806 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features={{ hookscript | ternary(['fuse=1'], ['nesting=1', 'keyctl=1', 'fuse=1']) }}, ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-23 22:33:16,570 p=79806 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:33:16,580 p=79806 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-23 22:33:16,596 p=79806 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-23 22:33:16,604 p=79806 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-23 22:33:16,616 p=79806 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-23 22:33:16,625 p=79806 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-23 22:33:16,960 p=79806 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:33:16,973 p=79806 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-23 22:33:17,653 p=79806 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:33:17,671 p=79806 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-23 22:33:18,063 p=79806 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:33:18,079 p=79806 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-23 22:33:18,426 p=79806 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-23 22:33:18,426 p=79806 u=craig n=ansible | ok: [192.168.1.99]
2023-07-23 22:33:18,483 p=79806 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-23 22:33:18,485 p=79806 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:33:18,897 p=79806 u=craig n=ansible | ok: [localhost]
2023-07-23 22:33:18,904 p=79806 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-23 22:33:19,116 p=79806 u=craig n=ansible | ok: [localhost]
2023-07-23 22:33:19,145 p=79806 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-23 22:33:19,153 p=79806 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:33:20,424 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:20,474 p=79806 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-23 22:33:20,694 p=79806 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-23 22:33:20,705 p=79806 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-23 22:33:22,465 p=79806 u=craig n=ansible | changed: [caddy]
2023-07-23 22:33:22,486 p=79806 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-23 22:33:23,971 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:23,990 p=79806 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-23 22:33:25,018 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:25,086 p=79806 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-23 22:33:25,092 p=79806 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:33:25,959 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:25,975 p=79806 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-23 22:33:27,280 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:27,289 p=79806 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-23 22:33:28,095 p=79806 u=craig n=ansible | ok: [caddy] => (item=apt-transport-https)
2023-07-23 22:33:28,805 p=79806 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-23 22:33:29,546 p=79806 u=craig n=ansible | ok: [caddy] => (item=curl)
2023-07-23 22:33:30,294 p=79806 u=craig n=ansible | ok: [caddy] => (item=gnupg)
2023-07-23 22:33:31,108 p=79806 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-23 22:33:31,835 p=79806 u=craig n=ansible | ok: [caddy] => (item=software-properties-common)
2023-07-23 22:33:31,848 p=79806 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-23 22:33:32,494 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:32,502 p=79806 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-23 22:33:33,003 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:33,011 p=79806 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-23 22:33:33,826 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:33,834 p=79806 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-23 22:33:34,392 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:34,400 p=79806 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-23 22:33:34,818 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:34,825 p=79806 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-23 22:33:35,571 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:35,579 p=79806 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-23 22:33:36,590 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:36,645 p=79806 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-23 22:33:36,658 p=79806 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-23 22:33:37,456 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:37,496 p=79806 u=craig n=ansible | TASK [caddy_docker : Check if Docker Compose file exists path=/opt/caddy/docker-compose.yml] ***************************************************************************************************************
2023-07-23 22:33:37,773 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:37,790 p=79806 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_volumes=True] ************************************************************
2023-07-23 22:33:37,806 p=79806 u=craig n=ansible | skipping: [caddy]
2023-07-23 22:33:37,819 p=79806 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300] ****************************************************************************************************************************************************
2023-07-23 22:33:37,833 p=79806 u=craig n=ansible | skipping: [caddy]
2023-07-23 22:33:37,843 p=79806 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-07-23 22:33:38,126 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:38,144 p=79806 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-07-23 22:33:38,657 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:38,673 p=79806 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-07-23 22:33:39,187 p=79806 u=craig n=ansible | ok: [caddy]
2023-07-23 22:33:39,210 p=79806 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-07-23 22:33:39,862 p=79806 u=craig n=ansible | changed: [caddy]
2023-07-23 22:33:39,878 p=79806 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] *************************************************************************************
2023-07-23 22:34:14,809 p=79806 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:8fa8a41d7e0d498b6b70a5fca05bdb9e3deb00312a830610d2efd6d83fb2b442\nStatus: Downloaded newer image for caddy:2-builder\n ---> cb47caf09278\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in 06444a1ee655\n", "msg": "Error: build failed with (<Service: caddy>, 'AppArmor enabled on system but the docker-default profile could not be loaded: running `/usr/sbin/apparmor_parser apparmor_parser -Kr /var/lib/docker/tmp/docker-default1750011309` failed with output: apparmor_parser: Unable to replace \"docker-default\".  Permission denied; attempted to load a profile while confined?\\n\\nerror: exit status 243')"}
2023-07-23 22:34:14,810 p=79806 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-23 22:34:14,811 p=79806 u=craig n=ansible | 192.168.1.99               : ok=8    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-23 22:34:14,811 p=79806 u=craig n=ansible | caddy                      : ok=21   changed=2    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2023-07-23 22:34:14,811 p=79806 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 07:06:12,443 p=85019 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-24 07:06:12,471 p=85019 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-24 07:06:13,523 p=85019 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:06:13,541 p=85019 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features=['nesting=1', 'keyctl=1', 'fuse=1'], ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-24 07:06:13,583 p=85019 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:06:13,593 p=85019 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-24 07:06:13,608 p=85019 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-24 07:06:13,616 p=85019 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-24 07:06:13,628 p=85019 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-24 07:06:13,637 p=85019 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-24 07:06:13,978 p=85019 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:06:13,993 p=85019 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-24 07:06:14,691 p=85019 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:06:14,706 p=85019 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-24 07:06:27,097 p=85019 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 07:06:27,116 p=85019 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-24 07:06:30,561 p=85019 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-24 07:06:30,562 p=85019 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 07:06:30,622 p=85019 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-24 07:06:30,626 p=85019 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:06:31,132 p=85019 u=craig n=ansible | ok: [localhost]
2023-07-24 07:06:31,139 p=85019 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-24 07:06:31,381 p=85019 u=craig n=ansible | ok: [localhost]
2023-07-24 07:06:31,409 p=85019 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-24 07:06:31,417 p=85019 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:06:33,502 p=85019 u=craig n=ansible | ok: [caddy]
2023-07-24 07:06:33,552 p=85019 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-24 07:06:33,809 p=85019 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-24 07:06:33,819 p=85019 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-24 07:06:41,861 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:06:41,880 p=85019 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-24 07:06:43,255 p=85019 u=craig n=ansible | ok: [caddy]
2023-07-24 07:06:43,276 p=85019 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-24 07:07:59,735 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:07:59,817 p=85019 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-24 07:07:59,824 p=85019 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:08:00,776 p=85019 u=craig n=ansible | ok: [caddy]
2023-07-24 07:08:00,794 p=85019 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-24 07:08:03,027 p=85019 u=craig n=ansible | ok: [caddy]
2023-07-24 07:08:03,039 p=85019 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-24 07:08:04,884 p=85019 u=craig n=ansible | changed: [caddy] => (item=apt-transport-https)
2023-07-24 07:08:05,607 p=85019 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-24 07:08:09,085 p=85019 u=craig n=ansible | changed: [caddy] => (item=curl)
2023-07-24 07:08:14,515 p=85019 u=craig n=ansible | changed: [caddy] => (item=gnupg)
2023-07-24 07:08:15,290 p=85019 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-24 07:08:29,390 p=85019 u=craig n=ansible | changed: [caddy] => (item=software-properties-common)
2023-07-24 07:08:29,405 p=85019 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-24 07:08:30,166 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:08:30,178 p=85019 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-24 07:08:32,160 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:08:32,172 p=85019 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-24 07:08:51,692 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:08:51,706 p=85019 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-24 07:08:52,351 p=85019 u=craig n=ansible | ok: [caddy]
2023-07-24 07:08:52,361 p=85019 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-24 07:08:52,809 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:08:52,819 p=85019 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-24 07:09:18,515 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:09:18,523 p=85019 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-24 07:09:24,227 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:09:24,297 p=85019 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-24 07:09:24,311 p=85019 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:09:25,147 p=85019 u=craig n=ansible | ok: [caddy]
2023-07-24 07:09:25,180 p=85019 u=craig n=ansible | TASK [caddy_docker : Check if Docker Compose file exists path=/opt/caddy/docker-compose.yml] ***************************************************************************************************************
2023-07-24 07:09:25,456 p=85019 u=craig n=ansible | ok: [caddy]
2023-07-24 07:09:25,469 p=85019 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_volumes=True] ************************************************************
2023-07-24 07:09:25,484 p=85019 u=craig n=ansible | skipping: [caddy]
2023-07-24 07:09:25,497 p=85019 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300] ****************************************************************************************************************************************************
2023-07-24 07:09:25,512 p=85019 u=craig n=ansible | skipping: [caddy]
2023-07-24 07:09:25,526 p=85019 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-07-24 07:09:25,822 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:09:25,835 p=85019 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-07-24 07:09:26,509 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:09:26,521 p=85019 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-07-24 07:09:27,105 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:09:27,125 p=85019 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-07-24 07:09:27,760 p=85019 u=craig n=ansible | changed: [caddy]
2023-07-24 07:09:27,777 p=85019 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] *************************************************************************************
2023-07-24 07:09:38,241 p=85019 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:8fa8a41d7e0d498b6b70a5fca05bdb9e3deb00312a830610d2efd6d83fb2b442\nStatus: Downloaded newer image for caddy:2-builder\n ---> cb47caf09278\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in e799d7014562\n", "msg": "Error: build failed with (<Service: caddy>, 'AppArmor enabled on system but the docker-default profile could not be loaded: running `/usr/sbin/apparmor_parser apparmor_parser -Kr /var/lib/docker/tmp/docker-default2544060194` failed with output: apparmor_parser: Unable to replace \"docker-default\".  Permission denied; attempted to load a profile while confined?\\n\\nerror: exit status 243')"}
2023-07-24 07:09:38,242 p=85019 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-24 07:09:38,242 p=85019 u=craig n=ansible | 192.168.1.99               : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 07:09:38,242 p=85019 u=craig n=ansible | caddy                      : ok=21   changed=13   unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2023-07-24 07:09:38,242 p=85019 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 07:14:12,898 p=86290 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-24 07:14:12,925 p=86290 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-24 07:14:14,036 p=86290 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:14:14,054 p=86290 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features=['nesting=1', 'keyctl=1', 'fuse=1'], ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-24 07:14:14,097 p=86290 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:14:14,107 p=86290 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-24 07:14:14,124 p=86290 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-24 07:14:14,131 p=86290 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-24 07:14:14,141 p=86290 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-24 07:14:14,149 p=86290 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-24 07:14:14,533 p=86290 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:14:14,546 p=86290 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-24 07:14:15,262 p=86290 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 07:14:15,276 p=86290 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-24 07:14:23,205 p=86290 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 07:14:23,228 p=86290 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-24 07:14:27,597 p=86290 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-24 07:14:27,597 p=86290 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 07:14:27,636 p=86290 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-24 07:14:27,639 p=86290 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:14:28,111 p=86290 u=craig n=ansible | ok: [localhost]
2023-07-24 07:14:28,119 p=86290 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-24 07:14:28,358 p=86290 u=craig n=ansible | ok: [localhost]
2023-07-24 07:14:28,386 p=86290 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-24 07:14:28,395 p=86290 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:14:30,397 p=86290 u=craig n=ansible | ok: [caddy]
2023-07-24 07:14:30,441 p=86290 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-24 07:14:30,660 p=86290 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-24 07:14:30,671 p=86290 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-24 07:14:34,200 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:14:34,222 p=86290 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-24 07:14:35,290 p=86290 u=craig n=ansible | ok: [caddy]
2023-07-24 07:14:35,309 p=86290 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-24 07:15:44,727 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:15:44,793 p=86290 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-24 07:15:44,799 p=86290 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:15:45,689 p=86290 u=craig n=ansible | ok: [caddy]
2023-07-24 07:15:45,735 p=86290 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-24 07:15:47,958 p=86290 u=craig n=ansible | ok: [caddy]
2023-07-24 07:15:47,970 p=86290 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-24 07:15:49,983 p=86290 u=craig n=ansible | changed: [caddy] => (item=apt-transport-https)
2023-07-24 07:15:50,760 p=86290 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-24 07:15:54,806 p=86290 u=craig n=ansible | changed: [caddy] => (item=curl)
2023-07-24 07:16:01,462 p=86290 u=craig n=ansible | changed: [caddy] => (item=gnupg)
2023-07-24 07:16:02,194 p=86290 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-24 07:16:18,324 p=86290 u=craig n=ansible | changed: [caddy] => (item=software-properties-common)
2023-07-24 07:16:18,341 p=86290 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-24 07:16:19,263 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:16:19,274 p=86290 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-24 07:16:21,347 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:16:21,358 p=86290 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-24 07:16:40,911 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:16:40,923 p=86290 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-24 07:16:41,537 p=86290 u=craig n=ansible | ok: [caddy]
2023-07-24 07:16:41,546 p=86290 u=craig n=ansible | TASK [docker : apt install apparmor and apparmor-utils name=['apparmor', 'apparmor-utils'], state=present] *************************************************************************************************
2023-07-24 07:16:44,977 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:16:44,991 p=86290 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-24 07:16:45,488 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:16:45,497 p=86290 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-24 07:17:15,980 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:17:15,992 p=86290 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-24 07:17:21,300 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:17:21,384 p=86290 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-24 07:17:21,394 p=86290 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 07:17:22,255 p=86290 u=craig n=ansible | ok: [caddy]
2023-07-24 07:17:22,298 p=86290 u=craig n=ansible | TASK [caddy_docker : Check if Docker Compose file exists path=/opt/caddy/docker-compose.yml] ***************************************************************************************************************
2023-07-24 07:17:22,575 p=86290 u=craig n=ansible | ok: [caddy]
2023-07-24 07:17:22,587 p=86290 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_volumes=True] ************************************************************
2023-07-24 07:17:22,609 p=86290 u=craig n=ansible | skipping: [caddy]
2023-07-24 07:17:22,623 p=86290 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300] ****************************************************************************************************************************************************
2023-07-24 07:17:22,637 p=86290 u=craig n=ansible | skipping: [caddy]
2023-07-24 07:17:22,650 p=86290 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-07-24 07:17:22,926 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:17:22,942 p=86290 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-07-24 07:17:23,625 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:17:23,642 p=86290 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-07-24 07:17:24,244 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:17:24,266 p=86290 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-07-24 07:17:24,876 p=86290 u=craig n=ansible | changed: [caddy]
2023-07-24 07:17:24,904 p=86290 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] *************************************************************************************
2023-07-24 07:17:34,767 p=86290 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:8fa8a41d7e0d498b6b70a5fca05bdb9e3deb00312a830610d2efd6d83fb2b442\nStatus: Downloaded newer image for caddy:2-builder\n ---> cb47caf09278\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in 4ad440bd2ca1\n", "msg": "Error: build failed with (<Service: caddy>, 'AppArmor enabled on system but the docker-default profile could not be loaded: running `/usr/sbin/apparmor_parser apparmor_parser -Kr /var/lib/docker/tmp/docker-default3835535432` failed with output: apparmor_parser: Unable to replace \"docker-default\".  Permission denied; attempted to load a profile while confined?\\n\\nerror: exit status 243')"}
2023-07-24 07:17:34,769 p=86290 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-24 07:17:34,770 p=86290 u=craig n=ansible | 192.168.1.99               : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 07:17:34,770 p=86290 u=craig n=ansible | caddy                      : ok=22   changed=14   unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2023-07-24 07:17:34,770 p=86290 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 08:21:23,050 p=89816 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-24 08:21:23,077 p=89816 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-24 08:21:24,198 p=89816 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:21:24,216 p=89816 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features=['nesting=1', 'keyctl=1', 'fuse=1'], ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-24 08:21:24,253 p=89816 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:21:24,263 p=89816 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-24 08:21:24,279 p=89816 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-24 08:21:24,287 p=89816 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-24 08:21:24,299 p=89816 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-24 08:21:24,307 p=89816 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-24 08:21:24,626 p=89816 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:21:24,635 p=89816 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-24 08:21:25,307 p=89816 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:21:25,322 p=89816 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-24 08:21:37,744 p=89816 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 08:21:37,757 p=89816 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-24 08:21:40,189 p=89816 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-24 08:21:40,190 p=89816 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 08:21:40,460 p=89816 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-24 08:21:40,474 p=89816 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 08:21:41,415 p=89816 u=craig n=ansible | ok: [localhost]
2023-07-24 08:21:41,423 p=89816 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-24 08:21:41,693 p=89816 u=craig n=ansible | ok: [localhost]
2023-07-24 08:21:41,725 p=89816 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-24 08:21:41,733 p=89816 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 08:21:43,582 p=89816 u=craig n=ansible | ok: [caddy]
2023-07-24 08:21:43,642 p=89816 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-24 08:21:43,920 p=89816 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-24 08:21:43,931 p=89816 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-24 08:21:49,444 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:21:49,471 p=89816 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-24 08:21:50,568 p=89816 u=craig n=ansible | ok: [caddy]
2023-07-24 08:21:50,596 p=89816 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-24 08:22:59,054 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:22:59,125 p=89816 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-24 08:22:59,131 p=89816 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 08:22:59,954 p=89816 u=craig n=ansible | ok: [caddy]
2023-07-24 08:22:59,976 p=89816 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-24 08:23:01,935 p=89816 u=craig n=ansible | ok: [caddy]
2023-07-24 08:23:01,951 p=89816 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-24 08:23:03,880 p=89816 u=craig n=ansible | changed: [caddy] => (item=apt-transport-https)
2023-07-24 08:23:04,629 p=89816 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-24 08:23:08,141 p=89816 u=craig n=ansible | changed: [caddy] => (item=curl)
2023-07-24 08:23:13,788 p=89816 u=craig n=ansible | changed: [caddy] => (item=gnupg)
2023-07-24 08:23:14,536 p=89816 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-24 08:23:28,456 p=89816 u=craig n=ansible | changed: [caddy] => (item=software-properties-common)
2023-07-24 08:23:28,473 p=89816 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-24 08:23:29,296 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:23:29,310 p=89816 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-24 08:23:31,331 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:23:31,344 p=89816 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-24 08:23:49,991 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:23:50,003 p=89816 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-24 08:23:50,660 p=89816 u=craig n=ansible | ok: [caddy]
2023-07-24 08:23:50,671 p=89816 u=craig n=ansible | TASK [docker : apt install apparmor and apparmor-utils name=['apparmor', 'apparmor-utils'], state=present] *************************************************************************************************
2023-07-24 08:23:53,707 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:23:53,720 p=89816 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-24 08:23:54,182 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:23:54,192 p=89816 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-24 08:24:18,596 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:24:18,608 p=89816 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-24 08:24:24,085 p=89816 u=craig n=ansible | changed: [caddy]
2023-07-24 08:24:24,108 p=89816 u=craig n=ansible | RUNNING HANDLER [docker : restart container name=your_container_name, state=started, restart=True] *********************************************************************************************************
2023-07-24 08:24:24,901 p=89816 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "msg": "Cannot create container when image is not specified!"}
2023-07-24 08:24:24,903 p=89816 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-24 08:24:24,903 p=89816 u=craig n=ansible | 192.168.1.99               : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 08:24:24,903 p=89816 u=craig n=ansible | caddy                      : ok=16   changed=10   unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-07-24 08:24:24,903 p=89816 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 08:30:30,887 p=90925 u=craig n=ansible | PLAY [Deploy LXC container in Proxmox] *********************************************************************************************************************************************************************
2023-07-24 08:30:30,913 p=90925 u=craig n=ansible | TASK [create_lxc : Install proxmoxer on main host name=proxmoxer] ******************************************************************************************************************************************
2023-07-24 08:30:32,069 p=90925 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:30:32,087 p=90925 u=craig n=ansible | TASK [create_lxc : Set LXC options lxc_unprivileged={{ hookscript | ternary(0, 1) }}, lxc_hookscript={{ hookscript | ternary('local:snippets/enable_lxc_ssh_hook.sh', None) }}, lxc_features=['nesting=1', 'keyctl=1', 'fuse=1'], ssh_key_content={{ lookup('file', machine_ssh_key) }}] ***
2023-07-24 08:30:32,121 p=90925 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:30:32,131 p=90925 u=craig n=ansible | TASK [create_lxc : Debug var=lxc_hookscript] ***************************************************************************************************************************************************************
2023-07-24 08:30:32,147 p=90925 u=craig n=ansible | ok: [192.168.1.99] => {
    "lxc_hookscript": "local:snippets/enable_lxc_ssh_hook.sh"
}
2023-07-24 08:30:32,155 p=90925 u=craig n=ansible | TASK [create_lxc : Debug var=hookscript] *******************************************************************************************************************************************************************
2023-07-24 08:30:32,166 p=90925 u=craig n=ansible | ok: [192.168.1.99] => {
    "hookscript": true
}
2023-07-24 08:30:32,174 p=90925 u=craig n=ansible | TASK [create_lxc : Create a directory to house the ssh keys to pass to a new LXC path=/var/lib/vz/snippets/, state=directory, mode=448] ********************************************************************
2023-07-24 08:30:32,508 p=90925 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:30:32,521 p=90925 u=craig n=ansible | TASK [create_lxc : Copy the bash script to snippets directory and make it executable src=enable_lxc_ssh_hook.sh, dest=/var/lib/vz/snippets, mode=448] ******************************************************
2023-07-24 08:30:33,226 p=90925 u=craig n=ansible | ok: [192.168.1.99]
2023-07-24 08:30:33,235 p=90925 u=craig n=ansible | TASK [create_lxc : Create LXC vmid={{ machine_id }}, node=bigprox, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, hostname={{machine_name}}, password={{machine_password}}, ostemplate=local:vztmpl/{{machine_image}}, storage=local-lvm, unprivileged={{ lxc_unprivileged }}, hookscript={{ lxc_hookscript }}, netif={'net0':'name=enp6s0,gw=192.168.1.1,ip={{machine_ip}},bridge=vmbr0'}, pubkey={{ ssh_key_content }}, features={{ lxc_features }}, cores={{machine_cores}}, cpus={{machine_cpus}}, memory={{machine_ram}}, disk={{machine_disk}}, onboot={{onboot}}, state=present] ***
2023-07-24 08:30:41,496 p=90925 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 08:30:41,519 p=90925 u=craig n=ansible | TASK [create_lxc : Start container vmid={{ machine_id }}, api_user={{root_user}}, api_password={{root_password}}, api_host={{host_ip}}, state=started, timeout=90] *****************************************
2023-07-24 08:30:45,935 p=90925 u=craig n=ansible | [DEPRECATION WARNING]: The default value `false` for the parameter "unprivileged" is deprecated and it will be replaced with `true`. This feature will be removed from community.general in version 7.0.0. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2023-07-24 08:30:45,935 p=90925 u=craig n=ansible | changed: [192.168.1.99]
2023-07-24 08:30:45,994 p=90925 u=craig n=ansible | PLAY [Update inventory] ************************************************************************************************************************************************************************************
2023-07-24 08:30:45,997 p=90925 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 08:30:46,511 p=90925 u=craig n=ansible | ok: [localhost]
2023-07-24 08:30:46,520 p=90925 u=craig n=ansible | TASK [add_host : Add new host to the specified group in inventory file path={{ inventory_file }}, insertafter=^\[{{ group_name }}\], regexp=^{{ host_name }} , line={{ host_name }} ansible_host={{ host_ip }}{{ host_user is defined | ternary(' ansible_user=' + host_user, '') }}, state=present] ***
2023-07-24 08:30:46,809 p=90925 u=craig n=ansible | ok: [localhost]
2023-07-24 08:30:46,838 p=90925 u=craig n=ansible | PLAY [Configure LXC] ***************************************************************************************************************************************************************************************
2023-07-24 08:30:46,846 p=90925 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 08:30:48,986 p=90925 u=craig n=ansible | ok: [caddy]
2023-07-24 08:30:49,036 p=90925 u=craig n=ansible | TASK [configure_lxc : Wait for port 22 to become open on the host port=22, state=started, sleep=5, timeout=300] ********************************************************************************************
2023-07-24 08:30:49,264 p=90925 u=craig n=ansible | ok: [caddy -> localhost]
2023-07-24 08:30:49,275 p=90925 u=craig n=ansible | TASK [configure_lxc : Allow release-info to change for APT repositories _raw_params=apt-get update -y --allow-releaseinfo-change] **************************************************************************
2023-07-24 08:30:55,374 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:30:55,401 p=90925 u=craig n=ansible | TASK [configure_lxc : Run the equivalent of "apt-get update" update_cache=True, force_apt_get=True] ********************************************************************************************************
2023-07-24 08:30:56,704 p=90925 u=craig n=ansible | ok: [caddy]
2023-07-24 08:30:56,730 p=90925 u=craig n=ansible | TASK [configure_lxc : Update all packages to their latest version name=*, state=latest] ********************************************************************************************************************
2023-07-24 08:32:12,955 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:32:13,039 p=90925 u=craig n=ansible | PLAY [Install Docker in the container] *********************************************************************************************************************************************************************
2023-07-24 08:32:13,053 p=90925 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 08:32:13,883 p=90925 u=craig n=ansible | ok: [caddy]
2023-07-24 08:32:13,902 p=90925 u=craig n=ansible | TASK [docker : Update apt cache update_cache=True] *********************************************************************************************************************************************************
2023-07-24 08:32:15,946 p=90925 u=craig n=ansible | ok: [caddy]
2023-07-24 08:32:15,958 p=90925 u=craig n=ansible | TASK [docker : Install required packages name={{ item }}, state=present] ***********************************************************************************************************************************
2023-07-24 08:32:17,756 p=90925 u=craig n=ansible | changed: [caddy] => (item=apt-transport-https)
2023-07-24 08:32:18,533 p=90925 u=craig n=ansible | ok: [caddy] => (item=ca-certificates)
2023-07-24 08:32:22,135 p=90925 u=craig n=ansible | changed: [caddy] => (item=curl)
2023-07-24 08:32:27,743 p=90925 u=craig n=ansible | changed: [caddy] => (item=gnupg)
2023-07-24 08:32:28,488 p=90925 u=craig n=ansible | ok: [caddy] => (item=lsb-release)
2023-07-24 08:32:42,884 p=90925 u=craig n=ansible | changed: [caddy] => (item=software-properties-common)
2023-07-24 08:32:42,902 p=90925 u=craig n=ansible | TASK [docker : Add Docker GPG key url=https://download.docker.com/linux/ubuntu/gpg, state=present] *********************************************************************************************************
2023-07-24 08:32:43,753 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:32:43,766 p=90925 u=craig n=ansible | TASK [docker : Add Docker repository repo=deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable, state=present] **********************************************
2023-07-24 08:32:45,615 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:32:45,625 p=90925 u=craig n=ansible | TASK [docker : Install Docker name=docker-ce, state=present] ***********************************************************************************************************************************************
2023-07-24 08:33:05,203 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:05,215 p=90925 u=craig n=ansible | TASK [docker : Start and enable Docker service name=docker, state=started, enabled=True] *******************************************************************************************************************
2023-07-24 08:33:05,821 p=90925 u=craig n=ansible | ok: [caddy]
2023-07-24 08:33:05,833 p=90925 u=craig n=ansible | TASK [docker : apt install apparmor and apparmor-utils name=['apparmor', 'apparmor-utils'], state=present] *************************************************************************************************
2023-07-24 08:33:08,776 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:08,789 p=90925 u=craig n=ansible | TASK [docker : Add user to docker group name={{ ansible_user }}, groups=docker, append=True] ***************************************************************************************************************
2023-07-24 08:33:09,249 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:09,259 p=90925 u=craig n=ansible | TASK [docker : Install python3-pip name=python3-pip, state=present] ****************************************************************************************************************************************
2023-07-24 08:33:33,546 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:33,554 p=90925 u=craig n=ansible | TASK [docker : Install Docker SDK for Python name=['docker', 'requests', 'docker-compose', 'jsondiff'], state=present] *************************************************************************************
2023-07-24 08:33:39,035 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:39,067 p=90925 u=craig n=ansible | RUNNING HANDLER [docker : restart container ] **************************************************************************************************************************************************************
2023-07-24 08:33:48,168 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:48,222 p=90925 u=craig n=ansible | PLAY [Deploy Caddy in the container] ***********************************************************************************************************************************************************************
2023-07-24 08:33:48,239 p=90925 u=craig n=ansible | TASK [Gathering Facts ] ************************************************************************************************************************************************************************************
2023-07-24 08:33:49,102 p=90925 u=craig n=ansible | ok: [caddy]
2023-07-24 08:33:49,138 p=90925 u=craig n=ansible | TASK [caddy_docker : Check if Docker Compose file exists path=/opt/caddy/docker-compose.yml] ***************************************************************************************************************
2023-07-24 08:33:49,405 p=90925 u=craig n=ansible | ok: [caddy]
2023-07-24 08:33:49,421 p=90925 u=craig n=ansible | TASK [caddy_docker : Stop and remove Caddy container if it exists project_src=/opt/caddy, state=absent, remove_images=all, remove_volumes=True] ************************************************************
2023-07-24 08:33:49,435 p=90925 u=craig n=ansible | skipping: [caddy]
2023-07-24 08:33:49,446 p=90925 u=craig n=ansible | TASK [caddy_docker : Restart system reboot_timeout=300] ****************************************************************************************************************************************************
2023-07-24 08:33:49,458 p=90925 u=craig n=ansible | skipping: [caddy]
2023-07-24 08:33:49,469 p=90925 u=craig n=ansible | TASK [caddy_docker : Create caddy directory path=/opt/caddy, state=directory] ******************************************************************************************************************************
2023-07-24 08:33:49,744 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:49,762 p=90925 u=craig n=ansible | TASK [caddy_docker : Copy initial Caddyfile even if it exists src=Caddyfile, dest=/opt/caddy/Caddyfile, force=True] ****************************************************************************************
2023-07-24 08:33:50,422 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:50,440 p=90925 u=craig n=ansible | TASK [caddy_docker : Copy Dockerfile src=Dockerfile, dest=/opt/caddy/Dockerfile, force=True] ***************************************************************************************************************
2023-07-24 08:33:51,045 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:51,065 p=90925 u=craig n=ansible | TASK [caddy_docker : Copy docker-compose.yml src=templates/docker-compose.yml.j2, dest=/opt/caddy/docker-compose.yml, force=True] **************************************************************************
2023-07-24 08:33:51,700 p=90925 u=craig n=ansible | changed: [caddy]
2023-07-24 08:33:51,722 p=90925 u=craig n=ansible | TASK [caddy_docker : Start Caddy container project_src=/opt/caddy, state=present, build=True, pull=True, nocache=True] *************************************************************************************
2023-07-24 08:34:02,134 p=90925 u=craig n=ansible | fatal: [caddy]: FAILED! => {"changed": false, "errors": [], "module_stderr": "", "module_stdout": "Step 1/5 : ARG VERSION=2\nStep 2/5 : FROM caddy:${VERSION}-builder AS builder\n2-builder: Pulling from library/caddy\nDigest: sha256:8fa8a41d7e0d498b6b70a5fca05bdb9e3deb00312a830610d2efd6d83fb2b442\nStatus: Downloaded newer image for caddy:2-builder\n ---> cb47caf09278\nStep 3/5 : RUN xcaddy build     --with github.com/caddy-dns/cloudflare\n ---> Running in 51658cb7bd74\n", "msg": "Error: build failed with (<Service: caddy>, 'AppArmor enabled on system but the docker-default profile could not be loaded: running `/usr/sbin/apparmor_parser apparmor_parser -Kr /var/lib/docker/tmp/docker-default1010549278` failed with output: apparmor_parser: Unable to replace \"docker-default\".  Permission denied; attempted to load a profile while confined?\\n\\nerror: exit status 243')"}
2023-07-24 08:34:02,135 p=90925 u=craig n=ansible | PLAY RECAP *************************************************************************************************************************************************************************************************
2023-07-24 08:34:02,135 p=90925 u=craig n=ansible | 192.168.1.99               : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-07-24 08:34:02,135 p=90925 u=craig n=ansible | caddy                      : ok=23   changed=15   unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2023-07-24 08:34:02,135 p=90925 u=craig n=ansible | localhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
